
import os
os.environ['PYTORCH_KERNEL_CACHE_PATH'] = '/mnt/mffuse/.cache/torch/kernels'
os.environ['TORCH_DISABLE_ADDR2LINE'] = '1'
os.environ['TORCH_TRACE'] = '/mnt/mffuse/outputs/sfsdp-dsv3-16b--tp1-bs2-inductor-64-ivankobzarev-gw1hcmpr/torch_trace/'
os.environ['PYTORCH_CUDA_ALLOC_CONF'] = 'expandable_segments:True'
os.environ['TORCHELASTIC_LOG_LINE_PREFIX_TEMPLATE'] = '[${role_name}${rank}|${local_rank}]:'
os.environ['TORCHELASTIC_MAX_RESTARTS'] = '0'
os.environ['TORCHX_INTERNAL_SESSION_ID'] = 'a7cb45e8-8435-4d98-8768-5273c1f06ab2'
os.environ['TORCHX_RUN_PYTHONPATH'] = ''
os.environ['TORCHELASTIC_ERROR_FILE'] = '/tmp/torchelastic_rm4e8tdn/sfsdp-dsv3-16b--tp1-bs2-inductor-64-ivankobzarev-gw1hcmpr_eyl0q0pn/attempt_0/0/error.json'
os.environ['TORCH_ADDR2LINE_BINARY'] = '/packages/folly.symbolizer/folly-addr2line'
os.environ['TORCHX_JOB_ID'] = 'mast_conda://torchx/sfsdp-dsv3-16b--tp1-bs2-inductor-64-ivankobzarev-gw1hcmpr'
os.environ['TORCH_NCCL_ASYNC_ERROR_HANDLING'] = '3'
os.environ['TORCHELASTIC_SIGNALS_TO_HANDLE'] = 'SIGTERM,SIGINT,SIGHUP,SIGQUIT'
os.environ['TORCHELASTIC_RUN_ID'] = 'sfsdp-dsv3-16b--tp1-bs2-inductor-64-ivankobzarev-gw1hcmpr'
os.environ['TORCH_SHOW_CPP_STACKTRACES'] = '1'
os.environ['TORCHELASTIC_RESTART_COUNT'] = '0'
os.environ['TORCHELASTIC_USE_AGENT_STORE'] = 'False'
os.environ['PYTORCH_DDP_USE_SIDE_STREAM'] = '0'
os.environ['TORCHINDUCTOR_CACHE_DIR'] = '/tmp/torchinductor_root'
os.environ['TORCH_FR_BUFFER_SIZE'] = '20000'
os.environ['TORCH_NCCL_DUMP_ON_TIMEOUT'] = '1'
os.environ['TORCH_FR_DUMP_TEMP_FILE'] = '/mnt/mffuse_nccl_trace/nccl_trace/sfsdp-dsv3-16b--tp1-bs2-inductor-64-ivankobzarev-gw1hcmpr/v_0/attempt_0/nccl_trace_rank_'
os.environ['TRITON_CACHE_DIR'] = '/tmp/torchinductor_root/triton/0'

import torch
from torch import tensor, device
import torch.fx as fx
from torch._dynamo.testing import rand_strided
from math import inf
import torch._inductor.inductor_prims
import torch.distributed as dist
from torch.testing._internal.distributed.fake_pg import FakeStore
import triton
import triton.language as tl

import torch._dynamo.config
import torch._inductor.config
import torch._functorch.config
import torch.fx.experimental._config
torch._dynamo.config.capture_scalar_outputs = True
torch._inductor.config.allow_buffer_reuse = False
torch._inductor.config.reorder_for_compute_comm_overlap = False
torch._inductor.config.reorder_for_peak_memory = False
torch._inductor.config.max_autotune = False
torch._inductor.config.coordinate_descent_tuning = False
torch._inductor.config.deterministic = False
torch._inductor.config.aten_distributed_optimizations.collective_bucketing = True
torch._inductor.config.aten_distributed_optimizations.insert_overlap_deps = True
torch._inductor.config.wrap_inductor_compiled_regions = False
torch._inductor.config.triton.cudagraphs = False
torch._inductor.config.triton.store_cubin = False
torch._inductor.config.test_configs.runtime_triton_dtype_assert = False
torch._functorch.config.functionalize_rng_ops = False
torch._functorch.config.fake_tensor_allow_unsafe_data_ptr_access = True
torch._functorch.config.unlift_effect_tokens = True
torch._functorch.config.selective_decompose = False



isolate_fails_code_str = None





if "__compile_source__" in globals():
    import inspect as __after_aot_inspect
    import linecache as __after_aot_linecache
    __after_aot_filename = __after_aot_inspect.currentframe().f_code.co_filename
    __after_aot_linecache.cache[__after_aot_filename] = (
        len(__compile_source__),
        None,
        __compile_source__.splitlines(True),
        __after_aot_filename,
    )
# torch version: 2.11.0a0+git5ac4d4b
# torch cuda version: 12.4
# torch git version: 5ac4d4bf3f85e15fdd6676f46b090568ea91e47e


# CUDA Info: 
# nvcc not found
# GPU Hardware Info: 
# NVIDIA H100 80GB HBM3 : 8 

torch._higher_order_ops.triton_kernel_wrap.kernel_side_table.reset_table()

@triton.jit
def _fill_indices_kernel_0(
    tokens_per_expert_group_ptr,
    start_index_values_ptr,
    write_offsets_ptr,
    output_ptr,
    experts_per_rank: tl.constexpr,
    num_ranks: tl.constexpr,
    BLOCK_SIZE: tl.constexpr,  # Number of threads per block
):
    pid = tl.program_id(axis=0)
    num_programs = tl.num_programs(axis=0)

    # map programs (blocks) to the experts and loop (grid stride) if needed
    for expert_id in range(pid, experts_per_rank, num_programs):
        # read this experts write offset
        write_offset = tl.load(write_offsets_ptr + expert_id)

        for r in range(num_ranks):
            # index into tokens_per_expert_group array
            i = r * experts_per_rank + expert_id

            # load start index and number of tokens for this expert-rank pair
            start_index = tl.load(start_index_values_ptr + i)
            length = tl.load(tokens_per_expert_group_ptr + i)

            # each thread in block processes tokens in parallel
            offsets = tl.arange(0, BLOCK_SIZE)

            # tokens are processed in chunks of BLOCK_SIZE
            for chunk_start in range(0, length, BLOCK_SIZE):
                chunk_offsets = chunk_start + offsets

                # mask valid indices
                mask = chunk_offsets < length

                values = start_index + chunk_offsets

                # destination
                dest_indices = write_offset + chunk_offsets

                # store
                tl.store(output_ptr + dest_indices, values, mask=mask)

            # update write offset for next rank
            write_offset += length

torch._higher_order_ops.triton_kernel_wrap.kernel_side_table.add_kernel(_fill_indices_kernel_0)
torch._higher_order_ops.triton_kernel_wrap.kernel_side_table.constant_args={0: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 1: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 2: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 3: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 4: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 5: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 6: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 7: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 8: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 9: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 10: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 11: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 12: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 13: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 14: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 15: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 16: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 17: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 18: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 19: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 20: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 21: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 22: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 23: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 24: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}, 25: {'experts_per_rank': 8, 'num_ranks': 8, 'BLOCK_SIZE': 128}}

from torch.nn import *
# Stub for submodules referenced in backward graph
class GraphModule(torch.nn.Module):
    def __init__(self):
        super().__init__()
    def forward(self, *args, **kwargs):
        pass
class Repro(torch.nn.Module):
    def __init__(self) -> None:
        super().__init__()
        self.fw_graph0 = GraphModule()
        self.joint_graph0 = GraphModule()
        self.mask_graph0 = GraphModule()
        self.fw_graph1 = GraphModule()
        self.joint_graph1 = GraphModule()
        self.mask_graph1 = GraphModule()
        self.fw_graph2 = GraphModule()
        self.joint_graph2 = GraphModule()
        self.mask_graph2 = GraphModule()
        self.fw_graph3 = GraphModule()
        self.joint_graph3 = GraphModule()
        self.mask_graph3 = GraphModule()
        self.fw_graph4 = GraphModule()
        self.joint_graph4 = GraphModule()
        self.mask_graph4 = GraphModule()
        self.fw_graph5 = GraphModule()
        self.joint_graph5 = GraphModule()
        self.mask_graph5 = GraphModule()
        self.fw_graph6 = GraphModule()
        self.joint_graph6 = GraphModule()
        self.mask_graph6 = GraphModule()
        self.fw_graph7 = GraphModule()
        self.joint_graph7 = GraphModule()
        self.mask_graph7 = GraphModule()
        self.fw_graph8 = GraphModule()
        self.joint_graph8 = GraphModule()
        self.mask_graph8 = GraphModule()
        self.fw_graph9 = GraphModule()
        self.joint_graph9 = GraphModule()
        self.mask_graph9 = GraphModule()
        self.fw_graph10 = GraphModule()
        self.joint_graph10 = GraphModule()
        self.mask_graph10 = GraphModule()
        self.fw_graph11 = GraphModule()
        self.joint_graph11 = GraphModule()
        self.mask_graph11 = GraphModule()
        self.fw_graph12 = GraphModule()
        self.joint_graph12 = GraphModule()
        self.mask_graph12 = GraphModule()
        self.fw_graph13 = GraphModule()
        self.joint_graph13 = GraphModule()
        self.mask_graph13 = GraphModule()
        self.fw_graph14 = GraphModule()
        self.joint_graph14 = GraphModule()
        self.mask_graph14 = GraphModule()
        self.fw_graph15 = GraphModule()
        self.joint_graph15 = GraphModule()
        self.mask_graph15 = GraphModule()
        self.fw_graph16 = GraphModule()
        self.joint_graph16 = GraphModule()
        self.mask_graph16 = GraphModule()
        self.fw_graph17 = GraphModule()
        self.joint_graph17 = GraphModule()
        self.mask_graph17 = GraphModule()
        self.fw_graph18 = GraphModule()
        self.joint_graph18 = GraphModule()
        self.mask_graph18 = GraphModule()
        self.fw_graph19 = GraphModule()
        self.joint_graph19 = GraphModule()
        self.mask_graph19 = GraphModule()
        self.fw_graph20 = GraphModule()
        self.joint_graph20 = GraphModule()
        self.mask_graph20 = GraphModule()
        self.fw_graph21 = GraphModule()
        self.joint_graph21 = GraphModule()
        self.mask_graph21 = GraphModule()
        self.fw_graph22 = GraphModule()
        self.joint_graph22 = GraphModule()
        self.mask_graph22 = GraphModule()
        self.fw_graph23 = GraphModule()
        self.joint_graph23 = GraphModule()
        self.mask_graph23 = GraphModule()
        self.fw_graph24 = GraphModule()
        self.joint_graph24 = GraphModule()
        self.mask_graph24 = GraphModule()
        self.fw_graph25 = GraphModule()
        self.joint_graph25 = GraphModule()
        self.mask_graph25 = GraphModule()
        self.fw_graph26 = GraphModule()
        self.joint_graph26 = GraphModule()
        self.mask_graph26 = GraphModule()



    def forward(self, _local_scalar_dense, _local_scalar_dense_1, _local_scalar_dense_2, _local_scalar_dense_3, _local_scalar_dense_4, _local_scalar_dense_5, _local_scalar_dense_6, _local_scalar_dense_7, _local_scalar_dense_8, _local_scalar_dense_9, _local_scalar_dense_10, _local_scalar_dense_11, _local_scalar_dense_12, _local_scalar_dense_13, _local_scalar_dense_14, _local_scalar_dense_15, _local_scalar_dense_16, _local_scalar_dense_17, _local_scalar_dense_18, _local_scalar_dense_19, _local_scalar_dense_20, _local_scalar_dense_21, _local_scalar_dense_22, _local_scalar_dense_23, _local_scalar_dense_24, _local_scalar_dense_25, _local_scalar_dense_26, _local_scalar_dense_27, _local_scalar_dense_28, _local_scalar_dense_29, _local_scalar_dense_30, _local_scalar_dense_31, _local_scalar_dense_32, _local_scalar_dense_33, _local_scalar_dense_34, _local_scalar_dense_35, _local_scalar_dense_36, _local_scalar_dense_37, _local_scalar_dense_38, _local_scalar_dense_39, _local_scalar_dense_40, _local_scalar_dense_41, _local_scalar_dense_42, _local_scalar_dense_43, _local_scalar_dense_44, _local_scalar_dense_45, _local_scalar_dense_46, _local_scalar_dense_47, _local_scalar_dense_48, _local_scalar_dense_49, _local_scalar_dense_50, _local_scalar_dense_51, _local_scalar_dense_52, _local_scalar_dense_53, _local_scalar_dense_54, _local_scalar_dense_55, _local_scalar_dense_56, _local_scalar_dense_57, _local_scalar_dense_58, _local_scalar_dense_59, _local_scalar_dense_60, _local_scalar_dense_61, _local_scalar_dense_62, _local_scalar_dense_63, _local_scalar_dense_64, _local_scalar_dense_65, _local_scalar_dense_66, _local_scalar_dense_67, _local_scalar_dense_68, _local_scalar_dense_69, _local_scalar_dense_70, _local_scalar_dense_71, _local_scalar_dense_72, _local_scalar_dense_73, _local_scalar_dense_74, _local_scalar_dense_75, _local_scalar_dense_76, _local_scalar_dense_77, _local_scalar_dense_78, _local_scalar_dense_79, _local_scalar_dense_80, _local_scalar_dense_81, _local_scalar_dense_82, _local_scalar_dense_83, _local_scalar_dense_84, _local_scalar_dense_85, _local_scalar_dense_86, _local_scalar_dense_87, _local_scalar_dense_88, _local_scalar_dense_89, _local_scalar_dense_90, _local_scalar_dense_91, _local_scalar_dense_92, _local_scalar_dense_93, _local_scalar_dense_94, _local_scalar_dense_95, _local_scalar_dense_96, _local_scalar_dense_97, _local_scalar_dense_98, _local_scalar_dense_99, _local_scalar_dense_100, _local_scalar_dense_101, _local_scalar_dense_102, _local_scalar_dense_103, _local_scalar_dense_104, _local_scalar_dense_105, _local_scalar_dense_106, _local_scalar_dense_107, _local_scalar_dense_108, _local_scalar_dense_109, _local_scalar_dense_110, _local_scalar_dense_111, _local_scalar_dense_112, _local_scalar_dense_113, _local_scalar_dense_114, _local_scalar_dense_115, _local_scalar_dense_116, _local_scalar_dense_117, _local_scalar_dense_118, _local_scalar_dense_119, _local_scalar_dense_120, _local_scalar_dense_121, _local_scalar_dense_122, _local_scalar_dense_123, _local_scalar_dense_124, _local_scalar_dense_125, _local_scalar_dense_126, _local_scalar_dense_127, _local_scalar_dense_128, _local_scalar_dense_129, _local_scalar_dense_130, _local_scalar_dense_131, _local_scalar_dense_132, _local_scalar_dense_133, _local_scalar_dense_134, _local_scalar_dense_135, _local_scalar_dense_136, _local_scalar_dense_137, _local_scalar_dense_138, _local_scalar_dense_139, _local_scalar_dense_140, _local_scalar_dense_141, _local_scalar_dense_142, _local_scalar_dense_143, _local_scalar_dense_144, _local_scalar_dense_145, _local_scalar_dense_146, _local_scalar_dense_147, _local_scalar_dense_148, _local_scalar_dense_149, _local_scalar_dense_150, _local_scalar_dense_151, _local_scalar_dense_152, _local_scalar_dense_153, _local_scalar_dense_154, _local_scalar_dense_155, _local_scalar_dense_156, _local_scalar_dense_157, _local_scalar_dense_158, _local_scalar_dense_159, _local_scalar_dense_160, _local_scalar_dense_161, _local_scalar_dense_162, _local_scalar_dense_163, _local_scalar_dense_164, _local_scalar_dense_165, _local_scalar_dense_166, _local_scalar_dense_167, _local_scalar_dense_168, _local_scalar_dense_169, _local_scalar_dense_170, _local_scalar_dense_171, _local_scalar_dense_172, _local_scalar_dense_173, _local_scalar_dense_174, _local_scalar_dense_175, _local_scalar_dense_176, _local_scalar_dense_177, _local_scalar_dense_178, _local_scalar_dense_179, _local_scalar_dense_180, _local_scalar_dense_181, _local_scalar_dense_182, _local_scalar_dense_183, _local_scalar_dense_184, _local_scalar_dense_185, _local_scalar_dense_186, _local_scalar_dense_187, _local_scalar_dense_188, _local_scalar_dense_189, _local_scalar_dense_190, _local_scalar_dense_191, _local_scalar_dense_192, _local_scalar_dense_193, _local_scalar_dense_194, _local_scalar_dense_195, _local_scalar_dense_196, _local_scalar_dense_197, _local_scalar_dense_198, _local_scalar_dense_199, _local_scalar_dense_200, _local_scalar_dense_201, _local_scalar_dense_202, _local_scalar_dense_203, _local_scalar_dense_204, _local_scalar_dense_205, _local_scalar_dense_206, _local_scalar_dense_207, _local_scalar_dense_208, _local_scalar_dense_209, _local_scalar_dense_210, _local_scalar_dense_211, _local_scalar_dense_212, _local_scalar_dense_213, _local_scalar_dense_214, _local_scalar_dense_215, _local_scalar_dense_216, _local_scalar_dense_217, _local_scalar_dense_218, _local_scalar_dense_219, _local_scalar_dense_220, _local_scalar_dense_221, _local_scalar_dense_222, _local_scalar_dense_223, _local_scalar_dense_224, _local_scalar_dense_225, _local_scalar_dense_226, _local_scalar_dense_227, _local_scalar_dense_228, _local_scalar_dense_229, _local_scalar_dense_230, _local_scalar_dense_231, _local_scalar_dense_232, _local_scalar_dense_233, _local_scalar_dense_234, _local_scalar_dense_235, _local_scalar_dense_236, _local_scalar_dense_237, _local_scalar_dense_238, _local_scalar_dense_239, _local_scalar_dense_240, _local_scalar_dense_241, _local_scalar_dense_242, _local_scalar_dense_243, _local_scalar_dense_244, _local_scalar_dense_245, _local_scalar_dense_246, _local_scalar_dense_247, _local_scalar_dense_248, _local_scalar_dense_249, _local_scalar_dense_250, _local_scalar_dense_251, _local_scalar_dense_252, _local_scalar_dense_253, _local_scalar_dense_254, _local_scalar_dense_255, _local_scalar_dense_256, _local_scalar_dense_257, _local_scalar_dense_258, _local_scalar_dense_259, _local_scalar_dense_260, _local_scalar_dense_261, _local_scalar_dense_262, _local_scalar_dense_263, _local_scalar_dense_264, _local_scalar_dense_265, _local_scalar_dense_266, _local_scalar_dense_267, _local_scalar_dense_268, _local_scalar_dense_269, _local_scalar_dense_270, _local_scalar_dense_271, _local_scalar_dense_272, _local_scalar_dense_273, _local_scalar_dense_274, _local_scalar_dense_275, _local_scalar_dense_276, _local_scalar_dense_277, _local_scalar_dense_278, _local_scalar_dense_279, _local_scalar_dense_280, _local_scalar_dense_281, _local_scalar_dense_282, _local_scalar_dense_283, _local_scalar_dense_284, _local_scalar_dense_285, _local_scalar_dense_286, _local_scalar_dense_287, _local_scalar_dense_288, _local_scalar_dense_289, _local_scalar_dense_290, _local_scalar_dense_291, _local_scalar_dense_292, _local_scalar_dense_293, _local_scalar_dense_294, _local_scalar_dense_295, _local_scalar_dense_296, _local_scalar_dense_297, _local_scalar_dense_298, _local_scalar_dense_299, _local_scalar_dense_300, _local_scalar_dense_301, _local_scalar_dense_302, _local_scalar_dense_303, _local_scalar_dense_304, _local_scalar_dense_305, _local_scalar_dense_306, _local_scalar_dense_307, _local_scalar_dense_308, _local_scalar_dense_309, _local_scalar_dense_310, _local_scalar_dense_311, _local_scalar_dense_312, _local_scalar_dense_313, _local_scalar_dense_314, _local_scalar_dense_315, _local_scalar_dense_316, _local_scalar_dense_317, _local_scalar_dense_318, _local_scalar_dense_319, _local_scalar_dense_320, _local_scalar_dense_321, _local_scalar_dense_322, _local_scalar_dense_323, _local_scalar_dense_324, _local_scalar_dense_325, _local_scalar_dense_326, _local_scalar_dense_327, _local_scalar_dense_328, _local_scalar_dense_329, _local_scalar_dense_330, _local_scalar_dense_331, _local_scalar_dense_332, _local_scalar_dense_333, _local_scalar_dense_334, _local_scalar_dense_335, _local_scalar_dense_336, _local_scalar_dense_337, _local_scalar_dense_338, _local_scalar_dense_339, _local_scalar_dense_340, _local_scalar_dense_341, _local_scalar_dense_342, _local_scalar_dense_343, _local_scalar_dense_344, _local_scalar_dense_345, _local_scalar_dense_346, _local_scalar_dense_347, _local_scalar_dense_348, _local_scalar_dense_349, _local_scalar_dense_350, _local_scalar_dense_351, _local_scalar_dense_352, _local_scalar_dense_353, _local_scalar_dense_354, _local_scalar_dense_355, _local_scalar_dense_356, _local_scalar_dense_357, _local_scalar_dense_358, _local_scalar_dense_359, _local_scalar_dense_360, _local_scalar_dense_361, _local_scalar_dense_362, _local_scalar_dense_363, _local_scalar_dense_364, _local_scalar_dense_365, _local_scalar_dense_366, _local_scalar_dense_367, _local_scalar_dense_368, _local_scalar_dense_369, _local_scalar_dense_370, _local_scalar_dense_371, _local_scalar_dense_372, _local_scalar_dense_373, _local_scalar_dense_374, _local_scalar_dense_375, _local_scalar_dense_376, _local_scalar_dense_377, _local_scalar_dense_378, _local_scalar_dense_379, _local_scalar_dense_380, _local_scalar_dense_381, _local_scalar_dense_382, _local_scalar_dense_383, _local_scalar_dense_384, _local_scalar_dense_385, _local_scalar_dense_386, _local_scalar_dense_387, _local_scalar_dense_388, _local_scalar_dense_389, _local_scalar_dense_390, _local_scalar_dense_391, _local_scalar_dense_392, _local_scalar_dense_393, _local_scalar_dense_394, _local_scalar_dense_395, _local_scalar_dense_396, _local_scalar_dense_397, _local_scalar_dense_398, _local_scalar_dense_399, _local_scalar_dense_400, _local_scalar_dense_401, _local_scalar_dense_402, _local_scalar_dense_403, _local_scalar_dense_404, _local_scalar_dense_405, _local_scalar_dense_406, _local_scalar_dense_407, _local_scalar_dense_408, _local_scalar_dense_409, _local_scalar_dense_410, _local_scalar_dense_411, _local_scalar_dense_412, _local_scalar_dense_413, _local_scalar_dense_414, _local_scalar_dense_415, sym_size_int_1, sym_size_int_5, sym_size_int_9, sym_size_int_13, sym_size_int_17, sym_size_int_21, sym_size_int_25, sym_size_int_29, sym_size_int_33, sym_size_int_37, sym_size_int_41, sym_size_int_45, sym_size_int_49, sym_size_int_53, sym_size_int_57, sym_size_int_61, sym_size_int_65, sym_size_int_69, sym_size_int_73, sym_size_int_77, sym_size_int_81, sym_size_int_85, sym_size_int_89, sym_size_int_93, sym_size_int_97, sym_size_int_101, add_1781, add_1796, add_1811, add_1826, add_1841, add_1856, add_1871, add_1886, add_1901, add_1916, add_1931, add_1946, add_1961, add_1976, add_1991, add_2006, add_2021, add_2036, add_2051, add_2066, add_2081, add_2096, add_2111, add_2126, add_2141, add_2156, primals_1, primals_2, primals_3, primals_4, primals_5, primals_6, primals_7, primals_8, primals_9, primals_10, primals_11, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, primals_18, primals_19, primals_20, primals_21, primals_22, primals_23, primals_24, primals_25, primals_26, primals_27, primals_28, primals_29, primals_31, primals_33, primals_34, primals_35, primals_36, primals_37, primals_38, primals_39, primals_40, primals_41, primals_42, primals_43, primals_44, primals_45, primals_47, primals_49, primals_50, primals_51, primals_52, primals_53, primals_54, primals_55, primals_56, primals_57, primals_58, primals_59, primals_60, primals_61, primals_63, primals_65, primals_66, primals_67, primals_68, primals_69, primals_70, primals_71, primals_72, primals_73, primals_74, primals_75, primals_76, primals_77, primals_79, primals_81, primals_82, primals_83, primals_84, primals_85, primals_86, primals_87, primals_88, primals_89, primals_90, primals_91, primals_92, primals_93, primals_95, primals_97, primals_98, primals_99, primals_100, primals_101, primals_102, primals_103, primals_104, primals_105, primals_106, primals_107, primals_108, primals_109, primals_111, primals_113, primals_114, primals_115, primals_116, primals_117, primals_118, primals_119, primals_120, primals_121, primals_122, primals_123, primals_124, primals_125, primals_127, primals_129, primals_130, primals_131, primals_132, primals_133, primals_134, primals_135, primals_136, primals_137, primals_138, primals_139, primals_140, primals_141, primals_143, primals_145, primals_146, primals_147, primals_148, primals_149, primals_150, primals_151, primals_152, primals_153, primals_154, primals_155, primals_156, primals_157, primals_159, primals_161, primals_162, primals_163, primals_164, primals_165, primals_166, primals_167, primals_168, primals_169, primals_170, primals_171, primals_172, primals_173, primals_175, primals_177, primals_178, primals_179, primals_180, primals_181, primals_182, primals_183, primals_184, primals_185, primals_186, primals_187, primals_188, primals_189, primals_191, primals_193, primals_194, primals_195, primals_196, primals_197, primals_198, primals_199, primals_200, primals_201, primals_202, primals_203, primals_204, primals_205, primals_207, primals_209, primals_210, primals_211, primals_212, primals_213, primals_214, primals_215, primals_216, primals_217, primals_218, primals_219, primals_220, primals_221, primals_223, primals_225, primals_226, primals_227, primals_228, primals_229, primals_230, primals_231, primals_232, primals_233, primals_234, primals_235, primals_236, primals_237, primals_239, primals_241, primals_242, primals_243, primals_244, primals_245, primals_246, primals_247, primals_248, primals_249, primals_250, primals_251, primals_252, primals_253, primals_255, primals_257, primals_258, primals_259, primals_260, primals_261, primals_262, primals_263, primals_264, primals_265, primals_266, primals_267, primals_268, primals_269, primals_271, primals_273, primals_274, primals_275, primals_276, primals_277, primals_278, primals_279, primals_280, primals_281, primals_282, primals_283, primals_284, primals_285, primals_287, primals_289, primals_290, primals_291, primals_292, primals_293, primals_294, primals_295, primals_296, primals_297, primals_298, primals_299, primals_300, primals_301, primals_303, primals_305, primals_306, primals_307, primals_308, primals_309, primals_310, primals_311, primals_312, primals_313, primals_314, primals_315, primals_316, primals_317, primals_319, primals_321, primals_322, primals_323, primals_324, primals_325, primals_326, primals_327, primals_328, primals_329, primals_330, primals_331, primals_332, primals_333, primals_335, primals_337, primals_338, primals_339, primals_340, primals_341, primals_342, primals_343, primals_344, primals_345, primals_346, primals_347, primals_348, primals_349, primals_351, primals_353, primals_354, primals_355, primals_356, primals_357, primals_358, primals_359, primals_360, primals_361, primals_362, primals_363, primals_364, primals_365, primals_367, primals_369, primals_370, primals_371, primals_372, primals_373, primals_374, primals_375, primals_376, primals_377, primals_378, primals_379, primals_380, primals_381, primals_383, primals_385, primals_386, primals_387, primals_388, primals_389, primals_390, primals_391, primals_392, primals_393, primals_394, primals_395, primals_396, primals_397, primals_399, primals_401, primals_402, primals_403, primals_404, primals_405, primals_406, primals_407, primals_408, primals_409, primals_410, primals_411, primals_412, primals_413, primals_415, primals_417, primals_418, primals_419, primals_420, primals_421, primals_422, primals_423, primals_424, primals_425, primals_426, primals_427, primals_428, primals_429, primals_431, primals_433, primals_434, primals_435, primals_436, primals_437, primals_438, primals_439, primals_440, embedding, rsqrt, view_3, getitem_2, rsqrt_1, view_17, permute_3, permute_4, permute_5, getitem_6, getitem_7, mm_3, rsqrt_2, view_26, mm_4, mm_5, view_32, add_5, rsqrt_3, view_36, getitem_11, rsqrt_4, view_50, permute_14, permute_15, permute_16, getitem_15, getitem_16, add_8, rsqrt_5, view_58, mm_11, amax, sum_1, getitem_19, getitem_21, div_2, getitem_22, index_1, cumsum_2, _grouped_mm, _grouped_mm_1, mul_35, mm_12, mm_13, mul_55, add_73, rsqrt_6, view_103, getitem_25, rsqrt_7, view_117, permute_29, permute_30, permute_31, getitem_29, getitem_30, add_76, rsqrt_8, view_125, mm_19, amax_1, sum_5, getitem_33, getitem_35, div_7, getitem_36, index_3, cumsum_5, _grouped_mm_3, _grouped_mm_4, mul_84, mm_20, mm_21, mul_104, add_141, rsqrt_9, view_170, getitem_39, rsqrt_10, view_184, permute_44, permute_45, permute_46, getitem_43, getitem_44, add_144, rsqrt_11, view_192, mm_27, amax_2, sum_9, getitem_47, getitem_49, div_12, getitem_50, index_5, cumsum_8, _grouped_mm_6, _grouped_mm_7, mul_133, mm_28, mm_29, mul_153, add_209, rsqrt_12, view_237, getitem_53, rsqrt_13, view_251, permute_59, permute_60, permute_61, getitem_57, getitem_58, add_212, rsqrt_14, view_259, mm_35, amax_3, sum_13, getitem_61, getitem_63, div_17, getitem_64, index_7, cumsum_11, _grouped_mm_9, _grouped_mm_10, mul_182, mm_36, mm_37, mul_202, add_277, rsqrt_15, view_304, getitem_67, rsqrt_16, view_318, permute_74, permute_75, permute_76, getitem_71, getitem_72, add_280, rsqrt_17, view_326, mm_43, amax_4, sum_17, getitem_75, getitem_77, div_22, getitem_78, index_9, cumsum_14, _grouped_mm_12, _grouped_mm_13, mul_231, mm_44, mm_45, mul_251, add_345, rsqrt_18, view_371, getitem_81, rsqrt_19, view_385, permute_89, permute_90, permute_91, getitem_85, getitem_86, add_348, rsqrt_20, view_393, mm_51, amax_5, sum_21, getitem_89, getitem_91, div_27, getitem_92, index_11, cumsum_17, _grouped_mm_15, _grouped_mm_16, mul_280, mm_52, mm_53, mul_300, add_413, rsqrt_21, view_438, getitem_95, rsqrt_22, view_452, permute_104, permute_105, permute_106, getitem_99, getitem_100, add_416, rsqrt_23, view_460, mm_59, amax_6, sum_25, getitem_103, getitem_105, div_32, getitem_106, index_13, cumsum_20, _grouped_mm_18, _grouped_mm_19, mul_329, mm_60, mm_61, mul_349, add_481, rsqrt_24, view_505, getitem_109, rsqrt_25, view_519, permute_119, permute_120, permute_121, getitem_113, getitem_114, add_484, rsqrt_26, view_527, mm_67, amax_7, sum_29, getitem_117, getitem_119, div_37, getitem_120, index_15, cumsum_23, _grouped_mm_21, _grouped_mm_22, mul_378, mm_68, mm_69, mul_398, add_549, rsqrt_27, view_572, getitem_123, rsqrt_28, view_586, permute_134, permute_135, permute_136, getitem_127, getitem_128, add_552, rsqrt_29, view_594, mm_75, amax_8, sum_33, getitem_131, getitem_133, div_42, getitem_134, index_17, cumsum_26, _grouped_mm_24, _grouped_mm_25, mul_427, mm_76, mm_77, mul_447, add_617, rsqrt_30, view_639, getitem_137, rsqrt_31, view_653, permute_149, permute_150, permute_151, getitem_141, getitem_142, add_620, rsqrt_32, view_661, mm_83, amax_9, sum_37, getitem_145, getitem_147, div_47, getitem_148, index_19, cumsum_29, _grouped_mm_27, _grouped_mm_28, mul_476, mm_84, mm_85, mul_496, add_685, rsqrt_33, view_706, getitem_151, rsqrt_34, view_720, permute_164, permute_165, permute_166, getitem_155, getitem_156, add_688, rsqrt_35, view_728, mm_91, amax_10, sum_41, getitem_159, getitem_161, div_52, getitem_162, index_21, cumsum_32, _grouped_mm_30, _grouped_mm_31, mul_525, mm_92, mm_93, mul_545, add_753, rsqrt_36, view_773, getitem_165, rsqrt_37, view_787, permute_179, permute_180, permute_181, getitem_169, getitem_170, add_756, rsqrt_38, view_795, mm_99, amax_11, sum_45, getitem_173, getitem_175, div_57, getitem_176, index_23, cumsum_35, _grouped_mm_33, _grouped_mm_34, mul_574, mm_100, mm_101, mul_594, add_821, rsqrt_39, view_840, getitem_179, rsqrt_40, view_854, permute_194, permute_195, permute_196, getitem_183, getitem_184, add_824, rsqrt_41, view_862, mm_107, amax_12, sum_49, getitem_187, getitem_189, div_62, getitem_190, index_25, cumsum_38, _grouped_mm_36, _grouped_mm_37, mul_623, mm_108, mm_109, mul_643, add_889, rsqrt_42, view_907, getitem_193, rsqrt_43, view_921, permute_209, permute_210, permute_211, getitem_197, getitem_198, add_892, rsqrt_44, view_929, mm_115, amax_13, sum_53, getitem_201, getitem_203, div_67, getitem_204, index_27, cumsum_41, _grouped_mm_39, _grouped_mm_40, mul_672, mm_116, mm_117, mul_692, add_957, rsqrt_45, view_974, getitem_207, rsqrt_46, view_988, permute_224, permute_225, permute_226, getitem_211, getitem_212, add_960, rsqrt_47, view_996, mm_123, amax_14, sum_57, getitem_215, getitem_217, div_72, getitem_218, index_29, cumsum_44, _grouped_mm_42, _grouped_mm_43, mul_721, mm_124, mm_125, mul_741, add_1025, rsqrt_48, view_1041, getitem_221, rsqrt_49, view_1055, permute_239, permute_240, permute_241, getitem_225, getitem_226, add_1028, rsqrt_50, view_1063, mm_131, amax_15, sum_61, getitem_229, getitem_231, div_77, getitem_232, index_31, cumsum_47, _grouped_mm_45, _grouped_mm_46, mul_770, mm_132, mm_133, mul_790, add_1093, rsqrt_51, view_1108, getitem_235, rsqrt_52, view_1122, permute_254, permute_255, permute_256, getitem_239, getitem_240, add_1096, rsqrt_53, view_1130, mm_139, amax_16, sum_65, getitem_243, getitem_245, div_82, getitem_246, index_33, cumsum_50, _grouped_mm_48, _grouped_mm_49, mul_819, mm_140, mm_141, mul_839, add_1161, rsqrt_54, view_1175, getitem_249, rsqrt_55, view_1189, permute_269, permute_270, permute_271, getitem_253, getitem_254, add_1164, rsqrt_56, view_1197, mm_147, amax_17, sum_69, getitem_257, getitem_259, div_87, getitem_260, index_35, cumsum_53, _grouped_mm_51, _grouped_mm_52, mul_868, mm_148, mm_149, mul_888, add_1229, rsqrt_57, view_1242, getitem_263, rsqrt_58, view_1256, permute_284, permute_285, permute_286, getitem_267, getitem_268, add_1232, rsqrt_59, view_1264, mm_155, amax_18, sum_73, getitem_271, getitem_273, div_92, getitem_274, index_37, cumsum_56, _grouped_mm_54, _grouped_mm_55, mul_917, mm_156, mm_157, mul_937, add_1297, rsqrt_60, view_1309, getitem_277, rsqrt_61, view_1323, permute_299, permute_300, permute_301, getitem_281, getitem_282, add_1300, rsqrt_62, view_1331, mm_163, amax_19, sum_77, getitem_285, getitem_287, div_97, getitem_288, index_39, cumsum_59, _grouped_mm_57, _grouped_mm_58, mul_966, mm_164, mm_165, mul_986, add_1365, rsqrt_63, view_1376, getitem_291, rsqrt_64, view_1390, permute_314, permute_315, permute_316, getitem_295, getitem_296, add_1368, rsqrt_65, view_1398, mm_171, amax_20, sum_81, getitem_299, getitem_301, div_102, getitem_302, index_41, cumsum_62, _grouped_mm_60, _grouped_mm_61, mul_1015, mm_172, mm_173, mul_1035, add_1433, rsqrt_66, view_1443, getitem_305, rsqrt_67, view_1457, permute_329, permute_330, permute_331, getitem_309, getitem_310, add_1436, rsqrt_68, view_1465, mm_179, amax_21, sum_85, getitem_313, getitem_315, div_107, getitem_316, index_43, cumsum_65, _grouped_mm_63, _grouped_mm_64, mul_1064, mm_180, mm_181, mul_1084, add_1501, rsqrt_69, view_1510, getitem_319, rsqrt_70, view_1524, permute_344, permute_345, permute_346, getitem_323, getitem_324, add_1504, rsqrt_71, view_1532, mm_187, amax_22, sum_89, getitem_327, getitem_329, div_112, getitem_330, index_45, cumsum_68, _grouped_mm_66, _grouped_mm_67, mul_1113, mm_188, mm_189, mul_1133, add_1569, rsqrt_72, view_1577, getitem_333, rsqrt_73, view_1591, permute_359, permute_360, permute_361, getitem_337, getitem_338, add_1572, rsqrt_74, view_1599, mm_195, amax_23, sum_93, getitem_341, getitem_343, div_117, getitem_344, index_47, cumsum_71, _grouped_mm_69, _grouped_mm_70, mul_1162, mm_196, mm_197, mul_1182, add_1637, rsqrt_75, view_1644, getitem_347, rsqrt_76, view_1658, permute_374, permute_375, permute_376, getitem_351, getitem_352, add_1640, rsqrt_77, view_1666, mm_203, amax_24, sum_97, getitem_355, getitem_357, div_122, getitem_358, index_49, cumsum_74, _grouped_mm_72, _grouped_mm_73, mul_1211, mm_204, mm_205, mul_1231, add_1705, rsqrt_78, view_1711, getitem_361, rsqrt_79, view_1725, permute_389, permute_390, permute_391, getitem_365, getitem_366, add_1708, rsqrt_80, view_1733, mm_211, amax_25, sum_101, getitem_369, getitem_371, div_127, getitem_372, index_51, cumsum_77, _grouped_mm_75, _grouped_mm_76, mul_1260, mm_212, mm_213, mul_1280, add_1773, rsqrt_81, view_1778, permute_406, permute_407, permute_456, permute_457, permute_506, permute_507, permute_556, permute_557, permute_606, permute_607, permute_656, permute_657, permute_706, permute_707, permute_756, permute_757, permute_806, permute_807, permute_856, permute_857, permute_906, permute_907, permute_956, permute_957, permute_1006, permute_1007, permute_1056, permute_1057, permute_1106, permute_1107, permute_1156, permute_1157, permute_1206, permute_1207, permute_1256, permute_1257, permute_1306, permute_1307, permute_1356, permute_1357, permute_1406, permute_1407, permute_1456, permute_1457, permute_1506, permute_1507, permute_1556, permute_1557, permute_1606, permute_1607, permute_1656, permute_1657, tangents_1):
        view_1780 = torch.ops.aten.view.default(tangents_1, [8192, 102400]);  tangents_1 = None
        permute_402 = torch.ops.aten.permute.default(view_1780, [1, 0])
        mm_216 = torch.ops.aten.mm.default(permute_402, view_1778);  permute_402 = view_1778 = None
        convert_element_type_1444 = torch.ops.prims.convert_element_type.default(primals_440, torch.bfloat16);  primals_440 = None
        all_gather_into_tensor_454 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1444, 64, '0');  convert_element_type_1444 = None
        wait_tensor_558 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_454);  all_gather_into_tensor_454 = None
        permute_401 = torch.ops.aten.permute.default(wait_tensor_558, [1, 0]);  wait_tensor_558 = None
        permute_404 = torch.ops.aten.permute.default(permute_401, [1, 0]);  permute_401 = None
        mm_217 = torch.ops.aten.mm.default(view_1780, permute_404);  view_1780 = permute_404 = None
        view_1781 = torch.ops.aten.view.default(mm_217, [2, 4096, 2048]);  mm_217 = None
        convert_element_type_1451 = torch.ops.prims.convert_element_type.default(mm_216, torch.float32);  mm_216 = None
        reduce_scatter_tensor = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1451, 'avg', 64, '0');  convert_element_type_1451 = None
        wait_tensor_559 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor);  reduce_scatter_tensor = None
        convert_element_type_1452 = torch.ops.prims.convert_element_type.default(view_1781, torch.float32);  view_1781 = None
        convert_element_type_1441 = torch.ops.prims.convert_element_type.default(primals_439, torch.bfloat16);  primals_439 = None
        all_gather_into_tensor_453 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1441, 64, '0');  convert_element_type_1441 = None
        wait_tensor_557 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_453);  all_gather_into_tensor_453 = None
        convert_element_type_1454 = torch.ops.prims.convert_element_type.default(wait_tensor_557, torch.float32);  wait_tensor_557 = None
        mul_1285 = torch.ops.aten.mul.Tensor(convert_element_type_1452, convert_element_type_1454);  convert_element_type_1454 = None
        convert_element_type_1442 = torch.ops.prims.convert_element_type.default(add_1773, torch.float32);  add_1773 = None
        mul_1283 = torch.ops.aten.mul.Tensor(convert_element_type_1442, rsqrt_81);  convert_element_type_1442 = None
        mul_1287 = torch.ops.aten.mul.Tensor(mul_1283, mul_1285)
        sum_105 = torch.ops.aten.sum.dim_IntList(mul_1287, [2], True);  mul_1287 = None
        div_131 = torch.ops.aten.div.Tensor(mul_1283, 2048)
        mul_1288 = torch.ops.aten.mul.Tensor(div_131, sum_105);  div_131 = sum_105 = None
        sub_624 = torch.ops.aten.sub.Tensor(mul_1285, mul_1288);  mul_1285 = mul_1288 = None
        mul_1289 = torch.ops.aten.mul.Tensor(sub_624, rsqrt_81);  sub_624 = rsqrt_81 = None
        mul_1290 = torch.ops.aten.mul.Tensor(convert_element_type_1452, mul_1283);  convert_element_type_1452 = mul_1283 = None
        sum_106 = torch.ops.aten.sum.dim_IntList(mul_1290, [0, 1]);  mul_1290 = None
        convert_element_type_1455 = torch.ops.prims.convert_element_type.default(mul_1289, torch.bfloat16);  mul_1289 = None
        convert_element_type_default_82 = torch.ops.prims.convert_element_type.default(sum_106, torch.float32);  sum_106 = None
        reduce_scatter_tensor_1 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_82, 'avg', 64, '0');  convert_element_type_default_82 = None
        wait_tensor_560 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_1);  reduce_scatter_tensor_1 = None
        view_1782 = torch.ops.aten.view.default(convert_element_type_1455, [8192, 2048])
        unsqueeze_53 = torch.ops.aten.unsqueeze.default(view_1782, 1)
        convert_element_type_1458 = torch.ops.prims.convert_element_type.default(unsqueeze_53, torch.float32);  unsqueeze_53 = None
        bmm_26 = torch.ops.aten.bmm.default(permute_406, convert_element_type_1458);  permute_406 = None
        bmm_27 = torch.ops.aten.bmm.default(convert_element_type_1458, permute_407);  convert_element_type_1458 = permute_407 = None
        convert_element_type_1459 = torch.ops.prims.convert_element_type.default(bmm_26, torch.bfloat16);  bmm_26 = None
        view_1783 = torch.ops.aten.view.default(bmm_27, [8192, 6]);  bmm_27 = None
        view_1784 = torch.ops.aten.view.default(convert_element_type_1459, [49152, 2048]);  convert_element_type_1459 = None
        index_52 = torch.ops.aten.index.Tensor(view_1784, [getitem_371]);  view_1784 = getitem_371 = None
        permute_408 = torch.ops.aten.permute.default(view_1782, [1, 0])
        mm_218 = torch.ops.aten.mm.default(permute_408, mul_1280);  permute_408 = mul_1280 = None
        convert_element_type_1436 = torch.ops.prims.convert_element_type.default(primals_438, torch.bfloat16);  primals_438 = None
        all_gather_into_tensor_452 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1436, 64, '0');  convert_element_type_1436 = None
        wait_tensor_556 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_452);  all_gather_into_tensor_452 = None
        permute_400 = torch.ops.aten.permute.default(wait_tensor_556, [1, 0]);  wait_tensor_556 = None
        permute_410 = torch.ops.aten.permute.default(permute_400, [1, 0]);  permute_400 = None
        mm_219 = torch.ops.aten.mm.default(view_1782, permute_410);  view_1782 = permute_410 = None
        convert_element_type_1464 = torch.ops.prims.convert_element_type.default(mm_218, torch.float32);  mm_218 = None
        reduce_scatter_tensor_2 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1464, 'avg', 64, '0');  convert_element_type_1464 = None
        wait_tensor_561 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_2);  reduce_scatter_tensor_2 = None
        convert_element_type_1431 = torch.ops.prims.convert_element_type.default(mm_212, torch.float32);  mm_212 = None
        neg_52 = torch.ops.aten.neg.default(convert_element_type_1431)
        exp_78 = torch.ops.aten.exp.default(neg_52);  neg_52 = None
        add_1768 = torch.ops.aten.add.Tensor(exp_78, 1);  exp_78 = None
        div_130 = torch.ops.aten.div.Tensor(convert_element_type_1431, add_1768)
        convert_element_type_1432 = torch.ops.prims.convert_element_type.default(div_130, torch.bfloat16);  div_130 = None
        mul_1291 = torch.ops.aten.mul.Tensor(mm_219, convert_element_type_1432);  convert_element_type_1432 = None
        mul_1292 = torch.ops.aten.mul.Tensor(mm_219, mm_213);  mm_219 = mm_213 = None
        permute_412 = torch.ops.aten.permute.default(mul_1291, [1, 0])
        mm_220 = torch.ops.aten.mm.default(permute_412, view_1733);  permute_412 = None
        convert_element_type_1433 = torch.ops.prims.convert_element_type.default(primals_437, torch.bfloat16);  primals_437 = None
        all_gather_into_tensor_451 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1433, 64, '0');  convert_element_type_1433 = None
        wait_tensor_555 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_451);  all_gather_into_tensor_451 = None
        permute_399 = torch.ops.aten.permute.default(wait_tensor_555, [1, 0]);  wait_tensor_555 = None
        permute_414 = torch.ops.aten.permute.default(permute_399, [1, 0]);  permute_399 = None
        mm_221 = torch.ops.aten.mm.default(mul_1291, permute_414);  mul_1291 = permute_414 = None
        convert_element_type_1469 = torch.ops.prims.convert_element_type.default(mm_220, torch.float32);  mm_220 = None
        reduce_scatter_tensor_3 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1469, 'avg', 64, '0');  convert_element_type_1469 = None
        wait_tensor_562 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_3);  reduce_scatter_tensor_3 = None
        convert_element_type_1470 = torch.ops.prims.convert_element_type.default(mul_1292, torch.float32);  mul_1292 = None
        reciprocal = torch.ops.aten.reciprocal.default(add_1768);  add_1768 = None
        mul_1293 = torch.ops.aten.mul.Tensor(reciprocal, 1);  reciprocal = None
        mul_1294 = torch.ops.aten.mul.Tensor(convert_element_type_1470, mul_1293);  convert_element_type_1470 = None
        sub_625 = torch.ops.aten.sub.Tensor(1, mul_1293);  mul_1293 = None
        mul_1295 = torch.ops.aten.mul.Tensor(convert_element_type_1431, sub_625);  convert_element_type_1431 = sub_625 = None
        add_1776 = torch.ops.aten.add.Tensor(mul_1295, 1);  mul_1295 = None
        mul_1296 = torch.ops.aten.mul.Tensor(mul_1294, add_1776);  mul_1294 = add_1776 = None
        convert_element_type_1472 = torch.ops.prims.convert_element_type.default(mul_1296, torch.bfloat16);  mul_1296 = None
        permute_416 = torch.ops.aten.permute.default(convert_element_type_1472, [1, 0])
        mm_222 = torch.ops.aten.mm.default(permute_416, view_1733);  permute_416 = None
        convert_element_type_1428 = torch.ops.prims.convert_element_type.default(primals_436, torch.bfloat16);  primals_436 = None
        all_gather_into_tensor_450 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1428, 64, '0');  convert_element_type_1428 = None
        wait_tensor_554 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_450);  all_gather_into_tensor_450 = None
        permute_398 = torch.ops.aten.permute.default(wait_tensor_554, [1, 0]);  wait_tensor_554 = None
        permute_418 = torch.ops.aten.permute.default(permute_398, [1, 0]);  permute_398 = None
        mm_223 = torch.ops.aten.mm.default(convert_element_type_1472, permute_418);  convert_element_type_1472 = permute_418 = None
        add_1777 = torch.ops.aten.add.Tensor(mm_221, mm_223);  mm_221 = mm_223 = None
        convert_element_type_1477 = torch.ops.prims.convert_element_type.default(mm_222, torch.float32);  mm_222 = None
        reduce_scatter_tensor_4 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1477, 'avg', 64, '0');  convert_element_type_1477 = None
        wait_tensor_563 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_4);  reduce_scatter_tensor_4 = None
        all_to_all_single_78 = torch.ops._c10d_functional.all_to_all_single.default(index_52, [_local_scalar_dense_408, _local_scalar_dense_409, _local_scalar_dense_410, _local_scalar_dense_411, _local_scalar_dense_412, _local_scalar_dense_413, _local_scalar_dense_414, _local_scalar_dense_415], [_local_scalar_dense_400, _local_scalar_dense_401, _local_scalar_dense_402, _local_scalar_dense_403, _local_scalar_dense_404, _local_scalar_dense_405, _local_scalar_dense_406, _local_scalar_dense_407], '521');  index_52 = None
        wait_tensor_564 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_78);  all_to_all_single_78 = None
        full_348 = torch.ops.aten.full.default([sym_size_int_101, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_101 = None
        slice_scatter = torch.ops.aten.slice_scatter.default(full_348, wait_tensor_564, 0, 0, -1);  wait_tensor_564 = None
        index_53 = torch.ops.aten.index.Tensor(slice_scatter, [getitem_372]);  slice_scatter = None
        permute_420 = torch.ops.aten.permute.default(index_53, [1, 0])
        _grouped_mm_78 = torch.ops.aten._grouped_mm.default(permute_420, mul_1260, cumsum_77);  permute_420 = mul_1260 = None
        convert_element_type_1422 = torch.ops.prims.convert_element_type.default(primals_434, torch.bfloat16);  primals_434 = None
        all_gather_into_tensor_446 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1422, 8, '513');  convert_element_type_1422 = None
        wait_tensor_549 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_446);  all_gather_into_tensor_446 = None
        permute_397 = torch.ops.aten.permute.default(wait_tensor_549, [0, 2, 1]);  wait_tensor_549 = None
        permute_422 = torch.ops.aten.permute.default(permute_397, [0, 2, 1]);  permute_397 = None
        _grouped_mm_79 = torch.ops.aten._grouped_mm.default(index_53, permute_422, cumsum_77);  index_53 = permute_422 = None
        convert_element_type_1426 = torch.ops.prims.convert_element_type.default(_grouped_mm_75, torch.float32);  _grouped_mm_75 = None
        neg_51 = torch.ops.aten.neg.default(convert_element_type_1426)
        exp_77 = torch.ops.aten.exp.default(neg_51);  neg_51 = None
        add_1732 = torch.ops.aten.add.Tensor(exp_77, 1);  exp_77 = None
        div_129 = torch.ops.aten.div.Tensor(convert_element_type_1426, add_1732)
        convert_element_type_1427 = torch.ops.prims.convert_element_type.default(div_129, torch.bfloat16);  div_129 = None
        mul_1297 = torch.ops.aten.mul.Tensor(_grouped_mm_79, convert_element_type_1427);  convert_element_type_1427 = None
        mul_1298 = torch.ops.aten.mul.Tensor(_grouped_mm_79, _grouped_mm_76);  _grouped_mm_79 = _grouped_mm_76 = None
        permute_424 = torch.ops.aten.permute.default(mul_1297, [1, 0])
        _grouped_mm_80 = torch.ops.aten._grouped_mm.default(permute_424, index_51, cumsum_77);  permute_424 = None
        convert_element_type_1423 = torch.ops.prims.convert_element_type.default(primals_435, torch.bfloat16);  primals_435 = None
        all_gather_into_tensor_447 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1423, 8, '513');  convert_element_type_1423 = None
        wait_tensor_550 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_447);  all_gather_into_tensor_447 = None
        permute_396 = torch.ops.aten.permute.default(wait_tensor_550, [0, 2, 1]);  wait_tensor_550 = None
        permute_426 = torch.ops.aten.permute.default(permute_396, [0, 2, 1]);  permute_396 = None
        _grouped_mm_81 = torch.ops.aten._grouped_mm.default(mul_1297, permute_426, cumsum_77);  mul_1297 = permute_426 = None
        convert_element_type_1478 = torch.ops.prims.convert_element_type.default(mul_1298, torch.float32);  mul_1298 = None
        reciprocal_1 = torch.ops.aten.reciprocal.default(add_1732);  add_1732 = None
        mul_1299 = torch.ops.aten.mul.Tensor(reciprocal_1, 1);  reciprocal_1 = None
        mul_1300 = torch.ops.aten.mul.Tensor(convert_element_type_1478, mul_1299);  convert_element_type_1478 = None
        sub_626 = torch.ops.aten.sub.Tensor(1, mul_1299);  mul_1299 = None
        mul_1301 = torch.ops.aten.mul.Tensor(convert_element_type_1426, sub_626);  convert_element_type_1426 = sub_626 = None
        add_1779 = torch.ops.aten.add.Tensor(mul_1301, 1);  mul_1301 = None
        mul_1302 = torch.ops.aten.mul.Tensor(mul_1300, add_1779);  mul_1300 = add_1779 = None
        convert_element_type_1480 = torch.ops.prims.convert_element_type.default(mul_1302, torch.bfloat16);  mul_1302 = None
        permute_428 = torch.ops.aten.permute.default(convert_element_type_1480, [1, 0])
        _grouped_mm_82 = torch.ops.aten._grouped_mm.default(permute_428, index_51, cumsum_77);  permute_428 = index_51 = None
        convert_element_type_1420 = torch.ops.prims.convert_element_type.default(primals_433, torch.bfloat16);  primals_433 = None
        all_gather_into_tensor_444 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1420, 8, '513');  convert_element_type_1420 = None
        wait_tensor_547 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_444);  all_gather_into_tensor_444 = None
        permute_395 = torch.ops.aten.permute.default(wait_tensor_547, [0, 2, 1]);  wait_tensor_547 = None
        permute_430 = torch.ops.aten.permute.default(permute_395, [0, 2, 1]);  permute_395 = None
        _grouped_mm_83 = torch.ops.aten._grouped_mm.default(convert_element_type_1480, permute_430, cumsum_77);  convert_element_type_1480 = permute_430 = cumsum_77 = None
        add_1780 = torch.ops.aten.add.Tensor(_grouped_mm_81, _grouped_mm_83);  _grouped_mm_81 = _grouped_mm_83 = None
        convert_element_type_1481 = torch.ops.prims.convert_element_type.default(_grouped_mm_80, torch.float32);  _grouped_mm_80 = None
        div_132 = torch.ops.aten.div.Tensor(convert_element_type_1481, 64);  convert_element_type_1481 = None
        reduce_scatter_tensor_5 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_132, 'sum', 8, '513');  div_132 = None
        wait_tensor_565 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_5);  reduce_scatter_tensor_5 = None
        convert_element_type_1482 = torch.ops.prims.convert_element_type.default(_grouped_mm_78, torch.float32);  _grouped_mm_78 = None
        div_133 = torch.ops.aten.div.Tensor(convert_element_type_1482, 64);  convert_element_type_1482 = None
        reduce_scatter_tensor_6 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_133, 'sum', 8, '513');  div_133 = None
        wait_tensor_566 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_6);  reduce_scatter_tensor_6 = None
        convert_element_type_1483 = torch.ops.prims.convert_element_type.default(_grouped_mm_82, torch.float32);  _grouped_mm_82 = None
        div_134 = torch.ops.aten.div.Tensor(convert_element_type_1483, 64);  convert_element_type_1483 = None
        reduce_scatter_tensor_7 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_134, 'sum', 8, '513');  div_134 = None
        wait_tensor_567 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_7);  reduce_scatter_tensor_7 = None
        index_put_52 = torch.ops.aten.index_put.default(full_348, [getitem_372], add_1780, True);  full_348 = getitem_372 = add_1780 = None
        slice_107 = torch.ops.aten.slice.Tensor(index_put_52, 0, 0, add_1781);  index_put_52 = add_1781 = None
        all_to_all_single_79 = torch.ops._c10d_functional.all_to_all_single.default(slice_107, [_local_scalar_dense_400, _local_scalar_dense_401, _local_scalar_dense_402, _local_scalar_dense_403, _local_scalar_dense_404, _local_scalar_dense_405, _local_scalar_dense_406, _local_scalar_dense_407], [_local_scalar_dense_408, _local_scalar_dense_409, _local_scalar_dense_410, _local_scalar_dense_411, _local_scalar_dense_412, _local_scalar_dense_413, _local_scalar_dense_414, _local_scalar_dense_415], '521');  slice_107 = _local_scalar_dense_400 = _local_scalar_dense_401 = _local_scalar_dense_402 = _local_scalar_dense_403 = _local_scalar_dense_404 = _local_scalar_dense_405 = _local_scalar_dense_406 = _local_scalar_dense_407 = _local_scalar_dense_408 = _local_scalar_dense_409 = _local_scalar_dense_410 = _local_scalar_dense_411 = _local_scalar_dense_412 = _local_scalar_dense_413 = _local_scalar_dense_414 = _local_scalar_dense_415 = None
        wait_tensor_568 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_79);  all_to_all_single_79 = None
        full_default_52 = torch.ops.aten.full.default([8192, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False)
        index_put_53 = torch.ops.aten.index_put.default(full_default_52, [div_127], wait_tensor_568, True);  div_127 = wait_tensor_568 = None
        add_1785 = torch.ops.aten.add.Tensor(add_1777, index_put_53);  add_1777 = index_put_53 = None
        mul_1303 = torch.ops.aten.mul.Tensor(view_1783, 1.0);  view_1783 = None
        full_default_53 = torch.ops.aten.full.default([8192, 64], 0, dtype = torch.float32, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False)
        scatter_add = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_369, mul_1303);  getitem_369 = mul_1303 = None
        convert_element_type_1415 = torch.ops.prims.convert_element_type.default(mm_211, torch.float32);  mm_211 = None
        sub_600 = torch.ops.aten.sub.Tensor(convert_element_type_1415, amax_25);  convert_element_type_1415 = amax_25 = None
        exp_76 = torch.ops.aten.exp.default(sub_600);  sub_600 = None
        div_126 = torch.ops.aten.div.Tensor(exp_76, sum_101);  exp_76 = sum_101 = None
        mul_1304 = torch.ops.aten.mul.Tensor(scatter_add, div_126);  scatter_add = None
        sum_107 = torch.ops.aten.sum.dim_IntList(mul_1304, [1], True)
        neg_55 = torch.ops.aten.neg.default(div_126);  div_126 = None
        fma = torch.ops.prims.fma.default(neg_55, sum_107, mul_1304);  neg_55 = sum_107 = mul_1304 = None
        convert_element_type_1484 = torch.ops.prims.convert_element_type.default(fma, torch.bfloat16);  fma = None
        permute_432 = torch.ops.aten.permute.default(convert_element_type_1484, [1, 0])
        mm_224 = torch.ops.aten.mm.default(permute_432, view_1733);  permute_432 = view_1733 = None
        convert_element_type_1412 = torch.ops.prims.convert_element_type.default(primals_431, torch.bfloat16);  primals_431 = None
        all_gather_into_tensor_443 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1412, 64, '0');  convert_element_type_1412 = None
        wait_tensor_543 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_443);  all_gather_into_tensor_443 = None
        permute_394 = torch.ops.aten.permute.default(wait_tensor_543, [1, 0]);  wait_tensor_543 = None
        permute_434 = torch.ops.aten.permute.default(permute_394, [1, 0]);  permute_394 = None
        mm_225 = torch.ops.aten.mm.default(convert_element_type_1484, permute_434);  convert_element_type_1484 = permute_434 = None
        add_1786 = torch.ops.aten.add.Tensor(add_1785, mm_225);  add_1785 = mm_225 = None
        convert_element_type_1489 = torch.ops.prims.convert_element_type.default(mm_224, torch.float32);  mm_224 = None
        reduce_scatter_tensor_8 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1489, 'avg', 64, '0');  convert_element_type_1489 = None
        wait_tensor_569 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_8);  reduce_scatter_tensor_8 = None
        view_1785 = torch.ops.aten.view.default(add_1786, [2, 4096, 2048]);  add_1786 = None
        convert_element_type_1490 = torch.ops.prims.convert_element_type.default(view_1785, torch.float32);  view_1785 = None
        convert_element_type_1409 = torch.ops.prims.convert_element_type.default(primals_429, torch.bfloat16);  primals_429 = None
        all_gather_into_tensor_442 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1409, 64, '0');  convert_element_type_1409 = None
        wait_tensor_542 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_442);  all_gather_into_tensor_442 = None
        convert_element_type_1492 = torch.ops.prims.convert_element_type.default(wait_tensor_542, torch.float32);  wait_tensor_542 = None
        mul_1305 = torch.ops.aten.mul.Tensor(convert_element_type_1490, convert_element_type_1492);  convert_element_type_1492 = None
        convert_element_type_1410 = torch.ops.prims.convert_element_type.default(add_1708, torch.float32);  add_1708 = None
        mul_1240 = torch.ops.aten.mul.Tensor(convert_element_type_1410, rsqrt_80);  convert_element_type_1410 = None
        mul_1307 = torch.ops.aten.mul.Tensor(mul_1240, mul_1305)
        sum_108 = torch.ops.aten.sum.dim_IntList(mul_1307, [2], True);  mul_1307 = None
        div_135 = torch.ops.aten.div.Tensor(mul_1240, 2048)
        mul_1308 = torch.ops.aten.mul.Tensor(div_135, sum_108);  div_135 = sum_108 = None
        sub_628 = torch.ops.aten.sub.Tensor(mul_1305, mul_1308);  mul_1305 = mul_1308 = None
        mul_1309 = torch.ops.aten.mul.Tensor(sub_628, rsqrt_80);  sub_628 = rsqrt_80 = None
        mul_1310 = torch.ops.aten.mul.Tensor(convert_element_type_1490, mul_1240);  convert_element_type_1490 = mul_1240 = None
        sum_109 = torch.ops.aten.sum.dim_IntList(mul_1310, [0, 1]);  mul_1310 = None
        convert_element_type_1493 = torch.ops.prims.convert_element_type.default(mul_1309, torch.bfloat16);  mul_1309 = None
        add_1787 = torch.ops.aten.add.Tensor(convert_element_type_1455, convert_element_type_1493);  convert_element_type_1455 = convert_element_type_1493 = None
        convert_element_type_default_81 = torch.ops.prims.convert_element_type.default(sum_109, torch.float32);  sum_109 = None
        reduce_scatter_tensor_9 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_81, 'avg', 64, '0');  convert_element_type_default_81 = None
        wait_tensor_570 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_9);  reduce_scatter_tensor_9 = None
        view_1786 = torch.ops.aten.view.default(add_1787, [8192, 2048])
        permute_436 = torch.ops.aten.permute.default(view_1786, [1, 0])
        permute_392 = torch.ops.aten.permute.default(getitem_365, [0, 2, 1, 3])
        view_1728 = torch.ops.aten.view.default(permute_392, [2, 4096, -1]);  permute_392 = None
        view_1730 = torch.ops.aten.view.default(view_1728, [8192, 2048]);  view_1728 = None
        mm_226 = torch.ops.aten.mm.default(permute_436, view_1730);  permute_436 = view_1730 = None
        convert_element_type_1406 = torch.ops.prims.convert_element_type.default(primals_428, torch.bfloat16);  primals_428 = None
        all_gather_into_tensor_441 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1406, 64, '0');  convert_element_type_1406 = None
        wait_tensor_541 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_441);  all_gather_into_tensor_441 = None
        permute_393 = torch.ops.aten.permute.default(wait_tensor_541, [1, 0]);  wait_tensor_541 = None
        permute_438 = torch.ops.aten.permute.default(permute_393, [1, 0]);  permute_393 = None
        mm_227 = torch.ops.aten.mm.default(view_1786, permute_438);  view_1786 = permute_438 = None
        view_1787 = torch.ops.aten.view.default(mm_227, [2, 4096, 2048]);  mm_227 = None
        convert_element_type_1500 = torch.ops.prims.convert_element_type.default(mm_226, torch.float32);  mm_226 = None
        reduce_scatter_tensor_10 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1500, 'avg', 64, '0');  convert_element_type_1500 = None
        wait_tensor_571 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_10);  reduce_scatter_tensor_10 = None
        view_1788 = torch.ops.aten.view.default(view_1787, [2, 4096, 16, 128]);  view_1787 = None
        permute_440 = torch.ops.aten.permute.default(view_1788, [0, 2, 1, 3]);  view_1788 = None
        fw_graph0 = self.fw_graph0
        joint_graph0 = self.joint_graph0
        mask_graph0 = self.mask_graph0
        flex_attention_backward = torch.ops.higher_order.flex_attention_backward(permute_389, permute_390, permute_391, getitem_365, getitem_366, permute_440, None, fw_graph0, joint_graph0, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph0), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_389 = permute_390 = permute_391 = getitem_365 = getitem_366 = permute_440 = fw_graph0 = joint_graph0 = mask_graph0 = None
        getitem_373 = flex_attention_backward[0]
        getitem_374 = flex_attention_backward[1]
        getitem_375 = flex_attention_backward[2];  flex_attention_backward = None
        permute_441 = torch.ops.aten.permute.default(getitem_375, [0, 2, 1, 3]);  getitem_375 = None
        permute_442 = torch.ops.aten.permute.default(getitem_374, [0, 2, 1, 3]);  getitem_374 = None
        permute_443 = torch.ops.aten.permute.default(getitem_373, [0, 2, 1, 3]);  getitem_373 = None
        slice_109 = torch.ops.aten.slice.Tensor(permute_442, 3, 0, 128)
        slice_110 = torch.ops.aten.slice.Tensor(permute_442, 3, 128, 192);  permute_442 = None
        sum_110 = torch.ops.aten.sum.dim_IntList(slice_110, [2], True);  slice_110 = None
        cat_80 = torch.ops.aten.cat.default([slice_109, permute_441], 3);  slice_109 = permute_441 = None
        view_1789 = torch.ops.aten.view.default(cat_80, [2, 4096, 4096]);  cat_80 = None
        view_1790 = torch.ops.aten.view.default(view_1789, [8192, 4096]);  view_1789 = None
        permute_444 = torch.ops.aten.permute.default(view_1790, [1, 0])
        mm_228 = torch.ops.aten.mm.default(permute_444, view_1725);  permute_444 = view_1725 = None
        convert_element_type_1403 = torch.ops.prims.convert_element_type.default(primals_427, torch.bfloat16);  primals_427 = None
        all_gather_into_tensor_440 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1403, 64, '0');  convert_element_type_1403 = None
        wait_tensor_540 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_440);  all_gather_into_tensor_440 = None
        permute_388 = torch.ops.aten.permute.default(wait_tensor_540, [1, 0]);  wait_tensor_540 = None
        permute_446 = torch.ops.aten.permute.default(permute_388, [1, 0]);  permute_388 = None
        mm_229 = torch.ops.aten.mm.default(view_1790, permute_446);  view_1790 = permute_446 = None
        view_1791 = torch.ops.aten.view.default(mm_229, [2, 4096, 512]);  mm_229 = None
        convert_element_type_1505 = torch.ops.prims.convert_element_type.default(mm_228, torch.float32);  mm_228 = None
        reduce_scatter_tensor_11 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1505, 'avg', 64, '0');  convert_element_type_1505 = None
        wait_tensor_572 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_11);  reduce_scatter_tensor_11 = None
        convert_element_type_1506 = torch.ops.prims.convert_element_type.default(view_1791, torch.float32);  view_1791 = None
        convert_element_type_1400 = torch.ops.prims.convert_element_type.default(primals_426, torch.bfloat16);  primals_426 = None
        all_gather_into_tensor_439 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1400, 64, '0');  convert_element_type_1400 = None
        wait_tensor_539 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_439);  all_gather_into_tensor_439 = None
        convert_element_type_1508 = torch.ops.prims.convert_element_type.default(wait_tensor_539, torch.float32);  wait_tensor_539 = None
        mul_1311 = torch.ops.aten.mul.Tensor(convert_element_type_1506, convert_element_type_1508);  convert_element_type_1508 = None
        convert_element_type_1401 = torch.ops.prims.convert_element_type.default(getitem_361, torch.float32);  getitem_361 = None
        mul_1238 = torch.ops.aten.mul.Tensor(convert_element_type_1401, rsqrt_79);  convert_element_type_1401 = None
        mul_1313 = torch.ops.aten.mul.Tensor(mul_1238, mul_1311)
        sum_111 = torch.ops.aten.sum.dim_IntList(mul_1313, [2], True);  mul_1313 = None
        div_136 = torch.ops.aten.div.Tensor(mul_1238, 512)
        mul_1314 = torch.ops.aten.mul.Tensor(div_136, sum_111);  div_136 = sum_111 = None
        sub_629 = torch.ops.aten.sub.Tensor(mul_1311, mul_1314);  mul_1311 = mul_1314 = None
        mul_1315 = torch.ops.aten.mul.Tensor(sub_629, rsqrt_79);  sub_629 = rsqrt_79 = None
        mul_1316 = torch.ops.aten.mul.Tensor(convert_element_type_1506, mul_1238);  convert_element_type_1506 = mul_1238 = None
        sum_112 = torch.ops.aten.sum.dim_IntList(mul_1316, [0, 1]);  mul_1316 = None
        convert_element_type_1509 = torch.ops.prims.convert_element_type.default(mul_1315, torch.bfloat16);  mul_1315 = None
        convert_element_type_default_80 = torch.ops.prims.convert_element_type.default(sum_112, torch.float32);  sum_112 = None
        reduce_scatter_tensor_12 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_80, 'avg', 64, '0');  convert_element_type_default_80 = None
        wait_tensor_573 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_12);  reduce_scatter_tensor_12 = None
        convert_element_type_1512 = torch.ops.prims.convert_element_type.default(sum_110, torch.float32);  sum_110 = None
        view_1792 = torch.ops.aten.view.default(convert_element_type_1512, [2, 4096, 1, 32, 2]);  convert_element_type_1512 = None
        view_as_complex_54 = torch.ops.aten.view_as_complex.default(view_1792);  view_1792 = None
        view_7 = torch.ops.aten.view.default(primals_3, [1, 4096, 1, 32]);  primals_3 = None
        _conj = torch.ops.aten._conj.default(view_7);  view_7 = None
        clone_9 = torch.ops.aten.clone.default(_conj);  _conj = None
        mul_1317 = torch.ops.aten.mul.Tensor(view_as_complex_54, clone_9);  view_as_complex_54 = None
        view_as_real_54 = torch.ops.aten.view_as_real.default(mul_1317);  mul_1317 = None
        view_1793 = torch.ops.aten.view.default(view_as_real_54, [2, 4096, 1, 64]);  view_as_real_54 = None
        convert_element_type_1513 = torch.ops.prims.convert_element_type.default(view_1793, torch.bfloat16);  view_1793 = None
        squeeze_26 = torch.ops.aten.squeeze.dim(convert_element_type_1513, 2);  convert_element_type_1513 = None
        cat_81 = torch.ops.aten.cat.default([convert_element_type_1509, squeeze_26], 2);  convert_element_type_1509 = squeeze_26 = None
        view_1794 = torch.ops.aten.view.default(cat_81, [8192, 576]);  cat_81 = None
        permute_448 = torch.ops.aten.permute.default(view_1794, [1, 0])
        mm_230 = torch.ops.aten.mm.default(permute_448, view_1711);  permute_448 = None
        convert_element_type_1395 = torch.ops.prims.convert_element_type.default(primals_425, torch.bfloat16);  primals_425 = None
        all_gather_into_tensor_438 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1395, 64, '0');  convert_element_type_1395 = None
        wait_tensor_538 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_438);  all_gather_into_tensor_438 = None
        permute_387 = torch.ops.aten.permute.default(wait_tensor_538, [1, 0]);  wait_tensor_538 = None
        permute_450 = torch.ops.aten.permute.default(permute_387, [1, 0]);  permute_387 = None
        mm_231 = torch.ops.aten.mm.default(view_1794, permute_450);  view_1794 = permute_450 = None
        view_1795 = torch.ops.aten.view.default(mm_231, [2, 4096, 2048]);  mm_231 = None
        convert_element_type_1518 = torch.ops.prims.convert_element_type.default(mm_230, torch.float32);  mm_230 = None
        reduce_scatter_tensor_13 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1518, 'avg', 64, '0');  convert_element_type_1518 = None
        wait_tensor_574 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_13);  reduce_scatter_tensor_13 = None
        slice_111 = torch.ops.aten.slice.Tensor(permute_443, 3, 0, 128)
        slice_112 = torch.ops.aten.slice.Tensor(permute_443, 3, 128, 192);  permute_443 = None
        convert_element_type_1519 = torch.ops.prims.convert_element_type.default(slice_112, torch.float32);  slice_112 = None
        view_1796 = torch.ops.aten.view.default(convert_element_type_1519, [2, 4096, 16, 32, 2]);  convert_element_type_1519 = None
        view_as_complex_55 = torch.ops.aten.view_as_complex.default(view_1796);  view_1796 = None
        mul_1318 = torch.ops.aten.mul.Tensor(view_as_complex_55, clone_9);  view_as_complex_55 = None
        view_as_real_55 = torch.ops.aten.view_as_real.default(mul_1318);  mul_1318 = None
        view_1797 = torch.ops.aten.view.default(view_as_real_55, [2, 4096, 16, 64]);  view_as_real_55 = None
        convert_element_type_1520 = torch.ops.prims.convert_element_type.default(view_1797, torch.bfloat16);  view_1797 = None
        cat_82 = torch.ops.aten.cat.default([slice_111, convert_element_type_1520], 3);  slice_111 = convert_element_type_1520 = None
        view_1798 = torch.ops.aten.view.default(cat_82, [2, 4096, 3072]);  cat_82 = None
        view_1799 = torch.ops.aten.view.default(view_1798, [8192, 3072]);  view_1798 = None
        permute_452 = torch.ops.aten.permute.default(view_1799, [1, 0])
        mm_232 = torch.ops.aten.mm.default(permute_452, view_1711);  permute_452 = view_1711 = None
        convert_element_type_1390 = torch.ops.prims.convert_element_type.default(primals_424, torch.bfloat16);  primals_424 = None
        all_gather_into_tensor_437 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1390, 64, '0');  convert_element_type_1390 = None
        wait_tensor_537 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_437);  all_gather_into_tensor_437 = None
        permute_386 = torch.ops.aten.permute.default(wait_tensor_537, [1, 0]);  wait_tensor_537 = None
        permute_454 = torch.ops.aten.permute.default(permute_386, [1, 0]);  permute_386 = None
        mm_233 = torch.ops.aten.mm.default(view_1799, permute_454);  view_1799 = permute_454 = None
        view_1800 = torch.ops.aten.view.default(mm_233, [2, 4096, 2048]);  mm_233 = None
        add_1788 = torch.ops.aten.add.Tensor(view_1795, view_1800);  view_1795 = view_1800 = None
        convert_element_type_1525 = torch.ops.prims.convert_element_type.default(mm_232, torch.float32);  mm_232 = None
        reduce_scatter_tensor_14 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1525, 'avg', 64, '0');  convert_element_type_1525 = None
        wait_tensor_575 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_14);  reduce_scatter_tensor_14 = None
        convert_element_type_1526 = torch.ops.prims.convert_element_type.default(add_1788, torch.float32);  add_1788 = None
        convert_element_type_1387 = torch.ops.prims.convert_element_type.default(primals_423, torch.bfloat16);  primals_423 = None
        all_gather_into_tensor_436 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1387, 64, '0');  convert_element_type_1387 = None
        wait_tensor_536 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_436);  all_gather_into_tensor_436 = None
        convert_element_type_1528 = torch.ops.prims.convert_element_type.default(wait_tensor_536, torch.float32);  wait_tensor_536 = None
        mul_1319 = torch.ops.aten.mul.Tensor(convert_element_type_1526, convert_element_type_1528);  convert_element_type_1528 = None
        convert_element_type_1388 = torch.ops.prims.convert_element_type.default(add_1705, torch.float32);  add_1705 = None
        mul_1234 = torch.ops.aten.mul.Tensor(convert_element_type_1388, rsqrt_78);  convert_element_type_1388 = None
        mul_1321 = torch.ops.aten.mul.Tensor(mul_1234, mul_1319)
        sum_113 = torch.ops.aten.sum.dim_IntList(mul_1321, [2], True);  mul_1321 = None
        div_137 = torch.ops.aten.div.Tensor(mul_1234, 2048)
        mul_1322 = torch.ops.aten.mul.Tensor(div_137, sum_113);  div_137 = sum_113 = None
        sub_630 = torch.ops.aten.sub.Tensor(mul_1319, mul_1322);  mul_1319 = mul_1322 = None
        mul_1323 = torch.ops.aten.mul.Tensor(sub_630, rsqrt_78);  sub_630 = rsqrt_78 = None
        mul_1324 = torch.ops.aten.mul.Tensor(convert_element_type_1526, mul_1234);  convert_element_type_1526 = mul_1234 = None
        sum_114 = torch.ops.aten.sum.dim_IntList(mul_1324, [0, 1]);  mul_1324 = None
        convert_element_type_1529 = torch.ops.prims.convert_element_type.default(mul_1323, torch.bfloat16);  mul_1323 = None
        add_1789 = torch.ops.aten.add.Tensor(add_1787, convert_element_type_1529);  add_1787 = convert_element_type_1529 = None
        convert_element_type_default_79 = torch.ops.prims.convert_element_type.default(sum_114, torch.float32);  sum_114 = None
        reduce_scatter_tensor_15 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_79, 'avg', 64, '0');  convert_element_type_default_79 = None
        wait_tensor_576 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_15);  reduce_scatter_tensor_15 = None
        view_1801 = torch.ops.aten.view.default(add_1789, [8192, 2048])
        unsqueeze_54 = torch.ops.aten.unsqueeze.default(view_1801, 1)
        convert_element_type_1532 = torch.ops.prims.convert_element_type.default(unsqueeze_54, torch.float32);  unsqueeze_54 = None
        bmm_28 = torch.ops.aten.bmm.default(permute_456, convert_element_type_1532);  permute_456 = None
        bmm_29 = torch.ops.aten.bmm.default(convert_element_type_1532, permute_457);  convert_element_type_1532 = permute_457 = None
        convert_element_type_1533 = torch.ops.prims.convert_element_type.default(bmm_28, torch.bfloat16);  bmm_28 = None
        view_1802 = torch.ops.aten.view.default(bmm_29, [8192, 6]);  bmm_29 = None
        view_1803 = torch.ops.aten.view.default(convert_element_type_1533, [49152, 2048]);  convert_element_type_1533 = None
        index_54 = torch.ops.aten.index.Tensor(view_1803, [getitem_357]);  view_1803 = getitem_357 = None
        permute_458 = torch.ops.aten.permute.default(view_1801, [1, 0])
        mm_234 = torch.ops.aten.mm.default(permute_458, mul_1231);  permute_458 = mul_1231 = None
        convert_element_type_1382 = torch.ops.prims.convert_element_type.default(primals_422, torch.bfloat16);  primals_422 = None
        all_gather_into_tensor_435 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1382, 64, '0');  convert_element_type_1382 = None
        wait_tensor_535 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_435);  all_gather_into_tensor_435 = None
        permute_385 = torch.ops.aten.permute.default(wait_tensor_535, [1, 0]);  wait_tensor_535 = None
        permute_460 = torch.ops.aten.permute.default(permute_385, [1, 0]);  permute_385 = None
        mm_235 = torch.ops.aten.mm.default(view_1801, permute_460);  view_1801 = permute_460 = None
        convert_element_type_1538 = torch.ops.prims.convert_element_type.default(mm_234, torch.float32);  mm_234 = None
        reduce_scatter_tensor_16 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1538, 'avg', 64, '0');  convert_element_type_1538 = None
        wait_tensor_577 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_16);  reduce_scatter_tensor_16 = None
        convert_element_type_1377 = torch.ops.prims.convert_element_type.default(mm_204, torch.float32);  mm_204 = None
        neg_50 = torch.ops.aten.neg.default(convert_element_type_1377)
        exp_75 = torch.ops.aten.exp.default(neg_50);  neg_50 = None
        add_1700 = torch.ops.aten.add.Tensor(exp_75, 1);  exp_75 = None
        div_125 = torch.ops.aten.div.Tensor(convert_element_type_1377, add_1700)
        convert_element_type_1378 = torch.ops.prims.convert_element_type.default(div_125, torch.bfloat16);  div_125 = None
        mul_1325 = torch.ops.aten.mul.Tensor(mm_235, convert_element_type_1378);  convert_element_type_1378 = None
        mul_1326 = torch.ops.aten.mul.Tensor(mm_235, mm_205);  mm_235 = mm_205 = None
        permute_462 = torch.ops.aten.permute.default(mul_1325, [1, 0])
        mm_236 = torch.ops.aten.mm.default(permute_462, view_1666);  permute_462 = None
        convert_element_type_1379 = torch.ops.prims.convert_element_type.default(primals_421, torch.bfloat16);  primals_421 = None
        all_gather_into_tensor_434 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1379, 64, '0');  convert_element_type_1379 = None
        wait_tensor_534 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_434);  all_gather_into_tensor_434 = None
        permute_384 = torch.ops.aten.permute.default(wait_tensor_534, [1, 0]);  wait_tensor_534 = None
        permute_464 = torch.ops.aten.permute.default(permute_384, [1, 0]);  permute_384 = None
        mm_237 = torch.ops.aten.mm.default(mul_1325, permute_464);  mul_1325 = permute_464 = None
        convert_element_type_1543 = torch.ops.prims.convert_element_type.default(mm_236, torch.float32);  mm_236 = None
        reduce_scatter_tensor_17 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1543, 'avg', 64, '0');  convert_element_type_1543 = None
        wait_tensor_578 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_17);  reduce_scatter_tensor_17 = None
        convert_element_type_1544 = torch.ops.prims.convert_element_type.default(mul_1326, torch.float32);  mul_1326 = None
        reciprocal_2 = torch.ops.aten.reciprocal.default(add_1700);  add_1700 = None
        mul_1327 = torch.ops.aten.mul.Tensor(reciprocal_2, 1);  reciprocal_2 = None
        mul_1328 = torch.ops.aten.mul.Tensor(convert_element_type_1544, mul_1327);  convert_element_type_1544 = None
        sub_631 = torch.ops.aten.sub.Tensor(1, mul_1327);  mul_1327 = None
        mul_1329 = torch.ops.aten.mul.Tensor(convert_element_type_1377, sub_631);  convert_element_type_1377 = sub_631 = None
        add_1791 = torch.ops.aten.add.Tensor(mul_1329, 1);  mul_1329 = None
        mul_1330 = torch.ops.aten.mul.Tensor(mul_1328, add_1791);  mul_1328 = add_1791 = None
        convert_element_type_1546 = torch.ops.prims.convert_element_type.default(mul_1330, torch.bfloat16);  mul_1330 = None
        permute_466 = torch.ops.aten.permute.default(convert_element_type_1546, [1, 0])
        mm_238 = torch.ops.aten.mm.default(permute_466, view_1666);  permute_466 = None
        convert_element_type_1374 = torch.ops.prims.convert_element_type.default(primals_420, torch.bfloat16);  primals_420 = None
        all_gather_into_tensor_433 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1374, 64, '0');  convert_element_type_1374 = None
        wait_tensor_533 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_433);  all_gather_into_tensor_433 = None
        permute_383 = torch.ops.aten.permute.default(wait_tensor_533, [1, 0]);  wait_tensor_533 = None
        permute_468 = torch.ops.aten.permute.default(permute_383, [1, 0]);  permute_383 = None
        mm_239 = torch.ops.aten.mm.default(convert_element_type_1546, permute_468);  convert_element_type_1546 = permute_468 = None
        add_1792 = torch.ops.aten.add.Tensor(mm_237, mm_239);  mm_237 = mm_239 = None
        convert_element_type_1551 = torch.ops.prims.convert_element_type.default(mm_238, torch.float32);  mm_238 = None
        reduce_scatter_tensor_18 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1551, 'avg', 64, '0');  convert_element_type_1551 = None
        wait_tensor_579 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_18);  reduce_scatter_tensor_18 = None
        all_to_all_single_80 = torch.ops._c10d_functional.all_to_all_single.default(index_54, [_local_scalar_dense_392, _local_scalar_dense_393, _local_scalar_dense_394, _local_scalar_dense_395, _local_scalar_dense_396, _local_scalar_dense_397, _local_scalar_dense_398, _local_scalar_dense_399], [_local_scalar_dense_384, _local_scalar_dense_385, _local_scalar_dense_386, _local_scalar_dense_387, _local_scalar_dense_388, _local_scalar_dense_389, _local_scalar_dense_390, _local_scalar_dense_391], '521');  index_54 = None
        wait_tensor_580 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_80);  all_to_all_single_80 = None
        full_352 = torch.ops.aten.full.default([sym_size_int_97, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_97 = None
        slice_scatter_1 = torch.ops.aten.slice_scatter.default(full_352, wait_tensor_580, 0, 0, -1);  wait_tensor_580 = None
        index_55 = torch.ops.aten.index.Tensor(slice_scatter_1, [getitem_358]);  slice_scatter_1 = None
        permute_470 = torch.ops.aten.permute.default(index_55, [1, 0])
        _grouped_mm_84 = torch.ops.aten._grouped_mm.default(permute_470, mul_1211, cumsum_74);  permute_470 = mul_1211 = None
        convert_element_type_1368 = torch.ops.prims.convert_element_type.default(primals_418, torch.bfloat16);  primals_418 = None
        all_gather_into_tensor_429 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1368, 8, '513');  convert_element_type_1368 = None
        wait_tensor_528 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_429);  all_gather_into_tensor_429 = None
        permute_382 = torch.ops.aten.permute.default(wait_tensor_528, [0, 2, 1]);  wait_tensor_528 = None
        permute_472 = torch.ops.aten.permute.default(permute_382, [0, 2, 1]);  permute_382 = None
        _grouped_mm_85 = torch.ops.aten._grouped_mm.default(index_55, permute_472, cumsum_74);  index_55 = permute_472 = None
        convert_element_type_1372 = torch.ops.prims.convert_element_type.default(_grouped_mm_72, torch.float32);  _grouped_mm_72 = None
        neg_49 = torch.ops.aten.neg.default(convert_element_type_1372)
        exp_74 = torch.ops.aten.exp.default(neg_49);  neg_49 = None
        add_1664 = torch.ops.aten.add.Tensor(exp_74, 1);  exp_74 = None
        div_124 = torch.ops.aten.div.Tensor(convert_element_type_1372, add_1664)
        convert_element_type_1373 = torch.ops.prims.convert_element_type.default(div_124, torch.bfloat16);  div_124 = None
        mul_1331 = torch.ops.aten.mul.Tensor(_grouped_mm_85, convert_element_type_1373);  convert_element_type_1373 = None
        mul_1332 = torch.ops.aten.mul.Tensor(_grouped_mm_85, _grouped_mm_73);  _grouped_mm_85 = _grouped_mm_73 = None
        permute_474 = torch.ops.aten.permute.default(mul_1331, [1, 0])
        _grouped_mm_86 = torch.ops.aten._grouped_mm.default(permute_474, index_49, cumsum_74);  permute_474 = None
        convert_element_type_1369 = torch.ops.prims.convert_element_type.default(primals_419, torch.bfloat16);  primals_419 = None
        all_gather_into_tensor_430 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1369, 8, '513');  convert_element_type_1369 = None
        wait_tensor_529 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_430);  all_gather_into_tensor_430 = None
        permute_381 = torch.ops.aten.permute.default(wait_tensor_529, [0, 2, 1]);  wait_tensor_529 = None
        permute_476 = torch.ops.aten.permute.default(permute_381, [0, 2, 1]);  permute_381 = None
        _grouped_mm_87 = torch.ops.aten._grouped_mm.default(mul_1331, permute_476, cumsum_74);  mul_1331 = permute_476 = None
        convert_element_type_1552 = torch.ops.prims.convert_element_type.default(mul_1332, torch.float32);  mul_1332 = None
        reciprocal_3 = torch.ops.aten.reciprocal.default(add_1664);  add_1664 = None
        mul_1333 = torch.ops.aten.mul.Tensor(reciprocal_3, 1);  reciprocal_3 = None
        mul_1334 = torch.ops.aten.mul.Tensor(convert_element_type_1552, mul_1333);  convert_element_type_1552 = None
        sub_632 = torch.ops.aten.sub.Tensor(1, mul_1333);  mul_1333 = None
        mul_1335 = torch.ops.aten.mul.Tensor(convert_element_type_1372, sub_632);  convert_element_type_1372 = sub_632 = None
        add_1794 = torch.ops.aten.add.Tensor(mul_1335, 1);  mul_1335 = None
        mul_1336 = torch.ops.aten.mul.Tensor(mul_1334, add_1794);  mul_1334 = add_1794 = None
        convert_element_type_1554 = torch.ops.prims.convert_element_type.default(mul_1336, torch.bfloat16);  mul_1336 = None
        permute_478 = torch.ops.aten.permute.default(convert_element_type_1554, [1, 0])
        _grouped_mm_88 = torch.ops.aten._grouped_mm.default(permute_478, index_49, cumsum_74);  permute_478 = index_49 = None
        convert_element_type_1366 = torch.ops.prims.convert_element_type.default(primals_417, torch.bfloat16);  primals_417 = None
        all_gather_into_tensor_427 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1366, 8, '513');  convert_element_type_1366 = None
        wait_tensor_526 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_427);  all_gather_into_tensor_427 = None
        permute_380 = torch.ops.aten.permute.default(wait_tensor_526, [0, 2, 1]);  wait_tensor_526 = None
        permute_480 = torch.ops.aten.permute.default(permute_380, [0, 2, 1]);  permute_380 = None
        _grouped_mm_89 = torch.ops.aten._grouped_mm.default(convert_element_type_1554, permute_480, cumsum_74);  convert_element_type_1554 = permute_480 = cumsum_74 = None
        add_1795 = torch.ops.aten.add.Tensor(_grouped_mm_87, _grouped_mm_89);  _grouped_mm_87 = _grouped_mm_89 = None
        convert_element_type_1555 = torch.ops.prims.convert_element_type.default(_grouped_mm_86, torch.float32);  _grouped_mm_86 = None
        div_138 = torch.ops.aten.div.Tensor(convert_element_type_1555, 64);  convert_element_type_1555 = None
        reduce_scatter_tensor_19 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_138, 'sum', 8, '513');  div_138 = None
        wait_tensor_581 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_19);  reduce_scatter_tensor_19 = None
        convert_element_type_1556 = torch.ops.prims.convert_element_type.default(_grouped_mm_84, torch.float32);  _grouped_mm_84 = None
        div_139 = torch.ops.aten.div.Tensor(convert_element_type_1556, 64);  convert_element_type_1556 = None
        reduce_scatter_tensor_20 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_139, 'sum', 8, '513');  div_139 = None
        wait_tensor_582 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_20);  reduce_scatter_tensor_20 = None
        convert_element_type_1557 = torch.ops.prims.convert_element_type.default(_grouped_mm_88, torch.float32);  _grouped_mm_88 = None
        div_140 = torch.ops.aten.div.Tensor(convert_element_type_1557, 64);  convert_element_type_1557 = None
        reduce_scatter_tensor_21 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_140, 'sum', 8, '513');  div_140 = None
        wait_tensor_583 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_21);  reduce_scatter_tensor_21 = None
        index_put_54 = torch.ops.aten.index_put.default(full_352, [getitem_358], add_1795, True);  full_352 = getitem_358 = add_1795 = None
        slice_113 = torch.ops.aten.slice.Tensor(index_put_54, 0, 0, add_1796);  index_put_54 = add_1796 = None
        all_to_all_single_81 = torch.ops._c10d_functional.all_to_all_single.default(slice_113, [_local_scalar_dense_384, _local_scalar_dense_385, _local_scalar_dense_386, _local_scalar_dense_387, _local_scalar_dense_388, _local_scalar_dense_389, _local_scalar_dense_390, _local_scalar_dense_391], [_local_scalar_dense_392, _local_scalar_dense_393, _local_scalar_dense_394, _local_scalar_dense_395, _local_scalar_dense_396, _local_scalar_dense_397, _local_scalar_dense_398, _local_scalar_dense_399], '521');  slice_113 = _local_scalar_dense_384 = _local_scalar_dense_385 = _local_scalar_dense_386 = _local_scalar_dense_387 = _local_scalar_dense_388 = _local_scalar_dense_389 = _local_scalar_dense_390 = _local_scalar_dense_391 = _local_scalar_dense_392 = _local_scalar_dense_393 = _local_scalar_dense_394 = _local_scalar_dense_395 = _local_scalar_dense_396 = _local_scalar_dense_397 = _local_scalar_dense_398 = _local_scalar_dense_399 = None
        wait_tensor_584 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_81);  all_to_all_single_81 = None
        index_put_55 = torch.ops.aten.index_put.default(full_default_52, [div_122], wait_tensor_584, True);  div_122 = wait_tensor_584 = None
        add_1800 = torch.ops.aten.add.Tensor(add_1792, index_put_55);  add_1792 = index_put_55 = None
        mul_1337 = torch.ops.aten.mul.Tensor(view_1802, 1.0);  view_1802 = None
        scatter_add_1 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_355, mul_1337);  getitem_355 = mul_1337 = None
        convert_element_type_1361 = torch.ops.prims.convert_element_type.default(mm_203, torch.float32);  mm_203 = None
        sub_576 = torch.ops.aten.sub.Tensor(convert_element_type_1361, amax_24);  convert_element_type_1361 = amax_24 = None
        exp_73 = torch.ops.aten.exp.default(sub_576);  sub_576 = None
        div_121 = torch.ops.aten.div.Tensor(exp_73, sum_97);  exp_73 = sum_97 = None
        mul_1338 = torch.ops.aten.mul.Tensor(scatter_add_1, div_121);  scatter_add_1 = None
        sum_115 = torch.ops.aten.sum.dim_IntList(mul_1338, [1], True)
        neg_58 = torch.ops.aten.neg.default(div_121);  div_121 = None
        fma_1 = torch.ops.prims.fma.default(neg_58, sum_115, mul_1338);  neg_58 = sum_115 = mul_1338 = None
        convert_element_type_1558 = torch.ops.prims.convert_element_type.default(fma_1, torch.bfloat16);  fma_1 = None
        permute_482 = torch.ops.aten.permute.default(convert_element_type_1558, [1, 0])
        mm_240 = torch.ops.aten.mm.default(permute_482, view_1666);  permute_482 = view_1666 = None
        convert_element_type_1358 = torch.ops.prims.convert_element_type.default(primals_415, torch.bfloat16);  primals_415 = None
        all_gather_into_tensor_426 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1358, 64, '0');  convert_element_type_1358 = None
        wait_tensor_522 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_426);  all_gather_into_tensor_426 = None
        permute_379 = torch.ops.aten.permute.default(wait_tensor_522, [1, 0]);  wait_tensor_522 = None
        permute_484 = torch.ops.aten.permute.default(permute_379, [1, 0]);  permute_379 = None
        mm_241 = torch.ops.aten.mm.default(convert_element_type_1558, permute_484);  convert_element_type_1558 = permute_484 = None
        add_1801 = torch.ops.aten.add.Tensor(add_1800, mm_241);  add_1800 = mm_241 = None
        convert_element_type_1563 = torch.ops.prims.convert_element_type.default(mm_240, torch.float32);  mm_240 = None
        reduce_scatter_tensor_22 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1563, 'avg', 64, '0');  convert_element_type_1563 = None
        wait_tensor_585 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_22);  reduce_scatter_tensor_22 = None
        view_1804 = torch.ops.aten.view.default(add_1801, [2, 4096, 2048]);  add_1801 = None
        convert_element_type_1564 = torch.ops.prims.convert_element_type.default(view_1804, torch.float32);  view_1804 = None
        convert_element_type_1355 = torch.ops.prims.convert_element_type.default(primals_413, torch.bfloat16);  primals_413 = None
        all_gather_into_tensor_425 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1355, 64, '0');  convert_element_type_1355 = None
        wait_tensor_521 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_425);  all_gather_into_tensor_425 = None
        convert_element_type_1566 = torch.ops.prims.convert_element_type.default(wait_tensor_521, torch.float32);  wait_tensor_521 = None
        mul_1339 = torch.ops.aten.mul.Tensor(convert_element_type_1564, convert_element_type_1566);  convert_element_type_1566 = None
        convert_element_type_1356 = torch.ops.prims.convert_element_type.default(add_1640, torch.float32);  add_1640 = None
        mul_1191 = torch.ops.aten.mul.Tensor(convert_element_type_1356, rsqrt_77);  convert_element_type_1356 = None
        mul_1341 = torch.ops.aten.mul.Tensor(mul_1191, mul_1339)
        sum_116 = torch.ops.aten.sum.dim_IntList(mul_1341, [2], True);  mul_1341 = None
        div_141 = torch.ops.aten.div.Tensor(mul_1191, 2048)
        mul_1342 = torch.ops.aten.mul.Tensor(div_141, sum_116);  div_141 = sum_116 = None
        sub_634 = torch.ops.aten.sub.Tensor(mul_1339, mul_1342);  mul_1339 = mul_1342 = None
        mul_1343 = torch.ops.aten.mul.Tensor(sub_634, rsqrt_77);  sub_634 = rsqrt_77 = None
        mul_1344 = torch.ops.aten.mul.Tensor(convert_element_type_1564, mul_1191);  convert_element_type_1564 = mul_1191 = None
        sum_117 = torch.ops.aten.sum.dim_IntList(mul_1344, [0, 1]);  mul_1344 = None
        convert_element_type_1567 = torch.ops.prims.convert_element_type.default(mul_1343, torch.bfloat16);  mul_1343 = None
        add_1802 = torch.ops.aten.add.Tensor(add_1789, convert_element_type_1567);  add_1789 = convert_element_type_1567 = None
        convert_element_type_default_78 = torch.ops.prims.convert_element_type.default(sum_117, torch.float32);  sum_117 = None
        reduce_scatter_tensor_23 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_78, 'avg', 64, '0');  convert_element_type_default_78 = None
        wait_tensor_586 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_23);  reduce_scatter_tensor_23 = None
        view_1805 = torch.ops.aten.view.default(add_1802, [8192, 2048])
        permute_486 = torch.ops.aten.permute.default(view_1805, [1, 0])
        permute_377 = torch.ops.aten.permute.default(getitem_351, [0, 2, 1, 3])
        view_1661 = torch.ops.aten.view.default(permute_377, [2, 4096, -1]);  permute_377 = None
        view_1663 = torch.ops.aten.view.default(view_1661, [8192, 2048]);  view_1661 = None
        mm_242 = torch.ops.aten.mm.default(permute_486, view_1663);  permute_486 = view_1663 = None
        convert_element_type_1352 = torch.ops.prims.convert_element_type.default(primals_412, torch.bfloat16);  primals_412 = None
        all_gather_into_tensor_424 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1352, 64, '0');  convert_element_type_1352 = None
        wait_tensor_520 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_424);  all_gather_into_tensor_424 = None
        permute_378 = torch.ops.aten.permute.default(wait_tensor_520, [1, 0]);  wait_tensor_520 = None
        permute_488 = torch.ops.aten.permute.default(permute_378, [1, 0]);  permute_378 = None
        mm_243 = torch.ops.aten.mm.default(view_1805, permute_488);  view_1805 = permute_488 = None
        view_1806 = torch.ops.aten.view.default(mm_243, [2, 4096, 2048]);  mm_243 = None
        convert_element_type_1574 = torch.ops.prims.convert_element_type.default(mm_242, torch.float32);  mm_242 = None
        reduce_scatter_tensor_24 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1574, 'avg', 64, '0');  convert_element_type_1574 = None
        wait_tensor_587 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_24);  reduce_scatter_tensor_24 = None
        view_1807 = torch.ops.aten.view.default(view_1806, [2, 4096, 16, 128]);  view_1806 = None
        permute_490 = torch.ops.aten.permute.default(view_1807, [0, 2, 1, 3]);  view_1807 = None
        fw_graph1 = self.fw_graph1
        joint_graph1 = self.joint_graph1
        mask_graph1 = self.mask_graph1
        flex_attention_backward_1 = torch.ops.higher_order.flex_attention_backward(permute_374, permute_375, permute_376, getitem_351, getitem_352, permute_490, None, fw_graph1, joint_graph1, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph1), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_374 = permute_375 = permute_376 = getitem_351 = getitem_352 = permute_490 = fw_graph1 = joint_graph1 = mask_graph1 = None
        getitem_377 = flex_attention_backward_1[0]
        getitem_378 = flex_attention_backward_1[1]
        getitem_379 = flex_attention_backward_1[2];  flex_attention_backward_1 = None
        permute_491 = torch.ops.aten.permute.default(getitem_379, [0, 2, 1, 3]);  getitem_379 = None
        permute_492 = torch.ops.aten.permute.default(getitem_378, [0, 2, 1, 3]);  getitem_378 = None
        permute_493 = torch.ops.aten.permute.default(getitem_377, [0, 2, 1, 3]);  getitem_377 = None
        slice_115 = torch.ops.aten.slice.Tensor(permute_492, 3, 0, 128)
        slice_116 = torch.ops.aten.slice.Tensor(permute_492, 3, 128, 192);  permute_492 = None
        sum_118 = torch.ops.aten.sum.dim_IntList(slice_116, [2], True);  slice_116 = None
        cat_83 = torch.ops.aten.cat.default([slice_115, permute_491], 3);  slice_115 = permute_491 = None
        view_1808 = torch.ops.aten.view.default(cat_83, [2, 4096, 4096]);  cat_83 = None
        view_1809 = torch.ops.aten.view.default(view_1808, [8192, 4096]);  view_1808 = None
        permute_494 = torch.ops.aten.permute.default(view_1809, [1, 0])
        mm_244 = torch.ops.aten.mm.default(permute_494, view_1658);  permute_494 = view_1658 = None
        convert_element_type_1349 = torch.ops.prims.convert_element_type.default(primals_411, torch.bfloat16);  primals_411 = None
        all_gather_into_tensor_423 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1349, 64, '0');  convert_element_type_1349 = None
        wait_tensor_519 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_423);  all_gather_into_tensor_423 = None
        permute_373 = torch.ops.aten.permute.default(wait_tensor_519, [1, 0]);  wait_tensor_519 = None
        permute_496 = torch.ops.aten.permute.default(permute_373, [1, 0]);  permute_373 = None
        mm_245 = torch.ops.aten.mm.default(view_1809, permute_496);  view_1809 = permute_496 = None
        view_1810 = torch.ops.aten.view.default(mm_245, [2, 4096, 512]);  mm_245 = None
        convert_element_type_1579 = torch.ops.prims.convert_element_type.default(mm_244, torch.float32);  mm_244 = None
        reduce_scatter_tensor_25 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1579, 'avg', 64, '0');  convert_element_type_1579 = None
        wait_tensor_588 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_25);  reduce_scatter_tensor_25 = None
        convert_element_type_1580 = torch.ops.prims.convert_element_type.default(view_1810, torch.float32);  view_1810 = None
        convert_element_type_1346 = torch.ops.prims.convert_element_type.default(primals_410, torch.bfloat16);  primals_410 = None
        all_gather_into_tensor_422 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1346, 64, '0');  convert_element_type_1346 = None
        wait_tensor_518 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_422);  all_gather_into_tensor_422 = None
        convert_element_type_1582 = torch.ops.prims.convert_element_type.default(wait_tensor_518, torch.float32);  wait_tensor_518 = None
        mul_1345 = torch.ops.aten.mul.Tensor(convert_element_type_1580, convert_element_type_1582);  convert_element_type_1582 = None
        convert_element_type_1347 = torch.ops.prims.convert_element_type.default(getitem_347, torch.float32);  getitem_347 = None
        mul_1189 = torch.ops.aten.mul.Tensor(convert_element_type_1347, rsqrt_76);  convert_element_type_1347 = None
        mul_1347 = torch.ops.aten.mul.Tensor(mul_1189, mul_1345)
        sum_119 = torch.ops.aten.sum.dim_IntList(mul_1347, [2], True);  mul_1347 = None
        div_142 = torch.ops.aten.div.Tensor(mul_1189, 512)
        mul_1348 = torch.ops.aten.mul.Tensor(div_142, sum_119);  div_142 = sum_119 = None
        sub_635 = torch.ops.aten.sub.Tensor(mul_1345, mul_1348);  mul_1345 = mul_1348 = None
        mul_1349 = torch.ops.aten.mul.Tensor(sub_635, rsqrt_76);  sub_635 = rsqrt_76 = None
        mul_1350 = torch.ops.aten.mul.Tensor(convert_element_type_1580, mul_1189);  convert_element_type_1580 = mul_1189 = None
        sum_120 = torch.ops.aten.sum.dim_IntList(mul_1350, [0, 1]);  mul_1350 = None
        convert_element_type_1583 = torch.ops.prims.convert_element_type.default(mul_1349, torch.bfloat16);  mul_1349 = None
        convert_element_type_default_77 = torch.ops.prims.convert_element_type.default(sum_120, torch.float32);  sum_120 = None
        reduce_scatter_tensor_26 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_77, 'avg', 64, '0');  convert_element_type_default_77 = None
        wait_tensor_589 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_26);  reduce_scatter_tensor_26 = None
        convert_element_type_1586 = torch.ops.prims.convert_element_type.default(sum_118, torch.float32);  sum_118 = None
        view_1811 = torch.ops.aten.view.default(convert_element_type_1586, [2, 4096, 1, 32, 2]);  convert_element_type_1586 = None
        view_as_complex_56 = torch.ops.aten.view_as_complex.default(view_1811);  view_1811 = None
        mul_1351 = torch.ops.aten.mul.Tensor(view_as_complex_56, clone_9);  view_as_complex_56 = None
        view_as_real_56 = torch.ops.aten.view_as_real.default(mul_1351);  mul_1351 = None
        view_1812 = torch.ops.aten.view.default(view_as_real_56, [2, 4096, 1, 64]);  view_as_real_56 = None
        convert_element_type_1587 = torch.ops.prims.convert_element_type.default(view_1812, torch.bfloat16);  view_1812 = None
        squeeze_27 = torch.ops.aten.squeeze.dim(convert_element_type_1587, 2);  convert_element_type_1587 = None
        cat_84 = torch.ops.aten.cat.default([convert_element_type_1583, squeeze_27], 2);  convert_element_type_1583 = squeeze_27 = None
        view_1813 = torch.ops.aten.view.default(cat_84, [8192, 576]);  cat_84 = None
        permute_498 = torch.ops.aten.permute.default(view_1813, [1, 0])
        mm_246 = torch.ops.aten.mm.default(permute_498, view_1644);  permute_498 = None
        convert_element_type_1341 = torch.ops.prims.convert_element_type.default(primals_409, torch.bfloat16);  primals_409 = None
        all_gather_into_tensor_421 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1341, 64, '0');  convert_element_type_1341 = None
        wait_tensor_517 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_421);  all_gather_into_tensor_421 = None
        permute_372 = torch.ops.aten.permute.default(wait_tensor_517, [1, 0]);  wait_tensor_517 = None
        permute_500 = torch.ops.aten.permute.default(permute_372, [1, 0]);  permute_372 = None
        mm_247 = torch.ops.aten.mm.default(view_1813, permute_500);  view_1813 = permute_500 = None
        view_1814 = torch.ops.aten.view.default(mm_247, [2, 4096, 2048]);  mm_247 = None
        convert_element_type_1592 = torch.ops.prims.convert_element_type.default(mm_246, torch.float32);  mm_246 = None
        reduce_scatter_tensor_27 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1592, 'avg', 64, '0');  convert_element_type_1592 = None
        wait_tensor_590 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_27);  reduce_scatter_tensor_27 = None
        slice_117 = torch.ops.aten.slice.Tensor(permute_493, 3, 0, 128)
        slice_118 = torch.ops.aten.slice.Tensor(permute_493, 3, 128, 192);  permute_493 = None
        convert_element_type_1593 = torch.ops.prims.convert_element_type.default(slice_118, torch.float32);  slice_118 = None
        view_1815 = torch.ops.aten.view.default(convert_element_type_1593, [2, 4096, 16, 32, 2]);  convert_element_type_1593 = None
        view_as_complex_57 = torch.ops.aten.view_as_complex.default(view_1815);  view_1815 = None
        mul_1352 = torch.ops.aten.mul.Tensor(view_as_complex_57, clone_9);  view_as_complex_57 = None
        view_as_real_57 = torch.ops.aten.view_as_real.default(mul_1352);  mul_1352 = None
        view_1816 = torch.ops.aten.view.default(view_as_real_57, [2, 4096, 16, 64]);  view_as_real_57 = None
        convert_element_type_1594 = torch.ops.prims.convert_element_type.default(view_1816, torch.bfloat16);  view_1816 = None
        cat_85 = torch.ops.aten.cat.default([slice_117, convert_element_type_1594], 3);  slice_117 = convert_element_type_1594 = None
        view_1817 = torch.ops.aten.view.default(cat_85, [2, 4096, 3072]);  cat_85 = None
        view_1818 = torch.ops.aten.view.default(view_1817, [8192, 3072]);  view_1817 = None
        permute_502 = torch.ops.aten.permute.default(view_1818, [1, 0])
        mm_248 = torch.ops.aten.mm.default(permute_502, view_1644);  permute_502 = view_1644 = None
        convert_element_type_1336 = torch.ops.prims.convert_element_type.default(primals_408, torch.bfloat16);  primals_408 = None
        all_gather_into_tensor_420 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1336, 64, '0');  convert_element_type_1336 = None
        wait_tensor_516 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_420);  all_gather_into_tensor_420 = None
        permute_371 = torch.ops.aten.permute.default(wait_tensor_516, [1, 0]);  wait_tensor_516 = None
        permute_504 = torch.ops.aten.permute.default(permute_371, [1, 0]);  permute_371 = None
        mm_249 = torch.ops.aten.mm.default(view_1818, permute_504);  view_1818 = permute_504 = None
        view_1819 = torch.ops.aten.view.default(mm_249, [2, 4096, 2048]);  mm_249 = None
        add_1803 = torch.ops.aten.add.Tensor(view_1814, view_1819);  view_1814 = view_1819 = None
        convert_element_type_1599 = torch.ops.prims.convert_element_type.default(mm_248, torch.float32);  mm_248 = None
        reduce_scatter_tensor_28 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1599, 'avg', 64, '0');  convert_element_type_1599 = None
        wait_tensor_591 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_28);  reduce_scatter_tensor_28 = None
        convert_element_type_1600 = torch.ops.prims.convert_element_type.default(add_1803, torch.float32);  add_1803 = None
        convert_element_type_1333 = torch.ops.prims.convert_element_type.default(primals_407, torch.bfloat16);  primals_407 = None
        all_gather_into_tensor_419 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1333, 64, '0');  convert_element_type_1333 = None
        wait_tensor_515 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_419);  all_gather_into_tensor_419 = None
        convert_element_type_1602 = torch.ops.prims.convert_element_type.default(wait_tensor_515, torch.float32);  wait_tensor_515 = None
        mul_1353 = torch.ops.aten.mul.Tensor(convert_element_type_1600, convert_element_type_1602);  convert_element_type_1602 = None
        convert_element_type_1334 = torch.ops.prims.convert_element_type.default(add_1637, torch.float32);  add_1637 = None
        mul_1185 = torch.ops.aten.mul.Tensor(convert_element_type_1334, rsqrt_75);  convert_element_type_1334 = None
        mul_1355 = torch.ops.aten.mul.Tensor(mul_1185, mul_1353)
        sum_121 = torch.ops.aten.sum.dim_IntList(mul_1355, [2], True);  mul_1355 = None
        div_143 = torch.ops.aten.div.Tensor(mul_1185, 2048)
        mul_1356 = torch.ops.aten.mul.Tensor(div_143, sum_121);  div_143 = sum_121 = None
        sub_636 = torch.ops.aten.sub.Tensor(mul_1353, mul_1356);  mul_1353 = mul_1356 = None
        mul_1357 = torch.ops.aten.mul.Tensor(sub_636, rsqrt_75);  sub_636 = rsqrt_75 = None
        mul_1358 = torch.ops.aten.mul.Tensor(convert_element_type_1600, mul_1185);  convert_element_type_1600 = mul_1185 = None
        sum_122 = torch.ops.aten.sum.dim_IntList(mul_1358, [0, 1]);  mul_1358 = None
        convert_element_type_1603 = torch.ops.prims.convert_element_type.default(mul_1357, torch.bfloat16);  mul_1357 = None
        add_1804 = torch.ops.aten.add.Tensor(add_1802, convert_element_type_1603);  add_1802 = convert_element_type_1603 = None
        convert_element_type_default_76 = torch.ops.prims.convert_element_type.default(sum_122, torch.float32);  sum_122 = None
        reduce_scatter_tensor_29 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_76, 'avg', 64, '0');  convert_element_type_default_76 = None
        wait_tensor_592 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_29);  reduce_scatter_tensor_29 = None
        view_1820 = torch.ops.aten.view.default(add_1804, [8192, 2048])
        unsqueeze_55 = torch.ops.aten.unsqueeze.default(view_1820, 1)
        convert_element_type_1606 = torch.ops.prims.convert_element_type.default(unsqueeze_55, torch.float32);  unsqueeze_55 = None
        bmm_30 = torch.ops.aten.bmm.default(permute_506, convert_element_type_1606);  permute_506 = None
        bmm_31 = torch.ops.aten.bmm.default(convert_element_type_1606, permute_507);  convert_element_type_1606 = permute_507 = None
        convert_element_type_1607 = torch.ops.prims.convert_element_type.default(bmm_30, torch.bfloat16);  bmm_30 = None
        view_1821 = torch.ops.aten.view.default(bmm_31, [8192, 6]);  bmm_31 = None
        view_1822 = torch.ops.aten.view.default(convert_element_type_1607, [49152, 2048]);  convert_element_type_1607 = None
        index_56 = torch.ops.aten.index.Tensor(view_1822, [getitem_343]);  view_1822 = getitem_343 = None
        permute_508 = torch.ops.aten.permute.default(view_1820, [1, 0])
        mm_250 = torch.ops.aten.mm.default(permute_508, mul_1182);  permute_508 = mul_1182 = None
        convert_element_type_1328 = torch.ops.prims.convert_element_type.default(primals_406, torch.bfloat16);  primals_406 = None
        all_gather_into_tensor_418 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1328, 64, '0');  convert_element_type_1328 = None
        wait_tensor_514 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_418);  all_gather_into_tensor_418 = None
        permute_370 = torch.ops.aten.permute.default(wait_tensor_514, [1, 0]);  wait_tensor_514 = None
        permute_510 = torch.ops.aten.permute.default(permute_370, [1, 0]);  permute_370 = None
        mm_251 = torch.ops.aten.mm.default(view_1820, permute_510);  view_1820 = permute_510 = None
        convert_element_type_1612 = torch.ops.prims.convert_element_type.default(mm_250, torch.float32);  mm_250 = None
        reduce_scatter_tensor_30 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1612, 'avg', 64, '0');  convert_element_type_1612 = None
        wait_tensor_593 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_30);  reduce_scatter_tensor_30 = None
        convert_element_type_1323 = torch.ops.prims.convert_element_type.default(mm_196, torch.float32);  mm_196 = None
        neg_48 = torch.ops.aten.neg.default(convert_element_type_1323)
        exp_72 = torch.ops.aten.exp.default(neg_48);  neg_48 = None
        add_1632 = torch.ops.aten.add.Tensor(exp_72, 1);  exp_72 = None
        div_120 = torch.ops.aten.div.Tensor(convert_element_type_1323, add_1632)
        convert_element_type_1324 = torch.ops.prims.convert_element_type.default(div_120, torch.bfloat16);  div_120 = None
        mul_1359 = torch.ops.aten.mul.Tensor(mm_251, convert_element_type_1324);  convert_element_type_1324 = None
        mul_1360 = torch.ops.aten.mul.Tensor(mm_251, mm_197);  mm_251 = mm_197 = None
        permute_512 = torch.ops.aten.permute.default(mul_1359, [1, 0])
        mm_252 = torch.ops.aten.mm.default(permute_512, view_1599);  permute_512 = None
        convert_element_type_1325 = torch.ops.prims.convert_element_type.default(primals_405, torch.bfloat16);  primals_405 = None
        all_gather_into_tensor_417 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1325, 64, '0');  convert_element_type_1325 = None
        wait_tensor_513 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_417);  all_gather_into_tensor_417 = None
        permute_369 = torch.ops.aten.permute.default(wait_tensor_513, [1, 0]);  wait_tensor_513 = None
        permute_514 = torch.ops.aten.permute.default(permute_369, [1, 0]);  permute_369 = None
        mm_253 = torch.ops.aten.mm.default(mul_1359, permute_514);  mul_1359 = permute_514 = None
        convert_element_type_1617 = torch.ops.prims.convert_element_type.default(mm_252, torch.float32);  mm_252 = None
        reduce_scatter_tensor_31 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1617, 'avg', 64, '0');  convert_element_type_1617 = None
        wait_tensor_594 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_31);  reduce_scatter_tensor_31 = None
        convert_element_type_1618 = torch.ops.prims.convert_element_type.default(mul_1360, torch.float32);  mul_1360 = None
        reciprocal_4 = torch.ops.aten.reciprocal.default(add_1632);  add_1632 = None
        mul_1361 = torch.ops.aten.mul.Tensor(reciprocal_4, 1);  reciprocal_4 = None
        mul_1362 = torch.ops.aten.mul.Tensor(convert_element_type_1618, mul_1361);  convert_element_type_1618 = None
        sub_637 = torch.ops.aten.sub.Tensor(1, mul_1361);  mul_1361 = None
        mul_1363 = torch.ops.aten.mul.Tensor(convert_element_type_1323, sub_637);  convert_element_type_1323 = sub_637 = None
        add_1806 = torch.ops.aten.add.Tensor(mul_1363, 1);  mul_1363 = None
        mul_1364 = torch.ops.aten.mul.Tensor(mul_1362, add_1806);  mul_1362 = add_1806 = None
        convert_element_type_1620 = torch.ops.prims.convert_element_type.default(mul_1364, torch.bfloat16);  mul_1364 = None
        permute_516 = torch.ops.aten.permute.default(convert_element_type_1620, [1, 0])
        mm_254 = torch.ops.aten.mm.default(permute_516, view_1599);  permute_516 = None
        convert_element_type_1320 = torch.ops.prims.convert_element_type.default(primals_404, torch.bfloat16);  primals_404 = None
        all_gather_into_tensor_416 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1320, 64, '0');  convert_element_type_1320 = None
        wait_tensor_512 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_416);  all_gather_into_tensor_416 = None
        permute_368 = torch.ops.aten.permute.default(wait_tensor_512, [1, 0]);  wait_tensor_512 = None
        permute_518 = torch.ops.aten.permute.default(permute_368, [1, 0]);  permute_368 = None
        mm_255 = torch.ops.aten.mm.default(convert_element_type_1620, permute_518);  convert_element_type_1620 = permute_518 = None
        add_1807 = torch.ops.aten.add.Tensor(mm_253, mm_255);  mm_253 = mm_255 = None
        convert_element_type_1625 = torch.ops.prims.convert_element_type.default(mm_254, torch.float32);  mm_254 = None
        reduce_scatter_tensor_32 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1625, 'avg', 64, '0');  convert_element_type_1625 = None
        wait_tensor_595 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_32);  reduce_scatter_tensor_32 = None
        all_to_all_single_82 = torch.ops._c10d_functional.all_to_all_single.default(index_56, [_local_scalar_dense_376, _local_scalar_dense_377, _local_scalar_dense_378, _local_scalar_dense_379, _local_scalar_dense_380, _local_scalar_dense_381, _local_scalar_dense_382, _local_scalar_dense_383], [_local_scalar_dense_368, _local_scalar_dense_369, _local_scalar_dense_370, _local_scalar_dense_371, _local_scalar_dense_372, _local_scalar_dense_373, _local_scalar_dense_374, _local_scalar_dense_375], '521');  index_56 = None
        wait_tensor_596 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_82);  all_to_all_single_82 = None
        full_356 = torch.ops.aten.full.default([sym_size_int_93, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_93 = None
        slice_scatter_2 = torch.ops.aten.slice_scatter.default(full_356, wait_tensor_596, 0, 0, -1);  wait_tensor_596 = None
        index_57 = torch.ops.aten.index.Tensor(slice_scatter_2, [getitem_344]);  slice_scatter_2 = None
        permute_520 = torch.ops.aten.permute.default(index_57, [1, 0])
        _grouped_mm_90 = torch.ops.aten._grouped_mm.default(permute_520, mul_1162, cumsum_71);  permute_520 = mul_1162 = None
        convert_element_type_1314 = torch.ops.prims.convert_element_type.default(primals_402, torch.bfloat16);  primals_402 = None
        all_gather_into_tensor_412 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1314, 8, '513');  convert_element_type_1314 = None
        wait_tensor_507 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_412);  all_gather_into_tensor_412 = None
        permute_367 = torch.ops.aten.permute.default(wait_tensor_507, [0, 2, 1]);  wait_tensor_507 = None
        permute_522 = torch.ops.aten.permute.default(permute_367, [0, 2, 1]);  permute_367 = None
        _grouped_mm_91 = torch.ops.aten._grouped_mm.default(index_57, permute_522, cumsum_71);  index_57 = permute_522 = None
        convert_element_type_1318 = torch.ops.prims.convert_element_type.default(_grouped_mm_69, torch.float32);  _grouped_mm_69 = None
        neg_47 = torch.ops.aten.neg.default(convert_element_type_1318)
        exp_71 = torch.ops.aten.exp.default(neg_47);  neg_47 = None
        add_1596 = torch.ops.aten.add.Tensor(exp_71, 1);  exp_71 = None
        div_119 = torch.ops.aten.div.Tensor(convert_element_type_1318, add_1596)
        convert_element_type_1319 = torch.ops.prims.convert_element_type.default(div_119, torch.bfloat16);  div_119 = None
        mul_1365 = torch.ops.aten.mul.Tensor(_grouped_mm_91, convert_element_type_1319);  convert_element_type_1319 = None
        mul_1366 = torch.ops.aten.mul.Tensor(_grouped_mm_91, _grouped_mm_70);  _grouped_mm_91 = _grouped_mm_70 = None
        permute_524 = torch.ops.aten.permute.default(mul_1365, [1, 0])
        _grouped_mm_92 = torch.ops.aten._grouped_mm.default(permute_524, index_47, cumsum_71);  permute_524 = None
        convert_element_type_1315 = torch.ops.prims.convert_element_type.default(primals_403, torch.bfloat16);  primals_403 = None
        all_gather_into_tensor_413 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1315, 8, '513');  convert_element_type_1315 = None
        wait_tensor_508 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_413);  all_gather_into_tensor_413 = None
        permute_366 = torch.ops.aten.permute.default(wait_tensor_508, [0, 2, 1]);  wait_tensor_508 = None
        permute_526 = torch.ops.aten.permute.default(permute_366, [0, 2, 1]);  permute_366 = None
        _grouped_mm_93 = torch.ops.aten._grouped_mm.default(mul_1365, permute_526, cumsum_71);  mul_1365 = permute_526 = None
        convert_element_type_1626 = torch.ops.prims.convert_element_type.default(mul_1366, torch.float32);  mul_1366 = None
        reciprocal_5 = torch.ops.aten.reciprocal.default(add_1596);  add_1596 = None
        mul_1367 = torch.ops.aten.mul.Tensor(reciprocal_5, 1);  reciprocal_5 = None
        mul_1368 = torch.ops.aten.mul.Tensor(convert_element_type_1626, mul_1367);  convert_element_type_1626 = None
        sub_638 = torch.ops.aten.sub.Tensor(1, mul_1367);  mul_1367 = None
        mul_1369 = torch.ops.aten.mul.Tensor(convert_element_type_1318, sub_638);  convert_element_type_1318 = sub_638 = None
        add_1809 = torch.ops.aten.add.Tensor(mul_1369, 1);  mul_1369 = None
        mul_1370 = torch.ops.aten.mul.Tensor(mul_1368, add_1809);  mul_1368 = add_1809 = None
        convert_element_type_1628 = torch.ops.prims.convert_element_type.default(mul_1370, torch.bfloat16);  mul_1370 = None
        permute_528 = torch.ops.aten.permute.default(convert_element_type_1628, [1, 0])
        _grouped_mm_94 = torch.ops.aten._grouped_mm.default(permute_528, index_47, cumsum_71);  permute_528 = index_47 = None
        convert_element_type_1312 = torch.ops.prims.convert_element_type.default(primals_401, torch.bfloat16);  primals_401 = None
        all_gather_into_tensor_410 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1312, 8, '513');  convert_element_type_1312 = None
        wait_tensor_505 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_410);  all_gather_into_tensor_410 = None
        permute_365 = torch.ops.aten.permute.default(wait_tensor_505, [0, 2, 1]);  wait_tensor_505 = None
        permute_530 = torch.ops.aten.permute.default(permute_365, [0, 2, 1]);  permute_365 = None
        _grouped_mm_95 = torch.ops.aten._grouped_mm.default(convert_element_type_1628, permute_530, cumsum_71);  convert_element_type_1628 = permute_530 = cumsum_71 = None
        add_1810 = torch.ops.aten.add.Tensor(_grouped_mm_93, _grouped_mm_95);  _grouped_mm_93 = _grouped_mm_95 = None
        convert_element_type_1629 = torch.ops.prims.convert_element_type.default(_grouped_mm_92, torch.float32);  _grouped_mm_92 = None
        div_144 = torch.ops.aten.div.Tensor(convert_element_type_1629, 64);  convert_element_type_1629 = None
        reduce_scatter_tensor_33 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_144, 'sum', 8, '513');  div_144 = None
        wait_tensor_597 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_33);  reduce_scatter_tensor_33 = None
        convert_element_type_1630 = torch.ops.prims.convert_element_type.default(_grouped_mm_90, torch.float32);  _grouped_mm_90 = None
        div_145 = torch.ops.aten.div.Tensor(convert_element_type_1630, 64);  convert_element_type_1630 = None
        reduce_scatter_tensor_34 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_145, 'sum', 8, '513');  div_145 = None
        wait_tensor_598 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_34);  reduce_scatter_tensor_34 = None
        convert_element_type_1631 = torch.ops.prims.convert_element_type.default(_grouped_mm_94, torch.float32);  _grouped_mm_94 = None
        div_146 = torch.ops.aten.div.Tensor(convert_element_type_1631, 64);  convert_element_type_1631 = None
        reduce_scatter_tensor_35 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_146, 'sum', 8, '513');  div_146 = None
        wait_tensor_599 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_35);  reduce_scatter_tensor_35 = None
        index_put_56 = torch.ops.aten.index_put.default(full_356, [getitem_344], add_1810, True);  full_356 = getitem_344 = add_1810 = None
        slice_119 = torch.ops.aten.slice.Tensor(index_put_56, 0, 0, add_1811);  index_put_56 = add_1811 = None
        all_to_all_single_83 = torch.ops._c10d_functional.all_to_all_single.default(slice_119, [_local_scalar_dense_368, _local_scalar_dense_369, _local_scalar_dense_370, _local_scalar_dense_371, _local_scalar_dense_372, _local_scalar_dense_373, _local_scalar_dense_374, _local_scalar_dense_375], [_local_scalar_dense_376, _local_scalar_dense_377, _local_scalar_dense_378, _local_scalar_dense_379, _local_scalar_dense_380, _local_scalar_dense_381, _local_scalar_dense_382, _local_scalar_dense_383], '521');  slice_119 = _local_scalar_dense_368 = _local_scalar_dense_369 = _local_scalar_dense_370 = _local_scalar_dense_371 = _local_scalar_dense_372 = _local_scalar_dense_373 = _local_scalar_dense_374 = _local_scalar_dense_375 = _local_scalar_dense_376 = _local_scalar_dense_377 = _local_scalar_dense_378 = _local_scalar_dense_379 = _local_scalar_dense_380 = _local_scalar_dense_381 = _local_scalar_dense_382 = _local_scalar_dense_383 = None
        wait_tensor_600 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_83);  all_to_all_single_83 = None
        index_put_57 = torch.ops.aten.index_put.default(full_default_52, [div_117], wait_tensor_600, True);  div_117 = wait_tensor_600 = None
        add_1815 = torch.ops.aten.add.Tensor(add_1807, index_put_57);  add_1807 = index_put_57 = None
        mul_1371 = torch.ops.aten.mul.Tensor(view_1821, 1.0);  view_1821 = None
        scatter_add_2 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_341, mul_1371);  getitem_341 = mul_1371 = None
        convert_element_type_1307 = torch.ops.prims.convert_element_type.default(mm_195, torch.float32);  mm_195 = None
        sub_552 = torch.ops.aten.sub.Tensor(convert_element_type_1307, amax_23);  convert_element_type_1307 = amax_23 = None
        exp_70 = torch.ops.aten.exp.default(sub_552);  sub_552 = None
        div_116 = torch.ops.aten.div.Tensor(exp_70, sum_93);  exp_70 = sum_93 = None
        mul_1372 = torch.ops.aten.mul.Tensor(scatter_add_2, div_116);  scatter_add_2 = None
        sum_123 = torch.ops.aten.sum.dim_IntList(mul_1372, [1], True)
        neg_61 = torch.ops.aten.neg.default(div_116);  div_116 = None
        fma_2 = torch.ops.prims.fma.default(neg_61, sum_123, mul_1372);  neg_61 = sum_123 = mul_1372 = None
        convert_element_type_1632 = torch.ops.prims.convert_element_type.default(fma_2, torch.bfloat16);  fma_2 = None
        permute_532 = torch.ops.aten.permute.default(convert_element_type_1632, [1, 0])
        mm_256 = torch.ops.aten.mm.default(permute_532, view_1599);  permute_532 = view_1599 = None
        convert_element_type_1304 = torch.ops.prims.convert_element_type.default(primals_399, torch.bfloat16);  primals_399 = None
        all_gather_into_tensor_409 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1304, 64, '0');  convert_element_type_1304 = None
        wait_tensor_501 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_409);  all_gather_into_tensor_409 = None
        permute_364 = torch.ops.aten.permute.default(wait_tensor_501, [1, 0]);  wait_tensor_501 = None
        permute_534 = torch.ops.aten.permute.default(permute_364, [1, 0]);  permute_364 = None
        mm_257 = torch.ops.aten.mm.default(convert_element_type_1632, permute_534);  convert_element_type_1632 = permute_534 = None
        add_1816 = torch.ops.aten.add.Tensor(add_1815, mm_257);  add_1815 = mm_257 = None
        convert_element_type_1637 = torch.ops.prims.convert_element_type.default(mm_256, torch.float32);  mm_256 = None
        reduce_scatter_tensor_36 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1637, 'avg', 64, '0');  convert_element_type_1637 = None
        wait_tensor_601 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_36);  reduce_scatter_tensor_36 = None
        view_1823 = torch.ops.aten.view.default(add_1816, [2, 4096, 2048]);  add_1816 = None
        convert_element_type_1638 = torch.ops.prims.convert_element_type.default(view_1823, torch.float32);  view_1823 = None
        convert_element_type_1301 = torch.ops.prims.convert_element_type.default(primals_397, torch.bfloat16);  primals_397 = None
        all_gather_into_tensor_408 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1301, 64, '0');  convert_element_type_1301 = None
        wait_tensor_500 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_408);  all_gather_into_tensor_408 = None
        convert_element_type_1640 = torch.ops.prims.convert_element_type.default(wait_tensor_500, torch.float32);  wait_tensor_500 = None
        mul_1373 = torch.ops.aten.mul.Tensor(convert_element_type_1638, convert_element_type_1640);  convert_element_type_1640 = None
        convert_element_type_1302 = torch.ops.prims.convert_element_type.default(add_1572, torch.float32);  add_1572 = None
        mul_1142 = torch.ops.aten.mul.Tensor(convert_element_type_1302, rsqrt_74);  convert_element_type_1302 = None
        mul_1375 = torch.ops.aten.mul.Tensor(mul_1142, mul_1373)
        sum_124 = torch.ops.aten.sum.dim_IntList(mul_1375, [2], True);  mul_1375 = None
        div_147 = torch.ops.aten.div.Tensor(mul_1142, 2048)
        mul_1376 = torch.ops.aten.mul.Tensor(div_147, sum_124);  div_147 = sum_124 = None
        sub_640 = torch.ops.aten.sub.Tensor(mul_1373, mul_1376);  mul_1373 = mul_1376 = None
        mul_1377 = torch.ops.aten.mul.Tensor(sub_640, rsqrt_74);  sub_640 = rsqrt_74 = None
        mul_1378 = torch.ops.aten.mul.Tensor(convert_element_type_1638, mul_1142);  convert_element_type_1638 = mul_1142 = None
        sum_125 = torch.ops.aten.sum.dim_IntList(mul_1378, [0, 1]);  mul_1378 = None
        convert_element_type_1641 = torch.ops.prims.convert_element_type.default(mul_1377, torch.bfloat16);  mul_1377 = None
        add_1817 = torch.ops.aten.add.Tensor(add_1804, convert_element_type_1641);  add_1804 = convert_element_type_1641 = None
        convert_element_type_default_75 = torch.ops.prims.convert_element_type.default(sum_125, torch.float32);  sum_125 = None
        reduce_scatter_tensor_37 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_75, 'avg', 64, '0');  convert_element_type_default_75 = None
        wait_tensor_602 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_37);  reduce_scatter_tensor_37 = None
        view_1824 = torch.ops.aten.view.default(add_1817, [8192, 2048])
        permute_536 = torch.ops.aten.permute.default(view_1824, [1, 0])
        permute_362 = torch.ops.aten.permute.default(getitem_337, [0, 2, 1, 3])
        view_1594 = torch.ops.aten.view.default(permute_362, [2, 4096, -1]);  permute_362 = None
        view_1596 = torch.ops.aten.view.default(view_1594, [8192, 2048]);  view_1594 = None
        mm_258 = torch.ops.aten.mm.default(permute_536, view_1596);  permute_536 = view_1596 = None
        convert_element_type_1298 = torch.ops.prims.convert_element_type.default(primals_396, torch.bfloat16);  primals_396 = None
        all_gather_into_tensor_407 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1298, 64, '0');  convert_element_type_1298 = None
        wait_tensor_499 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_407);  all_gather_into_tensor_407 = None
        permute_363 = torch.ops.aten.permute.default(wait_tensor_499, [1, 0]);  wait_tensor_499 = None
        permute_538 = torch.ops.aten.permute.default(permute_363, [1, 0]);  permute_363 = None
        mm_259 = torch.ops.aten.mm.default(view_1824, permute_538);  view_1824 = permute_538 = None
        view_1825 = torch.ops.aten.view.default(mm_259, [2, 4096, 2048]);  mm_259 = None
        convert_element_type_1648 = torch.ops.prims.convert_element_type.default(mm_258, torch.float32);  mm_258 = None
        reduce_scatter_tensor_38 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1648, 'avg', 64, '0');  convert_element_type_1648 = None
        wait_tensor_603 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_38);  reduce_scatter_tensor_38 = None
        view_1826 = torch.ops.aten.view.default(view_1825, [2, 4096, 16, 128]);  view_1825 = None
        permute_540 = torch.ops.aten.permute.default(view_1826, [0, 2, 1, 3]);  view_1826 = None
        fw_graph2 = self.fw_graph2
        joint_graph2 = self.joint_graph2
        mask_graph2 = self.mask_graph2
        flex_attention_backward_2 = torch.ops.higher_order.flex_attention_backward(permute_359, permute_360, permute_361, getitem_337, getitem_338, permute_540, None, fw_graph2, joint_graph2, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph2), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_359 = permute_360 = permute_361 = getitem_337 = getitem_338 = permute_540 = fw_graph2 = joint_graph2 = mask_graph2 = None
        getitem_381 = flex_attention_backward_2[0]
        getitem_382 = flex_attention_backward_2[1]
        getitem_383 = flex_attention_backward_2[2];  flex_attention_backward_2 = None
        permute_541 = torch.ops.aten.permute.default(getitem_383, [0, 2, 1, 3]);  getitem_383 = None
        permute_542 = torch.ops.aten.permute.default(getitem_382, [0, 2, 1, 3]);  getitem_382 = None
        permute_543 = torch.ops.aten.permute.default(getitem_381, [0, 2, 1, 3]);  getitem_381 = None
        slice_121 = torch.ops.aten.slice.Tensor(permute_542, 3, 0, 128)
        slice_122 = torch.ops.aten.slice.Tensor(permute_542, 3, 128, 192);  permute_542 = None
        sum_126 = torch.ops.aten.sum.dim_IntList(slice_122, [2], True);  slice_122 = None
        cat_86 = torch.ops.aten.cat.default([slice_121, permute_541], 3);  slice_121 = permute_541 = None
        view_1827 = torch.ops.aten.view.default(cat_86, [2, 4096, 4096]);  cat_86 = None
        view_1828 = torch.ops.aten.view.default(view_1827, [8192, 4096]);  view_1827 = None
        permute_544 = torch.ops.aten.permute.default(view_1828, [1, 0])
        mm_260 = torch.ops.aten.mm.default(permute_544, view_1591);  permute_544 = view_1591 = None
        convert_element_type_1295 = torch.ops.prims.convert_element_type.default(primals_395, torch.bfloat16);  primals_395 = None
        all_gather_into_tensor_406 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1295, 64, '0');  convert_element_type_1295 = None
        wait_tensor_498 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_406);  all_gather_into_tensor_406 = None
        permute_358 = torch.ops.aten.permute.default(wait_tensor_498, [1, 0]);  wait_tensor_498 = None
        permute_546 = torch.ops.aten.permute.default(permute_358, [1, 0]);  permute_358 = None
        mm_261 = torch.ops.aten.mm.default(view_1828, permute_546);  view_1828 = permute_546 = None
        view_1829 = torch.ops.aten.view.default(mm_261, [2, 4096, 512]);  mm_261 = None
        convert_element_type_1653 = torch.ops.prims.convert_element_type.default(mm_260, torch.float32);  mm_260 = None
        reduce_scatter_tensor_39 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1653, 'avg', 64, '0');  convert_element_type_1653 = None
        wait_tensor_604 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_39);  reduce_scatter_tensor_39 = None
        convert_element_type_1654 = torch.ops.prims.convert_element_type.default(view_1829, torch.float32);  view_1829 = None
        convert_element_type_1292 = torch.ops.prims.convert_element_type.default(primals_394, torch.bfloat16);  primals_394 = None
        all_gather_into_tensor_405 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1292, 64, '0');  convert_element_type_1292 = None
        wait_tensor_497 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_405);  all_gather_into_tensor_405 = None
        convert_element_type_1656 = torch.ops.prims.convert_element_type.default(wait_tensor_497, torch.float32);  wait_tensor_497 = None
        mul_1379 = torch.ops.aten.mul.Tensor(convert_element_type_1654, convert_element_type_1656);  convert_element_type_1656 = None
        convert_element_type_1293 = torch.ops.prims.convert_element_type.default(getitem_333, torch.float32);  getitem_333 = None
        mul_1140 = torch.ops.aten.mul.Tensor(convert_element_type_1293, rsqrt_73);  convert_element_type_1293 = None
        mul_1381 = torch.ops.aten.mul.Tensor(mul_1140, mul_1379)
        sum_127 = torch.ops.aten.sum.dim_IntList(mul_1381, [2], True);  mul_1381 = None
        div_148 = torch.ops.aten.div.Tensor(mul_1140, 512)
        mul_1382 = torch.ops.aten.mul.Tensor(div_148, sum_127);  div_148 = sum_127 = None
        sub_641 = torch.ops.aten.sub.Tensor(mul_1379, mul_1382);  mul_1379 = mul_1382 = None
        mul_1383 = torch.ops.aten.mul.Tensor(sub_641, rsqrt_73);  sub_641 = rsqrt_73 = None
        mul_1384 = torch.ops.aten.mul.Tensor(convert_element_type_1654, mul_1140);  convert_element_type_1654 = mul_1140 = None
        sum_128 = torch.ops.aten.sum.dim_IntList(mul_1384, [0, 1]);  mul_1384 = None
        convert_element_type_1657 = torch.ops.prims.convert_element_type.default(mul_1383, torch.bfloat16);  mul_1383 = None
        convert_element_type_default_74 = torch.ops.prims.convert_element_type.default(sum_128, torch.float32);  sum_128 = None
        reduce_scatter_tensor_40 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_74, 'avg', 64, '0');  convert_element_type_default_74 = None
        wait_tensor_605 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_40);  reduce_scatter_tensor_40 = None
        convert_element_type_1660 = torch.ops.prims.convert_element_type.default(sum_126, torch.float32);  sum_126 = None
        view_1830 = torch.ops.aten.view.default(convert_element_type_1660, [2, 4096, 1, 32, 2]);  convert_element_type_1660 = None
        view_as_complex_58 = torch.ops.aten.view_as_complex.default(view_1830);  view_1830 = None
        mul_1385 = torch.ops.aten.mul.Tensor(view_as_complex_58, clone_9);  view_as_complex_58 = None
        view_as_real_58 = torch.ops.aten.view_as_real.default(mul_1385);  mul_1385 = None
        view_1831 = torch.ops.aten.view.default(view_as_real_58, [2, 4096, 1, 64]);  view_as_real_58 = None
        convert_element_type_1661 = torch.ops.prims.convert_element_type.default(view_1831, torch.bfloat16);  view_1831 = None
        squeeze_28 = torch.ops.aten.squeeze.dim(convert_element_type_1661, 2);  convert_element_type_1661 = None
        cat_87 = torch.ops.aten.cat.default([convert_element_type_1657, squeeze_28], 2);  convert_element_type_1657 = squeeze_28 = None
        view_1832 = torch.ops.aten.view.default(cat_87, [8192, 576]);  cat_87 = None
        permute_548 = torch.ops.aten.permute.default(view_1832, [1, 0])
        mm_262 = torch.ops.aten.mm.default(permute_548, view_1577);  permute_548 = None
        convert_element_type_1287 = torch.ops.prims.convert_element_type.default(primals_393, torch.bfloat16);  primals_393 = None
        all_gather_into_tensor_404 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1287, 64, '0');  convert_element_type_1287 = None
        wait_tensor_496 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_404);  all_gather_into_tensor_404 = None
        permute_357 = torch.ops.aten.permute.default(wait_tensor_496, [1, 0]);  wait_tensor_496 = None
        permute_550 = torch.ops.aten.permute.default(permute_357, [1, 0]);  permute_357 = None
        mm_263 = torch.ops.aten.mm.default(view_1832, permute_550);  view_1832 = permute_550 = None
        view_1833 = torch.ops.aten.view.default(mm_263, [2, 4096, 2048]);  mm_263 = None
        convert_element_type_1666 = torch.ops.prims.convert_element_type.default(mm_262, torch.float32);  mm_262 = None
        reduce_scatter_tensor_41 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1666, 'avg', 64, '0');  convert_element_type_1666 = None
        wait_tensor_606 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_41);  reduce_scatter_tensor_41 = None
        slice_123 = torch.ops.aten.slice.Tensor(permute_543, 3, 0, 128)
        slice_124 = torch.ops.aten.slice.Tensor(permute_543, 3, 128, 192);  permute_543 = None
        convert_element_type_1667 = torch.ops.prims.convert_element_type.default(slice_124, torch.float32);  slice_124 = None
        view_1834 = torch.ops.aten.view.default(convert_element_type_1667, [2, 4096, 16, 32, 2]);  convert_element_type_1667 = None
        view_as_complex_59 = torch.ops.aten.view_as_complex.default(view_1834);  view_1834 = None
        mul_1386 = torch.ops.aten.mul.Tensor(view_as_complex_59, clone_9);  view_as_complex_59 = None
        view_as_real_59 = torch.ops.aten.view_as_real.default(mul_1386);  mul_1386 = None
        view_1835 = torch.ops.aten.view.default(view_as_real_59, [2, 4096, 16, 64]);  view_as_real_59 = None
        convert_element_type_1668 = torch.ops.prims.convert_element_type.default(view_1835, torch.bfloat16);  view_1835 = None
        cat_88 = torch.ops.aten.cat.default([slice_123, convert_element_type_1668], 3);  slice_123 = convert_element_type_1668 = None
        view_1836 = torch.ops.aten.view.default(cat_88, [2, 4096, 3072]);  cat_88 = None
        view_1837 = torch.ops.aten.view.default(view_1836, [8192, 3072]);  view_1836 = None
        permute_552 = torch.ops.aten.permute.default(view_1837, [1, 0])
        mm_264 = torch.ops.aten.mm.default(permute_552, view_1577);  permute_552 = view_1577 = None
        convert_element_type_1282 = torch.ops.prims.convert_element_type.default(primals_392, torch.bfloat16);  primals_392 = None
        all_gather_into_tensor_403 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1282, 64, '0');  convert_element_type_1282 = None
        wait_tensor_495 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_403);  all_gather_into_tensor_403 = None
        permute_356 = torch.ops.aten.permute.default(wait_tensor_495, [1, 0]);  wait_tensor_495 = None
        permute_554 = torch.ops.aten.permute.default(permute_356, [1, 0]);  permute_356 = None
        mm_265 = torch.ops.aten.mm.default(view_1837, permute_554);  view_1837 = permute_554 = None
        view_1838 = torch.ops.aten.view.default(mm_265, [2, 4096, 2048]);  mm_265 = None
        add_1818 = torch.ops.aten.add.Tensor(view_1833, view_1838);  view_1833 = view_1838 = None
        convert_element_type_1673 = torch.ops.prims.convert_element_type.default(mm_264, torch.float32);  mm_264 = None
        reduce_scatter_tensor_42 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1673, 'avg', 64, '0');  convert_element_type_1673 = None
        wait_tensor_607 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_42);  reduce_scatter_tensor_42 = None
        convert_element_type_1674 = torch.ops.prims.convert_element_type.default(add_1818, torch.float32);  add_1818 = None
        convert_element_type_1279 = torch.ops.prims.convert_element_type.default(primals_391, torch.bfloat16);  primals_391 = None
        all_gather_into_tensor_402 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1279, 64, '0');  convert_element_type_1279 = None
        wait_tensor_494 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_402);  all_gather_into_tensor_402 = None
        convert_element_type_1676 = torch.ops.prims.convert_element_type.default(wait_tensor_494, torch.float32);  wait_tensor_494 = None
        mul_1387 = torch.ops.aten.mul.Tensor(convert_element_type_1674, convert_element_type_1676);  convert_element_type_1676 = None
        convert_element_type_1280 = torch.ops.prims.convert_element_type.default(add_1569, torch.float32);  add_1569 = None
        mul_1136 = torch.ops.aten.mul.Tensor(convert_element_type_1280, rsqrt_72);  convert_element_type_1280 = None
        mul_1389 = torch.ops.aten.mul.Tensor(mul_1136, mul_1387)
        sum_129 = torch.ops.aten.sum.dim_IntList(mul_1389, [2], True);  mul_1389 = None
        div_149 = torch.ops.aten.div.Tensor(mul_1136, 2048)
        mul_1390 = torch.ops.aten.mul.Tensor(div_149, sum_129);  div_149 = sum_129 = None
        sub_642 = torch.ops.aten.sub.Tensor(mul_1387, mul_1390);  mul_1387 = mul_1390 = None
        mul_1391 = torch.ops.aten.mul.Tensor(sub_642, rsqrt_72);  sub_642 = rsqrt_72 = None
        mul_1392 = torch.ops.aten.mul.Tensor(convert_element_type_1674, mul_1136);  convert_element_type_1674 = mul_1136 = None
        sum_130 = torch.ops.aten.sum.dim_IntList(mul_1392, [0, 1]);  mul_1392 = None
        convert_element_type_1677 = torch.ops.prims.convert_element_type.default(mul_1391, torch.bfloat16);  mul_1391 = None
        add_1819 = torch.ops.aten.add.Tensor(add_1817, convert_element_type_1677);  add_1817 = convert_element_type_1677 = None
        convert_element_type_default_73 = torch.ops.prims.convert_element_type.default(sum_130, torch.float32);  sum_130 = None
        reduce_scatter_tensor_43 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_73, 'avg', 64, '0');  convert_element_type_default_73 = None
        wait_tensor_608 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_43);  reduce_scatter_tensor_43 = None
        view_1839 = torch.ops.aten.view.default(add_1819, [8192, 2048])
        unsqueeze_56 = torch.ops.aten.unsqueeze.default(view_1839, 1)
        convert_element_type_1680 = torch.ops.prims.convert_element_type.default(unsqueeze_56, torch.float32);  unsqueeze_56 = None
        bmm_32 = torch.ops.aten.bmm.default(permute_556, convert_element_type_1680);  permute_556 = None
        bmm_33 = torch.ops.aten.bmm.default(convert_element_type_1680, permute_557);  convert_element_type_1680 = permute_557 = None
        convert_element_type_1681 = torch.ops.prims.convert_element_type.default(bmm_32, torch.bfloat16);  bmm_32 = None
        view_1840 = torch.ops.aten.view.default(bmm_33, [8192, 6]);  bmm_33 = None
        view_1841 = torch.ops.aten.view.default(convert_element_type_1681, [49152, 2048]);  convert_element_type_1681 = None
        index_58 = torch.ops.aten.index.Tensor(view_1841, [getitem_329]);  view_1841 = getitem_329 = None
        permute_558 = torch.ops.aten.permute.default(view_1839, [1, 0])
        mm_266 = torch.ops.aten.mm.default(permute_558, mul_1133);  permute_558 = mul_1133 = None
        convert_element_type_1274 = torch.ops.prims.convert_element_type.default(primals_390, torch.bfloat16);  primals_390 = None
        all_gather_into_tensor_401 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1274, 64, '0');  convert_element_type_1274 = None
        wait_tensor_493 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_401);  all_gather_into_tensor_401 = None
        permute_355 = torch.ops.aten.permute.default(wait_tensor_493, [1, 0]);  wait_tensor_493 = None
        permute_560 = torch.ops.aten.permute.default(permute_355, [1, 0]);  permute_355 = None
        mm_267 = torch.ops.aten.mm.default(view_1839, permute_560);  view_1839 = permute_560 = None
        convert_element_type_1686 = torch.ops.prims.convert_element_type.default(mm_266, torch.float32);  mm_266 = None
        reduce_scatter_tensor_44 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1686, 'avg', 64, '0');  convert_element_type_1686 = None
        wait_tensor_609 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_44);  reduce_scatter_tensor_44 = None
        convert_element_type_1269 = torch.ops.prims.convert_element_type.default(mm_188, torch.float32);  mm_188 = None
        neg_46 = torch.ops.aten.neg.default(convert_element_type_1269)
        exp_69 = torch.ops.aten.exp.default(neg_46);  neg_46 = None
        add_1564 = torch.ops.aten.add.Tensor(exp_69, 1);  exp_69 = None
        div_115 = torch.ops.aten.div.Tensor(convert_element_type_1269, add_1564)
        convert_element_type_1270 = torch.ops.prims.convert_element_type.default(div_115, torch.bfloat16);  div_115 = None
        mul_1393 = torch.ops.aten.mul.Tensor(mm_267, convert_element_type_1270);  convert_element_type_1270 = None
        mul_1394 = torch.ops.aten.mul.Tensor(mm_267, mm_189);  mm_267 = mm_189 = None
        permute_562 = torch.ops.aten.permute.default(mul_1393, [1, 0])
        mm_268 = torch.ops.aten.mm.default(permute_562, view_1532);  permute_562 = None
        convert_element_type_1271 = torch.ops.prims.convert_element_type.default(primals_389, torch.bfloat16);  primals_389 = None
        all_gather_into_tensor_400 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1271, 64, '0');  convert_element_type_1271 = None
        wait_tensor_492 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_400);  all_gather_into_tensor_400 = None
        permute_354 = torch.ops.aten.permute.default(wait_tensor_492, [1, 0]);  wait_tensor_492 = None
        permute_564 = torch.ops.aten.permute.default(permute_354, [1, 0]);  permute_354 = None
        mm_269 = torch.ops.aten.mm.default(mul_1393, permute_564);  mul_1393 = permute_564 = None
        convert_element_type_1691 = torch.ops.prims.convert_element_type.default(mm_268, torch.float32);  mm_268 = None
        reduce_scatter_tensor_45 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1691, 'avg', 64, '0');  convert_element_type_1691 = None
        wait_tensor_610 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_45);  reduce_scatter_tensor_45 = None
        convert_element_type_1692 = torch.ops.prims.convert_element_type.default(mul_1394, torch.float32);  mul_1394 = None
        reciprocal_6 = torch.ops.aten.reciprocal.default(add_1564);  add_1564 = None
        mul_1395 = torch.ops.aten.mul.Tensor(reciprocal_6, 1);  reciprocal_6 = None
        mul_1396 = torch.ops.aten.mul.Tensor(convert_element_type_1692, mul_1395);  convert_element_type_1692 = None
        sub_643 = torch.ops.aten.sub.Tensor(1, mul_1395);  mul_1395 = None
        mul_1397 = torch.ops.aten.mul.Tensor(convert_element_type_1269, sub_643);  convert_element_type_1269 = sub_643 = None
        add_1821 = torch.ops.aten.add.Tensor(mul_1397, 1);  mul_1397 = None
        mul_1398 = torch.ops.aten.mul.Tensor(mul_1396, add_1821);  mul_1396 = add_1821 = None
        convert_element_type_1694 = torch.ops.prims.convert_element_type.default(mul_1398, torch.bfloat16);  mul_1398 = None
        permute_566 = torch.ops.aten.permute.default(convert_element_type_1694, [1, 0])
        mm_270 = torch.ops.aten.mm.default(permute_566, view_1532);  permute_566 = None
        convert_element_type_1266 = torch.ops.prims.convert_element_type.default(primals_388, torch.bfloat16);  primals_388 = None
        all_gather_into_tensor_399 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1266, 64, '0');  convert_element_type_1266 = None
        wait_tensor_491 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_399);  all_gather_into_tensor_399 = None
        permute_353 = torch.ops.aten.permute.default(wait_tensor_491, [1, 0]);  wait_tensor_491 = None
        permute_568 = torch.ops.aten.permute.default(permute_353, [1, 0]);  permute_353 = None
        mm_271 = torch.ops.aten.mm.default(convert_element_type_1694, permute_568);  convert_element_type_1694 = permute_568 = None
        add_1822 = torch.ops.aten.add.Tensor(mm_269, mm_271);  mm_269 = mm_271 = None
        convert_element_type_1699 = torch.ops.prims.convert_element_type.default(mm_270, torch.float32);  mm_270 = None
        reduce_scatter_tensor_46 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1699, 'avg', 64, '0');  convert_element_type_1699 = None
        wait_tensor_611 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_46);  reduce_scatter_tensor_46 = None
        all_to_all_single_84 = torch.ops._c10d_functional.all_to_all_single.default(index_58, [_local_scalar_dense_360, _local_scalar_dense_361, _local_scalar_dense_362, _local_scalar_dense_363, _local_scalar_dense_364, _local_scalar_dense_365, _local_scalar_dense_366, _local_scalar_dense_367], [_local_scalar_dense_352, _local_scalar_dense_353, _local_scalar_dense_354, _local_scalar_dense_355, _local_scalar_dense_356, _local_scalar_dense_357, _local_scalar_dense_358, _local_scalar_dense_359], '521');  index_58 = None
        wait_tensor_612 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_84);  all_to_all_single_84 = None
        full_360 = torch.ops.aten.full.default([sym_size_int_89, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_89 = None
        slice_scatter_3 = torch.ops.aten.slice_scatter.default(full_360, wait_tensor_612, 0, 0, -1);  wait_tensor_612 = None
        index_59 = torch.ops.aten.index.Tensor(slice_scatter_3, [getitem_330]);  slice_scatter_3 = None
        permute_570 = torch.ops.aten.permute.default(index_59, [1, 0])
        _grouped_mm_96 = torch.ops.aten._grouped_mm.default(permute_570, mul_1113, cumsum_68);  permute_570 = mul_1113 = None
        convert_element_type_1260 = torch.ops.prims.convert_element_type.default(primals_386, torch.bfloat16);  primals_386 = None
        all_gather_into_tensor_395 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1260, 8, '513');  convert_element_type_1260 = None
        wait_tensor_486 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_395);  all_gather_into_tensor_395 = None
        permute_352 = torch.ops.aten.permute.default(wait_tensor_486, [0, 2, 1]);  wait_tensor_486 = None
        permute_572 = torch.ops.aten.permute.default(permute_352, [0, 2, 1]);  permute_352 = None
        _grouped_mm_97 = torch.ops.aten._grouped_mm.default(index_59, permute_572, cumsum_68);  index_59 = permute_572 = None
        convert_element_type_1264 = torch.ops.prims.convert_element_type.default(_grouped_mm_66, torch.float32);  _grouped_mm_66 = None
        neg_45 = torch.ops.aten.neg.default(convert_element_type_1264)
        exp_68 = torch.ops.aten.exp.default(neg_45);  neg_45 = None
        add_1528 = torch.ops.aten.add.Tensor(exp_68, 1);  exp_68 = None
        div_114 = torch.ops.aten.div.Tensor(convert_element_type_1264, add_1528)
        convert_element_type_1265 = torch.ops.prims.convert_element_type.default(div_114, torch.bfloat16);  div_114 = None
        mul_1399 = torch.ops.aten.mul.Tensor(_grouped_mm_97, convert_element_type_1265);  convert_element_type_1265 = None
        mul_1400 = torch.ops.aten.mul.Tensor(_grouped_mm_97, _grouped_mm_67);  _grouped_mm_97 = _grouped_mm_67 = None
        permute_574 = torch.ops.aten.permute.default(mul_1399, [1, 0])
        _grouped_mm_98 = torch.ops.aten._grouped_mm.default(permute_574, index_45, cumsum_68);  permute_574 = None
        convert_element_type_1261 = torch.ops.prims.convert_element_type.default(primals_387, torch.bfloat16);  primals_387 = None
        all_gather_into_tensor_396 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1261, 8, '513');  convert_element_type_1261 = None
        wait_tensor_487 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_396);  all_gather_into_tensor_396 = None
        permute_351 = torch.ops.aten.permute.default(wait_tensor_487, [0, 2, 1]);  wait_tensor_487 = None
        permute_576 = torch.ops.aten.permute.default(permute_351, [0, 2, 1]);  permute_351 = None
        _grouped_mm_99 = torch.ops.aten._grouped_mm.default(mul_1399, permute_576, cumsum_68);  mul_1399 = permute_576 = None
        convert_element_type_1700 = torch.ops.prims.convert_element_type.default(mul_1400, torch.float32);  mul_1400 = None
        reciprocal_7 = torch.ops.aten.reciprocal.default(add_1528);  add_1528 = None
        mul_1401 = torch.ops.aten.mul.Tensor(reciprocal_7, 1);  reciprocal_7 = None
        mul_1402 = torch.ops.aten.mul.Tensor(convert_element_type_1700, mul_1401);  convert_element_type_1700 = None
        sub_644 = torch.ops.aten.sub.Tensor(1, mul_1401);  mul_1401 = None
        mul_1403 = torch.ops.aten.mul.Tensor(convert_element_type_1264, sub_644);  convert_element_type_1264 = sub_644 = None
        add_1824 = torch.ops.aten.add.Tensor(mul_1403, 1);  mul_1403 = None
        mul_1404 = torch.ops.aten.mul.Tensor(mul_1402, add_1824);  mul_1402 = add_1824 = None
        convert_element_type_1702 = torch.ops.prims.convert_element_type.default(mul_1404, torch.bfloat16);  mul_1404 = None
        permute_578 = torch.ops.aten.permute.default(convert_element_type_1702, [1, 0])
        _grouped_mm_100 = torch.ops.aten._grouped_mm.default(permute_578, index_45, cumsum_68);  permute_578 = index_45 = None
        convert_element_type_1258 = torch.ops.prims.convert_element_type.default(primals_385, torch.bfloat16);  primals_385 = None
        all_gather_into_tensor_393 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1258, 8, '513');  convert_element_type_1258 = None
        wait_tensor_484 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_393);  all_gather_into_tensor_393 = None
        permute_350 = torch.ops.aten.permute.default(wait_tensor_484, [0, 2, 1]);  wait_tensor_484 = None
        permute_580 = torch.ops.aten.permute.default(permute_350, [0, 2, 1]);  permute_350 = None
        _grouped_mm_101 = torch.ops.aten._grouped_mm.default(convert_element_type_1702, permute_580, cumsum_68);  convert_element_type_1702 = permute_580 = cumsum_68 = None
        add_1825 = torch.ops.aten.add.Tensor(_grouped_mm_99, _grouped_mm_101);  _grouped_mm_99 = _grouped_mm_101 = None
        convert_element_type_1703 = torch.ops.prims.convert_element_type.default(_grouped_mm_98, torch.float32);  _grouped_mm_98 = None
        div_150 = torch.ops.aten.div.Tensor(convert_element_type_1703, 64);  convert_element_type_1703 = None
        reduce_scatter_tensor_47 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_150, 'sum', 8, '513');  div_150 = None
        wait_tensor_613 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_47);  reduce_scatter_tensor_47 = None
        convert_element_type_1704 = torch.ops.prims.convert_element_type.default(_grouped_mm_96, torch.float32);  _grouped_mm_96 = None
        div_151 = torch.ops.aten.div.Tensor(convert_element_type_1704, 64);  convert_element_type_1704 = None
        reduce_scatter_tensor_48 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_151, 'sum', 8, '513');  div_151 = None
        wait_tensor_614 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_48);  reduce_scatter_tensor_48 = None
        convert_element_type_1705 = torch.ops.prims.convert_element_type.default(_grouped_mm_100, torch.float32);  _grouped_mm_100 = None
        div_152 = torch.ops.aten.div.Tensor(convert_element_type_1705, 64);  convert_element_type_1705 = None
        reduce_scatter_tensor_49 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_152, 'sum', 8, '513');  div_152 = None
        wait_tensor_615 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_49);  reduce_scatter_tensor_49 = None
        index_put_58 = torch.ops.aten.index_put.default(full_360, [getitem_330], add_1825, True);  full_360 = getitem_330 = add_1825 = None
        slice_125 = torch.ops.aten.slice.Tensor(index_put_58, 0, 0, add_1826);  index_put_58 = add_1826 = None
        all_to_all_single_85 = torch.ops._c10d_functional.all_to_all_single.default(slice_125, [_local_scalar_dense_352, _local_scalar_dense_353, _local_scalar_dense_354, _local_scalar_dense_355, _local_scalar_dense_356, _local_scalar_dense_357, _local_scalar_dense_358, _local_scalar_dense_359], [_local_scalar_dense_360, _local_scalar_dense_361, _local_scalar_dense_362, _local_scalar_dense_363, _local_scalar_dense_364, _local_scalar_dense_365, _local_scalar_dense_366, _local_scalar_dense_367], '521');  slice_125 = _local_scalar_dense_352 = _local_scalar_dense_353 = _local_scalar_dense_354 = _local_scalar_dense_355 = _local_scalar_dense_356 = _local_scalar_dense_357 = _local_scalar_dense_358 = _local_scalar_dense_359 = _local_scalar_dense_360 = _local_scalar_dense_361 = _local_scalar_dense_362 = _local_scalar_dense_363 = _local_scalar_dense_364 = _local_scalar_dense_365 = _local_scalar_dense_366 = _local_scalar_dense_367 = None
        wait_tensor_616 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_85);  all_to_all_single_85 = None
        index_put_59 = torch.ops.aten.index_put.default(full_default_52, [div_112], wait_tensor_616, True);  div_112 = wait_tensor_616 = None
        add_1830 = torch.ops.aten.add.Tensor(add_1822, index_put_59);  add_1822 = index_put_59 = None
        mul_1405 = torch.ops.aten.mul.Tensor(view_1840, 1.0);  view_1840 = None
        scatter_add_3 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_327, mul_1405);  getitem_327 = mul_1405 = None
        convert_element_type_1253 = torch.ops.prims.convert_element_type.default(mm_187, torch.float32);  mm_187 = None
        sub_528 = torch.ops.aten.sub.Tensor(convert_element_type_1253, amax_22);  convert_element_type_1253 = amax_22 = None
        exp_67 = torch.ops.aten.exp.default(sub_528);  sub_528 = None
        div_111 = torch.ops.aten.div.Tensor(exp_67, sum_89);  exp_67 = sum_89 = None
        mul_1406 = torch.ops.aten.mul.Tensor(scatter_add_3, div_111);  scatter_add_3 = None
        sum_131 = torch.ops.aten.sum.dim_IntList(mul_1406, [1], True)
        neg_64 = torch.ops.aten.neg.default(div_111);  div_111 = None
        fma_3 = torch.ops.prims.fma.default(neg_64, sum_131, mul_1406);  neg_64 = sum_131 = mul_1406 = None
        convert_element_type_1706 = torch.ops.prims.convert_element_type.default(fma_3, torch.bfloat16);  fma_3 = None
        permute_582 = torch.ops.aten.permute.default(convert_element_type_1706, [1, 0])
        mm_272 = torch.ops.aten.mm.default(permute_582, view_1532);  permute_582 = view_1532 = None
        convert_element_type_1250 = torch.ops.prims.convert_element_type.default(primals_383, torch.bfloat16);  primals_383 = None
        all_gather_into_tensor_392 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1250, 64, '0');  convert_element_type_1250 = None
        wait_tensor_480 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_392);  all_gather_into_tensor_392 = None
        permute_349 = torch.ops.aten.permute.default(wait_tensor_480, [1, 0]);  wait_tensor_480 = None
        permute_584 = torch.ops.aten.permute.default(permute_349, [1, 0]);  permute_349 = None
        mm_273 = torch.ops.aten.mm.default(convert_element_type_1706, permute_584);  convert_element_type_1706 = permute_584 = None
        add_1831 = torch.ops.aten.add.Tensor(add_1830, mm_273);  add_1830 = mm_273 = None
        convert_element_type_1711 = torch.ops.prims.convert_element_type.default(mm_272, torch.float32);  mm_272 = None
        reduce_scatter_tensor_50 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1711, 'avg', 64, '0');  convert_element_type_1711 = None
        wait_tensor_617 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_50);  reduce_scatter_tensor_50 = None
        view_1842 = torch.ops.aten.view.default(add_1831, [2, 4096, 2048]);  add_1831 = None
        convert_element_type_1712 = torch.ops.prims.convert_element_type.default(view_1842, torch.float32);  view_1842 = None
        convert_element_type_1247 = torch.ops.prims.convert_element_type.default(primals_381, torch.bfloat16);  primals_381 = None
        all_gather_into_tensor_391 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1247, 64, '0');  convert_element_type_1247 = None
        wait_tensor_479 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_391);  all_gather_into_tensor_391 = None
        convert_element_type_1714 = torch.ops.prims.convert_element_type.default(wait_tensor_479, torch.float32);  wait_tensor_479 = None
        mul_1407 = torch.ops.aten.mul.Tensor(convert_element_type_1712, convert_element_type_1714);  convert_element_type_1714 = None
        convert_element_type_1248 = torch.ops.prims.convert_element_type.default(add_1504, torch.float32);  add_1504 = None
        mul_1093 = torch.ops.aten.mul.Tensor(convert_element_type_1248, rsqrt_71);  convert_element_type_1248 = None
        mul_1409 = torch.ops.aten.mul.Tensor(mul_1093, mul_1407)
        sum_132 = torch.ops.aten.sum.dim_IntList(mul_1409, [2], True);  mul_1409 = None
        div_153 = torch.ops.aten.div.Tensor(mul_1093, 2048)
        mul_1410 = torch.ops.aten.mul.Tensor(div_153, sum_132);  div_153 = sum_132 = None
        sub_646 = torch.ops.aten.sub.Tensor(mul_1407, mul_1410);  mul_1407 = mul_1410 = None
        mul_1411 = torch.ops.aten.mul.Tensor(sub_646, rsqrt_71);  sub_646 = rsqrt_71 = None
        mul_1412 = torch.ops.aten.mul.Tensor(convert_element_type_1712, mul_1093);  convert_element_type_1712 = mul_1093 = None
        sum_133 = torch.ops.aten.sum.dim_IntList(mul_1412, [0, 1]);  mul_1412 = None
        convert_element_type_1715 = torch.ops.prims.convert_element_type.default(mul_1411, torch.bfloat16);  mul_1411 = None
        add_1832 = torch.ops.aten.add.Tensor(add_1819, convert_element_type_1715);  add_1819 = convert_element_type_1715 = None
        convert_element_type_default_72 = torch.ops.prims.convert_element_type.default(sum_133, torch.float32);  sum_133 = None
        reduce_scatter_tensor_51 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_72, 'avg', 64, '0');  convert_element_type_default_72 = None
        wait_tensor_618 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_51);  reduce_scatter_tensor_51 = None
        view_1843 = torch.ops.aten.view.default(add_1832, [8192, 2048])
        permute_586 = torch.ops.aten.permute.default(view_1843, [1, 0])
        permute_347 = torch.ops.aten.permute.default(getitem_323, [0, 2, 1, 3])
        view_1527 = torch.ops.aten.view.default(permute_347, [2, 4096, -1]);  permute_347 = None
        view_1529 = torch.ops.aten.view.default(view_1527, [8192, 2048]);  view_1527 = None
        mm_274 = torch.ops.aten.mm.default(permute_586, view_1529);  permute_586 = view_1529 = None
        convert_element_type_1244 = torch.ops.prims.convert_element_type.default(primals_380, torch.bfloat16);  primals_380 = None
        all_gather_into_tensor_390 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1244, 64, '0');  convert_element_type_1244 = None
        wait_tensor_478 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_390);  all_gather_into_tensor_390 = None
        permute_348 = torch.ops.aten.permute.default(wait_tensor_478, [1, 0]);  wait_tensor_478 = None
        permute_588 = torch.ops.aten.permute.default(permute_348, [1, 0]);  permute_348 = None
        mm_275 = torch.ops.aten.mm.default(view_1843, permute_588);  view_1843 = permute_588 = None
        view_1844 = torch.ops.aten.view.default(mm_275, [2, 4096, 2048]);  mm_275 = None
        convert_element_type_1722 = torch.ops.prims.convert_element_type.default(mm_274, torch.float32);  mm_274 = None
        reduce_scatter_tensor_52 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1722, 'avg', 64, '0');  convert_element_type_1722 = None
        wait_tensor_619 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_52);  reduce_scatter_tensor_52 = None
        view_1845 = torch.ops.aten.view.default(view_1844, [2, 4096, 16, 128]);  view_1844 = None
        permute_590 = torch.ops.aten.permute.default(view_1845, [0, 2, 1, 3]);  view_1845 = None
        fw_graph3 = self.fw_graph3
        joint_graph3 = self.joint_graph3
        mask_graph3 = self.mask_graph3
        flex_attention_backward_3 = torch.ops.higher_order.flex_attention_backward(permute_344, permute_345, permute_346, getitem_323, getitem_324, permute_590, None, fw_graph3, joint_graph3, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph3), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_344 = permute_345 = permute_346 = getitem_323 = getitem_324 = permute_590 = fw_graph3 = joint_graph3 = mask_graph3 = None
        getitem_385 = flex_attention_backward_3[0]
        getitem_386 = flex_attention_backward_3[1]
        getitem_387 = flex_attention_backward_3[2];  flex_attention_backward_3 = None
        permute_591 = torch.ops.aten.permute.default(getitem_387, [0, 2, 1, 3]);  getitem_387 = None
        permute_592 = torch.ops.aten.permute.default(getitem_386, [0, 2, 1, 3]);  getitem_386 = None
        permute_593 = torch.ops.aten.permute.default(getitem_385, [0, 2, 1, 3]);  getitem_385 = None
        slice_127 = torch.ops.aten.slice.Tensor(permute_592, 3, 0, 128)
        slice_128 = torch.ops.aten.slice.Tensor(permute_592, 3, 128, 192);  permute_592 = None
        sum_134 = torch.ops.aten.sum.dim_IntList(slice_128, [2], True);  slice_128 = None
        cat_89 = torch.ops.aten.cat.default([slice_127, permute_591], 3);  slice_127 = permute_591 = None
        view_1846 = torch.ops.aten.view.default(cat_89, [2, 4096, 4096]);  cat_89 = None
        view_1847 = torch.ops.aten.view.default(view_1846, [8192, 4096]);  view_1846 = None
        permute_594 = torch.ops.aten.permute.default(view_1847, [1, 0])
        mm_276 = torch.ops.aten.mm.default(permute_594, view_1524);  permute_594 = view_1524 = None
        convert_element_type_1241 = torch.ops.prims.convert_element_type.default(primals_379, torch.bfloat16);  primals_379 = None
        all_gather_into_tensor_389 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1241, 64, '0');  convert_element_type_1241 = None
        wait_tensor_477 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_389);  all_gather_into_tensor_389 = None
        permute_343 = torch.ops.aten.permute.default(wait_tensor_477, [1, 0]);  wait_tensor_477 = None
        permute_596 = torch.ops.aten.permute.default(permute_343, [1, 0]);  permute_343 = None
        mm_277 = torch.ops.aten.mm.default(view_1847, permute_596);  view_1847 = permute_596 = None
        view_1848 = torch.ops.aten.view.default(mm_277, [2, 4096, 512]);  mm_277 = None
        convert_element_type_1727 = torch.ops.prims.convert_element_type.default(mm_276, torch.float32);  mm_276 = None
        reduce_scatter_tensor_53 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1727, 'avg', 64, '0');  convert_element_type_1727 = None
        wait_tensor_620 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_53);  reduce_scatter_tensor_53 = None
        convert_element_type_1728 = torch.ops.prims.convert_element_type.default(view_1848, torch.float32);  view_1848 = None
        convert_element_type_1238 = torch.ops.prims.convert_element_type.default(primals_378, torch.bfloat16);  primals_378 = None
        all_gather_into_tensor_388 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1238, 64, '0');  convert_element_type_1238 = None
        wait_tensor_476 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_388);  all_gather_into_tensor_388 = None
        convert_element_type_1730 = torch.ops.prims.convert_element_type.default(wait_tensor_476, torch.float32);  wait_tensor_476 = None
        mul_1413 = torch.ops.aten.mul.Tensor(convert_element_type_1728, convert_element_type_1730);  convert_element_type_1730 = None
        convert_element_type_1239 = torch.ops.prims.convert_element_type.default(getitem_319, torch.float32);  getitem_319 = None
        mul_1091 = torch.ops.aten.mul.Tensor(convert_element_type_1239, rsqrt_70);  convert_element_type_1239 = None
        mul_1415 = torch.ops.aten.mul.Tensor(mul_1091, mul_1413)
        sum_135 = torch.ops.aten.sum.dim_IntList(mul_1415, [2], True);  mul_1415 = None
        div_154 = torch.ops.aten.div.Tensor(mul_1091, 512)
        mul_1416 = torch.ops.aten.mul.Tensor(div_154, sum_135);  div_154 = sum_135 = None
        sub_647 = torch.ops.aten.sub.Tensor(mul_1413, mul_1416);  mul_1413 = mul_1416 = None
        mul_1417 = torch.ops.aten.mul.Tensor(sub_647, rsqrt_70);  sub_647 = rsqrt_70 = None
        mul_1418 = torch.ops.aten.mul.Tensor(convert_element_type_1728, mul_1091);  convert_element_type_1728 = mul_1091 = None
        sum_136 = torch.ops.aten.sum.dim_IntList(mul_1418, [0, 1]);  mul_1418 = None
        convert_element_type_1731 = torch.ops.prims.convert_element_type.default(mul_1417, torch.bfloat16);  mul_1417 = None
        convert_element_type_default_71 = torch.ops.prims.convert_element_type.default(sum_136, torch.float32);  sum_136 = None
        reduce_scatter_tensor_54 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_71, 'avg', 64, '0');  convert_element_type_default_71 = None
        wait_tensor_621 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_54);  reduce_scatter_tensor_54 = None
        convert_element_type_1734 = torch.ops.prims.convert_element_type.default(sum_134, torch.float32);  sum_134 = None
        view_1849 = torch.ops.aten.view.default(convert_element_type_1734, [2, 4096, 1, 32, 2]);  convert_element_type_1734 = None
        view_as_complex_60 = torch.ops.aten.view_as_complex.default(view_1849);  view_1849 = None
        mul_1419 = torch.ops.aten.mul.Tensor(view_as_complex_60, clone_9);  view_as_complex_60 = None
        view_as_real_60 = torch.ops.aten.view_as_real.default(mul_1419);  mul_1419 = None
        view_1850 = torch.ops.aten.view.default(view_as_real_60, [2, 4096, 1, 64]);  view_as_real_60 = None
        convert_element_type_1735 = torch.ops.prims.convert_element_type.default(view_1850, torch.bfloat16);  view_1850 = None
        squeeze_29 = torch.ops.aten.squeeze.dim(convert_element_type_1735, 2);  convert_element_type_1735 = None
        cat_90 = torch.ops.aten.cat.default([convert_element_type_1731, squeeze_29], 2);  convert_element_type_1731 = squeeze_29 = None
        view_1851 = torch.ops.aten.view.default(cat_90, [8192, 576]);  cat_90 = None
        permute_598 = torch.ops.aten.permute.default(view_1851, [1, 0])
        mm_278 = torch.ops.aten.mm.default(permute_598, view_1510);  permute_598 = None
        convert_element_type_1233 = torch.ops.prims.convert_element_type.default(primals_377, torch.bfloat16);  primals_377 = None
        all_gather_into_tensor_387 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1233, 64, '0');  convert_element_type_1233 = None
        wait_tensor_475 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_387);  all_gather_into_tensor_387 = None
        permute_342 = torch.ops.aten.permute.default(wait_tensor_475, [1, 0]);  wait_tensor_475 = None
        permute_600 = torch.ops.aten.permute.default(permute_342, [1, 0]);  permute_342 = None
        mm_279 = torch.ops.aten.mm.default(view_1851, permute_600);  view_1851 = permute_600 = None
        view_1852 = torch.ops.aten.view.default(mm_279, [2, 4096, 2048]);  mm_279 = None
        convert_element_type_1740 = torch.ops.prims.convert_element_type.default(mm_278, torch.float32);  mm_278 = None
        reduce_scatter_tensor_55 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1740, 'avg', 64, '0');  convert_element_type_1740 = None
        wait_tensor_622 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_55);  reduce_scatter_tensor_55 = None
        slice_129 = torch.ops.aten.slice.Tensor(permute_593, 3, 0, 128)
        slice_130 = torch.ops.aten.slice.Tensor(permute_593, 3, 128, 192);  permute_593 = None
        convert_element_type_1741 = torch.ops.prims.convert_element_type.default(slice_130, torch.float32);  slice_130 = None
        view_1853 = torch.ops.aten.view.default(convert_element_type_1741, [2, 4096, 16, 32, 2]);  convert_element_type_1741 = None
        view_as_complex_61 = torch.ops.aten.view_as_complex.default(view_1853);  view_1853 = None
        mul_1420 = torch.ops.aten.mul.Tensor(view_as_complex_61, clone_9);  view_as_complex_61 = None
        view_as_real_61 = torch.ops.aten.view_as_real.default(mul_1420);  mul_1420 = None
        view_1854 = torch.ops.aten.view.default(view_as_real_61, [2, 4096, 16, 64]);  view_as_real_61 = None
        convert_element_type_1742 = torch.ops.prims.convert_element_type.default(view_1854, torch.bfloat16);  view_1854 = None
        cat_91 = torch.ops.aten.cat.default([slice_129, convert_element_type_1742], 3);  slice_129 = convert_element_type_1742 = None
        view_1855 = torch.ops.aten.view.default(cat_91, [2, 4096, 3072]);  cat_91 = None
        view_1856 = torch.ops.aten.view.default(view_1855, [8192, 3072]);  view_1855 = None
        permute_602 = torch.ops.aten.permute.default(view_1856, [1, 0])
        mm_280 = torch.ops.aten.mm.default(permute_602, view_1510);  permute_602 = view_1510 = None
        convert_element_type_1228 = torch.ops.prims.convert_element_type.default(primals_376, torch.bfloat16);  primals_376 = None
        all_gather_into_tensor_386 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1228, 64, '0');  convert_element_type_1228 = None
        wait_tensor_474 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_386);  all_gather_into_tensor_386 = None
        permute_341 = torch.ops.aten.permute.default(wait_tensor_474, [1, 0]);  wait_tensor_474 = None
        permute_604 = torch.ops.aten.permute.default(permute_341, [1, 0]);  permute_341 = None
        mm_281 = torch.ops.aten.mm.default(view_1856, permute_604);  view_1856 = permute_604 = None
        view_1857 = torch.ops.aten.view.default(mm_281, [2, 4096, 2048]);  mm_281 = None
        add_1833 = torch.ops.aten.add.Tensor(view_1852, view_1857);  view_1852 = view_1857 = None
        convert_element_type_1747 = torch.ops.prims.convert_element_type.default(mm_280, torch.float32);  mm_280 = None
        reduce_scatter_tensor_56 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1747, 'avg', 64, '0');  convert_element_type_1747 = None
        wait_tensor_623 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_56);  reduce_scatter_tensor_56 = None
        convert_element_type_1748 = torch.ops.prims.convert_element_type.default(add_1833, torch.float32);  add_1833 = None
        convert_element_type_1225 = torch.ops.prims.convert_element_type.default(primals_375, torch.bfloat16);  primals_375 = None
        all_gather_into_tensor_385 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1225, 64, '0');  convert_element_type_1225 = None
        wait_tensor_473 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_385);  all_gather_into_tensor_385 = None
        convert_element_type_1750 = torch.ops.prims.convert_element_type.default(wait_tensor_473, torch.float32);  wait_tensor_473 = None
        mul_1421 = torch.ops.aten.mul.Tensor(convert_element_type_1748, convert_element_type_1750);  convert_element_type_1750 = None
        convert_element_type_1226 = torch.ops.prims.convert_element_type.default(add_1501, torch.float32);  add_1501 = None
        mul_1087 = torch.ops.aten.mul.Tensor(convert_element_type_1226, rsqrt_69);  convert_element_type_1226 = None
        mul_1423 = torch.ops.aten.mul.Tensor(mul_1087, mul_1421)
        sum_137 = torch.ops.aten.sum.dim_IntList(mul_1423, [2], True);  mul_1423 = None
        div_155 = torch.ops.aten.div.Tensor(mul_1087, 2048)
        mul_1424 = torch.ops.aten.mul.Tensor(div_155, sum_137);  div_155 = sum_137 = None
        sub_648 = torch.ops.aten.sub.Tensor(mul_1421, mul_1424);  mul_1421 = mul_1424 = None
        mul_1425 = torch.ops.aten.mul.Tensor(sub_648, rsqrt_69);  sub_648 = rsqrt_69 = None
        mul_1426 = torch.ops.aten.mul.Tensor(convert_element_type_1748, mul_1087);  convert_element_type_1748 = mul_1087 = None
        sum_138 = torch.ops.aten.sum.dim_IntList(mul_1426, [0, 1]);  mul_1426 = None
        convert_element_type_1751 = torch.ops.prims.convert_element_type.default(mul_1425, torch.bfloat16);  mul_1425 = None
        add_1834 = torch.ops.aten.add.Tensor(add_1832, convert_element_type_1751);  add_1832 = convert_element_type_1751 = None
        convert_element_type_default_70 = torch.ops.prims.convert_element_type.default(sum_138, torch.float32);  sum_138 = None
        reduce_scatter_tensor_57 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_70, 'avg', 64, '0');  convert_element_type_default_70 = None
        wait_tensor_624 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_57);  reduce_scatter_tensor_57 = None
        view_1858 = torch.ops.aten.view.default(add_1834, [8192, 2048])
        unsqueeze_57 = torch.ops.aten.unsqueeze.default(view_1858, 1)
        convert_element_type_1754 = torch.ops.prims.convert_element_type.default(unsqueeze_57, torch.float32);  unsqueeze_57 = None
        bmm_34 = torch.ops.aten.bmm.default(permute_606, convert_element_type_1754);  permute_606 = None
        bmm_35 = torch.ops.aten.bmm.default(convert_element_type_1754, permute_607);  convert_element_type_1754 = permute_607 = None
        convert_element_type_1755 = torch.ops.prims.convert_element_type.default(bmm_34, torch.bfloat16);  bmm_34 = None
        view_1859 = torch.ops.aten.view.default(bmm_35, [8192, 6]);  bmm_35 = None
        view_1860 = torch.ops.aten.view.default(convert_element_type_1755, [49152, 2048]);  convert_element_type_1755 = None
        index_60 = torch.ops.aten.index.Tensor(view_1860, [getitem_315]);  view_1860 = getitem_315 = None
        permute_608 = torch.ops.aten.permute.default(view_1858, [1, 0])
        mm_282 = torch.ops.aten.mm.default(permute_608, mul_1084);  permute_608 = mul_1084 = None
        convert_element_type_1220 = torch.ops.prims.convert_element_type.default(primals_374, torch.bfloat16);  primals_374 = None
        all_gather_into_tensor_384 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1220, 64, '0');  convert_element_type_1220 = None
        wait_tensor_472 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_384);  all_gather_into_tensor_384 = None
        permute_340 = torch.ops.aten.permute.default(wait_tensor_472, [1, 0]);  wait_tensor_472 = None
        permute_610 = torch.ops.aten.permute.default(permute_340, [1, 0]);  permute_340 = None
        mm_283 = torch.ops.aten.mm.default(view_1858, permute_610);  view_1858 = permute_610 = None
        convert_element_type_1760 = torch.ops.prims.convert_element_type.default(mm_282, torch.float32);  mm_282 = None
        reduce_scatter_tensor_58 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1760, 'avg', 64, '0');  convert_element_type_1760 = None
        wait_tensor_625 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_58);  reduce_scatter_tensor_58 = None
        convert_element_type_1215 = torch.ops.prims.convert_element_type.default(mm_180, torch.float32);  mm_180 = None
        neg_44 = torch.ops.aten.neg.default(convert_element_type_1215)
        exp_66 = torch.ops.aten.exp.default(neg_44);  neg_44 = None
        add_1496 = torch.ops.aten.add.Tensor(exp_66, 1);  exp_66 = None
        div_110 = torch.ops.aten.div.Tensor(convert_element_type_1215, add_1496)
        convert_element_type_1216 = torch.ops.prims.convert_element_type.default(div_110, torch.bfloat16);  div_110 = None
        mul_1427 = torch.ops.aten.mul.Tensor(mm_283, convert_element_type_1216);  convert_element_type_1216 = None
        mul_1428 = torch.ops.aten.mul.Tensor(mm_283, mm_181);  mm_283 = mm_181 = None
        permute_612 = torch.ops.aten.permute.default(mul_1427, [1, 0])
        mm_284 = torch.ops.aten.mm.default(permute_612, view_1465);  permute_612 = None
        convert_element_type_1217 = torch.ops.prims.convert_element_type.default(primals_373, torch.bfloat16);  primals_373 = None
        all_gather_into_tensor_383 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1217, 64, '0');  convert_element_type_1217 = None
        wait_tensor_471 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_383);  all_gather_into_tensor_383 = None
        permute_339 = torch.ops.aten.permute.default(wait_tensor_471, [1, 0]);  wait_tensor_471 = None
        permute_614 = torch.ops.aten.permute.default(permute_339, [1, 0]);  permute_339 = None
        mm_285 = torch.ops.aten.mm.default(mul_1427, permute_614);  mul_1427 = permute_614 = None
        convert_element_type_1765 = torch.ops.prims.convert_element_type.default(mm_284, torch.float32);  mm_284 = None
        reduce_scatter_tensor_59 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1765, 'avg', 64, '0');  convert_element_type_1765 = None
        wait_tensor_626 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_59);  reduce_scatter_tensor_59 = None
        convert_element_type_1766 = torch.ops.prims.convert_element_type.default(mul_1428, torch.float32);  mul_1428 = None
        reciprocal_8 = torch.ops.aten.reciprocal.default(add_1496);  add_1496 = None
        mul_1429 = torch.ops.aten.mul.Tensor(reciprocal_8, 1);  reciprocal_8 = None
        mul_1430 = torch.ops.aten.mul.Tensor(convert_element_type_1766, mul_1429);  convert_element_type_1766 = None
        sub_649 = torch.ops.aten.sub.Tensor(1, mul_1429);  mul_1429 = None
        mul_1431 = torch.ops.aten.mul.Tensor(convert_element_type_1215, sub_649);  convert_element_type_1215 = sub_649 = None
        add_1836 = torch.ops.aten.add.Tensor(mul_1431, 1);  mul_1431 = None
        mul_1432 = torch.ops.aten.mul.Tensor(mul_1430, add_1836);  mul_1430 = add_1836 = None
        convert_element_type_1768 = torch.ops.prims.convert_element_type.default(mul_1432, torch.bfloat16);  mul_1432 = None
        permute_616 = torch.ops.aten.permute.default(convert_element_type_1768, [1, 0])
        mm_286 = torch.ops.aten.mm.default(permute_616, view_1465);  permute_616 = None
        convert_element_type_1212 = torch.ops.prims.convert_element_type.default(primals_372, torch.bfloat16);  primals_372 = None
        all_gather_into_tensor_382 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1212, 64, '0');  convert_element_type_1212 = None
        wait_tensor_470 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_382);  all_gather_into_tensor_382 = None
        permute_338 = torch.ops.aten.permute.default(wait_tensor_470, [1, 0]);  wait_tensor_470 = None
        permute_618 = torch.ops.aten.permute.default(permute_338, [1, 0]);  permute_338 = None
        mm_287 = torch.ops.aten.mm.default(convert_element_type_1768, permute_618);  convert_element_type_1768 = permute_618 = None
        add_1837 = torch.ops.aten.add.Tensor(mm_285, mm_287);  mm_285 = mm_287 = None
        convert_element_type_1773 = torch.ops.prims.convert_element_type.default(mm_286, torch.float32);  mm_286 = None
        reduce_scatter_tensor_60 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1773, 'avg', 64, '0');  convert_element_type_1773 = None
        wait_tensor_627 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_60);  reduce_scatter_tensor_60 = None
        all_to_all_single_86 = torch.ops._c10d_functional.all_to_all_single.default(index_60, [_local_scalar_dense_344, _local_scalar_dense_345, _local_scalar_dense_346, _local_scalar_dense_347, _local_scalar_dense_348, _local_scalar_dense_349, _local_scalar_dense_350, _local_scalar_dense_351], [_local_scalar_dense_336, _local_scalar_dense_337, _local_scalar_dense_338, _local_scalar_dense_339, _local_scalar_dense_340, _local_scalar_dense_341, _local_scalar_dense_342, _local_scalar_dense_343], '521');  index_60 = None
        wait_tensor_628 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_86);  all_to_all_single_86 = None
        full_364 = torch.ops.aten.full.default([sym_size_int_85, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_85 = None
        slice_scatter_4 = torch.ops.aten.slice_scatter.default(full_364, wait_tensor_628, 0, 0, -1);  wait_tensor_628 = None
        index_61 = torch.ops.aten.index.Tensor(slice_scatter_4, [getitem_316]);  slice_scatter_4 = None
        permute_620 = torch.ops.aten.permute.default(index_61, [1, 0])
        _grouped_mm_102 = torch.ops.aten._grouped_mm.default(permute_620, mul_1064, cumsum_65);  permute_620 = mul_1064 = None
        convert_element_type_1206 = torch.ops.prims.convert_element_type.default(primals_370, torch.bfloat16);  primals_370 = None
        all_gather_into_tensor_378 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1206, 8, '513');  convert_element_type_1206 = None
        wait_tensor_465 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_378);  all_gather_into_tensor_378 = None
        permute_337 = torch.ops.aten.permute.default(wait_tensor_465, [0, 2, 1]);  wait_tensor_465 = None
        permute_622 = torch.ops.aten.permute.default(permute_337, [0, 2, 1]);  permute_337 = None
        _grouped_mm_103 = torch.ops.aten._grouped_mm.default(index_61, permute_622, cumsum_65);  index_61 = permute_622 = None
        convert_element_type_1210 = torch.ops.prims.convert_element_type.default(_grouped_mm_63, torch.float32);  _grouped_mm_63 = None
        neg_43 = torch.ops.aten.neg.default(convert_element_type_1210)
        exp_65 = torch.ops.aten.exp.default(neg_43);  neg_43 = None
        add_1460 = torch.ops.aten.add.Tensor(exp_65, 1);  exp_65 = None
        div_109 = torch.ops.aten.div.Tensor(convert_element_type_1210, add_1460)
        convert_element_type_1211 = torch.ops.prims.convert_element_type.default(div_109, torch.bfloat16);  div_109 = None
        mul_1433 = torch.ops.aten.mul.Tensor(_grouped_mm_103, convert_element_type_1211);  convert_element_type_1211 = None
        mul_1434 = torch.ops.aten.mul.Tensor(_grouped_mm_103, _grouped_mm_64);  _grouped_mm_103 = _grouped_mm_64 = None
        permute_624 = torch.ops.aten.permute.default(mul_1433, [1, 0])
        _grouped_mm_104 = torch.ops.aten._grouped_mm.default(permute_624, index_43, cumsum_65);  permute_624 = None
        convert_element_type_1207 = torch.ops.prims.convert_element_type.default(primals_371, torch.bfloat16);  primals_371 = None
        all_gather_into_tensor_379 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1207, 8, '513');  convert_element_type_1207 = None
        wait_tensor_466 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_379);  all_gather_into_tensor_379 = None
        permute_336 = torch.ops.aten.permute.default(wait_tensor_466, [0, 2, 1]);  wait_tensor_466 = None
        permute_626 = torch.ops.aten.permute.default(permute_336, [0, 2, 1]);  permute_336 = None
        _grouped_mm_105 = torch.ops.aten._grouped_mm.default(mul_1433, permute_626, cumsum_65);  mul_1433 = permute_626 = None
        convert_element_type_1774 = torch.ops.prims.convert_element_type.default(mul_1434, torch.float32);  mul_1434 = None
        reciprocal_9 = torch.ops.aten.reciprocal.default(add_1460);  add_1460 = None
        mul_1435 = torch.ops.aten.mul.Tensor(reciprocal_9, 1);  reciprocal_9 = None
        mul_1436 = torch.ops.aten.mul.Tensor(convert_element_type_1774, mul_1435);  convert_element_type_1774 = None
        sub_650 = torch.ops.aten.sub.Tensor(1, mul_1435);  mul_1435 = None
        mul_1437 = torch.ops.aten.mul.Tensor(convert_element_type_1210, sub_650);  convert_element_type_1210 = sub_650 = None
        add_1839 = torch.ops.aten.add.Tensor(mul_1437, 1);  mul_1437 = None
        mul_1438 = torch.ops.aten.mul.Tensor(mul_1436, add_1839);  mul_1436 = add_1839 = None
        convert_element_type_1776 = torch.ops.prims.convert_element_type.default(mul_1438, torch.bfloat16);  mul_1438 = None
        permute_628 = torch.ops.aten.permute.default(convert_element_type_1776, [1, 0])
        _grouped_mm_106 = torch.ops.aten._grouped_mm.default(permute_628, index_43, cumsum_65);  permute_628 = index_43 = None
        convert_element_type_1204 = torch.ops.prims.convert_element_type.default(primals_369, torch.bfloat16);  primals_369 = None
        all_gather_into_tensor_376 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1204, 8, '513');  convert_element_type_1204 = None
        wait_tensor_463 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_376);  all_gather_into_tensor_376 = None
        permute_335 = torch.ops.aten.permute.default(wait_tensor_463, [0, 2, 1]);  wait_tensor_463 = None
        permute_630 = torch.ops.aten.permute.default(permute_335, [0, 2, 1]);  permute_335 = None
        _grouped_mm_107 = torch.ops.aten._grouped_mm.default(convert_element_type_1776, permute_630, cumsum_65);  convert_element_type_1776 = permute_630 = cumsum_65 = None
        add_1840 = torch.ops.aten.add.Tensor(_grouped_mm_105, _grouped_mm_107);  _grouped_mm_105 = _grouped_mm_107 = None
        convert_element_type_1777 = torch.ops.prims.convert_element_type.default(_grouped_mm_104, torch.float32);  _grouped_mm_104 = None
        div_156 = torch.ops.aten.div.Tensor(convert_element_type_1777, 64);  convert_element_type_1777 = None
        reduce_scatter_tensor_61 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_156, 'sum', 8, '513');  div_156 = None
        wait_tensor_629 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_61);  reduce_scatter_tensor_61 = None
        convert_element_type_1778 = torch.ops.prims.convert_element_type.default(_grouped_mm_102, torch.float32);  _grouped_mm_102 = None
        div_157 = torch.ops.aten.div.Tensor(convert_element_type_1778, 64);  convert_element_type_1778 = None
        reduce_scatter_tensor_62 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_157, 'sum', 8, '513');  div_157 = None
        wait_tensor_630 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_62);  reduce_scatter_tensor_62 = None
        convert_element_type_1779 = torch.ops.prims.convert_element_type.default(_grouped_mm_106, torch.float32);  _grouped_mm_106 = None
        div_158 = torch.ops.aten.div.Tensor(convert_element_type_1779, 64);  convert_element_type_1779 = None
        reduce_scatter_tensor_63 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_158, 'sum', 8, '513');  div_158 = None
        wait_tensor_631 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_63);  reduce_scatter_tensor_63 = None
        index_put_60 = torch.ops.aten.index_put.default(full_364, [getitem_316], add_1840, True);  full_364 = getitem_316 = add_1840 = None
        slice_131 = torch.ops.aten.slice.Tensor(index_put_60, 0, 0, add_1841);  index_put_60 = add_1841 = None
        all_to_all_single_87 = torch.ops._c10d_functional.all_to_all_single.default(slice_131, [_local_scalar_dense_336, _local_scalar_dense_337, _local_scalar_dense_338, _local_scalar_dense_339, _local_scalar_dense_340, _local_scalar_dense_341, _local_scalar_dense_342, _local_scalar_dense_343], [_local_scalar_dense_344, _local_scalar_dense_345, _local_scalar_dense_346, _local_scalar_dense_347, _local_scalar_dense_348, _local_scalar_dense_349, _local_scalar_dense_350, _local_scalar_dense_351], '521');  slice_131 = _local_scalar_dense_336 = _local_scalar_dense_337 = _local_scalar_dense_338 = _local_scalar_dense_339 = _local_scalar_dense_340 = _local_scalar_dense_341 = _local_scalar_dense_342 = _local_scalar_dense_343 = _local_scalar_dense_344 = _local_scalar_dense_345 = _local_scalar_dense_346 = _local_scalar_dense_347 = _local_scalar_dense_348 = _local_scalar_dense_349 = _local_scalar_dense_350 = _local_scalar_dense_351 = None
        wait_tensor_632 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_87);  all_to_all_single_87 = None
        index_put_61 = torch.ops.aten.index_put.default(full_default_52, [div_107], wait_tensor_632, True);  div_107 = wait_tensor_632 = None
        add_1845 = torch.ops.aten.add.Tensor(add_1837, index_put_61);  add_1837 = index_put_61 = None
        mul_1439 = torch.ops.aten.mul.Tensor(view_1859, 1.0);  view_1859 = None
        scatter_add_4 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_313, mul_1439);  getitem_313 = mul_1439 = None
        convert_element_type_1199 = torch.ops.prims.convert_element_type.default(mm_179, torch.float32);  mm_179 = None
        sub_504 = torch.ops.aten.sub.Tensor(convert_element_type_1199, amax_21);  convert_element_type_1199 = amax_21 = None
        exp_64 = torch.ops.aten.exp.default(sub_504);  sub_504 = None
        div_106 = torch.ops.aten.div.Tensor(exp_64, sum_85);  exp_64 = sum_85 = None
        mul_1440 = torch.ops.aten.mul.Tensor(scatter_add_4, div_106);  scatter_add_4 = None
        sum_139 = torch.ops.aten.sum.dim_IntList(mul_1440, [1], True)
        neg_67 = torch.ops.aten.neg.default(div_106);  div_106 = None
        fma_4 = torch.ops.prims.fma.default(neg_67, sum_139, mul_1440);  neg_67 = sum_139 = mul_1440 = None
        convert_element_type_1780 = torch.ops.prims.convert_element_type.default(fma_4, torch.bfloat16);  fma_4 = None
        permute_632 = torch.ops.aten.permute.default(convert_element_type_1780, [1, 0])
        mm_288 = torch.ops.aten.mm.default(permute_632, view_1465);  permute_632 = view_1465 = None
        convert_element_type_1196 = torch.ops.prims.convert_element_type.default(primals_367, torch.bfloat16);  primals_367 = None
        all_gather_into_tensor_375 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1196, 64, '0');  convert_element_type_1196 = None
        wait_tensor_459 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_375);  all_gather_into_tensor_375 = None
        permute_334 = torch.ops.aten.permute.default(wait_tensor_459, [1, 0]);  wait_tensor_459 = None
        permute_634 = torch.ops.aten.permute.default(permute_334, [1, 0]);  permute_334 = None
        mm_289 = torch.ops.aten.mm.default(convert_element_type_1780, permute_634);  convert_element_type_1780 = permute_634 = None
        add_1846 = torch.ops.aten.add.Tensor(add_1845, mm_289);  add_1845 = mm_289 = None
        convert_element_type_1785 = torch.ops.prims.convert_element_type.default(mm_288, torch.float32);  mm_288 = None
        reduce_scatter_tensor_64 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1785, 'avg', 64, '0');  convert_element_type_1785 = None
        wait_tensor_633 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_64);  reduce_scatter_tensor_64 = None
        view_1861 = torch.ops.aten.view.default(add_1846, [2, 4096, 2048]);  add_1846 = None
        convert_element_type_1786 = torch.ops.prims.convert_element_type.default(view_1861, torch.float32);  view_1861 = None
        convert_element_type_1193 = torch.ops.prims.convert_element_type.default(primals_365, torch.bfloat16);  primals_365 = None
        all_gather_into_tensor_374 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1193, 64, '0');  convert_element_type_1193 = None
        wait_tensor_458 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_374);  all_gather_into_tensor_374 = None
        convert_element_type_1788 = torch.ops.prims.convert_element_type.default(wait_tensor_458, torch.float32);  wait_tensor_458 = None
        mul_1441 = torch.ops.aten.mul.Tensor(convert_element_type_1786, convert_element_type_1788);  convert_element_type_1788 = None
        convert_element_type_1194 = torch.ops.prims.convert_element_type.default(add_1436, torch.float32);  add_1436 = None
        mul_1044 = torch.ops.aten.mul.Tensor(convert_element_type_1194, rsqrt_68);  convert_element_type_1194 = None
        mul_1443 = torch.ops.aten.mul.Tensor(mul_1044, mul_1441)
        sum_140 = torch.ops.aten.sum.dim_IntList(mul_1443, [2], True);  mul_1443 = None
        div_159 = torch.ops.aten.div.Tensor(mul_1044, 2048)
        mul_1444 = torch.ops.aten.mul.Tensor(div_159, sum_140);  div_159 = sum_140 = None
        sub_652 = torch.ops.aten.sub.Tensor(mul_1441, mul_1444);  mul_1441 = mul_1444 = None
        mul_1445 = torch.ops.aten.mul.Tensor(sub_652, rsqrt_68);  sub_652 = rsqrt_68 = None
        mul_1446 = torch.ops.aten.mul.Tensor(convert_element_type_1786, mul_1044);  convert_element_type_1786 = mul_1044 = None
        sum_141 = torch.ops.aten.sum.dim_IntList(mul_1446, [0, 1]);  mul_1446 = None
        convert_element_type_1789 = torch.ops.prims.convert_element_type.default(mul_1445, torch.bfloat16);  mul_1445 = None
        add_1847 = torch.ops.aten.add.Tensor(add_1834, convert_element_type_1789);  add_1834 = convert_element_type_1789 = None
        convert_element_type_default_69 = torch.ops.prims.convert_element_type.default(sum_141, torch.float32);  sum_141 = None
        reduce_scatter_tensor_65 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_69, 'avg', 64, '0');  convert_element_type_default_69 = None
        wait_tensor_634 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_65);  reduce_scatter_tensor_65 = None
        view_1862 = torch.ops.aten.view.default(add_1847, [8192, 2048])
        permute_636 = torch.ops.aten.permute.default(view_1862, [1, 0])
        permute_332 = torch.ops.aten.permute.default(getitem_309, [0, 2, 1, 3])
        view_1460 = torch.ops.aten.view.default(permute_332, [2, 4096, -1]);  permute_332 = None
        view_1462 = torch.ops.aten.view.default(view_1460, [8192, 2048]);  view_1460 = None
        mm_290 = torch.ops.aten.mm.default(permute_636, view_1462);  permute_636 = view_1462 = None
        convert_element_type_1190 = torch.ops.prims.convert_element_type.default(primals_364, torch.bfloat16);  primals_364 = None
        all_gather_into_tensor_373 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1190, 64, '0');  convert_element_type_1190 = None
        wait_tensor_457 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_373);  all_gather_into_tensor_373 = None
        permute_333 = torch.ops.aten.permute.default(wait_tensor_457, [1, 0]);  wait_tensor_457 = None
        permute_638 = torch.ops.aten.permute.default(permute_333, [1, 0]);  permute_333 = None
        mm_291 = torch.ops.aten.mm.default(view_1862, permute_638);  view_1862 = permute_638 = None
        view_1863 = torch.ops.aten.view.default(mm_291, [2, 4096, 2048]);  mm_291 = None
        convert_element_type_1796 = torch.ops.prims.convert_element_type.default(mm_290, torch.float32);  mm_290 = None
        reduce_scatter_tensor_66 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1796, 'avg', 64, '0');  convert_element_type_1796 = None
        wait_tensor_635 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_66);  reduce_scatter_tensor_66 = None
        view_1864 = torch.ops.aten.view.default(view_1863, [2, 4096, 16, 128]);  view_1863 = None
        permute_640 = torch.ops.aten.permute.default(view_1864, [0, 2, 1, 3]);  view_1864 = None
        fw_graph4 = self.fw_graph4
        joint_graph4 = self.joint_graph4
        mask_graph4 = self.mask_graph4
        flex_attention_backward_4 = torch.ops.higher_order.flex_attention_backward(permute_329, permute_330, permute_331, getitem_309, getitem_310, permute_640, None, fw_graph4, joint_graph4, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph4), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_329 = permute_330 = permute_331 = getitem_309 = getitem_310 = permute_640 = fw_graph4 = joint_graph4 = mask_graph4 = None
        getitem_389 = flex_attention_backward_4[0]
        getitem_390 = flex_attention_backward_4[1]
        getitem_391 = flex_attention_backward_4[2];  flex_attention_backward_4 = None
        permute_641 = torch.ops.aten.permute.default(getitem_391, [0, 2, 1, 3]);  getitem_391 = None
        permute_642 = torch.ops.aten.permute.default(getitem_390, [0, 2, 1, 3]);  getitem_390 = None
        permute_643 = torch.ops.aten.permute.default(getitem_389, [0, 2, 1, 3]);  getitem_389 = None
        slice_133 = torch.ops.aten.slice.Tensor(permute_642, 3, 0, 128)
        slice_134 = torch.ops.aten.slice.Tensor(permute_642, 3, 128, 192);  permute_642 = None
        sum_142 = torch.ops.aten.sum.dim_IntList(slice_134, [2], True);  slice_134 = None
        cat_92 = torch.ops.aten.cat.default([slice_133, permute_641], 3);  slice_133 = permute_641 = None
        view_1865 = torch.ops.aten.view.default(cat_92, [2, 4096, 4096]);  cat_92 = None
        view_1866 = torch.ops.aten.view.default(view_1865, [8192, 4096]);  view_1865 = None
        permute_644 = torch.ops.aten.permute.default(view_1866, [1, 0])
        mm_292 = torch.ops.aten.mm.default(permute_644, view_1457);  permute_644 = view_1457 = None
        convert_element_type_1187 = torch.ops.prims.convert_element_type.default(primals_363, torch.bfloat16);  primals_363 = None
        all_gather_into_tensor_372 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1187, 64, '0');  convert_element_type_1187 = None
        wait_tensor_456 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_372);  all_gather_into_tensor_372 = None
        permute_328 = torch.ops.aten.permute.default(wait_tensor_456, [1, 0]);  wait_tensor_456 = None
        permute_646 = torch.ops.aten.permute.default(permute_328, [1, 0]);  permute_328 = None
        mm_293 = torch.ops.aten.mm.default(view_1866, permute_646);  view_1866 = permute_646 = None
        view_1867 = torch.ops.aten.view.default(mm_293, [2, 4096, 512]);  mm_293 = None
        convert_element_type_1801 = torch.ops.prims.convert_element_type.default(mm_292, torch.float32);  mm_292 = None
        reduce_scatter_tensor_67 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1801, 'avg', 64, '0');  convert_element_type_1801 = None
        wait_tensor_636 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_67);  reduce_scatter_tensor_67 = None
        convert_element_type_1802 = torch.ops.prims.convert_element_type.default(view_1867, torch.float32);  view_1867 = None
        convert_element_type_1184 = torch.ops.prims.convert_element_type.default(primals_362, torch.bfloat16);  primals_362 = None
        all_gather_into_tensor_371 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1184, 64, '0');  convert_element_type_1184 = None
        wait_tensor_455 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_371);  all_gather_into_tensor_371 = None
        convert_element_type_1804 = torch.ops.prims.convert_element_type.default(wait_tensor_455, torch.float32);  wait_tensor_455 = None
        mul_1447 = torch.ops.aten.mul.Tensor(convert_element_type_1802, convert_element_type_1804);  convert_element_type_1804 = None
        convert_element_type_1185 = torch.ops.prims.convert_element_type.default(getitem_305, torch.float32);  getitem_305 = None
        mul_1042 = torch.ops.aten.mul.Tensor(convert_element_type_1185, rsqrt_67);  convert_element_type_1185 = None
        mul_1449 = torch.ops.aten.mul.Tensor(mul_1042, mul_1447)
        sum_143 = torch.ops.aten.sum.dim_IntList(mul_1449, [2], True);  mul_1449 = None
        div_160 = torch.ops.aten.div.Tensor(mul_1042, 512)
        mul_1450 = torch.ops.aten.mul.Tensor(div_160, sum_143);  div_160 = sum_143 = None
        sub_653 = torch.ops.aten.sub.Tensor(mul_1447, mul_1450);  mul_1447 = mul_1450 = None
        mul_1451 = torch.ops.aten.mul.Tensor(sub_653, rsqrt_67);  sub_653 = rsqrt_67 = None
        mul_1452 = torch.ops.aten.mul.Tensor(convert_element_type_1802, mul_1042);  convert_element_type_1802 = mul_1042 = None
        sum_144 = torch.ops.aten.sum.dim_IntList(mul_1452, [0, 1]);  mul_1452 = None
        convert_element_type_1805 = torch.ops.prims.convert_element_type.default(mul_1451, torch.bfloat16);  mul_1451 = None
        convert_element_type_default_68 = torch.ops.prims.convert_element_type.default(sum_144, torch.float32);  sum_144 = None
        reduce_scatter_tensor_68 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_68, 'avg', 64, '0');  convert_element_type_default_68 = None
        wait_tensor_637 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_68);  reduce_scatter_tensor_68 = None
        convert_element_type_1808 = torch.ops.prims.convert_element_type.default(sum_142, torch.float32);  sum_142 = None
        view_1868 = torch.ops.aten.view.default(convert_element_type_1808, [2, 4096, 1, 32, 2]);  convert_element_type_1808 = None
        view_as_complex_62 = torch.ops.aten.view_as_complex.default(view_1868);  view_1868 = None
        mul_1453 = torch.ops.aten.mul.Tensor(view_as_complex_62, clone_9);  view_as_complex_62 = None
        view_as_real_62 = torch.ops.aten.view_as_real.default(mul_1453);  mul_1453 = None
        view_1869 = torch.ops.aten.view.default(view_as_real_62, [2, 4096, 1, 64]);  view_as_real_62 = None
        convert_element_type_1809 = torch.ops.prims.convert_element_type.default(view_1869, torch.bfloat16);  view_1869 = None
        squeeze_30 = torch.ops.aten.squeeze.dim(convert_element_type_1809, 2);  convert_element_type_1809 = None
        cat_93 = torch.ops.aten.cat.default([convert_element_type_1805, squeeze_30], 2);  convert_element_type_1805 = squeeze_30 = None
        view_1870 = torch.ops.aten.view.default(cat_93, [8192, 576]);  cat_93 = None
        permute_648 = torch.ops.aten.permute.default(view_1870, [1, 0])
        mm_294 = torch.ops.aten.mm.default(permute_648, view_1443);  permute_648 = None
        convert_element_type_1179 = torch.ops.prims.convert_element_type.default(primals_361, torch.bfloat16);  primals_361 = None
        all_gather_into_tensor_370 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1179, 64, '0');  convert_element_type_1179 = None
        wait_tensor_454 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_370);  all_gather_into_tensor_370 = None
        permute_327 = torch.ops.aten.permute.default(wait_tensor_454, [1, 0]);  wait_tensor_454 = None
        permute_650 = torch.ops.aten.permute.default(permute_327, [1, 0]);  permute_327 = None
        mm_295 = torch.ops.aten.mm.default(view_1870, permute_650);  view_1870 = permute_650 = None
        view_1871 = torch.ops.aten.view.default(mm_295, [2, 4096, 2048]);  mm_295 = None
        convert_element_type_1814 = torch.ops.prims.convert_element_type.default(mm_294, torch.float32);  mm_294 = None
        reduce_scatter_tensor_69 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1814, 'avg', 64, '0');  convert_element_type_1814 = None
        wait_tensor_638 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_69);  reduce_scatter_tensor_69 = None
        slice_135 = torch.ops.aten.slice.Tensor(permute_643, 3, 0, 128)
        slice_136 = torch.ops.aten.slice.Tensor(permute_643, 3, 128, 192);  permute_643 = None
        convert_element_type_1815 = torch.ops.prims.convert_element_type.default(slice_136, torch.float32);  slice_136 = None
        view_1872 = torch.ops.aten.view.default(convert_element_type_1815, [2, 4096, 16, 32, 2]);  convert_element_type_1815 = None
        view_as_complex_63 = torch.ops.aten.view_as_complex.default(view_1872);  view_1872 = None
        mul_1454 = torch.ops.aten.mul.Tensor(view_as_complex_63, clone_9);  view_as_complex_63 = None
        view_as_real_63 = torch.ops.aten.view_as_real.default(mul_1454);  mul_1454 = None
        view_1873 = torch.ops.aten.view.default(view_as_real_63, [2, 4096, 16, 64]);  view_as_real_63 = None
        convert_element_type_1816 = torch.ops.prims.convert_element_type.default(view_1873, torch.bfloat16);  view_1873 = None
        cat_94 = torch.ops.aten.cat.default([slice_135, convert_element_type_1816], 3);  slice_135 = convert_element_type_1816 = None
        view_1874 = torch.ops.aten.view.default(cat_94, [2, 4096, 3072]);  cat_94 = None
        view_1875 = torch.ops.aten.view.default(view_1874, [8192, 3072]);  view_1874 = None
        permute_652 = torch.ops.aten.permute.default(view_1875, [1, 0])
        mm_296 = torch.ops.aten.mm.default(permute_652, view_1443);  permute_652 = view_1443 = None
        convert_element_type_1174 = torch.ops.prims.convert_element_type.default(primals_360, torch.bfloat16);  primals_360 = None
        all_gather_into_tensor_369 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1174, 64, '0');  convert_element_type_1174 = None
        wait_tensor_453 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_369);  all_gather_into_tensor_369 = None
        permute_326 = torch.ops.aten.permute.default(wait_tensor_453, [1, 0]);  wait_tensor_453 = None
        permute_654 = torch.ops.aten.permute.default(permute_326, [1, 0]);  permute_326 = None
        mm_297 = torch.ops.aten.mm.default(view_1875, permute_654);  view_1875 = permute_654 = None
        view_1876 = torch.ops.aten.view.default(mm_297, [2, 4096, 2048]);  mm_297 = None
        add_1848 = torch.ops.aten.add.Tensor(view_1871, view_1876);  view_1871 = view_1876 = None
        convert_element_type_1821 = torch.ops.prims.convert_element_type.default(mm_296, torch.float32);  mm_296 = None
        reduce_scatter_tensor_70 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1821, 'avg', 64, '0');  convert_element_type_1821 = None
        wait_tensor_639 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_70);  reduce_scatter_tensor_70 = None
        convert_element_type_1822 = torch.ops.prims.convert_element_type.default(add_1848, torch.float32);  add_1848 = None
        convert_element_type_1171 = torch.ops.prims.convert_element_type.default(primals_359, torch.bfloat16);  primals_359 = None
        all_gather_into_tensor_368 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1171, 64, '0');  convert_element_type_1171 = None
        wait_tensor_452 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_368);  all_gather_into_tensor_368 = None
        convert_element_type_1824 = torch.ops.prims.convert_element_type.default(wait_tensor_452, torch.float32);  wait_tensor_452 = None
        mul_1455 = torch.ops.aten.mul.Tensor(convert_element_type_1822, convert_element_type_1824);  convert_element_type_1824 = None
        convert_element_type_1172 = torch.ops.prims.convert_element_type.default(add_1433, torch.float32);  add_1433 = None
        mul_1038 = torch.ops.aten.mul.Tensor(convert_element_type_1172, rsqrt_66);  convert_element_type_1172 = None
        mul_1457 = torch.ops.aten.mul.Tensor(mul_1038, mul_1455)
        sum_145 = torch.ops.aten.sum.dim_IntList(mul_1457, [2], True);  mul_1457 = None
        div_161 = torch.ops.aten.div.Tensor(mul_1038, 2048)
        mul_1458 = torch.ops.aten.mul.Tensor(div_161, sum_145);  div_161 = sum_145 = None
        sub_654 = torch.ops.aten.sub.Tensor(mul_1455, mul_1458);  mul_1455 = mul_1458 = None
        mul_1459 = torch.ops.aten.mul.Tensor(sub_654, rsqrt_66);  sub_654 = rsqrt_66 = None
        mul_1460 = torch.ops.aten.mul.Tensor(convert_element_type_1822, mul_1038);  convert_element_type_1822 = mul_1038 = None
        sum_146 = torch.ops.aten.sum.dim_IntList(mul_1460, [0, 1]);  mul_1460 = None
        convert_element_type_1825 = torch.ops.prims.convert_element_type.default(mul_1459, torch.bfloat16);  mul_1459 = None
        add_1849 = torch.ops.aten.add.Tensor(add_1847, convert_element_type_1825);  add_1847 = convert_element_type_1825 = None
        convert_element_type_default_67 = torch.ops.prims.convert_element_type.default(sum_146, torch.float32);  sum_146 = None
        reduce_scatter_tensor_71 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_67, 'avg', 64, '0');  convert_element_type_default_67 = None
        wait_tensor_640 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_71);  reduce_scatter_tensor_71 = None
        view_1877 = torch.ops.aten.view.default(add_1849, [8192, 2048])
        unsqueeze_58 = torch.ops.aten.unsqueeze.default(view_1877, 1)
        convert_element_type_1828 = torch.ops.prims.convert_element_type.default(unsqueeze_58, torch.float32);  unsqueeze_58 = None
        bmm_36 = torch.ops.aten.bmm.default(permute_656, convert_element_type_1828);  permute_656 = None
        bmm_37 = torch.ops.aten.bmm.default(convert_element_type_1828, permute_657);  convert_element_type_1828 = permute_657 = None
        convert_element_type_1829 = torch.ops.prims.convert_element_type.default(bmm_36, torch.bfloat16);  bmm_36 = None
        view_1878 = torch.ops.aten.view.default(bmm_37, [8192, 6]);  bmm_37 = None
        view_1879 = torch.ops.aten.view.default(convert_element_type_1829, [49152, 2048]);  convert_element_type_1829 = None
        index_62 = torch.ops.aten.index.Tensor(view_1879, [getitem_301]);  view_1879 = getitem_301 = None
        permute_658 = torch.ops.aten.permute.default(view_1877, [1, 0])
        mm_298 = torch.ops.aten.mm.default(permute_658, mul_1035);  permute_658 = mul_1035 = None
        convert_element_type_1166 = torch.ops.prims.convert_element_type.default(primals_358, torch.bfloat16);  primals_358 = None
        all_gather_into_tensor_367 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1166, 64, '0');  convert_element_type_1166 = None
        wait_tensor_451 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_367);  all_gather_into_tensor_367 = None
        permute_325 = torch.ops.aten.permute.default(wait_tensor_451, [1, 0]);  wait_tensor_451 = None
        permute_660 = torch.ops.aten.permute.default(permute_325, [1, 0]);  permute_325 = None
        mm_299 = torch.ops.aten.mm.default(view_1877, permute_660);  view_1877 = permute_660 = None
        convert_element_type_1834 = torch.ops.prims.convert_element_type.default(mm_298, torch.float32);  mm_298 = None
        reduce_scatter_tensor_72 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1834, 'avg', 64, '0');  convert_element_type_1834 = None
        wait_tensor_641 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_72);  reduce_scatter_tensor_72 = None
        convert_element_type_1161 = torch.ops.prims.convert_element_type.default(mm_172, torch.float32);  mm_172 = None
        neg_42 = torch.ops.aten.neg.default(convert_element_type_1161)
        exp_63 = torch.ops.aten.exp.default(neg_42);  neg_42 = None
        add_1428 = torch.ops.aten.add.Tensor(exp_63, 1);  exp_63 = None
        div_105 = torch.ops.aten.div.Tensor(convert_element_type_1161, add_1428)
        convert_element_type_1162 = torch.ops.prims.convert_element_type.default(div_105, torch.bfloat16);  div_105 = None
        mul_1461 = torch.ops.aten.mul.Tensor(mm_299, convert_element_type_1162);  convert_element_type_1162 = None
        mul_1462 = torch.ops.aten.mul.Tensor(mm_299, mm_173);  mm_299 = mm_173 = None
        permute_662 = torch.ops.aten.permute.default(mul_1461, [1, 0])
        mm_300 = torch.ops.aten.mm.default(permute_662, view_1398);  permute_662 = None
        convert_element_type_1163 = torch.ops.prims.convert_element_type.default(primals_357, torch.bfloat16);  primals_357 = None
        all_gather_into_tensor_366 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1163, 64, '0');  convert_element_type_1163 = None
        wait_tensor_450 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_366);  all_gather_into_tensor_366 = None
        permute_324 = torch.ops.aten.permute.default(wait_tensor_450, [1, 0]);  wait_tensor_450 = None
        permute_664 = torch.ops.aten.permute.default(permute_324, [1, 0]);  permute_324 = None
        mm_301 = torch.ops.aten.mm.default(mul_1461, permute_664);  mul_1461 = permute_664 = None
        convert_element_type_1839 = torch.ops.prims.convert_element_type.default(mm_300, torch.float32);  mm_300 = None
        reduce_scatter_tensor_73 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1839, 'avg', 64, '0');  convert_element_type_1839 = None
        wait_tensor_642 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_73);  reduce_scatter_tensor_73 = None
        convert_element_type_1840 = torch.ops.prims.convert_element_type.default(mul_1462, torch.float32);  mul_1462 = None
        reciprocal_10 = torch.ops.aten.reciprocal.default(add_1428);  add_1428 = None
        mul_1463 = torch.ops.aten.mul.Tensor(reciprocal_10, 1);  reciprocal_10 = None
        mul_1464 = torch.ops.aten.mul.Tensor(convert_element_type_1840, mul_1463);  convert_element_type_1840 = None
        sub_655 = torch.ops.aten.sub.Tensor(1, mul_1463);  mul_1463 = None
        mul_1465 = torch.ops.aten.mul.Tensor(convert_element_type_1161, sub_655);  convert_element_type_1161 = sub_655 = None
        add_1851 = torch.ops.aten.add.Tensor(mul_1465, 1);  mul_1465 = None
        mul_1466 = torch.ops.aten.mul.Tensor(mul_1464, add_1851);  mul_1464 = add_1851 = None
        convert_element_type_1842 = torch.ops.prims.convert_element_type.default(mul_1466, torch.bfloat16);  mul_1466 = None
        permute_666 = torch.ops.aten.permute.default(convert_element_type_1842, [1, 0])
        mm_302 = torch.ops.aten.mm.default(permute_666, view_1398);  permute_666 = None
        convert_element_type_1158 = torch.ops.prims.convert_element_type.default(primals_356, torch.bfloat16);  primals_356 = None
        all_gather_into_tensor_365 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1158, 64, '0');  convert_element_type_1158 = None
        wait_tensor_449 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_365);  all_gather_into_tensor_365 = None
        permute_323 = torch.ops.aten.permute.default(wait_tensor_449, [1, 0]);  wait_tensor_449 = None
        permute_668 = torch.ops.aten.permute.default(permute_323, [1, 0]);  permute_323 = None
        mm_303 = torch.ops.aten.mm.default(convert_element_type_1842, permute_668);  convert_element_type_1842 = permute_668 = None
        add_1852 = torch.ops.aten.add.Tensor(mm_301, mm_303);  mm_301 = mm_303 = None
        convert_element_type_1847 = torch.ops.prims.convert_element_type.default(mm_302, torch.float32);  mm_302 = None
        reduce_scatter_tensor_74 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1847, 'avg', 64, '0');  convert_element_type_1847 = None
        wait_tensor_643 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_74);  reduce_scatter_tensor_74 = None
        all_to_all_single_88 = torch.ops._c10d_functional.all_to_all_single.default(index_62, [_local_scalar_dense_328, _local_scalar_dense_329, _local_scalar_dense_330, _local_scalar_dense_331, _local_scalar_dense_332, _local_scalar_dense_333, _local_scalar_dense_334, _local_scalar_dense_335], [_local_scalar_dense_320, _local_scalar_dense_321, _local_scalar_dense_322, _local_scalar_dense_323, _local_scalar_dense_324, _local_scalar_dense_325, _local_scalar_dense_326, _local_scalar_dense_327], '521');  index_62 = None
        wait_tensor_644 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_88);  all_to_all_single_88 = None
        full_368 = torch.ops.aten.full.default([sym_size_int_81, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_81 = None
        slice_scatter_5 = torch.ops.aten.slice_scatter.default(full_368, wait_tensor_644, 0, 0, -1);  wait_tensor_644 = None
        index_63 = torch.ops.aten.index.Tensor(slice_scatter_5, [getitem_302]);  slice_scatter_5 = None
        permute_670 = torch.ops.aten.permute.default(index_63, [1, 0])
        _grouped_mm_108 = torch.ops.aten._grouped_mm.default(permute_670, mul_1015, cumsum_62);  permute_670 = mul_1015 = None
        convert_element_type_1152 = torch.ops.prims.convert_element_type.default(primals_354, torch.bfloat16);  primals_354 = None
        all_gather_into_tensor_361 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1152, 8, '513');  convert_element_type_1152 = None
        wait_tensor_444 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_361);  all_gather_into_tensor_361 = None
        permute_322 = torch.ops.aten.permute.default(wait_tensor_444, [0, 2, 1]);  wait_tensor_444 = None
        permute_672 = torch.ops.aten.permute.default(permute_322, [0, 2, 1]);  permute_322 = None
        _grouped_mm_109 = torch.ops.aten._grouped_mm.default(index_63, permute_672, cumsum_62);  index_63 = permute_672 = None
        convert_element_type_1156 = torch.ops.prims.convert_element_type.default(_grouped_mm_60, torch.float32);  _grouped_mm_60 = None
        neg_41 = torch.ops.aten.neg.default(convert_element_type_1156)
        exp_62 = torch.ops.aten.exp.default(neg_41);  neg_41 = None
        add_1392 = torch.ops.aten.add.Tensor(exp_62, 1);  exp_62 = None
        div_104 = torch.ops.aten.div.Tensor(convert_element_type_1156, add_1392)
        convert_element_type_1157 = torch.ops.prims.convert_element_type.default(div_104, torch.bfloat16);  div_104 = None
        mul_1467 = torch.ops.aten.mul.Tensor(_grouped_mm_109, convert_element_type_1157);  convert_element_type_1157 = None
        mul_1468 = torch.ops.aten.mul.Tensor(_grouped_mm_109, _grouped_mm_61);  _grouped_mm_109 = _grouped_mm_61 = None
        permute_674 = torch.ops.aten.permute.default(mul_1467, [1, 0])
        _grouped_mm_110 = torch.ops.aten._grouped_mm.default(permute_674, index_41, cumsum_62);  permute_674 = None
        convert_element_type_1153 = torch.ops.prims.convert_element_type.default(primals_355, torch.bfloat16);  primals_355 = None
        all_gather_into_tensor_362 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1153, 8, '513');  convert_element_type_1153 = None
        wait_tensor_445 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_362);  all_gather_into_tensor_362 = None
        permute_321 = torch.ops.aten.permute.default(wait_tensor_445, [0, 2, 1]);  wait_tensor_445 = None
        permute_676 = torch.ops.aten.permute.default(permute_321, [0, 2, 1]);  permute_321 = None
        _grouped_mm_111 = torch.ops.aten._grouped_mm.default(mul_1467, permute_676, cumsum_62);  mul_1467 = permute_676 = None
        convert_element_type_1848 = torch.ops.prims.convert_element_type.default(mul_1468, torch.float32);  mul_1468 = None
        reciprocal_11 = torch.ops.aten.reciprocal.default(add_1392);  add_1392 = None
        mul_1469 = torch.ops.aten.mul.Tensor(reciprocal_11, 1);  reciprocal_11 = None
        mul_1470 = torch.ops.aten.mul.Tensor(convert_element_type_1848, mul_1469);  convert_element_type_1848 = None
        sub_656 = torch.ops.aten.sub.Tensor(1, mul_1469);  mul_1469 = None
        mul_1471 = torch.ops.aten.mul.Tensor(convert_element_type_1156, sub_656);  convert_element_type_1156 = sub_656 = None
        add_1854 = torch.ops.aten.add.Tensor(mul_1471, 1);  mul_1471 = None
        mul_1472 = torch.ops.aten.mul.Tensor(mul_1470, add_1854);  mul_1470 = add_1854 = None
        convert_element_type_1850 = torch.ops.prims.convert_element_type.default(mul_1472, torch.bfloat16);  mul_1472 = None
        permute_678 = torch.ops.aten.permute.default(convert_element_type_1850, [1, 0])
        _grouped_mm_112 = torch.ops.aten._grouped_mm.default(permute_678, index_41, cumsum_62);  permute_678 = index_41 = None
        convert_element_type_1150 = torch.ops.prims.convert_element_type.default(primals_353, torch.bfloat16);  primals_353 = None
        all_gather_into_tensor_359 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1150, 8, '513');  convert_element_type_1150 = None
        wait_tensor_442 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_359);  all_gather_into_tensor_359 = None
        permute_320 = torch.ops.aten.permute.default(wait_tensor_442, [0, 2, 1]);  wait_tensor_442 = None
        permute_680 = torch.ops.aten.permute.default(permute_320, [0, 2, 1]);  permute_320 = None
        _grouped_mm_113 = torch.ops.aten._grouped_mm.default(convert_element_type_1850, permute_680, cumsum_62);  convert_element_type_1850 = permute_680 = cumsum_62 = None
        add_1855 = torch.ops.aten.add.Tensor(_grouped_mm_111, _grouped_mm_113);  _grouped_mm_111 = _grouped_mm_113 = None
        convert_element_type_1851 = torch.ops.prims.convert_element_type.default(_grouped_mm_110, torch.float32);  _grouped_mm_110 = None
        div_162 = torch.ops.aten.div.Tensor(convert_element_type_1851, 64);  convert_element_type_1851 = None
        reduce_scatter_tensor_75 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_162, 'sum', 8, '513');  div_162 = None
        wait_tensor_645 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_75);  reduce_scatter_tensor_75 = None
        convert_element_type_1852 = torch.ops.prims.convert_element_type.default(_grouped_mm_108, torch.float32);  _grouped_mm_108 = None
        div_163 = torch.ops.aten.div.Tensor(convert_element_type_1852, 64);  convert_element_type_1852 = None
        reduce_scatter_tensor_76 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_163, 'sum', 8, '513');  div_163 = None
        wait_tensor_646 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_76);  reduce_scatter_tensor_76 = None
        convert_element_type_1853 = torch.ops.prims.convert_element_type.default(_grouped_mm_112, torch.float32);  _grouped_mm_112 = None
        div_164 = torch.ops.aten.div.Tensor(convert_element_type_1853, 64);  convert_element_type_1853 = None
        reduce_scatter_tensor_77 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_164, 'sum', 8, '513');  div_164 = None
        wait_tensor_647 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_77);  reduce_scatter_tensor_77 = None
        index_put_62 = torch.ops.aten.index_put.default(full_368, [getitem_302], add_1855, True);  full_368 = getitem_302 = add_1855 = None
        slice_137 = torch.ops.aten.slice.Tensor(index_put_62, 0, 0, add_1856);  index_put_62 = add_1856 = None
        all_to_all_single_89 = torch.ops._c10d_functional.all_to_all_single.default(slice_137, [_local_scalar_dense_320, _local_scalar_dense_321, _local_scalar_dense_322, _local_scalar_dense_323, _local_scalar_dense_324, _local_scalar_dense_325, _local_scalar_dense_326, _local_scalar_dense_327], [_local_scalar_dense_328, _local_scalar_dense_329, _local_scalar_dense_330, _local_scalar_dense_331, _local_scalar_dense_332, _local_scalar_dense_333, _local_scalar_dense_334, _local_scalar_dense_335], '521');  slice_137 = _local_scalar_dense_320 = _local_scalar_dense_321 = _local_scalar_dense_322 = _local_scalar_dense_323 = _local_scalar_dense_324 = _local_scalar_dense_325 = _local_scalar_dense_326 = _local_scalar_dense_327 = _local_scalar_dense_328 = _local_scalar_dense_329 = _local_scalar_dense_330 = _local_scalar_dense_331 = _local_scalar_dense_332 = _local_scalar_dense_333 = _local_scalar_dense_334 = _local_scalar_dense_335 = None
        wait_tensor_648 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_89);  all_to_all_single_89 = None
        index_put_63 = torch.ops.aten.index_put.default(full_default_52, [div_102], wait_tensor_648, True);  div_102 = wait_tensor_648 = None
        add_1860 = torch.ops.aten.add.Tensor(add_1852, index_put_63);  add_1852 = index_put_63 = None
        mul_1473 = torch.ops.aten.mul.Tensor(view_1878, 1.0);  view_1878 = None
        scatter_add_5 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_299, mul_1473);  getitem_299 = mul_1473 = None
        convert_element_type_1145 = torch.ops.prims.convert_element_type.default(mm_171, torch.float32);  mm_171 = None
        sub_480 = torch.ops.aten.sub.Tensor(convert_element_type_1145, amax_20);  convert_element_type_1145 = amax_20 = None
        exp_61 = torch.ops.aten.exp.default(sub_480);  sub_480 = None
        div_101 = torch.ops.aten.div.Tensor(exp_61, sum_81);  exp_61 = sum_81 = None
        mul_1474 = torch.ops.aten.mul.Tensor(scatter_add_5, div_101);  scatter_add_5 = None
        sum_147 = torch.ops.aten.sum.dim_IntList(mul_1474, [1], True)
        neg_70 = torch.ops.aten.neg.default(div_101);  div_101 = None
        fma_5 = torch.ops.prims.fma.default(neg_70, sum_147, mul_1474);  neg_70 = sum_147 = mul_1474 = None
        convert_element_type_1854 = torch.ops.prims.convert_element_type.default(fma_5, torch.bfloat16);  fma_5 = None
        permute_682 = torch.ops.aten.permute.default(convert_element_type_1854, [1, 0])
        mm_304 = torch.ops.aten.mm.default(permute_682, view_1398);  permute_682 = view_1398 = None
        convert_element_type_1142 = torch.ops.prims.convert_element_type.default(primals_351, torch.bfloat16);  primals_351 = None
        all_gather_into_tensor_358 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1142, 64, '0');  convert_element_type_1142 = None
        wait_tensor_438 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_358);  all_gather_into_tensor_358 = None
        permute_319 = torch.ops.aten.permute.default(wait_tensor_438, [1, 0]);  wait_tensor_438 = None
        permute_684 = torch.ops.aten.permute.default(permute_319, [1, 0]);  permute_319 = None
        mm_305 = torch.ops.aten.mm.default(convert_element_type_1854, permute_684);  convert_element_type_1854 = permute_684 = None
        add_1861 = torch.ops.aten.add.Tensor(add_1860, mm_305);  add_1860 = mm_305 = None
        convert_element_type_1859 = torch.ops.prims.convert_element_type.default(mm_304, torch.float32);  mm_304 = None
        reduce_scatter_tensor_78 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1859, 'avg', 64, '0');  convert_element_type_1859 = None
        wait_tensor_649 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_78);  reduce_scatter_tensor_78 = None
        view_1880 = torch.ops.aten.view.default(add_1861, [2, 4096, 2048]);  add_1861 = None
        convert_element_type_1860 = torch.ops.prims.convert_element_type.default(view_1880, torch.float32);  view_1880 = None
        convert_element_type_1139 = torch.ops.prims.convert_element_type.default(primals_349, torch.bfloat16);  primals_349 = None
        all_gather_into_tensor_357 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1139, 64, '0');  convert_element_type_1139 = None
        wait_tensor_437 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_357);  all_gather_into_tensor_357 = None
        convert_element_type_1862 = torch.ops.prims.convert_element_type.default(wait_tensor_437, torch.float32);  wait_tensor_437 = None
        mul_1475 = torch.ops.aten.mul.Tensor(convert_element_type_1860, convert_element_type_1862);  convert_element_type_1862 = None
        convert_element_type_1140 = torch.ops.prims.convert_element_type.default(add_1368, torch.float32);  add_1368 = None
        mul_995 = torch.ops.aten.mul.Tensor(convert_element_type_1140, rsqrt_65);  convert_element_type_1140 = None
        mul_1477 = torch.ops.aten.mul.Tensor(mul_995, mul_1475)
        sum_148 = torch.ops.aten.sum.dim_IntList(mul_1477, [2], True);  mul_1477 = None
        div_165 = torch.ops.aten.div.Tensor(mul_995, 2048)
        mul_1478 = torch.ops.aten.mul.Tensor(div_165, sum_148);  div_165 = sum_148 = None
        sub_658 = torch.ops.aten.sub.Tensor(mul_1475, mul_1478);  mul_1475 = mul_1478 = None
        mul_1479 = torch.ops.aten.mul.Tensor(sub_658, rsqrt_65);  sub_658 = rsqrt_65 = None
        mul_1480 = torch.ops.aten.mul.Tensor(convert_element_type_1860, mul_995);  convert_element_type_1860 = mul_995 = None
        sum_149 = torch.ops.aten.sum.dim_IntList(mul_1480, [0, 1]);  mul_1480 = None
        convert_element_type_1863 = torch.ops.prims.convert_element_type.default(mul_1479, torch.bfloat16);  mul_1479 = None
        add_1862 = torch.ops.aten.add.Tensor(add_1849, convert_element_type_1863);  add_1849 = convert_element_type_1863 = None
        convert_element_type_default_66 = torch.ops.prims.convert_element_type.default(sum_149, torch.float32);  sum_149 = None
        reduce_scatter_tensor_79 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_66, 'avg', 64, '0');  convert_element_type_default_66 = None
        wait_tensor_650 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_79);  reduce_scatter_tensor_79 = None
        view_1881 = torch.ops.aten.view.default(add_1862, [8192, 2048])
        permute_686 = torch.ops.aten.permute.default(view_1881, [1, 0])
        permute_317 = torch.ops.aten.permute.default(getitem_295, [0, 2, 1, 3])
        view_1393 = torch.ops.aten.view.default(permute_317, [2, 4096, -1]);  permute_317 = None
        view_1395 = torch.ops.aten.view.default(view_1393, [8192, 2048]);  view_1393 = None
        mm_306 = torch.ops.aten.mm.default(permute_686, view_1395);  permute_686 = view_1395 = None
        convert_element_type_1136 = torch.ops.prims.convert_element_type.default(primals_348, torch.bfloat16);  primals_348 = None
        all_gather_into_tensor_356 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1136, 64, '0');  convert_element_type_1136 = None
        wait_tensor_436 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_356);  all_gather_into_tensor_356 = None
        permute_318 = torch.ops.aten.permute.default(wait_tensor_436, [1, 0]);  wait_tensor_436 = None
        permute_688 = torch.ops.aten.permute.default(permute_318, [1, 0]);  permute_318 = None
        mm_307 = torch.ops.aten.mm.default(view_1881, permute_688);  view_1881 = permute_688 = None
        view_1882 = torch.ops.aten.view.default(mm_307, [2, 4096, 2048]);  mm_307 = None
        convert_element_type_1870 = torch.ops.prims.convert_element_type.default(mm_306, torch.float32);  mm_306 = None
        reduce_scatter_tensor_80 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1870, 'avg', 64, '0');  convert_element_type_1870 = None
        wait_tensor_651 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_80);  reduce_scatter_tensor_80 = None
        view_1883 = torch.ops.aten.view.default(view_1882, [2, 4096, 16, 128]);  view_1882 = None
        permute_690 = torch.ops.aten.permute.default(view_1883, [0, 2, 1, 3]);  view_1883 = None
        fw_graph5 = self.fw_graph5
        joint_graph5 = self.joint_graph5
        mask_graph5 = self.mask_graph5
        flex_attention_backward_5 = torch.ops.higher_order.flex_attention_backward(permute_314, permute_315, permute_316, getitem_295, getitem_296, permute_690, None, fw_graph5, joint_graph5, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph5), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_314 = permute_315 = permute_316 = getitem_295 = getitem_296 = permute_690 = fw_graph5 = joint_graph5 = mask_graph5 = None
        getitem_393 = flex_attention_backward_5[0]
        getitem_394 = flex_attention_backward_5[1]
        getitem_395 = flex_attention_backward_5[2];  flex_attention_backward_5 = None
        permute_691 = torch.ops.aten.permute.default(getitem_395, [0, 2, 1, 3]);  getitem_395 = None
        permute_692 = torch.ops.aten.permute.default(getitem_394, [0, 2, 1, 3]);  getitem_394 = None
        permute_693 = torch.ops.aten.permute.default(getitem_393, [0, 2, 1, 3]);  getitem_393 = None
        slice_139 = torch.ops.aten.slice.Tensor(permute_692, 3, 0, 128)
        slice_140 = torch.ops.aten.slice.Tensor(permute_692, 3, 128, 192);  permute_692 = None
        sum_150 = torch.ops.aten.sum.dim_IntList(slice_140, [2], True);  slice_140 = None
        cat_95 = torch.ops.aten.cat.default([slice_139, permute_691], 3);  slice_139 = permute_691 = None
        view_1884 = torch.ops.aten.view.default(cat_95, [2, 4096, 4096]);  cat_95 = None
        view_1885 = torch.ops.aten.view.default(view_1884, [8192, 4096]);  view_1884 = None
        permute_694 = torch.ops.aten.permute.default(view_1885, [1, 0])
        mm_308 = torch.ops.aten.mm.default(permute_694, view_1390);  permute_694 = view_1390 = None
        convert_element_type_1133 = torch.ops.prims.convert_element_type.default(primals_347, torch.bfloat16);  primals_347 = None
        all_gather_into_tensor_355 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1133, 64, '0');  convert_element_type_1133 = None
        wait_tensor_435 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_355);  all_gather_into_tensor_355 = None
        permute_313 = torch.ops.aten.permute.default(wait_tensor_435, [1, 0]);  wait_tensor_435 = None
        permute_696 = torch.ops.aten.permute.default(permute_313, [1, 0]);  permute_313 = None
        mm_309 = torch.ops.aten.mm.default(view_1885, permute_696);  view_1885 = permute_696 = None
        view_1886 = torch.ops.aten.view.default(mm_309, [2, 4096, 512]);  mm_309 = None
        convert_element_type_1875 = torch.ops.prims.convert_element_type.default(mm_308, torch.float32);  mm_308 = None
        reduce_scatter_tensor_81 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1875, 'avg', 64, '0');  convert_element_type_1875 = None
        wait_tensor_652 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_81);  reduce_scatter_tensor_81 = None
        convert_element_type_1876 = torch.ops.prims.convert_element_type.default(view_1886, torch.float32);  view_1886 = None
        convert_element_type_1130 = torch.ops.prims.convert_element_type.default(primals_346, torch.bfloat16);  primals_346 = None
        all_gather_into_tensor_354 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1130, 64, '0');  convert_element_type_1130 = None
        wait_tensor_434 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_354);  all_gather_into_tensor_354 = None
        convert_element_type_1878 = torch.ops.prims.convert_element_type.default(wait_tensor_434, torch.float32);  wait_tensor_434 = None
        mul_1481 = torch.ops.aten.mul.Tensor(convert_element_type_1876, convert_element_type_1878);  convert_element_type_1878 = None
        convert_element_type_1131 = torch.ops.prims.convert_element_type.default(getitem_291, torch.float32);  getitem_291 = None
        mul_993 = torch.ops.aten.mul.Tensor(convert_element_type_1131, rsqrt_64);  convert_element_type_1131 = None
        mul_1483 = torch.ops.aten.mul.Tensor(mul_993, mul_1481)
        sum_151 = torch.ops.aten.sum.dim_IntList(mul_1483, [2], True);  mul_1483 = None
        div_166 = torch.ops.aten.div.Tensor(mul_993, 512)
        mul_1484 = torch.ops.aten.mul.Tensor(div_166, sum_151);  div_166 = sum_151 = None
        sub_659 = torch.ops.aten.sub.Tensor(mul_1481, mul_1484);  mul_1481 = mul_1484 = None
        mul_1485 = torch.ops.aten.mul.Tensor(sub_659, rsqrt_64);  sub_659 = rsqrt_64 = None
        mul_1486 = torch.ops.aten.mul.Tensor(convert_element_type_1876, mul_993);  convert_element_type_1876 = mul_993 = None
        sum_152 = torch.ops.aten.sum.dim_IntList(mul_1486, [0, 1]);  mul_1486 = None
        convert_element_type_1879 = torch.ops.prims.convert_element_type.default(mul_1485, torch.bfloat16);  mul_1485 = None
        convert_element_type_default_65 = torch.ops.prims.convert_element_type.default(sum_152, torch.float32);  sum_152 = None
        reduce_scatter_tensor_82 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_65, 'avg', 64, '0');  convert_element_type_default_65 = None
        wait_tensor_653 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_82);  reduce_scatter_tensor_82 = None
        convert_element_type_1882 = torch.ops.prims.convert_element_type.default(sum_150, torch.float32);  sum_150 = None
        view_1887 = torch.ops.aten.view.default(convert_element_type_1882, [2, 4096, 1, 32, 2]);  convert_element_type_1882 = None
        view_as_complex_64 = torch.ops.aten.view_as_complex.default(view_1887);  view_1887 = None
        mul_1487 = torch.ops.aten.mul.Tensor(view_as_complex_64, clone_9);  view_as_complex_64 = None
        view_as_real_64 = torch.ops.aten.view_as_real.default(mul_1487);  mul_1487 = None
        view_1888 = torch.ops.aten.view.default(view_as_real_64, [2, 4096, 1, 64]);  view_as_real_64 = None
        convert_element_type_1883 = torch.ops.prims.convert_element_type.default(view_1888, torch.bfloat16);  view_1888 = None
        squeeze_31 = torch.ops.aten.squeeze.dim(convert_element_type_1883, 2);  convert_element_type_1883 = None
        cat_96 = torch.ops.aten.cat.default([convert_element_type_1879, squeeze_31], 2);  convert_element_type_1879 = squeeze_31 = None
        view_1889 = torch.ops.aten.view.default(cat_96, [8192, 576]);  cat_96 = None
        permute_698 = torch.ops.aten.permute.default(view_1889, [1, 0])
        mm_310 = torch.ops.aten.mm.default(permute_698, view_1376);  permute_698 = None
        convert_element_type_1125 = torch.ops.prims.convert_element_type.default(primals_345, torch.bfloat16);  primals_345 = None
        all_gather_into_tensor_353 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1125, 64, '0');  convert_element_type_1125 = None
        wait_tensor_433 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_353);  all_gather_into_tensor_353 = None
        permute_312 = torch.ops.aten.permute.default(wait_tensor_433, [1, 0]);  wait_tensor_433 = None
        permute_700 = torch.ops.aten.permute.default(permute_312, [1, 0]);  permute_312 = None
        mm_311 = torch.ops.aten.mm.default(view_1889, permute_700);  view_1889 = permute_700 = None
        view_1890 = torch.ops.aten.view.default(mm_311, [2, 4096, 2048]);  mm_311 = None
        convert_element_type_1888 = torch.ops.prims.convert_element_type.default(mm_310, torch.float32);  mm_310 = None
        reduce_scatter_tensor_83 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1888, 'avg', 64, '0');  convert_element_type_1888 = None
        wait_tensor_654 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_83);  reduce_scatter_tensor_83 = None
        slice_141 = torch.ops.aten.slice.Tensor(permute_693, 3, 0, 128)
        slice_142 = torch.ops.aten.slice.Tensor(permute_693, 3, 128, 192);  permute_693 = None
        convert_element_type_1889 = torch.ops.prims.convert_element_type.default(slice_142, torch.float32);  slice_142 = None
        view_1891 = torch.ops.aten.view.default(convert_element_type_1889, [2, 4096, 16, 32, 2]);  convert_element_type_1889 = None
        view_as_complex_65 = torch.ops.aten.view_as_complex.default(view_1891);  view_1891 = None
        mul_1488 = torch.ops.aten.mul.Tensor(view_as_complex_65, clone_9);  view_as_complex_65 = None
        view_as_real_65 = torch.ops.aten.view_as_real.default(mul_1488);  mul_1488 = None
        view_1892 = torch.ops.aten.view.default(view_as_real_65, [2, 4096, 16, 64]);  view_as_real_65 = None
        convert_element_type_1890 = torch.ops.prims.convert_element_type.default(view_1892, torch.bfloat16);  view_1892 = None
        cat_97 = torch.ops.aten.cat.default([slice_141, convert_element_type_1890], 3);  slice_141 = convert_element_type_1890 = None
        view_1893 = torch.ops.aten.view.default(cat_97, [2, 4096, 3072]);  cat_97 = None
        view_1894 = torch.ops.aten.view.default(view_1893, [8192, 3072]);  view_1893 = None
        permute_702 = torch.ops.aten.permute.default(view_1894, [1, 0])
        mm_312 = torch.ops.aten.mm.default(permute_702, view_1376);  permute_702 = view_1376 = None
        convert_element_type_1120 = torch.ops.prims.convert_element_type.default(primals_344, torch.bfloat16);  primals_344 = None
        all_gather_into_tensor_352 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1120, 64, '0');  convert_element_type_1120 = None
        wait_tensor_432 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_352);  all_gather_into_tensor_352 = None
        permute_311 = torch.ops.aten.permute.default(wait_tensor_432, [1, 0]);  wait_tensor_432 = None
        permute_704 = torch.ops.aten.permute.default(permute_311, [1, 0]);  permute_311 = None
        mm_313 = torch.ops.aten.mm.default(view_1894, permute_704);  view_1894 = permute_704 = None
        view_1895 = torch.ops.aten.view.default(mm_313, [2, 4096, 2048]);  mm_313 = None
        add_1863 = torch.ops.aten.add.Tensor(view_1890, view_1895);  view_1890 = view_1895 = None
        convert_element_type_1895 = torch.ops.prims.convert_element_type.default(mm_312, torch.float32);  mm_312 = None
        reduce_scatter_tensor_84 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1895, 'avg', 64, '0');  convert_element_type_1895 = None
        wait_tensor_655 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_84);  reduce_scatter_tensor_84 = None
        convert_element_type_1896 = torch.ops.prims.convert_element_type.default(add_1863, torch.float32);  add_1863 = None
        convert_element_type_1117 = torch.ops.prims.convert_element_type.default(primals_343, torch.bfloat16);  primals_343 = None
        all_gather_into_tensor_351 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1117, 64, '0');  convert_element_type_1117 = None
        wait_tensor_431 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_351);  all_gather_into_tensor_351 = None
        convert_element_type_1898 = torch.ops.prims.convert_element_type.default(wait_tensor_431, torch.float32);  wait_tensor_431 = None
        mul_1489 = torch.ops.aten.mul.Tensor(convert_element_type_1896, convert_element_type_1898);  convert_element_type_1898 = None
        convert_element_type_1118 = torch.ops.prims.convert_element_type.default(add_1365, torch.float32);  add_1365 = None
        mul_989 = torch.ops.aten.mul.Tensor(convert_element_type_1118, rsqrt_63);  convert_element_type_1118 = None
        mul_1491 = torch.ops.aten.mul.Tensor(mul_989, mul_1489)
        sum_153 = torch.ops.aten.sum.dim_IntList(mul_1491, [2], True);  mul_1491 = None
        div_167 = torch.ops.aten.div.Tensor(mul_989, 2048)
        mul_1492 = torch.ops.aten.mul.Tensor(div_167, sum_153);  div_167 = sum_153 = None
        sub_660 = torch.ops.aten.sub.Tensor(mul_1489, mul_1492);  mul_1489 = mul_1492 = None
        mul_1493 = torch.ops.aten.mul.Tensor(sub_660, rsqrt_63);  sub_660 = rsqrt_63 = None
        mul_1494 = torch.ops.aten.mul.Tensor(convert_element_type_1896, mul_989);  convert_element_type_1896 = mul_989 = None
        sum_154 = torch.ops.aten.sum.dim_IntList(mul_1494, [0, 1]);  mul_1494 = None
        convert_element_type_1899 = torch.ops.prims.convert_element_type.default(mul_1493, torch.bfloat16);  mul_1493 = None
        add_1864 = torch.ops.aten.add.Tensor(add_1862, convert_element_type_1899);  add_1862 = convert_element_type_1899 = None
        convert_element_type_default_64 = torch.ops.prims.convert_element_type.default(sum_154, torch.float32);  sum_154 = None
        reduce_scatter_tensor_85 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_64, 'avg', 64, '0');  convert_element_type_default_64 = None
        wait_tensor_656 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_85);  reduce_scatter_tensor_85 = None
        view_1896 = torch.ops.aten.view.default(add_1864, [8192, 2048])
        unsqueeze_59 = torch.ops.aten.unsqueeze.default(view_1896, 1)
        convert_element_type_1902 = torch.ops.prims.convert_element_type.default(unsqueeze_59, torch.float32);  unsqueeze_59 = None
        bmm_38 = torch.ops.aten.bmm.default(permute_706, convert_element_type_1902);  permute_706 = None
        bmm_39 = torch.ops.aten.bmm.default(convert_element_type_1902, permute_707);  convert_element_type_1902 = permute_707 = None
        convert_element_type_1903 = torch.ops.prims.convert_element_type.default(bmm_38, torch.bfloat16);  bmm_38 = None
        view_1897 = torch.ops.aten.view.default(bmm_39, [8192, 6]);  bmm_39 = None
        view_1898 = torch.ops.aten.view.default(convert_element_type_1903, [49152, 2048]);  convert_element_type_1903 = None
        index_64 = torch.ops.aten.index.Tensor(view_1898, [getitem_287]);  view_1898 = getitem_287 = None
        permute_708 = torch.ops.aten.permute.default(view_1896, [1, 0])
        mm_314 = torch.ops.aten.mm.default(permute_708, mul_986);  permute_708 = mul_986 = None
        convert_element_type_1112 = torch.ops.prims.convert_element_type.default(primals_342, torch.bfloat16);  primals_342 = None
        all_gather_into_tensor_350 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1112, 64, '0');  convert_element_type_1112 = None
        wait_tensor_430 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_350);  all_gather_into_tensor_350 = None
        permute_310 = torch.ops.aten.permute.default(wait_tensor_430, [1, 0]);  wait_tensor_430 = None
        permute_710 = torch.ops.aten.permute.default(permute_310, [1, 0]);  permute_310 = None
        mm_315 = torch.ops.aten.mm.default(view_1896, permute_710);  view_1896 = permute_710 = None
        convert_element_type_1908 = torch.ops.prims.convert_element_type.default(mm_314, torch.float32);  mm_314 = None
        reduce_scatter_tensor_86 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1908, 'avg', 64, '0');  convert_element_type_1908 = None
        wait_tensor_657 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_86);  reduce_scatter_tensor_86 = None
        convert_element_type_1107 = torch.ops.prims.convert_element_type.default(mm_164, torch.float32);  mm_164 = None
        neg_40 = torch.ops.aten.neg.default(convert_element_type_1107)
        exp_60 = torch.ops.aten.exp.default(neg_40);  neg_40 = None
        add_1360 = torch.ops.aten.add.Tensor(exp_60, 1);  exp_60 = None
        div_100 = torch.ops.aten.div.Tensor(convert_element_type_1107, add_1360)
        convert_element_type_1108 = torch.ops.prims.convert_element_type.default(div_100, torch.bfloat16);  div_100 = None
        mul_1495 = torch.ops.aten.mul.Tensor(mm_315, convert_element_type_1108);  convert_element_type_1108 = None
        mul_1496 = torch.ops.aten.mul.Tensor(mm_315, mm_165);  mm_315 = mm_165 = None
        permute_712 = torch.ops.aten.permute.default(mul_1495, [1, 0])
        mm_316 = torch.ops.aten.mm.default(permute_712, view_1331);  permute_712 = None
        convert_element_type_1109 = torch.ops.prims.convert_element_type.default(primals_341, torch.bfloat16);  primals_341 = None
        all_gather_into_tensor_349 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1109, 64, '0');  convert_element_type_1109 = None
        wait_tensor_429 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_349);  all_gather_into_tensor_349 = None
        permute_309 = torch.ops.aten.permute.default(wait_tensor_429, [1, 0]);  wait_tensor_429 = None
        permute_714 = torch.ops.aten.permute.default(permute_309, [1, 0]);  permute_309 = None
        mm_317 = torch.ops.aten.mm.default(mul_1495, permute_714);  mul_1495 = permute_714 = None
        convert_element_type_1913 = torch.ops.prims.convert_element_type.default(mm_316, torch.float32);  mm_316 = None
        reduce_scatter_tensor_87 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1913, 'avg', 64, '0');  convert_element_type_1913 = None
        wait_tensor_658 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_87);  reduce_scatter_tensor_87 = None
        convert_element_type_1914 = torch.ops.prims.convert_element_type.default(mul_1496, torch.float32);  mul_1496 = None
        reciprocal_12 = torch.ops.aten.reciprocal.default(add_1360);  add_1360 = None
        mul_1497 = torch.ops.aten.mul.Tensor(reciprocal_12, 1);  reciprocal_12 = None
        mul_1498 = torch.ops.aten.mul.Tensor(convert_element_type_1914, mul_1497);  convert_element_type_1914 = None
        sub_661 = torch.ops.aten.sub.Tensor(1, mul_1497);  mul_1497 = None
        mul_1499 = torch.ops.aten.mul.Tensor(convert_element_type_1107, sub_661);  convert_element_type_1107 = sub_661 = None
        add_1866 = torch.ops.aten.add.Tensor(mul_1499, 1);  mul_1499 = None
        mul_1500 = torch.ops.aten.mul.Tensor(mul_1498, add_1866);  mul_1498 = add_1866 = None
        convert_element_type_1916 = torch.ops.prims.convert_element_type.default(mul_1500, torch.bfloat16);  mul_1500 = None
        permute_716 = torch.ops.aten.permute.default(convert_element_type_1916, [1, 0])
        mm_318 = torch.ops.aten.mm.default(permute_716, view_1331);  permute_716 = None
        convert_element_type_1104 = torch.ops.prims.convert_element_type.default(primals_340, torch.bfloat16);  primals_340 = None
        all_gather_into_tensor_348 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1104, 64, '0');  convert_element_type_1104 = None
        wait_tensor_428 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_348);  all_gather_into_tensor_348 = None
        permute_308 = torch.ops.aten.permute.default(wait_tensor_428, [1, 0]);  wait_tensor_428 = None
        permute_718 = torch.ops.aten.permute.default(permute_308, [1, 0]);  permute_308 = None
        mm_319 = torch.ops.aten.mm.default(convert_element_type_1916, permute_718);  convert_element_type_1916 = permute_718 = None
        add_1867 = torch.ops.aten.add.Tensor(mm_317, mm_319);  mm_317 = mm_319 = None
        convert_element_type_1921 = torch.ops.prims.convert_element_type.default(mm_318, torch.float32);  mm_318 = None
        reduce_scatter_tensor_88 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1921, 'avg', 64, '0');  convert_element_type_1921 = None
        wait_tensor_659 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_88);  reduce_scatter_tensor_88 = None
        all_to_all_single_90 = torch.ops._c10d_functional.all_to_all_single.default(index_64, [_local_scalar_dense_312, _local_scalar_dense_313, _local_scalar_dense_314, _local_scalar_dense_315, _local_scalar_dense_316, _local_scalar_dense_317, _local_scalar_dense_318, _local_scalar_dense_319], [_local_scalar_dense_304, _local_scalar_dense_305, _local_scalar_dense_306, _local_scalar_dense_307, _local_scalar_dense_308, _local_scalar_dense_309, _local_scalar_dense_310, _local_scalar_dense_311], '521');  index_64 = None
        wait_tensor_660 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_90);  all_to_all_single_90 = None
        full_372 = torch.ops.aten.full.default([sym_size_int_77, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_77 = None
        slice_scatter_6 = torch.ops.aten.slice_scatter.default(full_372, wait_tensor_660, 0, 0, -1);  wait_tensor_660 = None
        index_65 = torch.ops.aten.index.Tensor(slice_scatter_6, [getitem_288]);  slice_scatter_6 = None
        permute_720 = torch.ops.aten.permute.default(index_65, [1, 0])
        _grouped_mm_114 = torch.ops.aten._grouped_mm.default(permute_720, mul_966, cumsum_59);  permute_720 = mul_966 = None
        convert_element_type_1098 = torch.ops.prims.convert_element_type.default(primals_338, torch.bfloat16);  primals_338 = None
        all_gather_into_tensor_344 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1098, 8, '513');  convert_element_type_1098 = None
        wait_tensor_423 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_344);  all_gather_into_tensor_344 = None
        permute_307 = torch.ops.aten.permute.default(wait_tensor_423, [0, 2, 1]);  wait_tensor_423 = None
        permute_722 = torch.ops.aten.permute.default(permute_307, [0, 2, 1]);  permute_307 = None
        _grouped_mm_115 = torch.ops.aten._grouped_mm.default(index_65, permute_722, cumsum_59);  index_65 = permute_722 = None
        convert_element_type_1102 = torch.ops.prims.convert_element_type.default(_grouped_mm_57, torch.float32);  _grouped_mm_57 = None
        neg_39 = torch.ops.aten.neg.default(convert_element_type_1102)
        exp_59 = torch.ops.aten.exp.default(neg_39);  neg_39 = None
        add_1324 = torch.ops.aten.add.Tensor(exp_59, 1);  exp_59 = None
        div_99 = torch.ops.aten.div.Tensor(convert_element_type_1102, add_1324)
        convert_element_type_1103 = torch.ops.prims.convert_element_type.default(div_99, torch.bfloat16);  div_99 = None
        mul_1501 = torch.ops.aten.mul.Tensor(_grouped_mm_115, convert_element_type_1103);  convert_element_type_1103 = None
        mul_1502 = torch.ops.aten.mul.Tensor(_grouped_mm_115, _grouped_mm_58);  _grouped_mm_115 = _grouped_mm_58 = None
        permute_724 = torch.ops.aten.permute.default(mul_1501, [1, 0])
        _grouped_mm_116 = torch.ops.aten._grouped_mm.default(permute_724, index_39, cumsum_59);  permute_724 = None
        convert_element_type_1099 = torch.ops.prims.convert_element_type.default(primals_339, torch.bfloat16);  primals_339 = None
        all_gather_into_tensor_345 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1099, 8, '513');  convert_element_type_1099 = None
        wait_tensor_424 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_345);  all_gather_into_tensor_345 = None
        permute_306 = torch.ops.aten.permute.default(wait_tensor_424, [0, 2, 1]);  wait_tensor_424 = None
        permute_726 = torch.ops.aten.permute.default(permute_306, [0, 2, 1]);  permute_306 = None
        _grouped_mm_117 = torch.ops.aten._grouped_mm.default(mul_1501, permute_726, cumsum_59);  mul_1501 = permute_726 = None
        convert_element_type_1922 = torch.ops.prims.convert_element_type.default(mul_1502, torch.float32);  mul_1502 = None
        reciprocal_13 = torch.ops.aten.reciprocal.default(add_1324);  add_1324 = None
        mul_1503 = torch.ops.aten.mul.Tensor(reciprocal_13, 1);  reciprocal_13 = None
        mul_1504 = torch.ops.aten.mul.Tensor(convert_element_type_1922, mul_1503);  convert_element_type_1922 = None
        sub_662 = torch.ops.aten.sub.Tensor(1, mul_1503);  mul_1503 = None
        mul_1505 = torch.ops.aten.mul.Tensor(convert_element_type_1102, sub_662);  convert_element_type_1102 = sub_662 = None
        add_1869 = torch.ops.aten.add.Tensor(mul_1505, 1);  mul_1505 = None
        mul_1506 = torch.ops.aten.mul.Tensor(mul_1504, add_1869);  mul_1504 = add_1869 = None
        convert_element_type_1924 = torch.ops.prims.convert_element_type.default(mul_1506, torch.bfloat16);  mul_1506 = None
        permute_728 = torch.ops.aten.permute.default(convert_element_type_1924, [1, 0])
        _grouped_mm_118 = torch.ops.aten._grouped_mm.default(permute_728, index_39, cumsum_59);  permute_728 = index_39 = None
        convert_element_type_1096 = torch.ops.prims.convert_element_type.default(primals_337, torch.bfloat16);  primals_337 = None
        all_gather_into_tensor_342 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1096, 8, '513');  convert_element_type_1096 = None
        wait_tensor_421 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_342);  all_gather_into_tensor_342 = None
        permute_305 = torch.ops.aten.permute.default(wait_tensor_421, [0, 2, 1]);  wait_tensor_421 = None
        permute_730 = torch.ops.aten.permute.default(permute_305, [0, 2, 1]);  permute_305 = None
        _grouped_mm_119 = torch.ops.aten._grouped_mm.default(convert_element_type_1924, permute_730, cumsum_59);  convert_element_type_1924 = permute_730 = cumsum_59 = None
        add_1870 = torch.ops.aten.add.Tensor(_grouped_mm_117, _grouped_mm_119);  _grouped_mm_117 = _grouped_mm_119 = None
        convert_element_type_1925 = torch.ops.prims.convert_element_type.default(_grouped_mm_116, torch.float32);  _grouped_mm_116 = None
        div_168 = torch.ops.aten.div.Tensor(convert_element_type_1925, 64);  convert_element_type_1925 = None
        reduce_scatter_tensor_89 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_168, 'sum', 8, '513');  div_168 = None
        wait_tensor_661 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_89);  reduce_scatter_tensor_89 = None
        convert_element_type_1926 = torch.ops.prims.convert_element_type.default(_grouped_mm_114, torch.float32);  _grouped_mm_114 = None
        div_169 = torch.ops.aten.div.Tensor(convert_element_type_1926, 64);  convert_element_type_1926 = None
        reduce_scatter_tensor_90 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_169, 'sum', 8, '513');  div_169 = None
        wait_tensor_662 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_90);  reduce_scatter_tensor_90 = None
        convert_element_type_1927 = torch.ops.prims.convert_element_type.default(_grouped_mm_118, torch.float32);  _grouped_mm_118 = None
        div_170 = torch.ops.aten.div.Tensor(convert_element_type_1927, 64);  convert_element_type_1927 = None
        reduce_scatter_tensor_91 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_170, 'sum', 8, '513');  div_170 = None
        wait_tensor_663 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_91);  reduce_scatter_tensor_91 = None
        index_put_64 = torch.ops.aten.index_put.default(full_372, [getitem_288], add_1870, True);  full_372 = getitem_288 = add_1870 = None
        slice_143 = torch.ops.aten.slice.Tensor(index_put_64, 0, 0, add_1871);  index_put_64 = add_1871 = None
        all_to_all_single_91 = torch.ops._c10d_functional.all_to_all_single.default(slice_143, [_local_scalar_dense_304, _local_scalar_dense_305, _local_scalar_dense_306, _local_scalar_dense_307, _local_scalar_dense_308, _local_scalar_dense_309, _local_scalar_dense_310, _local_scalar_dense_311], [_local_scalar_dense_312, _local_scalar_dense_313, _local_scalar_dense_314, _local_scalar_dense_315, _local_scalar_dense_316, _local_scalar_dense_317, _local_scalar_dense_318, _local_scalar_dense_319], '521');  slice_143 = _local_scalar_dense_304 = _local_scalar_dense_305 = _local_scalar_dense_306 = _local_scalar_dense_307 = _local_scalar_dense_308 = _local_scalar_dense_309 = _local_scalar_dense_310 = _local_scalar_dense_311 = _local_scalar_dense_312 = _local_scalar_dense_313 = _local_scalar_dense_314 = _local_scalar_dense_315 = _local_scalar_dense_316 = _local_scalar_dense_317 = _local_scalar_dense_318 = _local_scalar_dense_319 = None
        wait_tensor_664 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_91);  all_to_all_single_91 = None
        index_put_65 = torch.ops.aten.index_put.default(full_default_52, [div_97], wait_tensor_664, True);  div_97 = wait_tensor_664 = None
        add_1875 = torch.ops.aten.add.Tensor(add_1867, index_put_65);  add_1867 = index_put_65 = None
        mul_1507 = torch.ops.aten.mul.Tensor(view_1897, 1.0);  view_1897 = None
        scatter_add_6 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_285, mul_1507);  getitem_285 = mul_1507 = None
        convert_element_type_1091 = torch.ops.prims.convert_element_type.default(mm_163, torch.float32);  mm_163 = None
        sub_456 = torch.ops.aten.sub.Tensor(convert_element_type_1091, amax_19);  convert_element_type_1091 = amax_19 = None
        exp_58 = torch.ops.aten.exp.default(sub_456);  sub_456 = None
        div_96 = torch.ops.aten.div.Tensor(exp_58, sum_77);  exp_58 = sum_77 = None
        mul_1508 = torch.ops.aten.mul.Tensor(scatter_add_6, div_96);  scatter_add_6 = None
        sum_155 = torch.ops.aten.sum.dim_IntList(mul_1508, [1], True)
        neg_73 = torch.ops.aten.neg.default(div_96);  div_96 = None
        fma_6 = torch.ops.prims.fma.default(neg_73, sum_155, mul_1508);  neg_73 = sum_155 = mul_1508 = None
        convert_element_type_1928 = torch.ops.prims.convert_element_type.default(fma_6, torch.bfloat16);  fma_6 = None
        permute_732 = torch.ops.aten.permute.default(convert_element_type_1928, [1, 0])
        mm_320 = torch.ops.aten.mm.default(permute_732, view_1331);  permute_732 = view_1331 = None
        convert_element_type_1088 = torch.ops.prims.convert_element_type.default(primals_335, torch.bfloat16);  primals_335 = None
        all_gather_into_tensor_341 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1088, 64, '0');  convert_element_type_1088 = None
        wait_tensor_417 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_341);  all_gather_into_tensor_341 = None
        permute_304 = torch.ops.aten.permute.default(wait_tensor_417, [1, 0]);  wait_tensor_417 = None
        permute_734 = torch.ops.aten.permute.default(permute_304, [1, 0]);  permute_304 = None
        mm_321 = torch.ops.aten.mm.default(convert_element_type_1928, permute_734);  convert_element_type_1928 = permute_734 = None
        add_1876 = torch.ops.aten.add.Tensor(add_1875, mm_321);  add_1875 = mm_321 = None
        convert_element_type_1933 = torch.ops.prims.convert_element_type.default(mm_320, torch.float32);  mm_320 = None
        reduce_scatter_tensor_92 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1933, 'avg', 64, '0');  convert_element_type_1933 = None
        wait_tensor_665 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_92);  reduce_scatter_tensor_92 = None
        view_1899 = torch.ops.aten.view.default(add_1876, [2, 4096, 2048]);  add_1876 = None
        convert_element_type_1934 = torch.ops.prims.convert_element_type.default(view_1899, torch.float32);  view_1899 = None
        convert_element_type_1085 = torch.ops.prims.convert_element_type.default(primals_333, torch.bfloat16);  primals_333 = None
        all_gather_into_tensor_340 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1085, 64, '0');  convert_element_type_1085 = None
        wait_tensor_416 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_340);  all_gather_into_tensor_340 = None
        convert_element_type_1936 = torch.ops.prims.convert_element_type.default(wait_tensor_416, torch.float32);  wait_tensor_416 = None
        mul_1509 = torch.ops.aten.mul.Tensor(convert_element_type_1934, convert_element_type_1936);  convert_element_type_1936 = None
        convert_element_type_1086 = torch.ops.prims.convert_element_type.default(add_1300, torch.float32);  add_1300 = None
        mul_946 = torch.ops.aten.mul.Tensor(convert_element_type_1086, rsqrt_62);  convert_element_type_1086 = None
        mul_1511 = torch.ops.aten.mul.Tensor(mul_946, mul_1509)
        sum_156 = torch.ops.aten.sum.dim_IntList(mul_1511, [2], True);  mul_1511 = None
        div_171 = torch.ops.aten.div.Tensor(mul_946, 2048)
        mul_1512 = torch.ops.aten.mul.Tensor(div_171, sum_156);  div_171 = sum_156 = None
        sub_664 = torch.ops.aten.sub.Tensor(mul_1509, mul_1512);  mul_1509 = mul_1512 = None
        mul_1513 = torch.ops.aten.mul.Tensor(sub_664, rsqrt_62);  sub_664 = rsqrt_62 = None
        mul_1514 = torch.ops.aten.mul.Tensor(convert_element_type_1934, mul_946);  convert_element_type_1934 = mul_946 = None
        sum_157 = torch.ops.aten.sum.dim_IntList(mul_1514, [0, 1]);  mul_1514 = None
        convert_element_type_1937 = torch.ops.prims.convert_element_type.default(mul_1513, torch.bfloat16);  mul_1513 = None
        add_1877 = torch.ops.aten.add.Tensor(add_1864, convert_element_type_1937);  add_1864 = convert_element_type_1937 = None
        convert_element_type_default_63 = torch.ops.prims.convert_element_type.default(sum_157, torch.float32);  sum_157 = None
        reduce_scatter_tensor_93 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_63, 'avg', 64, '0');  convert_element_type_default_63 = None
        wait_tensor_666 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_93);  reduce_scatter_tensor_93 = None
        view_1900 = torch.ops.aten.view.default(add_1877, [8192, 2048])
        permute_736 = torch.ops.aten.permute.default(view_1900, [1, 0])
        permute_302 = torch.ops.aten.permute.default(getitem_281, [0, 2, 1, 3])
        view_1326 = torch.ops.aten.view.default(permute_302, [2, 4096, -1]);  permute_302 = None
        view_1328 = torch.ops.aten.view.default(view_1326, [8192, 2048]);  view_1326 = None
        mm_322 = torch.ops.aten.mm.default(permute_736, view_1328);  permute_736 = view_1328 = None
        convert_element_type_1082 = torch.ops.prims.convert_element_type.default(primals_332, torch.bfloat16);  primals_332 = None
        all_gather_into_tensor_339 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1082, 64, '0');  convert_element_type_1082 = None
        wait_tensor_415 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_339);  all_gather_into_tensor_339 = None
        permute_303 = torch.ops.aten.permute.default(wait_tensor_415, [1, 0]);  wait_tensor_415 = None
        permute_738 = torch.ops.aten.permute.default(permute_303, [1, 0]);  permute_303 = None
        mm_323 = torch.ops.aten.mm.default(view_1900, permute_738);  view_1900 = permute_738 = None
        view_1901 = torch.ops.aten.view.default(mm_323, [2, 4096, 2048]);  mm_323 = None
        convert_element_type_1944 = torch.ops.prims.convert_element_type.default(mm_322, torch.float32);  mm_322 = None
        reduce_scatter_tensor_94 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1944, 'avg', 64, '0');  convert_element_type_1944 = None
        wait_tensor_667 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_94);  reduce_scatter_tensor_94 = None
        view_1902 = torch.ops.aten.view.default(view_1901, [2, 4096, 16, 128]);  view_1901 = None
        permute_740 = torch.ops.aten.permute.default(view_1902, [0, 2, 1, 3]);  view_1902 = None
        fw_graph6 = self.fw_graph6
        joint_graph6 = self.joint_graph6
        mask_graph6 = self.mask_graph6
        flex_attention_backward_6 = torch.ops.higher_order.flex_attention_backward(permute_299, permute_300, permute_301, getitem_281, getitem_282, permute_740, None, fw_graph6, joint_graph6, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph6), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_299 = permute_300 = permute_301 = getitem_281 = getitem_282 = permute_740 = fw_graph6 = joint_graph6 = mask_graph6 = None
        getitem_397 = flex_attention_backward_6[0]
        getitem_398 = flex_attention_backward_6[1]
        getitem_399 = flex_attention_backward_6[2];  flex_attention_backward_6 = None
        permute_741 = torch.ops.aten.permute.default(getitem_399, [0, 2, 1, 3]);  getitem_399 = None
        permute_742 = torch.ops.aten.permute.default(getitem_398, [0, 2, 1, 3]);  getitem_398 = None
        permute_743 = torch.ops.aten.permute.default(getitem_397, [0, 2, 1, 3]);  getitem_397 = None
        slice_145 = torch.ops.aten.slice.Tensor(permute_742, 3, 0, 128)
        slice_146 = torch.ops.aten.slice.Tensor(permute_742, 3, 128, 192);  permute_742 = None
        sum_158 = torch.ops.aten.sum.dim_IntList(slice_146, [2], True);  slice_146 = None
        cat_98 = torch.ops.aten.cat.default([slice_145, permute_741], 3);  slice_145 = permute_741 = None
        view_1903 = torch.ops.aten.view.default(cat_98, [2, 4096, 4096]);  cat_98 = None
        view_1904 = torch.ops.aten.view.default(view_1903, [8192, 4096]);  view_1903 = None
        permute_744 = torch.ops.aten.permute.default(view_1904, [1, 0])
        mm_324 = torch.ops.aten.mm.default(permute_744, view_1323);  permute_744 = view_1323 = None
        convert_element_type_1079 = torch.ops.prims.convert_element_type.default(primals_331, torch.bfloat16);  primals_331 = None
        all_gather_into_tensor_338 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1079, 64, '0');  convert_element_type_1079 = None
        wait_tensor_414 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_338);  all_gather_into_tensor_338 = None
        permute_298 = torch.ops.aten.permute.default(wait_tensor_414, [1, 0]);  wait_tensor_414 = None
        permute_746 = torch.ops.aten.permute.default(permute_298, [1, 0]);  permute_298 = None
        mm_325 = torch.ops.aten.mm.default(view_1904, permute_746);  view_1904 = permute_746 = None
        view_1905 = torch.ops.aten.view.default(mm_325, [2, 4096, 512]);  mm_325 = None
        convert_element_type_1949 = torch.ops.prims.convert_element_type.default(mm_324, torch.float32);  mm_324 = None
        reduce_scatter_tensor_95 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1949, 'avg', 64, '0');  convert_element_type_1949 = None
        wait_tensor_668 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_95);  reduce_scatter_tensor_95 = None
        convert_element_type_1950 = torch.ops.prims.convert_element_type.default(view_1905, torch.float32);  view_1905 = None
        convert_element_type_1076 = torch.ops.prims.convert_element_type.default(primals_330, torch.bfloat16);  primals_330 = None
        all_gather_into_tensor_337 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1076, 64, '0');  convert_element_type_1076 = None
        wait_tensor_413 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_337);  all_gather_into_tensor_337 = None
        convert_element_type_1952 = torch.ops.prims.convert_element_type.default(wait_tensor_413, torch.float32);  wait_tensor_413 = None
        mul_1515 = torch.ops.aten.mul.Tensor(convert_element_type_1950, convert_element_type_1952);  convert_element_type_1952 = None
        convert_element_type_1077 = torch.ops.prims.convert_element_type.default(getitem_277, torch.float32);  getitem_277 = None
        mul_944 = torch.ops.aten.mul.Tensor(convert_element_type_1077, rsqrt_61);  convert_element_type_1077 = None
        mul_1517 = torch.ops.aten.mul.Tensor(mul_944, mul_1515)
        sum_159 = torch.ops.aten.sum.dim_IntList(mul_1517, [2], True);  mul_1517 = None
        div_172 = torch.ops.aten.div.Tensor(mul_944, 512)
        mul_1518 = torch.ops.aten.mul.Tensor(div_172, sum_159);  div_172 = sum_159 = None
        sub_665 = torch.ops.aten.sub.Tensor(mul_1515, mul_1518);  mul_1515 = mul_1518 = None
        mul_1519 = torch.ops.aten.mul.Tensor(sub_665, rsqrt_61);  sub_665 = rsqrt_61 = None
        mul_1520 = torch.ops.aten.mul.Tensor(convert_element_type_1950, mul_944);  convert_element_type_1950 = mul_944 = None
        sum_160 = torch.ops.aten.sum.dim_IntList(mul_1520, [0, 1]);  mul_1520 = None
        convert_element_type_1953 = torch.ops.prims.convert_element_type.default(mul_1519, torch.bfloat16);  mul_1519 = None
        convert_element_type_default_62 = torch.ops.prims.convert_element_type.default(sum_160, torch.float32);  sum_160 = None
        reduce_scatter_tensor_96 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_62, 'avg', 64, '0');  convert_element_type_default_62 = None
        wait_tensor_669 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_96);  reduce_scatter_tensor_96 = None
        convert_element_type_1956 = torch.ops.prims.convert_element_type.default(sum_158, torch.float32);  sum_158 = None
        view_1906 = torch.ops.aten.view.default(convert_element_type_1956, [2, 4096, 1, 32, 2]);  convert_element_type_1956 = None
        view_as_complex_66 = torch.ops.aten.view_as_complex.default(view_1906);  view_1906 = None
        mul_1521 = torch.ops.aten.mul.Tensor(view_as_complex_66, clone_9);  view_as_complex_66 = None
        view_as_real_66 = torch.ops.aten.view_as_real.default(mul_1521);  mul_1521 = None
        view_1907 = torch.ops.aten.view.default(view_as_real_66, [2, 4096, 1, 64]);  view_as_real_66 = None
        convert_element_type_1957 = torch.ops.prims.convert_element_type.default(view_1907, torch.bfloat16);  view_1907 = None
        squeeze_32 = torch.ops.aten.squeeze.dim(convert_element_type_1957, 2);  convert_element_type_1957 = None
        cat_99 = torch.ops.aten.cat.default([convert_element_type_1953, squeeze_32], 2);  convert_element_type_1953 = squeeze_32 = None
        view_1908 = torch.ops.aten.view.default(cat_99, [8192, 576]);  cat_99 = None
        permute_748 = torch.ops.aten.permute.default(view_1908, [1, 0])
        mm_326 = torch.ops.aten.mm.default(permute_748, view_1309);  permute_748 = None
        convert_element_type_1071 = torch.ops.prims.convert_element_type.default(primals_329, torch.bfloat16);  primals_329 = None
        all_gather_into_tensor_336 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1071, 64, '0');  convert_element_type_1071 = None
        wait_tensor_412 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_336);  all_gather_into_tensor_336 = None
        permute_297 = torch.ops.aten.permute.default(wait_tensor_412, [1, 0]);  wait_tensor_412 = None
        permute_750 = torch.ops.aten.permute.default(permute_297, [1, 0]);  permute_297 = None
        mm_327 = torch.ops.aten.mm.default(view_1908, permute_750);  view_1908 = permute_750 = None
        view_1909 = torch.ops.aten.view.default(mm_327, [2, 4096, 2048]);  mm_327 = None
        convert_element_type_1962 = torch.ops.prims.convert_element_type.default(mm_326, torch.float32);  mm_326 = None
        reduce_scatter_tensor_97 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1962, 'avg', 64, '0');  convert_element_type_1962 = None
        wait_tensor_670 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_97);  reduce_scatter_tensor_97 = None
        slice_147 = torch.ops.aten.slice.Tensor(permute_743, 3, 0, 128)
        slice_148 = torch.ops.aten.slice.Tensor(permute_743, 3, 128, 192);  permute_743 = None
        convert_element_type_1963 = torch.ops.prims.convert_element_type.default(slice_148, torch.float32);  slice_148 = None
        view_1910 = torch.ops.aten.view.default(convert_element_type_1963, [2, 4096, 16, 32, 2]);  convert_element_type_1963 = None
        view_as_complex_67 = torch.ops.aten.view_as_complex.default(view_1910);  view_1910 = None
        mul_1522 = torch.ops.aten.mul.Tensor(view_as_complex_67, clone_9);  view_as_complex_67 = None
        view_as_real_67 = torch.ops.aten.view_as_real.default(mul_1522);  mul_1522 = None
        view_1911 = torch.ops.aten.view.default(view_as_real_67, [2, 4096, 16, 64]);  view_as_real_67 = None
        convert_element_type_1964 = torch.ops.prims.convert_element_type.default(view_1911, torch.bfloat16);  view_1911 = None
        cat_100 = torch.ops.aten.cat.default([slice_147, convert_element_type_1964], 3);  slice_147 = convert_element_type_1964 = None
        view_1912 = torch.ops.aten.view.default(cat_100, [2, 4096, 3072]);  cat_100 = None
        view_1913 = torch.ops.aten.view.default(view_1912, [8192, 3072]);  view_1912 = None
        permute_752 = torch.ops.aten.permute.default(view_1913, [1, 0])
        mm_328 = torch.ops.aten.mm.default(permute_752, view_1309);  permute_752 = view_1309 = None
        convert_element_type_1066 = torch.ops.prims.convert_element_type.default(primals_328, torch.bfloat16);  primals_328 = None
        all_gather_into_tensor_335 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1066, 64, '0');  convert_element_type_1066 = None
        wait_tensor_411 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_335);  all_gather_into_tensor_335 = None
        permute_296 = torch.ops.aten.permute.default(wait_tensor_411, [1, 0]);  wait_tensor_411 = None
        permute_754 = torch.ops.aten.permute.default(permute_296, [1, 0]);  permute_296 = None
        mm_329 = torch.ops.aten.mm.default(view_1913, permute_754);  view_1913 = permute_754 = None
        view_1914 = torch.ops.aten.view.default(mm_329, [2, 4096, 2048]);  mm_329 = None
        add_1878 = torch.ops.aten.add.Tensor(view_1909, view_1914);  view_1909 = view_1914 = None
        convert_element_type_1969 = torch.ops.prims.convert_element_type.default(mm_328, torch.float32);  mm_328 = None
        reduce_scatter_tensor_98 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1969, 'avg', 64, '0');  convert_element_type_1969 = None
        wait_tensor_671 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_98);  reduce_scatter_tensor_98 = None
        convert_element_type_1970 = torch.ops.prims.convert_element_type.default(add_1878, torch.float32);  add_1878 = None
        convert_element_type_1063 = torch.ops.prims.convert_element_type.default(primals_327, torch.bfloat16);  primals_327 = None
        all_gather_into_tensor_334 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1063, 64, '0');  convert_element_type_1063 = None
        wait_tensor_410 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_334);  all_gather_into_tensor_334 = None
        convert_element_type_1972 = torch.ops.prims.convert_element_type.default(wait_tensor_410, torch.float32);  wait_tensor_410 = None
        mul_1523 = torch.ops.aten.mul.Tensor(convert_element_type_1970, convert_element_type_1972);  convert_element_type_1972 = None
        convert_element_type_1064 = torch.ops.prims.convert_element_type.default(add_1297, torch.float32);  add_1297 = None
        mul_940 = torch.ops.aten.mul.Tensor(convert_element_type_1064, rsqrt_60);  convert_element_type_1064 = None
        mul_1525 = torch.ops.aten.mul.Tensor(mul_940, mul_1523)
        sum_161 = torch.ops.aten.sum.dim_IntList(mul_1525, [2], True);  mul_1525 = None
        div_173 = torch.ops.aten.div.Tensor(mul_940, 2048)
        mul_1526 = torch.ops.aten.mul.Tensor(div_173, sum_161);  div_173 = sum_161 = None
        sub_666 = torch.ops.aten.sub.Tensor(mul_1523, mul_1526);  mul_1523 = mul_1526 = None
        mul_1527 = torch.ops.aten.mul.Tensor(sub_666, rsqrt_60);  sub_666 = rsqrt_60 = None
        mul_1528 = torch.ops.aten.mul.Tensor(convert_element_type_1970, mul_940);  convert_element_type_1970 = mul_940 = None
        sum_162 = torch.ops.aten.sum.dim_IntList(mul_1528, [0, 1]);  mul_1528 = None
        convert_element_type_1973 = torch.ops.prims.convert_element_type.default(mul_1527, torch.bfloat16);  mul_1527 = None
        add_1879 = torch.ops.aten.add.Tensor(add_1877, convert_element_type_1973);  add_1877 = convert_element_type_1973 = None
        convert_element_type_default_61 = torch.ops.prims.convert_element_type.default(sum_162, torch.float32);  sum_162 = None
        reduce_scatter_tensor_99 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_61, 'avg', 64, '0');  convert_element_type_default_61 = None
        wait_tensor_672 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_99);  reduce_scatter_tensor_99 = None
        view_1915 = torch.ops.aten.view.default(add_1879, [8192, 2048])
        unsqueeze_60 = torch.ops.aten.unsqueeze.default(view_1915, 1)
        convert_element_type_1976 = torch.ops.prims.convert_element_type.default(unsqueeze_60, torch.float32);  unsqueeze_60 = None
        bmm_40 = torch.ops.aten.bmm.default(permute_756, convert_element_type_1976);  permute_756 = None
        bmm_41 = torch.ops.aten.bmm.default(convert_element_type_1976, permute_757);  convert_element_type_1976 = permute_757 = None
        convert_element_type_1977 = torch.ops.prims.convert_element_type.default(bmm_40, torch.bfloat16);  bmm_40 = None
        view_1916 = torch.ops.aten.view.default(bmm_41, [8192, 6]);  bmm_41 = None
        view_1917 = torch.ops.aten.view.default(convert_element_type_1977, [49152, 2048]);  convert_element_type_1977 = None
        index_66 = torch.ops.aten.index.Tensor(view_1917, [getitem_273]);  view_1917 = getitem_273 = None
        permute_758 = torch.ops.aten.permute.default(view_1915, [1, 0])
        mm_330 = torch.ops.aten.mm.default(permute_758, mul_937);  permute_758 = mul_937 = None
        convert_element_type_1058 = torch.ops.prims.convert_element_type.default(primals_326, torch.bfloat16);  primals_326 = None
        all_gather_into_tensor_333 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1058, 64, '0');  convert_element_type_1058 = None
        wait_tensor_409 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_333);  all_gather_into_tensor_333 = None
        permute_295 = torch.ops.aten.permute.default(wait_tensor_409, [1, 0]);  wait_tensor_409 = None
        permute_760 = torch.ops.aten.permute.default(permute_295, [1, 0]);  permute_295 = None
        mm_331 = torch.ops.aten.mm.default(view_1915, permute_760);  view_1915 = permute_760 = None
        convert_element_type_1982 = torch.ops.prims.convert_element_type.default(mm_330, torch.float32);  mm_330 = None
        reduce_scatter_tensor_100 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1982, 'avg', 64, '0');  convert_element_type_1982 = None
        wait_tensor_673 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_100);  reduce_scatter_tensor_100 = None
        convert_element_type_1053 = torch.ops.prims.convert_element_type.default(mm_156, torch.float32);  mm_156 = None
        neg_38 = torch.ops.aten.neg.default(convert_element_type_1053)
        exp_57 = torch.ops.aten.exp.default(neg_38);  neg_38 = None
        add_1292 = torch.ops.aten.add.Tensor(exp_57, 1);  exp_57 = None
        div_95 = torch.ops.aten.div.Tensor(convert_element_type_1053, add_1292)
        convert_element_type_1054 = torch.ops.prims.convert_element_type.default(div_95, torch.bfloat16);  div_95 = None
        mul_1529 = torch.ops.aten.mul.Tensor(mm_331, convert_element_type_1054);  convert_element_type_1054 = None
        mul_1530 = torch.ops.aten.mul.Tensor(mm_331, mm_157);  mm_331 = mm_157 = None
        permute_762 = torch.ops.aten.permute.default(mul_1529, [1, 0])
        mm_332 = torch.ops.aten.mm.default(permute_762, view_1264);  permute_762 = None
        convert_element_type_1055 = torch.ops.prims.convert_element_type.default(primals_325, torch.bfloat16);  primals_325 = None
        all_gather_into_tensor_332 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1055, 64, '0');  convert_element_type_1055 = None
        wait_tensor_408 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_332);  all_gather_into_tensor_332 = None
        permute_294 = torch.ops.aten.permute.default(wait_tensor_408, [1, 0]);  wait_tensor_408 = None
        permute_764 = torch.ops.aten.permute.default(permute_294, [1, 0]);  permute_294 = None
        mm_333 = torch.ops.aten.mm.default(mul_1529, permute_764);  mul_1529 = permute_764 = None
        convert_element_type_1987 = torch.ops.prims.convert_element_type.default(mm_332, torch.float32);  mm_332 = None
        reduce_scatter_tensor_101 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1987, 'avg', 64, '0');  convert_element_type_1987 = None
        wait_tensor_674 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_101);  reduce_scatter_tensor_101 = None
        convert_element_type_1988 = torch.ops.prims.convert_element_type.default(mul_1530, torch.float32);  mul_1530 = None
        reciprocal_14 = torch.ops.aten.reciprocal.default(add_1292);  add_1292 = None
        mul_1531 = torch.ops.aten.mul.Tensor(reciprocal_14, 1);  reciprocal_14 = None
        mul_1532 = torch.ops.aten.mul.Tensor(convert_element_type_1988, mul_1531);  convert_element_type_1988 = None
        sub_667 = torch.ops.aten.sub.Tensor(1, mul_1531);  mul_1531 = None
        mul_1533 = torch.ops.aten.mul.Tensor(convert_element_type_1053, sub_667);  convert_element_type_1053 = sub_667 = None
        add_1881 = torch.ops.aten.add.Tensor(mul_1533, 1);  mul_1533 = None
        mul_1534 = torch.ops.aten.mul.Tensor(mul_1532, add_1881);  mul_1532 = add_1881 = None
        convert_element_type_1990 = torch.ops.prims.convert_element_type.default(mul_1534, torch.bfloat16);  mul_1534 = None
        permute_766 = torch.ops.aten.permute.default(convert_element_type_1990, [1, 0])
        mm_334 = torch.ops.aten.mm.default(permute_766, view_1264);  permute_766 = None
        convert_element_type_1050 = torch.ops.prims.convert_element_type.default(primals_324, torch.bfloat16);  primals_324 = None
        all_gather_into_tensor_331 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1050, 64, '0');  convert_element_type_1050 = None
        wait_tensor_407 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_331);  all_gather_into_tensor_331 = None
        permute_293 = torch.ops.aten.permute.default(wait_tensor_407, [1, 0]);  wait_tensor_407 = None
        permute_768 = torch.ops.aten.permute.default(permute_293, [1, 0]);  permute_293 = None
        mm_335 = torch.ops.aten.mm.default(convert_element_type_1990, permute_768);  convert_element_type_1990 = permute_768 = None
        add_1882 = torch.ops.aten.add.Tensor(mm_333, mm_335);  mm_333 = mm_335 = None
        convert_element_type_1995 = torch.ops.prims.convert_element_type.default(mm_334, torch.float32);  mm_334 = None
        reduce_scatter_tensor_102 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_1995, 'avg', 64, '0');  convert_element_type_1995 = None
        wait_tensor_675 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_102);  reduce_scatter_tensor_102 = None
        all_to_all_single_92 = torch.ops._c10d_functional.all_to_all_single.default(index_66, [_local_scalar_dense_296, _local_scalar_dense_297, _local_scalar_dense_298, _local_scalar_dense_299, _local_scalar_dense_300, _local_scalar_dense_301, _local_scalar_dense_302, _local_scalar_dense_303], [_local_scalar_dense_288, _local_scalar_dense_289, _local_scalar_dense_290, _local_scalar_dense_291, _local_scalar_dense_292, _local_scalar_dense_293, _local_scalar_dense_294, _local_scalar_dense_295], '521');  index_66 = None
        wait_tensor_676 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_92);  all_to_all_single_92 = None
        full_376 = torch.ops.aten.full.default([sym_size_int_73, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_73 = None
        slice_scatter_7 = torch.ops.aten.slice_scatter.default(full_376, wait_tensor_676, 0, 0, -1);  wait_tensor_676 = None
        index_67 = torch.ops.aten.index.Tensor(slice_scatter_7, [getitem_274]);  slice_scatter_7 = None
        permute_770 = torch.ops.aten.permute.default(index_67, [1, 0])
        _grouped_mm_120 = torch.ops.aten._grouped_mm.default(permute_770, mul_917, cumsum_56);  permute_770 = mul_917 = None
        convert_element_type_1044 = torch.ops.prims.convert_element_type.default(primals_322, torch.bfloat16);  primals_322 = None
        all_gather_into_tensor_327 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1044, 8, '513');  convert_element_type_1044 = None
        wait_tensor_402 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_327);  all_gather_into_tensor_327 = None
        permute_292 = torch.ops.aten.permute.default(wait_tensor_402, [0, 2, 1]);  wait_tensor_402 = None
        permute_772 = torch.ops.aten.permute.default(permute_292, [0, 2, 1]);  permute_292 = None
        _grouped_mm_121 = torch.ops.aten._grouped_mm.default(index_67, permute_772, cumsum_56);  index_67 = permute_772 = None
        convert_element_type_1048 = torch.ops.prims.convert_element_type.default(_grouped_mm_54, torch.float32);  _grouped_mm_54 = None
        neg_37 = torch.ops.aten.neg.default(convert_element_type_1048)
        exp_56 = torch.ops.aten.exp.default(neg_37);  neg_37 = None
        add_1256 = torch.ops.aten.add.Tensor(exp_56, 1);  exp_56 = None
        div_94 = torch.ops.aten.div.Tensor(convert_element_type_1048, add_1256)
        convert_element_type_1049 = torch.ops.prims.convert_element_type.default(div_94, torch.bfloat16);  div_94 = None
        mul_1535 = torch.ops.aten.mul.Tensor(_grouped_mm_121, convert_element_type_1049);  convert_element_type_1049 = None
        mul_1536 = torch.ops.aten.mul.Tensor(_grouped_mm_121, _grouped_mm_55);  _grouped_mm_121 = _grouped_mm_55 = None
        permute_774 = torch.ops.aten.permute.default(mul_1535, [1, 0])
        _grouped_mm_122 = torch.ops.aten._grouped_mm.default(permute_774, index_37, cumsum_56);  permute_774 = None
        convert_element_type_1045 = torch.ops.prims.convert_element_type.default(primals_323, torch.bfloat16);  primals_323 = None
        all_gather_into_tensor_328 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1045, 8, '513');  convert_element_type_1045 = None
        wait_tensor_403 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_328);  all_gather_into_tensor_328 = None
        permute_291 = torch.ops.aten.permute.default(wait_tensor_403, [0, 2, 1]);  wait_tensor_403 = None
        permute_776 = torch.ops.aten.permute.default(permute_291, [0, 2, 1]);  permute_291 = None
        _grouped_mm_123 = torch.ops.aten._grouped_mm.default(mul_1535, permute_776, cumsum_56);  mul_1535 = permute_776 = None
        convert_element_type_1996 = torch.ops.prims.convert_element_type.default(mul_1536, torch.float32);  mul_1536 = None
        reciprocal_15 = torch.ops.aten.reciprocal.default(add_1256);  add_1256 = None
        mul_1537 = torch.ops.aten.mul.Tensor(reciprocal_15, 1);  reciprocal_15 = None
        mul_1538 = torch.ops.aten.mul.Tensor(convert_element_type_1996, mul_1537);  convert_element_type_1996 = None
        sub_668 = torch.ops.aten.sub.Tensor(1, mul_1537);  mul_1537 = None
        mul_1539 = torch.ops.aten.mul.Tensor(convert_element_type_1048, sub_668);  convert_element_type_1048 = sub_668 = None
        add_1884 = torch.ops.aten.add.Tensor(mul_1539, 1);  mul_1539 = None
        mul_1540 = torch.ops.aten.mul.Tensor(mul_1538, add_1884);  mul_1538 = add_1884 = None
        convert_element_type_1998 = torch.ops.prims.convert_element_type.default(mul_1540, torch.bfloat16);  mul_1540 = None
        permute_778 = torch.ops.aten.permute.default(convert_element_type_1998, [1, 0])
        _grouped_mm_124 = torch.ops.aten._grouped_mm.default(permute_778, index_37, cumsum_56);  permute_778 = index_37 = None
        convert_element_type_1042 = torch.ops.prims.convert_element_type.default(primals_321, torch.bfloat16);  primals_321 = None
        all_gather_into_tensor_325 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1042, 8, '513');  convert_element_type_1042 = None
        wait_tensor_400 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_325);  all_gather_into_tensor_325 = None
        permute_290 = torch.ops.aten.permute.default(wait_tensor_400, [0, 2, 1]);  wait_tensor_400 = None
        permute_780 = torch.ops.aten.permute.default(permute_290, [0, 2, 1]);  permute_290 = None
        _grouped_mm_125 = torch.ops.aten._grouped_mm.default(convert_element_type_1998, permute_780, cumsum_56);  convert_element_type_1998 = permute_780 = cumsum_56 = None
        add_1885 = torch.ops.aten.add.Tensor(_grouped_mm_123, _grouped_mm_125);  _grouped_mm_123 = _grouped_mm_125 = None
        convert_element_type_1999 = torch.ops.prims.convert_element_type.default(_grouped_mm_122, torch.float32);  _grouped_mm_122 = None
        div_174 = torch.ops.aten.div.Tensor(convert_element_type_1999, 64);  convert_element_type_1999 = None
        reduce_scatter_tensor_103 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_174, 'sum', 8, '513');  div_174 = None
        wait_tensor_677 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_103);  reduce_scatter_tensor_103 = None
        convert_element_type_2000 = torch.ops.prims.convert_element_type.default(_grouped_mm_120, torch.float32);  _grouped_mm_120 = None
        div_175 = torch.ops.aten.div.Tensor(convert_element_type_2000, 64);  convert_element_type_2000 = None
        reduce_scatter_tensor_104 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_175, 'sum', 8, '513');  div_175 = None
        wait_tensor_678 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_104);  reduce_scatter_tensor_104 = None
        convert_element_type_2001 = torch.ops.prims.convert_element_type.default(_grouped_mm_124, torch.float32);  _grouped_mm_124 = None
        div_176 = torch.ops.aten.div.Tensor(convert_element_type_2001, 64);  convert_element_type_2001 = None
        reduce_scatter_tensor_105 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_176, 'sum', 8, '513');  div_176 = None
        wait_tensor_679 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_105);  reduce_scatter_tensor_105 = None
        index_put_66 = torch.ops.aten.index_put.default(full_376, [getitem_274], add_1885, True);  full_376 = getitem_274 = add_1885 = None
        slice_149 = torch.ops.aten.slice.Tensor(index_put_66, 0, 0, add_1886);  index_put_66 = add_1886 = None
        all_to_all_single_93 = torch.ops._c10d_functional.all_to_all_single.default(slice_149, [_local_scalar_dense_288, _local_scalar_dense_289, _local_scalar_dense_290, _local_scalar_dense_291, _local_scalar_dense_292, _local_scalar_dense_293, _local_scalar_dense_294, _local_scalar_dense_295], [_local_scalar_dense_296, _local_scalar_dense_297, _local_scalar_dense_298, _local_scalar_dense_299, _local_scalar_dense_300, _local_scalar_dense_301, _local_scalar_dense_302, _local_scalar_dense_303], '521');  slice_149 = _local_scalar_dense_288 = _local_scalar_dense_289 = _local_scalar_dense_290 = _local_scalar_dense_291 = _local_scalar_dense_292 = _local_scalar_dense_293 = _local_scalar_dense_294 = _local_scalar_dense_295 = _local_scalar_dense_296 = _local_scalar_dense_297 = _local_scalar_dense_298 = _local_scalar_dense_299 = _local_scalar_dense_300 = _local_scalar_dense_301 = _local_scalar_dense_302 = _local_scalar_dense_303 = None
        wait_tensor_680 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_93);  all_to_all_single_93 = None
        index_put_67 = torch.ops.aten.index_put.default(full_default_52, [div_92], wait_tensor_680, True);  div_92 = wait_tensor_680 = None
        add_1890 = torch.ops.aten.add.Tensor(add_1882, index_put_67);  add_1882 = index_put_67 = None
        mul_1541 = torch.ops.aten.mul.Tensor(view_1916, 1.0);  view_1916 = None
        scatter_add_7 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_271, mul_1541);  getitem_271 = mul_1541 = None
        convert_element_type_1037 = torch.ops.prims.convert_element_type.default(mm_155, torch.float32);  mm_155 = None
        sub_432 = torch.ops.aten.sub.Tensor(convert_element_type_1037, amax_18);  convert_element_type_1037 = amax_18 = None
        exp_55 = torch.ops.aten.exp.default(sub_432);  sub_432 = None
        div_91 = torch.ops.aten.div.Tensor(exp_55, sum_73);  exp_55 = sum_73 = None
        mul_1542 = torch.ops.aten.mul.Tensor(scatter_add_7, div_91);  scatter_add_7 = None
        sum_163 = torch.ops.aten.sum.dim_IntList(mul_1542, [1], True)
        neg_76 = torch.ops.aten.neg.default(div_91);  div_91 = None
        fma_7 = torch.ops.prims.fma.default(neg_76, sum_163, mul_1542);  neg_76 = sum_163 = mul_1542 = None
        convert_element_type_2002 = torch.ops.prims.convert_element_type.default(fma_7, torch.bfloat16);  fma_7 = None
        permute_782 = torch.ops.aten.permute.default(convert_element_type_2002, [1, 0])
        mm_336 = torch.ops.aten.mm.default(permute_782, view_1264);  permute_782 = view_1264 = None
        convert_element_type_1034 = torch.ops.prims.convert_element_type.default(primals_319, torch.bfloat16);  primals_319 = None
        all_gather_into_tensor_324 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1034, 64, '0');  convert_element_type_1034 = None
        wait_tensor_396 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_324);  all_gather_into_tensor_324 = None
        permute_289 = torch.ops.aten.permute.default(wait_tensor_396, [1, 0]);  wait_tensor_396 = None
        permute_784 = torch.ops.aten.permute.default(permute_289, [1, 0]);  permute_289 = None
        mm_337 = torch.ops.aten.mm.default(convert_element_type_2002, permute_784);  convert_element_type_2002 = permute_784 = None
        add_1891 = torch.ops.aten.add.Tensor(add_1890, mm_337);  add_1890 = mm_337 = None
        convert_element_type_2007 = torch.ops.prims.convert_element_type.default(mm_336, torch.float32);  mm_336 = None
        reduce_scatter_tensor_106 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2007, 'avg', 64, '0');  convert_element_type_2007 = None
        wait_tensor_681 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_106);  reduce_scatter_tensor_106 = None
        view_1918 = torch.ops.aten.view.default(add_1891, [2, 4096, 2048]);  add_1891 = None
        convert_element_type_2008 = torch.ops.prims.convert_element_type.default(view_1918, torch.float32);  view_1918 = None
        convert_element_type_1031 = torch.ops.prims.convert_element_type.default(primals_317, torch.bfloat16);  primals_317 = None
        all_gather_into_tensor_323 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1031, 64, '0');  convert_element_type_1031 = None
        wait_tensor_395 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_323);  all_gather_into_tensor_323 = None
        convert_element_type_2010 = torch.ops.prims.convert_element_type.default(wait_tensor_395, torch.float32);  wait_tensor_395 = None
        mul_1543 = torch.ops.aten.mul.Tensor(convert_element_type_2008, convert_element_type_2010);  convert_element_type_2010 = None
        convert_element_type_1032 = torch.ops.prims.convert_element_type.default(add_1232, torch.float32);  add_1232 = None
        mul_897 = torch.ops.aten.mul.Tensor(convert_element_type_1032, rsqrt_59);  convert_element_type_1032 = None
        mul_1545 = torch.ops.aten.mul.Tensor(mul_897, mul_1543)
        sum_164 = torch.ops.aten.sum.dim_IntList(mul_1545, [2], True);  mul_1545 = None
        div_177 = torch.ops.aten.div.Tensor(mul_897, 2048)
        mul_1546 = torch.ops.aten.mul.Tensor(div_177, sum_164);  div_177 = sum_164 = None
        sub_670 = torch.ops.aten.sub.Tensor(mul_1543, mul_1546);  mul_1543 = mul_1546 = None
        mul_1547 = torch.ops.aten.mul.Tensor(sub_670, rsqrt_59);  sub_670 = rsqrt_59 = None
        mul_1548 = torch.ops.aten.mul.Tensor(convert_element_type_2008, mul_897);  convert_element_type_2008 = mul_897 = None
        sum_165 = torch.ops.aten.sum.dim_IntList(mul_1548, [0, 1]);  mul_1548 = None
        convert_element_type_2011 = torch.ops.prims.convert_element_type.default(mul_1547, torch.bfloat16);  mul_1547 = None
        add_1892 = torch.ops.aten.add.Tensor(add_1879, convert_element_type_2011);  add_1879 = convert_element_type_2011 = None
        convert_element_type_default_60 = torch.ops.prims.convert_element_type.default(sum_165, torch.float32);  sum_165 = None
        reduce_scatter_tensor_107 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_60, 'avg', 64, '0');  convert_element_type_default_60 = None
        wait_tensor_682 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_107);  reduce_scatter_tensor_107 = None
        view_1919 = torch.ops.aten.view.default(add_1892, [8192, 2048])
        permute_786 = torch.ops.aten.permute.default(view_1919, [1, 0])
        permute_287 = torch.ops.aten.permute.default(getitem_267, [0, 2, 1, 3])
        view_1259 = torch.ops.aten.view.default(permute_287, [2, 4096, -1]);  permute_287 = None
        view_1261 = torch.ops.aten.view.default(view_1259, [8192, 2048]);  view_1259 = None
        mm_338 = torch.ops.aten.mm.default(permute_786, view_1261);  permute_786 = view_1261 = None
        convert_element_type_1028 = torch.ops.prims.convert_element_type.default(primals_316, torch.bfloat16);  primals_316 = None
        all_gather_into_tensor_322 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1028, 64, '0');  convert_element_type_1028 = None
        wait_tensor_394 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_322);  all_gather_into_tensor_322 = None
        permute_288 = torch.ops.aten.permute.default(wait_tensor_394, [1, 0]);  wait_tensor_394 = None
        permute_788 = torch.ops.aten.permute.default(permute_288, [1, 0]);  permute_288 = None
        mm_339 = torch.ops.aten.mm.default(view_1919, permute_788);  view_1919 = permute_788 = None
        view_1920 = torch.ops.aten.view.default(mm_339, [2, 4096, 2048]);  mm_339 = None
        convert_element_type_2018 = torch.ops.prims.convert_element_type.default(mm_338, torch.float32);  mm_338 = None
        reduce_scatter_tensor_108 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2018, 'avg', 64, '0');  convert_element_type_2018 = None
        wait_tensor_683 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_108);  reduce_scatter_tensor_108 = None
        view_1921 = torch.ops.aten.view.default(view_1920, [2, 4096, 16, 128]);  view_1920 = None
        permute_790 = torch.ops.aten.permute.default(view_1921, [0, 2, 1, 3]);  view_1921 = None
        fw_graph7 = self.fw_graph7
        joint_graph7 = self.joint_graph7
        mask_graph7 = self.mask_graph7
        flex_attention_backward_7 = torch.ops.higher_order.flex_attention_backward(permute_284, permute_285, permute_286, getitem_267, getitem_268, permute_790, None, fw_graph7, joint_graph7, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph7), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_284 = permute_285 = permute_286 = getitem_267 = getitem_268 = permute_790 = fw_graph7 = joint_graph7 = mask_graph7 = None
        getitem_401 = flex_attention_backward_7[0]
        getitem_402 = flex_attention_backward_7[1]
        getitem_403 = flex_attention_backward_7[2];  flex_attention_backward_7 = None
        permute_791 = torch.ops.aten.permute.default(getitem_403, [0, 2, 1, 3]);  getitem_403 = None
        permute_792 = torch.ops.aten.permute.default(getitem_402, [0, 2, 1, 3]);  getitem_402 = None
        permute_793 = torch.ops.aten.permute.default(getitem_401, [0, 2, 1, 3]);  getitem_401 = None
        slice_151 = torch.ops.aten.slice.Tensor(permute_792, 3, 0, 128)
        slice_152 = torch.ops.aten.slice.Tensor(permute_792, 3, 128, 192);  permute_792 = None
        sum_166 = torch.ops.aten.sum.dim_IntList(slice_152, [2], True);  slice_152 = None
        cat_101 = torch.ops.aten.cat.default([slice_151, permute_791], 3);  slice_151 = permute_791 = None
        view_1922 = torch.ops.aten.view.default(cat_101, [2, 4096, 4096]);  cat_101 = None
        view_1923 = torch.ops.aten.view.default(view_1922, [8192, 4096]);  view_1922 = None
        permute_794 = torch.ops.aten.permute.default(view_1923, [1, 0])
        mm_340 = torch.ops.aten.mm.default(permute_794, view_1256);  permute_794 = view_1256 = None
        convert_element_type_1025 = torch.ops.prims.convert_element_type.default(primals_315, torch.bfloat16);  primals_315 = None
        all_gather_into_tensor_321 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1025, 64, '0');  convert_element_type_1025 = None
        wait_tensor_393 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_321);  all_gather_into_tensor_321 = None
        permute_283 = torch.ops.aten.permute.default(wait_tensor_393, [1, 0]);  wait_tensor_393 = None
        permute_796 = torch.ops.aten.permute.default(permute_283, [1, 0]);  permute_283 = None
        mm_341 = torch.ops.aten.mm.default(view_1923, permute_796);  view_1923 = permute_796 = None
        view_1924 = torch.ops.aten.view.default(mm_341, [2, 4096, 512]);  mm_341 = None
        convert_element_type_2023 = torch.ops.prims.convert_element_type.default(mm_340, torch.float32);  mm_340 = None
        reduce_scatter_tensor_109 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2023, 'avg', 64, '0');  convert_element_type_2023 = None
        wait_tensor_684 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_109);  reduce_scatter_tensor_109 = None
        convert_element_type_2024 = torch.ops.prims.convert_element_type.default(view_1924, torch.float32);  view_1924 = None
        convert_element_type_1022 = torch.ops.prims.convert_element_type.default(primals_314, torch.bfloat16);  primals_314 = None
        all_gather_into_tensor_320 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1022, 64, '0');  convert_element_type_1022 = None
        wait_tensor_392 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_320);  all_gather_into_tensor_320 = None
        convert_element_type_2026 = torch.ops.prims.convert_element_type.default(wait_tensor_392, torch.float32);  wait_tensor_392 = None
        mul_1549 = torch.ops.aten.mul.Tensor(convert_element_type_2024, convert_element_type_2026);  convert_element_type_2026 = None
        convert_element_type_1023 = torch.ops.prims.convert_element_type.default(getitem_263, torch.float32);  getitem_263 = None
        mul_895 = torch.ops.aten.mul.Tensor(convert_element_type_1023, rsqrt_58);  convert_element_type_1023 = None
        mul_1551 = torch.ops.aten.mul.Tensor(mul_895, mul_1549)
        sum_167 = torch.ops.aten.sum.dim_IntList(mul_1551, [2], True);  mul_1551 = None
        div_178 = torch.ops.aten.div.Tensor(mul_895, 512)
        mul_1552 = torch.ops.aten.mul.Tensor(div_178, sum_167);  div_178 = sum_167 = None
        sub_671 = torch.ops.aten.sub.Tensor(mul_1549, mul_1552);  mul_1549 = mul_1552 = None
        mul_1553 = torch.ops.aten.mul.Tensor(sub_671, rsqrt_58);  sub_671 = rsqrt_58 = None
        mul_1554 = torch.ops.aten.mul.Tensor(convert_element_type_2024, mul_895);  convert_element_type_2024 = mul_895 = None
        sum_168 = torch.ops.aten.sum.dim_IntList(mul_1554, [0, 1]);  mul_1554 = None
        convert_element_type_2027 = torch.ops.prims.convert_element_type.default(mul_1553, torch.bfloat16);  mul_1553 = None
        convert_element_type_default_59 = torch.ops.prims.convert_element_type.default(sum_168, torch.float32);  sum_168 = None
        reduce_scatter_tensor_110 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_59, 'avg', 64, '0');  convert_element_type_default_59 = None
        wait_tensor_685 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_110);  reduce_scatter_tensor_110 = None
        convert_element_type_2030 = torch.ops.prims.convert_element_type.default(sum_166, torch.float32);  sum_166 = None
        view_1925 = torch.ops.aten.view.default(convert_element_type_2030, [2, 4096, 1, 32, 2]);  convert_element_type_2030 = None
        view_as_complex_68 = torch.ops.aten.view_as_complex.default(view_1925);  view_1925 = None
        mul_1555 = torch.ops.aten.mul.Tensor(view_as_complex_68, clone_9);  view_as_complex_68 = None
        view_as_real_68 = torch.ops.aten.view_as_real.default(mul_1555);  mul_1555 = None
        view_1926 = torch.ops.aten.view.default(view_as_real_68, [2, 4096, 1, 64]);  view_as_real_68 = None
        convert_element_type_2031 = torch.ops.prims.convert_element_type.default(view_1926, torch.bfloat16);  view_1926 = None
        squeeze_33 = torch.ops.aten.squeeze.dim(convert_element_type_2031, 2);  convert_element_type_2031 = None
        cat_102 = torch.ops.aten.cat.default([convert_element_type_2027, squeeze_33], 2);  convert_element_type_2027 = squeeze_33 = None
        view_1927 = torch.ops.aten.view.default(cat_102, [8192, 576]);  cat_102 = None
        permute_798 = torch.ops.aten.permute.default(view_1927, [1, 0])
        mm_342 = torch.ops.aten.mm.default(permute_798, view_1242);  permute_798 = None
        convert_element_type_1017 = torch.ops.prims.convert_element_type.default(primals_313, torch.bfloat16);  primals_313 = None
        all_gather_into_tensor_319 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1017, 64, '0');  convert_element_type_1017 = None
        wait_tensor_391 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_319);  all_gather_into_tensor_319 = None
        permute_282 = torch.ops.aten.permute.default(wait_tensor_391, [1, 0]);  wait_tensor_391 = None
        permute_800 = torch.ops.aten.permute.default(permute_282, [1, 0]);  permute_282 = None
        mm_343 = torch.ops.aten.mm.default(view_1927, permute_800);  view_1927 = permute_800 = None
        view_1928 = torch.ops.aten.view.default(mm_343, [2, 4096, 2048]);  mm_343 = None
        convert_element_type_2036 = torch.ops.prims.convert_element_type.default(mm_342, torch.float32);  mm_342 = None
        reduce_scatter_tensor_111 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2036, 'avg', 64, '0');  convert_element_type_2036 = None
        wait_tensor_686 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_111);  reduce_scatter_tensor_111 = None
        slice_153 = torch.ops.aten.slice.Tensor(permute_793, 3, 0, 128)
        slice_154 = torch.ops.aten.slice.Tensor(permute_793, 3, 128, 192);  permute_793 = None
        convert_element_type_2037 = torch.ops.prims.convert_element_type.default(slice_154, torch.float32);  slice_154 = None
        view_1929 = torch.ops.aten.view.default(convert_element_type_2037, [2, 4096, 16, 32, 2]);  convert_element_type_2037 = None
        view_as_complex_69 = torch.ops.aten.view_as_complex.default(view_1929);  view_1929 = None
        mul_1556 = torch.ops.aten.mul.Tensor(view_as_complex_69, clone_9);  view_as_complex_69 = None
        view_as_real_69 = torch.ops.aten.view_as_real.default(mul_1556);  mul_1556 = None
        view_1930 = torch.ops.aten.view.default(view_as_real_69, [2, 4096, 16, 64]);  view_as_real_69 = None
        convert_element_type_2038 = torch.ops.prims.convert_element_type.default(view_1930, torch.bfloat16);  view_1930 = None
        cat_103 = torch.ops.aten.cat.default([slice_153, convert_element_type_2038], 3);  slice_153 = convert_element_type_2038 = None
        view_1931 = torch.ops.aten.view.default(cat_103, [2, 4096, 3072]);  cat_103 = None
        view_1932 = torch.ops.aten.view.default(view_1931, [8192, 3072]);  view_1931 = None
        permute_802 = torch.ops.aten.permute.default(view_1932, [1, 0])
        mm_344 = torch.ops.aten.mm.default(permute_802, view_1242);  permute_802 = view_1242 = None
        convert_element_type_1012 = torch.ops.prims.convert_element_type.default(primals_312, torch.bfloat16);  primals_312 = None
        all_gather_into_tensor_318 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1012, 64, '0');  convert_element_type_1012 = None
        wait_tensor_390 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_318);  all_gather_into_tensor_318 = None
        permute_281 = torch.ops.aten.permute.default(wait_tensor_390, [1, 0]);  wait_tensor_390 = None
        permute_804 = torch.ops.aten.permute.default(permute_281, [1, 0]);  permute_281 = None
        mm_345 = torch.ops.aten.mm.default(view_1932, permute_804);  view_1932 = permute_804 = None
        view_1933 = torch.ops.aten.view.default(mm_345, [2, 4096, 2048]);  mm_345 = None
        add_1893 = torch.ops.aten.add.Tensor(view_1928, view_1933);  view_1928 = view_1933 = None
        convert_element_type_2043 = torch.ops.prims.convert_element_type.default(mm_344, torch.float32);  mm_344 = None
        reduce_scatter_tensor_112 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2043, 'avg', 64, '0');  convert_element_type_2043 = None
        wait_tensor_687 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_112);  reduce_scatter_tensor_112 = None
        convert_element_type_2044 = torch.ops.prims.convert_element_type.default(add_1893, torch.float32);  add_1893 = None
        convert_element_type_1009 = torch.ops.prims.convert_element_type.default(primals_311, torch.bfloat16);  primals_311 = None
        all_gather_into_tensor_317 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1009, 64, '0');  convert_element_type_1009 = None
        wait_tensor_389 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_317);  all_gather_into_tensor_317 = None
        convert_element_type_2046 = torch.ops.prims.convert_element_type.default(wait_tensor_389, torch.float32);  wait_tensor_389 = None
        mul_1557 = torch.ops.aten.mul.Tensor(convert_element_type_2044, convert_element_type_2046);  convert_element_type_2046 = None
        convert_element_type_1010 = torch.ops.prims.convert_element_type.default(add_1229, torch.float32);  add_1229 = None
        mul_891 = torch.ops.aten.mul.Tensor(convert_element_type_1010, rsqrt_57);  convert_element_type_1010 = None
        mul_1559 = torch.ops.aten.mul.Tensor(mul_891, mul_1557)
        sum_169 = torch.ops.aten.sum.dim_IntList(mul_1559, [2], True);  mul_1559 = None
        div_179 = torch.ops.aten.div.Tensor(mul_891, 2048)
        mul_1560 = torch.ops.aten.mul.Tensor(div_179, sum_169);  div_179 = sum_169 = None
        sub_672 = torch.ops.aten.sub.Tensor(mul_1557, mul_1560);  mul_1557 = mul_1560 = None
        mul_1561 = torch.ops.aten.mul.Tensor(sub_672, rsqrt_57);  sub_672 = rsqrt_57 = None
        mul_1562 = torch.ops.aten.mul.Tensor(convert_element_type_2044, mul_891);  convert_element_type_2044 = mul_891 = None
        sum_170 = torch.ops.aten.sum.dim_IntList(mul_1562, [0, 1]);  mul_1562 = None
        convert_element_type_2047 = torch.ops.prims.convert_element_type.default(mul_1561, torch.bfloat16);  mul_1561 = None
        add_1894 = torch.ops.aten.add.Tensor(add_1892, convert_element_type_2047);  add_1892 = convert_element_type_2047 = None
        convert_element_type_default_58 = torch.ops.prims.convert_element_type.default(sum_170, torch.float32);  sum_170 = None
        reduce_scatter_tensor_113 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_58, 'avg', 64, '0');  convert_element_type_default_58 = None
        wait_tensor_688 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_113);  reduce_scatter_tensor_113 = None
        view_1934 = torch.ops.aten.view.default(add_1894, [8192, 2048])
        unsqueeze_61 = torch.ops.aten.unsqueeze.default(view_1934, 1)
        convert_element_type_2050 = torch.ops.prims.convert_element_type.default(unsqueeze_61, torch.float32);  unsqueeze_61 = None
        bmm_42 = torch.ops.aten.bmm.default(permute_806, convert_element_type_2050);  permute_806 = None
        bmm_43 = torch.ops.aten.bmm.default(convert_element_type_2050, permute_807);  convert_element_type_2050 = permute_807 = None
        convert_element_type_2051 = torch.ops.prims.convert_element_type.default(bmm_42, torch.bfloat16);  bmm_42 = None
        view_1935 = torch.ops.aten.view.default(bmm_43, [8192, 6]);  bmm_43 = None
        view_1936 = torch.ops.aten.view.default(convert_element_type_2051, [49152, 2048]);  convert_element_type_2051 = None
        index_68 = torch.ops.aten.index.Tensor(view_1936, [getitem_259]);  view_1936 = getitem_259 = None
        permute_808 = torch.ops.aten.permute.default(view_1934, [1, 0])
        mm_346 = torch.ops.aten.mm.default(permute_808, mul_888);  permute_808 = mul_888 = None
        convert_element_type_1004 = torch.ops.prims.convert_element_type.default(primals_310, torch.bfloat16);  primals_310 = None
        all_gather_into_tensor_316 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1004, 64, '0');  convert_element_type_1004 = None
        wait_tensor_388 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_316);  all_gather_into_tensor_316 = None
        permute_280 = torch.ops.aten.permute.default(wait_tensor_388, [1, 0]);  wait_tensor_388 = None
        permute_810 = torch.ops.aten.permute.default(permute_280, [1, 0]);  permute_280 = None
        mm_347 = torch.ops.aten.mm.default(view_1934, permute_810);  view_1934 = permute_810 = None
        convert_element_type_2056 = torch.ops.prims.convert_element_type.default(mm_346, torch.float32);  mm_346 = None
        reduce_scatter_tensor_114 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2056, 'avg', 64, '0');  convert_element_type_2056 = None
        wait_tensor_689 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_114);  reduce_scatter_tensor_114 = None
        convert_element_type_999 = torch.ops.prims.convert_element_type.default(mm_148, torch.float32);  mm_148 = None
        neg_36 = torch.ops.aten.neg.default(convert_element_type_999)
        exp_54 = torch.ops.aten.exp.default(neg_36);  neg_36 = None
        add_1224 = torch.ops.aten.add.Tensor(exp_54, 1);  exp_54 = None
        div_90 = torch.ops.aten.div.Tensor(convert_element_type_999, add_1224)
        convert_element_type_1000 = torch.ops.prims.convert_element_type.default(div_90, torch.bfloat16);  div_90 = None
        mul_1563 = torch.ops.aten.mul.Tensor(mm_347, convert_element_type_1000);  convert_element_type_1000 = None
        mul_1564 = torch.ops.aten.mul.Tensor(mm_347, mm_149);  mm_347 = mm_149 = None
        permute_812 = torch.ops.aten.permute.default(mul_1563, [1, 0])
        mm_348 = torch.ops.aten.mm.default(permute_812, view_1197);  permute_812 = None
        convert_element_type_1001 = torch.ops.prims.convert_element_type.default(primals_309, torch.bfloat16);  primals_309 = None
        all_gather_into_tensor_315 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1001, 64, '0');  convert_element_type_1001 = None
        wait_tensor_387 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_315);  all_gather_into_tensor_315 = None
        permute_279 = torch.ops.aten.permute.default(wait_tensor_387, [1, 0]);  wait_tensor_387 = None
        permute_814 = torch.ops.aten.permute.default(permute_279, [1, 0]);  permute_279 = None
        mm_349 = torch.ops.aten.mm.default(mul_1563, permute_814);  mul_1563 = permute_814 = None
        convert_element_type_2061 = torch.ops.prims.convert_element_type.default(mm_348, torch.float32);  mm_348 = None
        reduce_scatter_tensor_115 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2061, 'avg', 64, '0');  convert_element_type_2061 = None
        wait_tensor_690 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_115);  reduce_scatter_tensor_115 = None
        convert_element_type_2062 = torch.ops.prims.convert_element_type.default(mul_1564, torch.float32);  mul_1564 = None
        reciprocal_16 = torch.ops.aten.reciprocal.default(add_1224);  add_1224 = None
        mul_1565 = torch.ops.aten.mul.Tensor(reciprocal_16, 1);  reciprocal_16 = None
        mul_1566 = torch.ops.aten.mul.Tensor(convert_element_type_2062, mul_1565);  convert_element_type_2062 = None
        sub_673 = torch.ops.aten.sub.Tensor(1, mul_1565);  mul_1565 = None
        mul_1567 = torch.ops.aten.mul.Tensor(convert_element_type_999, sub_673);  convert_element_type_999 = sub_673 = None
        add_1896 = torch.ops.aten.add.Tensor(mul_1567, 1);  mul_1567 = None
        mul_1568 = torch.ops.aten.mul.Tensor(mul_1566, add_1896);  mul_1566 = add_1896 = None
        convert_element_type_2064 = torch.ops.prims.convert_element_type.default(mul_1568, torch.bfloat16);  mul_1568 = None
        permute_816 = torch.ops.aten.permute.default(convert_element_type_2064, [1, 0])
        mm_350 = torch.ops.aten.mm.default(permute_816, view_1197);  permute_816 = None
        convert_element_type_996 = torch.ops.prims.convert_element_type.default(primals_308, torch.bfloat16);  primals_308 = None
        all_gather_into_tensor_314 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_996, 64, '0');  convert_element_type_996 = None
        wait_tensor_386 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_314);  all_gather_into_tensor_314 = None
        permute_278 = torch.ops.aten.permute.default(wait_tensor_386, [1, 0]);  wait_tensor_386 = None
        permute_818 = torch.ops.aten.permute.default(permute_278, [1, 0]);  permute_278 = None
        mm_351 = torch.ops.aten.mm.default(convert_element_type_2064, permute_818);  convert_element_type_2064 = permute_818 = None
        add_1897 = torch.ops.aten.add.Tensor(mm_349, mm_351);  mm_349 = mm_351 = None
        convert_element_type_2069 = torch.ops.prims.convert_element_type.default(mm_350, torch.float32);  mm_350 = None
        reduce_scatter_tensor_116 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2069, 'avg', 64, '0');  convert_element_type_2069 = None
        wait_tensor_691 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_116);  reduce_scatter_tensor_116 = None
        all_to_all_single_94 = torch.ops._c10d_functional.all_to_all_single.default(index_68, [_local_scalar_dense_280, _local_scalar_dense_281, _local_scalar_dense_282, _local_scalar_dense_283, _local_scalar_dense_284, _local_scalar_dense_285, _local_scalar_dense_286, _local_scalar_dense_287], [_local_scalar_dense_272, _local_scalar_dense_273, _local_scalar_dense_274, _local_scalar_dense_275, _local_scalar_dense_276, _local_scalar_dense_277, _local_scalar_dense_278, _local_scalar_dense_279], '521');  index_68 = None
        wait_tensor_692 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_94);  all_to_all_single_94 = None
        full_380 = torch.ops.aten.full.default([sym_size_int_69, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_69 = None
        slice_scatter_8 = torch.ops.aten.slice_scatter.default(full_380, wait_tensor_692, 0, 0, -1);  wait_tensor_692 = None
        index_69 = torch.ops.aten.index.Tensor(slice_scatter_8, [getitem_260]);  slice_scatter_8 = None
        permute_820 = torch.ops.aten.permute.default(index_69, [1, 0])
        _grouped_mm_126 = torch.ops.aten._grouped_mm.default(permute_820, mul_868, cumsum_53);  permute_820 = mul_868 = None
        convert_element_type_990 = torch.ops.prims.convert_element_type.default(primals_306, torch.bfloat16);  primals_306 = None
        all_gather_into_tensor_310 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_990, 8, '513');  convert_element_type_990 = None
        wait_tensor_381 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_310);  all_gather_into_tensor_310 = None
        permute_277 = torch.ops.aten.permute.default(wait_tensor_381, [0, 2, 1]);  wait_tensor_381 = None
        permute_822 = torch.ops.aten.permute.default(permute_277, [0, 2, 1]);  permute_277 = None
        _grouped_mm_127 = torch.ops.aten._grouped_mm.default(index_69, permute_822, cumsum_53);  index_69 = permute_822 = None
        convert_element_type_994 = torch.ops.prims.convert_element_type.default(_grouped_mm_51, torch.float32);  _grouped_mm_51 = None
        neg_35 = torch.ops.aten.neg.default(convert_element_type_994)
        exp_53 = torch.ops.aten.exp.default(neg_35);  neg_35 = None
        add_1188 = torch.ops.aten.add.Tensor(exp_53, 1);  exp_53 = None
        div_89 = torch.ops.aten.div.Tensor(convert_element_type_994, add_1188)
        convert_element_type_995 = torch.ops.prims.convert_element_type.default(div_89, torch.bfloat16);  div_89 = None
        mul_1569 = torch.ops.aten.mul.Tensor(_grouped_mm_127, convert_element_type_995);  convert_element_type_995 = None
        mul_1570 = torch.ops.aten.mul.Tensor(_grouped_mm_127, _grouped_mm_52);  _grouped_mm_127 = _grouped_mm_52 = None
        permute_824 = torch.ops.aten.permute.default(mul_1569, [1, 0])
        _grouped_mm_128 = torch.ops.aten._grouped_mm.default(permute_824, index_35, cumsum_53);  permute_824 = None
        convert_element_type_991 = torch.ops.prims.convert_element_type.default(primals_307, torch.bfloat16);  primals_307 = None
        all_gather_into_tensor_311 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_991, 8, '513');  convert_element_type_991 = None
        wait_tensor_382 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_311);  all_gather_into_tensor_311 = None
        permute_276 = torch.ops.aten.permute.default(wait_tensor_382, [0, 2, 1]);  wait_tensor_382 = None
        permute_826 = torch.ops.aten.permute.default(permute_276, [0, 2, 1]);  permute_276 = None
        _grouped_mm_129 = torch.ops.aten._grouped_mm.default(mul_1569, permute_826, cumsum_53);  mul_1569 = permute_826 = None
        convert_element_type_2070 = torch.ops.prims.convert_element_type.default(mul_1570, torch.float32);  mul_1570 = None
        reciprocal_17 = torch.ops.aten.reciprocal.default(add_1188);  add_1188 = None
        mul_1571 = torch.ops.aten.mul.Tensor(reciprocal_17, 1);  reciprocal_17 = None
        mul_1572 = torch.ops.aten.mul.Tensor(convert_element_type_2070, mul_1571);  convert_element_type_2070 = None
        sub_674 = torch.ops.aten.sub.Tensor(1, mul_1571);  mul_1571 = None
        mul_1573 = torch.ops.aten.mul.Tensor(convert_element_type_994, sub_674);  convert_element_type_994 = sub_674 = None
        add_1899 = torch.ops.aten.add.Tensor(mul_1573, 1);  mul_1573 = None
        mul_1574 = torch.ops.aten.mul.Tensor(mul_1572, add_1899);  mul_1572 = add_1899 = None
        convert_element_type_2072 = torch.ops.prims.convert_element_type.default(mul_1574, torch.bfloat16);  mul_1574 = None
        permute_828 = torch.ops.aten.permute.default(convert_element_type_2072, [1, 0])
        _grouped_mm_130 = torch.ops.aten._grouped_mm.default(permute_828, index_35, cumsum_53);  permute_828 = index_35 = None
        convert_element_type_988 = torch.ops.prims.convert_element_type.default(primals_305, torch.bfloat16);  primals_305 = None
        all_gather_into_tensor_308 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_988, 8, '513');  convert_element_type_988 = None
        wait_tensor_379 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_308);  all_gather_into_tensor_308 = None
        permute_275 = torch.ops.aten.permute.default(wait_tensor_379, [0, 2, 1]);  wait_tensor_379 = None
        permute_830 = torch.ops.aten.permute.default(permute_275, [0, 2, 1]);  permute_275 = None
        _grouped_mm_131 = torch.ops.aten._grouped_mm.default(convert_element_type_2072, permute_830, cumsum_53);  convert_element_type_2072 = permute_830 = cumsum_53 = None
        add_1900 = torch.ops.aten.add.Tensor(_grouped_mm_129, _grouped_mm_131);  _grouped_mm_129 = _grouped_mm_131 = None
        convert_element_type_2073 = torch.ops.prims.convert_element_type.default(_grouped_mm_128, torch.float32);  _grouped_mm_128 = None
        div_180 = torch.ops.aten.div.Tensor(convert_element_type_2073, 64);  convert_element_type_2073 = None
        reduce_scatter_tensor_117 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_180, 'sum', 8, '513');  div_180 = None
        wait_tensor_693 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_117);  reduce_scatter_tensor_117 = None
        convert_element_type_2074 = torch.ops.prims.convert_element_type.default(_grouped_mm_126, torch.float32);  _grouped_mm_126 = None
        div_181 = torch.ops.aten.div.Tensor(convert_element_type_2074, 64);  convert_element_type_2074 = None
        reduce_scatter_tensor_118 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_181, 'sum', 8, '513');  div_181 = None
        wait_tensor_694 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_118);  reduce_scatter_tensor_118 = None
        convert_element_type_2075 = torch.ops.prims.convert_element_type.default(_grouped_mm_130, torch.float32);  _grouped_mm_130 = None
        div_182 = torch.ops.aten.div.Tensor(convert_element_type_2075, 64);  convert_element_type_2075 = None
        reduce_scatter_tensor_119 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_182, 'sum', 8, '513');  div_182 = None
        wait_tensor_695 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_119);  reduce_scatter_tensor_119 = None
        index_put_68 = torch.ops.aten.index_put.default(full_380, [getitem_260], add_1900, True);  full_380 = getitem_260 = add_1900 = None
        slice_155 = torch.ops.aten.slice.Tensor(index_put_68, 0, 0, add_1901);  index_put_68 = add_1901 = None
        all_to_all_single_95 = torch.ops._c10d_functional.all_to_all_single.default(slice_155, [_local_scalar_dense_272, _local_scalar_dense_273, _local_scalar_dense_274, _local_scalar_dense_275, _local_scalar_dense_276, _local_scalar_dense_277, _local_scalar_dense_278, _local_scalar_dense_279], [_local_scalar_dense_280, _local_scalar_dense_281, _local_scalar_dense_282, _local_scalar_dense_283, _local_scalar_dense_284, _local_scalar_dense_285, _local_scalar_dense_286, _local_scalar_dense_287], '521');  slice_155 = _local_scalar_dense_272 = _local_scalar_dense_273 = _local_scalar_dense_274 = _local_scalar_dense_275 = _local_scalar_dense_276 = _local_scalar_dense_277 = _local_scalar_dense_278 = _local_scalar_dense_279 = _local_scalar_dense_280 = _local_scalar_dense_281 = _local_scalar_dense_282 = _local_scalar_dense_283 = _local_scalar_dense_284 = _local_scalar_dense_285 = _local_scalar_dense_286 = _local_scalar_dense_287 = None
        wait_tensor_696 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_95);  all_to_all_single_95 = None
        index_put_69 = torch.ops.aten.index_put.default(full_default_52, [div_87], wait_tensor_696, True);  div_87 = wait_tensor_696 = None
        add_1905 = torch.ops.aten.add.Tensor(add_1897, index_put_69);  add_1897 = index_put_69 = None
        mul_1575 = torch.ops.aten.mul.Tensor(view_1935, 1.0);  view_1935 = None
        scatter_add_8 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_257, mul_1575);  getitem_257 = mul_1575 = None
        convert_element_type_983 = torch.ops.prims.convert_element_type.default(mm_147, torch.float32);  mm_147 = None
        sub_408 = torch.ops.aten.sub.Tensor(convert_element_type_983, amax_17);  convert_element_type_983 = amax_17 = None
        exp_52 = torch.ops.aten.exp.default(sub_408);  sub_408 = None
        div_86 = torch.ops.aten.div.Tensor(exp_52, sum_69);  exp_52 = sum_69 = None
        mul_1576 = torch.ops.aten.mul.Tensor(scatter_add_8, div_86);  scatter_add_8 = None
        sum_171 = torch.ops.aten.sum.dim_IntList(mul_1576, [1], True)
        neg_79 = torch.ops.aten.neg.default(div_86);  div_86 = None
        fma_8 = torch.ops.prims.fma.default(neg_79, sum_171, mul_1576);  neg_79 = sum_171 = mul_1576 = None
        convert_element_type_2076 = torch.ops.prims.convert_element_type.default(fma_8, torch.bfloat16);  fma_8 = None
        permute_832 = torch.ops.aten.permute.default(convert_element_type_2076, [1, 0])
        mm_352 = torch.ops.aten.mm.default(permute_832, view_1197);  permute_832 = view_1197 = None
        convert_element_type_980 = torch.ops.prims.convert_element_type.default(primals_303, torch.bfloat16);  primals_303 = None
        all_gather_into_tensor_307 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_980, 64, '0');  convert_element_type_980 = None
        wait_tensor_375 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_307);  all_gather_into_tensor_307 = None
        permute_274 = torch.ops.aten.permute.default(wait_tensor_375, [1, 0]);  wait_tensor_375 = None
        permute_834 = torch.ops.aten.permute.default(permute_274, [1, 0]);  permute_274 = None
        mm_353 = torch.ops.aten.mm.default(convert_element_type_2076, permute_834);  convert_element_type_2076 = permute_834 = None
        add_1906 = torch.ops.aten.add.Tensor(add_1905, mm_353);  add_1905 = mm_353 = None
        convert_element_type_2081 = torch.ops.prims.convert_element_type.default(mm_352, torch.float32);  mm_352 = None
        reduce_scatter_tensor_120 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2081, 'avg', 64, '0');  convert_element_type_2081 = None
        wait_tensor_697 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_120);  reduce_scatter_tensor_120 = None
        view_1937 = torch.ops.aten.view.default(add_1906, [2, 4096, 2048]);  add_1906 = None
        convert_element_type_2082 = torch.ops.prims.convert_element_type.default(view_1937, torch.float32);  view_1937 = None
        convert_element_type_977 = torch.ops.prims.convert_element_type.default(primals_301, torch.bfloat16);  primals_301 = None
        all_gather_into_tensor_306 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_977, 64, '0');  convert_element_type_977 = None
        wait_tensor_374 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_306);  all_gather_into_tensor_306 = None
        convert_element_type_2084 = torch.ops.prims.convert_element_type.default(wait_tensor_374, torch.float32);  wait_tensor_374 = None
        mul_1577 = torch.ops.aten.mul.Tensor(convert_element_type_2082, convert_element_type_2084);  convert_element_type_2084 = None
        convert_element_type_978 = torch.ops.prims.convert_element_type.default(add_1164, torch.float32);  add_1164 = None
        mul_848 = torch.ops.aten.mul.Tensor(convert_element_type_978, rsqrt_56);  convert_element_type_978 = None
        mul_1579 = torch.ops.aten.mul.Tensor(mul_848, mul_1577)
        sum_172 = torch.ops.aten.sum.dim_IntList(mul_1579, [2], True);  mul_1579 = None
        div_183 = torch.ops.aten.div.Tensor(mul_848, 2048)
        mul_1580 = torch.ops.aten.mul.Tensor(div_183, sum_172);  div_183 = sum_172 = None
        sub_676 = torch.ops.aten.sub.Tensor(mul_1577, mul_1580);  mul_1577 = mul_1580 = None
        mul_1581 = torch.ops.aten.mul.Tensor(sub_676, rsqrt_56);  sub_676 = rsqrt_56 = None
        mul_1582 = torch.ops.aten.mul.Tensor(convert_element_type_2082, mul_848);  convert_element_type_2082 = mul_848 = None
        sum_173 = torch.ops.aten.sum.dim_IntList(mul_1582, [0, 1]);  mul_1582 = None
        convert_element_type_2085 = torch.ops.prims.convert_element_type.default(mul_1581, torch.bfloat16);  mul_1581 = None
        add_1907 = torch.ops.aten.add.Tensor(add_1894, convert_element_type_2085);  add_1894 = convert_element_type_2085 = None
        convert_element_type_default_57 = torch.ops.prims.convert_element_type.default(sum_173, torch.float32);  sum_173 = None
        reduce_scatter_tensor_121 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_57, 'avg', 64, '0');  convert_element_type_default_57 = None
        wait_tensor_698 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_121);  reduce_scatter_tensor_121 = None
        view_1938 = torch.ops.aten.view.default(add_1907, [8192, 2048])
        permute_836 = torch.ops.aten.permute.default(view_1938, [1, 0])
        permute_272 = torch.ops.aten.permute.default(getitem_253, [0, 2, 1, 3])
        view_1192 = torch.ops.aten.view.default(permute_272, [2, 4096, -1]);  permute_272 = None
        view_1194 = torch.ops.aten.view.default(view_1192, [8192, 2048]);  view_1192 = None
        mm_354 = torch.ops.aten.mm.default(permute_836, view_1194);  permute_836 = view_1194 = None
        convert_element_type_974 = torch.ops.prims.convert_element_type.default(primals_300, torch.bfloat16);  primals_300 = None
        all_gather_into_tensor_305 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_974, 64, '0');  convert_element_type_974 = None
        wait_tensor_373 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_305);  all_gather_into_tensor_305 = None
        permute_273 = torch.ops.aten.permute.default(wait_tensor_373, [1, 0]);  wait_tensor_373 = None
        permute_838 = torch.ops.aten.permute.default(permute_273, [1, 0]);  permute_273 = None
        mm_355 = torch.ops.aten.mm.default(view_1938, permute_838);  view_1938 = permute_838 = None
        view_1939 = torch.ops.aten.view.default(mm_355, [2, 4096, 2048]);  mm_355 = None
        convert_element_type_2092 = torch.ops.prims.convert_element_type.default(mm_354, torch.float32);  mm_354 = None
        reduce_scatter_tensor_122 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2092, 'avg', 64, '0');  convert_element_type_2092 = None
        wait_tensor_699 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_122);  reduce_scatter_tensor_122 = None
        view_1940 = torch.ops.aten.view.default(view_1939, [2, 4096, 16, 128]);  view_1939 = None
        permute_840 = torch.ops.aten.permute.default(view_1940, [0, 2, 1, 3]);  view_1940 = None
        fw_graph8 = self.fw_graph8
        joint_graph8 = self.joint_graph8
        mask_graph8 = self.mask_graph8
        flex_attention_backward_8 = torch.ops.higher_order.flex_attention_backward(permute_269, permute_270, permute_271, getitem_253, getitem_254, permute_840, None, fw_graph8, joint_graph8, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph8), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_269 = permute_270 = permute_271 = getitem_253 = getitem_254 = permute_840 = fw_graph8 = joint_graph8 = mask_graph8 = None
        getitem_405 = flex_attention_backward_8[0]
        getitem_406 = flex_attention_backward_8[1]
        getitem_407 = flex_attention_backward_8[2];  flex_attention_backward_8 = None
        permute_841 = torch.ops.aten.permute.default(getitem_407, [0, 2, 1, 3]);  getitem_407 = None
        permute_842 = torch.ops.aten.permute.default(getitem_406, [0, 2, 1, 3]);  getitem_406 = None
        permute_843 = torch.ops.aten.permute.default(getitem_405, [0, 2, 1, 3]);  getitem_405 = None
        slice_157 = torch.ops.aten.slice.Tensor(permute_842, 3, 0, 128)
        slice_158 = torch.ops.aten.slice.Tensor(permute_842, 3, 128, 192);  permute_842 = None
        sum_174 = torch.ops.aten.sum.dim_IntList(slice_158, [2], True);  slice_158 = None
        cat_104 = torch.ops.aten.cat.default([slice_157, permute_841], 3);  slice_157 = permute_841 = None
        view_1941 = torch.ops.aten.view.default(cat_104, [2, 4096, 4096]);  cat_104 = None
        view_1942 = torch.ops.aten.view.default(view_1941, [8192, 4096]);  view_1941 = None
        permute_844 = torch.ops.aten.permute.default(view_1942, [1, 0])
        mm_356 = torch.ops.aten.mm.default(permute_844, view_1189);  permute_844 = view_1189 = None
        convert_element_type_971 = torch.ops.prims.convert_element_type.default(primals_299, torch.bfloat16);  primals_299 = None
        all_gather_into_tensor_304 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_971, 64, '0');  convert_element_type_971 = None
        wait_tensor_372 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_304);  all_gather_into_tensor_304 = None
        permute_268 = torch.ops.aten.permute.default(wait_tensor_372, [1, 0]);  wait_tensor_372 = None
        permute_846 = torch.ops.aten.permute.default(permute_268, [1, 0]);  permute_268 = None
        mm_357 = torch.ops.aten.mm.default(view_1942, permute_846);  view_1942 = permute_846 = None
        view_1943 = torch.ops.aten.view.default(mm_357, [2, 4096, 512]);  mm_357 = None
        convert_element_type_2097 = torch.ops.prims.convert_element_type.default(mm_356, torch.float32);  mm_356 = None
        reduce_scatter_tensor_123 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2097, 'avg', 64, '0');  convert_element_type_2097 = None
        wait_tensor_700 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_123);  reduce_scatter_tensor_123 = None
        convert_element_type_2098 = torch.ops.prims.convert_element_type.default(view_1943, torch.float32);  view_1943 = None
        convert_element_type_968 = torch.ops.prims.convert_element_type.default(primals_298, torch.bfloat16);  primals_298 = None
        all_gather_into_tensor_303 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_968, 64, '0');  convert_element_type_968 = None
        wait_tensor_371 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_303);  all_gather_into_tensor_303 = None
        convert_element_type_2100 = torch.ops.prims.convert_element_type.default(wait_tensor_371, torch.float32);  wait_tensor_371 = None
        mul_1583 = torch.ops.aten.mul.Tensor(convert_element_type_2098, convert_element_type_2100);  convert_element_type_2100 = None
        convert_element_type_969 = torch.ops.prims.convert_element_type.default(getitem_249, torch.float32);  getitem_249 = None
        mul_846 = torch.ops.aten.mul.Tensor(convert_element_type_969, rsqrt_55);  convert_element_type_969 = None
        mul_1585 = torch.ops.aten.mul.Tensor(mul_846, mul_1583)
        sum_175 = torch.ops.aten.sum.dim_IntList(mul_1585, [2], True);  mul_1585 = None
        div_184 = torch.ops.aten.div.Tensor(mul_846, 512)
        mul_1586 = torch.ops.aten.mul.Tensor(div_184, sum_175);  div_184 = sum_175 = None
        sub_677 = torch.ops.aten.sub.Tensor(mul_1583, mul_1586);  mul_1583 = mul_1586 = None
        mul_1587 = torch.ops.aten.mul.Tensor(sub_677, rsqrt_55);  sub_677 = rsqrt_55 = None
        mul_1588 = torch.ops.aten.mul.Tensor(convert_element_type_2098, mul_846);  convert_element_type_2098 = mul_846 = None
        sum_176 = torch.ops.aten.sum.dim_IntList(mul_1588, [0, 1]);  mul_1588 = None
        convert_element_type_2101 = torch.ops.prims.convert_element_type.default(mul_1587, torch.bfloat16);  mul_1587 = None
        convert_element_type_default_56 = torch.ops.prims.convert_element_type.default(sum_176, torch.float32);  sum_176 = None
        reduce_scatter_tensor_124 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_56, 'avg', 64, '0');  convert_element_type_default_56 = None
        wait_tensor_701 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_124);  reduce_scatter_tensor_124 = None
        convert_element_type_2104 = torch.ops.prims.convert_element_type.default(sum_174, torch.float32);  sum_174 = None
        view_1944 = torch.ops.aten.view.default(convert_element_type_2104, [2, 4096, 1, 32, 2]);  convert_element_type_2104 = None
        view_as_complex_70 = torch.ops.aten.view_as_complex.default(view_1944);  view_1944 = None
        mul_1589 = torch.ops.aten.mul.Tensor(view_as_complex_70, clone_9);  view_as_complex_70 = None
        view_as_real_70 = torch.ops.aten.view_as_real.default(mul_1589);  mul_1589 = None
        view_1945 = torch.ops.aten.view.default(view_as_real_70, [2, 4096, 1, 64]);  view_as_real_70 = None
        convert_element_type_2105 = torch.ops.prims.convert_element_type.default(view_1945, torch.bfloat16);  view_1945 = None
        squeeze_34 = torch.ops.aten.squeeze.dim(convert_element_type_2105, 2);  convert_element_type_2105 = None
        cat_105 = torch.ops.aten.cat.default([convert_element_type_2101, squeeze_34], 2);  convert_element_type_2101 = squeeze_34 = None
        view_1946 = torch.ops.aten.view.default(cat_105, [8192, 576]);  cat_105 = None
        permute_848 = torch.ops.aten.permute.default(view_1946, [1, 0])
        mm_358 = torch.ops.aten.mm.default(permute_848, view_1175);  permute_848 = None
        convert_element_type_963 = torch.ops.prims.convert_element_type.default(primals_297, torch.bfloat16);  primals_297 = None
        all_gather_into_tensor_302 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_963, 64, '0');  convert_element_type_963 = None
        wait_tensor_370 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_302);  all_gather_into_tensor_302 = None
        permute_267 = torch.ops.aten.permute.default(wait_tensor_370, [1, 0]);  wait_tensor_370 = None
        permute_850 = torch.ops.aten.permute.default(permute_267, [1, 0]);  permute_267 = None
        mm_359 = torch.ops.aten.mm.default(view_1946, permute_850);  view_1946 = permute_850 = None
        view_1947 = torch.ops.aten.view.default(mm_359, [2, 4096, 2048]);  mm_359 = None
        convert_element_type_2110 = torch.ops.prims.convert_element_type.default(mm_358, torch.float32);  mm_358 = None
        reduce_scatter_tensor_125 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2110, 'avg', 64, '0');  convert_element_type_2110 = None
        wait_tensor_702 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_125);  reduce_scatter_tensor_125 = None
        slice_159 = torch.ops.aten.slice.Tensor(permute_843, 3, 0, 128)
        slice_160 = torch.ops.aten.slice.Tensor(permute_843, 3, 128, 192);  permute_843 = None
        convert_element_type_2111 = torch.ops.prims.convert_element_type.default(slice_160, torch.float32);  slice_160 = None
        view_1948 = torch.ops.aten.view.default(convert_element_type_2111, [2, 4096, 16, 32, 2]);  convert_element_type_2111 = None
        view_as_complex_71 = torch.ops.aten.view_as_complex.default(view_1948);  view_1948 = None
        mul_1590 = torch.ops.aten.mul.Tensor(view_as_complex_71, clone_9);  view_as_complex_71 = None
        view_as_real_71 = torch.ops.aten.view_as_real.default(mul_1590);  mul_1590 = None
        view_1949 = torch.ops.aten.view.default(view_as_real_71, [2, 4096, 16, 64]);  view_as_real_71 = None
        convert_element_type_2112 = torch.ops.prims.convert_element_type.default(view_1949, torch.bfloat16);  view_1949 = None
        cat_106 = torch.ops.aten.cat.default([slice_159, convert_element_type_2112], 3);  slice_159 = convert_element_type_2112 = None
        view_1950 = torch.ops.aten.view.default(cat_106, [2, 4096, 3072]);  cat_106 = None
        view_1951 = torch.ops.aten.view.default(view_1950, [8192, 3072]);  view_1950 = None
        permute_852 = torch.ops.aten.permute.default(view_1951, [1, 0])
        mm_360 = torch.ops.aten.mm.default(permute_852, view_1175);  permute_852 = view_1175 = None
        convert_element_type_958 = torch.ops.prims.convert_element_type.default(primals_296, torch.bfloat16);  primals_296 = None
        all_gather_into_tensor_301 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_958, 64, '0');  convert_element_type_958 = None
        wait_tensor_369 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_301);  all_gather_into_tensor_301 = None
        permute_266 = torch.ops.aten.permute.default(wait_tensor_369, [1, 0]);  wait_tensor_369 = None
        permute_854 = torch.ops.aten.permute.default(permute_266, [1, 0]);  permute_266 = None
        mm_361 = torch.ops.aten.mm.default(view_1951, permute_854);  view_1951 = permute_854 = None
        view_1952 = torch.ops.aten.view.default(mm_361, [2, 4096, 2048]);  mm_361 = None
        add_1908 = torch.ops.aten.add.Tensor(view_1947, view_1952);  view_1947 = view_1952 = None
        convert_element_type_2117 = torch.ops.prims.convert_element_type.default(mm_360, torch.float32);  mm_360 = None
        reduce_scatter_tensor_126 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2117, 'avg', 64, '0');  convert_element_type_2117 = None
        wait_tensor_703 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_126);  reduce_scatter_tensor_126 = None
        convert_element_type_2118 = torch.ops.prims.convert_element_type.default(add_1908, torch.float32);  add_1908 = None
        convert_element_type_955 = torch.ops.prims.convert_element_type.default(primals_295, torch.bfloat16);  primals_295 = None
        all_gather_into_tensor_300 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_955, 64, '0');  convert_element_type_955 = None
        wait_tensor_368 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_300);  all_gather_into_tensor_300 = None
        convert_element_type_2120 = torch.ops.prims.convert_element_type.default(wait_tensor_368, torch.float32);  wait_tensor_368 = None
        mul_1591 = torch.ops.aten.mul.Tensor(convert_element_type_2118, convert_element_type_2120);  convert_element_type_2120 = None
        convert_element_type_956 = torch.ops.prims.convert_element_type.default(add_1161, torch.float32);  add_1161 = None
        mul_842 = torch.ops.aten.mul.Tensor(convert_element_type_956, rsqrt_54);  convert_element_type_956 = None
        mul_1593 = torch.ops.aten.mul.Tensor(mul_842, mul_1591)
        sum_177 = torch.ops.aten.sum.dim_IntList(mul_1593, [2], True);  mul_1593 = None
        div_185 = torch.ops.aten.div.Tensor(mul_842, 2048)
        mul_1594 = torch.ops.aten.mul.Tensor(div_185, sum_177);  div_185 = sum_177 = None
        sub_678 = torch.ops.aten.sub.Tensor(mul_1591, mul_1594);  mul_1591 = mul_1594 = None
        mul_1595 = torch.ops.aten.mul.Tensor(sub_678, rsqrt_54);  sub_678 = rsqrt_54 = None
        mul_1596 = torch.ops.aten.mul.Tensor(convert_element_type_2118, mul_842);  convert_element_type_2118 = mul_842 = None
        sum_178 = torch.ops.aten.sum.dim_IntList(mul_1596, [0, 1]);  mul_1596 = None
        convert_element_type_2121 = torch.ops.prims.convert_element_type.default(mul_1595, torch.bfloat16);  mul_1595 = None
        add_1909 = torch.ops.aten.add.Tensor(add_1907, convert_element_type_2121);  add_1907 = convert_element_type_2121 = None
        convert_element_type_default_55 = torch.ops.prims.convert_element_type.default(sum_178, torch.float32);  sum_178 = None
        reduce_scatter_tensor_127 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_55, 'avg', 64, '0');  convert_element_type_default_55 = None
        wait_tensor_704 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_127);  reduce_scatter_tensor_127 = None
        view_1953 = torch.ops.aten.view.default(add_1909, [8192, 2048])
        unsqueeze_62 = torch.ops.aten.unsqueeze.default(view_1953, 1)
        convert_element_type_2124 = torch.ops.prims.convert_element_type.default(unsqueeze_62, torch.float32);  unsqueeze_62 = None
        bmm_44 = torch.ops.aten.bmm.default(permute_856, convert_element_type_2124);  permute_856 = None
        bmm_45 = torch.ops.aten.bmm.default(convert_element_type_2124, permute_857);  convert_element_type_2124 = permute_857 = None
        convert_element_type_2125 = torch.ops.prims.convert_element_type.default(bmm_44, torch.bfloat16);  bmm_44 = None
        view_1954 = torch.ops.aten.view.default(bmm_45, [8192, 6]);  bmm_45 = None
        view_1955 = torch.ops.aten.view.default(convert_element_type_2125, [49152, 2048]);  convert_element_type_2125 = None
        index_70 = torch.ops.aten.index.Tensor(view_1955, [getitem_245]);  view_1955 = getitem_245 = None
        permute_858 = torch.ops.aten.permute.default(view_1953, [1, 0])
        mm_362 = torch.ops.aten.mm.default(permute_858, mul_839);  permute_858 = mul_839 = None
        convert_element_type_950 = torch.ops.prims.convert_element_type.default(primals_294, torch.bfloat16);  primals_294 = None
        all_gather_into_tensor_299 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_950, 64, '0');  convert_element_type_950 = None
        wait_tensor_367 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_299);  all_gather_into_tensor_299 = None
        permute_265 = torch.ops.aten.permute.default(wait_tensor_367, [1, 0]);  wait_tensor_367 = None
        permute_860 = torch.ops.aten.permute.default(permute_265, [1, 0]);  permute_265 = None
        mm_363 = torch.ops.aten.mm.default(view_1953, permute_860);  view_1953 = permute_860 = None
        convert_element_type_2130 = torch.ops.prims.convert_element_type.default(mm_362, torch.float32);  mm_362 = None
        reduce_scatter_tensor_128 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2130, 'avg', 64, '0');  convert_element_type_2130 = None
        wait_tensor_705 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_128);  reduce_scatter_tensor_128 = None
        convert_element_type_945 = torch.ops.prims.convert_element_type.default(mm_140, torch.float32);  mm_140 = None
        neg_34 = torch.ops.aten.neg.default(convert_element_type_945)
        exp_51 = torch.ops.aten.exp.default(neg_34);  neg_34 = None
        add_1156 = torch.ops.aten.add.Tensor(exp_51, 1);  exp_51 = None
        div_85 = torch.ops.aten.div.Tensor(convert_element_type_945, add_1156)
        convert_element_type_946 = torch.ops.prims.convert_element_type.default(div_85, torch.bfloat16);  div_85 = None
        mul_1597 = torch.ops.aten.mul.Tensor(mm_363, convert_element_type_946);  convert_element_type_946 = None
        mul_1598 = torch.ops.aten.mul.Tensor(mm_363, mm_141);  mm_363 = mm_141 = None
        permute_862 = torch.ops.aten.permute.default(mul_1597, [1, 0])
        mm_364 = torch.ops.aten.mm.default(permute_862, view_1130);  permute_862 = None
        convert_element_type_947 = torch.ops.prims.convert_element_type.default(primals_293, torch.bfloat16);  primals_293 = None
        all_gather_into_tensor_298 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_947, 64, '0');  convert_element_type_947 = None
        wait_tensor_366 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_298);  all_gather_into_tensor_298 = None
        permute_264 = torch.ops.aten.permute.default(wait_tensor_366, [1, 0]);  wait_tensor_366 = None
        permute_864 = torch.ops.aten.permute.default(permute_264, [1, 0]);  permute_264 = None
        mm_365 = torch.ops.aten.mm.default(mul_1597, permute_864);  mul_1597 = permute_864 = None
        convert_element_type_2135 = torch.ops.prims.convert_element_type.default(mm_364, torch.float32);  mm_364 = None
        reduce_scatter_tensor_129 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2135, 'avg', 64, '0');  convert_element_type_2135 = None
        wait_tensor_706 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_129);  reduce_scatter_tensor_129 = None
        convert_element_type_2136 = torch.ops.prims.convert_element_type.default(mul_1598, torch.float32);  mul_1598 = None
        reciprocal_18 = torch.ops.aten.reciprocal.default(add_1156);  add_1156 = None
        mul_1599 = torch.ops.aten.mul.Tensor(reciprocal_18, 1);  reciprocal_18 = None
        mul_1600 = torch.ops.aten.mul.Tensor(convert_element_type_2136, mul_1599);  convert_element_type_2136 = None
        sub_679 = torch.ops.aten.sub.Tensor(1, mul_1599);  mul_1599 = None
        mul_1601 = torch.ops.aten.mul.Tensor(convert_element_type_945, sub_679);  convert_element_type_945 = sub_679 = None
        add_1911 = torch.ops.aten.add.Tensor(mul_1601, 1);  mul_1601 = None
        mul_1602 = torch.ops.aten.mul.Tensor(mul_1600, add_1911);  mul_1600 = add_1911 = None
        convert_element_type_2138 = torch.ops.prims.convert_element_type.default(mul_1602, torch.bfloat16);  mul_1602 = None
        permute_866 = torch.ops.aten.permute.default(convert_element_type_2138, [1, 0])
        mm_366 = torch.ops.aten.mm.default(permute_866, view_1130);  permute_866 = None
        convert_element_type_942 = torch.ops.prims.convert_element_type.default(primals_292, torch.bfloat16);  primals_292 = None
        all_gather_into_tensor_297 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_942, 64, '0');  convert_element_type_942 = None
        wait_tensor_365 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_297);  all_gather_into_tensor_297 = None
        permute_263 = torch.ops.aten.permute.default(wait_tensor_365, [1, 0]);  wait_tensor_365 = None
        permute_868 = torch.ops.aten.permute.default(permute_263, [1, 0]);  permute_263 = None
        mm_367 = torch.ops.aten.mm.default(convert_element_type_2138, permute_868);  convert_element_type_2138 = permute_868 = None
        add_1912 = torch.ops.aten.add.Tensor(mm_365, mm_367);  mm_365 = mm_367 = None
        convert_element_type_2143 = torch.ops.prims.convert_element_type.default(mm_366, torch.float32);  mm_366 = None
        reduce_scatter_tensor_130 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2143, 'avg', 64, '0');  convert_element_type_2143 = None
        wait_tensor_707 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_130);  reduce_scatter_tensor_130 = None
        all_to_all_single_96 = torch.ops._c10d_functional.all_to_all_single.default(index_70, [_local_scalar_dense_264, _local_scalar_dense_265, _local_scalar_dense_266, _local_scalar_dense_267, _local_scalar_dense_268, _local_scalar_dense_269, _local_scalar_dense_270, _local_scalar_dense_271], [_local_scalar_dense_256, _local_scalar_dense_257, _local_scalar_dense_258, _local_scalar_dense_259, _local_scalar_dense_260, _local_scalar_dense_261, _local_scalar_dense_262, _local_scalar_dense_263], '521');  index_70 = None
        wait_tensor_708 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_96);  all_to_all_single_96 = None
        full_384 = torch.ops.aten.full.default([sym_size_int_65, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_65 = None
        slice_scatter_9 = torch.ops.aten.slice_scatter.default(full_384, wait_tensor_708, 0, 0, -1);  wait_tensor_708 = None
        index_71 = torch.ops.aten.index.Tensor(slice_scatter_9, [getitem_246]);  slice_scatter_9 = None
        permute_870 = torch.ops.aten.permute.default(index_71, [1, 0])
        _grouped_mm_132 = torch.ops.aten._grouped_mm.default(permute_870, mul_819, cumsum_50);  permute_870 = mul_819 = None
        convert_element_type_936 = torch.ops.prims.convert_element_type.default(primals_290, torch.bfloat16);  primals_290 = None
        all_gather_into_tensor_293 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_936, 8, '513');  convert_element_type_936 = None
        wait_tensor_360 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_293);  all_gather_into_tensor_293 = None
        permute_262 = torch.ops.aten.permute.default(wait_tensor_360, [0, 2, 1]);  wait_tensor_360 = None
        permute_872 = torch.ops.aten.permute.default(permute_262, [0, 2, 1]);  permute_262 = None
        _grouped_mm_133 = torch.ops.aten._grouped_mm.default(index_71, permute_872, cumsum_50);  index_71 = permute_872 = None
        convert_element_type_940 = torch.ops.prims.convert_element_type.default(_grouped_mm_48, torch.float32);  _grouped_mm_48 = None
        neg_33 = torch.ops.aten.neg.default(convert_element_type_940)
        exp_50 = torch.ops.aten.exp.default(neg_33);  neg_33 = None
        add_1120 = torch.ops.aten.add.Tensor(exp_50, 1);  exp_50 = None
        div_84 = torch.ops.aten.div.Tensor(convert_element_type_940, add_1120)
        convert_element_type_941 = torch.ops.prims.convert_element_type.default(div_84, torch.bfloat16);  div_84 = None
        mul_1603 = torch.ops.aten.mul.Tensor(_grouped_mm_133, convert_element_type_941);  convert_element_type_941 = None
        mul_1604 = torch.ops.aten.mul.Tensor(_grouped_mm_133, _grouped_mm_49);  _grouped_mm_133 = _grouped_mm_49 = None
        permute_874 = torch.ops.aten.permute.default(mul_1603, [1, 0])
        _grouped_mm_134 = torch.ops.aten._grouped_mm.default(permute_874, index_33, cumsum_50);  permute_874 = None
        convert_element_type_937 = torch.ops.prims.convert_element_type.default(primals_291, torch.bfloat16);  primals_291 = None
        all_gather_into_tensor_294 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_937, 8, '513');  convert_element_type_937 = None
        wait_tensor_361 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_294);  all_gather_into_tensor_294 = None
        permute_261 = torch.ops.aten.permute.default(wait_tensor_361, [0, 2, 1]);  wait_tensor_361 = None
        permute_876 = torch.ops.aten.permute.default(permute_261, [0, 2, 1]);  permute_261 = None
        _grouped_mm_135 = torch.ops.aten._grouped_mm.default(mul_1603, permute_876, cumsum_50);  mul_1603 = permute_876 = None
        convert_element_type_2144 = torch.ops.prims.convert_element_type.default(mul_1604, torch.float32);  mul_1604 = None
        reciprocal_19 = torch.ops.aten.reciprocal.default(add_1120);  add_1120 = None
        mul_1605 = torch.ops.aten.mul.Tensor(reciprocal_19, 1);  reciprocal_19 = None
        mul_1606 = torch.ops.aten.mul.Tensor(convert_element_type_2144, mul_1605);  convert_element_type_2144 = None
        sub_680 = torch.ops.aten.sub.Tensor(1, mul_1605);  mul_1605 = None
        mul_1607 = torch.ops.aten.mul.Tensor(convert_element_type_940, sub_680);  convert_element_type_940 = sub_680 = None
        add_1914 = torch.ops.aten.add.Tensor(mul_1607, 1);  mul_1607 = None
        mul_1608 = torch.ops.aten.mul.Tensor(mul_1606, add_1914);  mul_1606 = add_1914 = None
        convert_element_type_2146 = torch.ops.prims.convert_element_type.default(mul_1608, torch.bfloat16);  mul_1608 = None
        permute_878 = torch.ops.aten.permute.default(convert_element_type_2146, [1, 0])
        _grouped_mm_136 = torch.ops.aten._grouped_mm.default(permute_878, index_33, cumsum_50);  permute_878 = index_33 = None
        convert_element_type_934 = torch.ops.prims.convert_element_type.default(primals_289, torch.bfloat16);  primals_289 = None
        all_gather_into_tensor_291 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_934, 8, '513');  convert_element_type_934 = None
        wait_tensor_358 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_291);  all_gather_into_tensor_291 = None
        permute_260 = torch.ops.aten.permute.default(wait_tensor_358, [0, 2, 1]);  wait_tensor_358 = None
        permute_880 = torch.ops.aten.permute.default(permute_260, [0, 2, 1]);  permute_260 = None
        _grouped_mm_137 = torch.ops.aten._grouped_mm.default(convert_element_type_2146, permute_880, cumsum_50);  convert_element_type_2146 = permute_880 = cumsum_50 = None
        add_1915 = torch.ops.aten.add.Tensor(_grouped_mm_135, _grouped_mm_137);  _grouped_mm_135 = _grouped_mm_137 = None
        convert_element_type_2147 = torch.ops.prims.convert_element_type.default(_grouped_mm_134, torch.float32);  _grouped_mm_134 = None
        div_186 = torch.ops.aten.div.Tensor(convert_element_type_2147, 64);  convert_element_type_2147 = None
        reduce_scatter_tensor_131 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_186, 'sum', 8, '513');  div_186 = None
        wait_tensor_709 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_131);  reduce_scatter_tensor_131 = None
        convert_element_type_2148 = torch.ops.prims.convert_element_type.default(_grouped_mm_132, torch.float32);  _grouped_mm_132 = None
        div_187 = torch.ops.aten.div.Tensor(convert_element_type_2148, 64);  convert_element_type_2148 = None
        reduce_scatter_tensor_132 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_187, 'sum', 8, '513');  div_187 = None
        wait_tensor_710 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_132);  reduce_scatter_tensor_132 = None
        convert_element_type_2149 = torch.ops.prims.convert_element_type.default(_grouped_mm_136, torch.float32);  _grouped_mm_136 = None
        div_188 = torch.ops.aten.div.Tensor(convert_element_type_2149, 64);  convert_element_type_2149 = None
        reduce_scatter_tensor_133 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_188, 'sum', 8, '513');  div_188 = None
        wait_tensor_711 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_133);  reduce_scatter_tensor_133 = None
        index_put_70 = torch.ops.aten.index_put.default(full_384, [getitem_246], add_1915, True);  full_384 = getitem_246 = add_1915 = None
        slice_161 = torch.ops.aten.slice.Tensor(index_put_70, 0, 0, add_1916);  index_put_70 = add_1916 = None
        all_to_all_single_97 = torch.ops._c10d_functional.all_to_all_single.default(slice_161, [_local_scalar_dense_256, _local_scalar_dense_257, _local_scalar_dense_258, _local_scalar_dense_259, _local_scalar_dense_260, _local_scalar_dense_261, _local_scalar_dense_262, _local_scalar_dense_263], [_local_scalar_dense_264, _local_scalar_dense_265, _local_scalar_dense_266, _local_scalar_dense_267, _local_scalar_dense_268, _local_scalar_dense_269, _local_scalar_dense_270, _local_scalar_dense_271], '521');  slice_161 = _local_scalar_dense_256 = _local_scalar_dense_257 = _local_scalar_dense_258 = _local_scalar_dense_259 = _local_scalar_dense_260 = _local_scalar_dense_261 = _local_scalar_dense_262 = _local_scalar_dense_263 = _local_scalar_dense_264 = _local_scalar_dense_265 = _local_scalar_dense_266 = _local_scalar_dense_267 = _local_scalar_dense_268 = _local_scalar_dense_269 = _local_scalar_dense_270 = _local_scalar_dense_271 = None
        wait_tensor_712 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_97);  all_to_all_single_97 = None
        index_put_71 = torch.ops.aten.index_put.default(full_default_52, [div_82], wait_tensor_712, True);  div_82 = wait_tensor_712 = None
        add_1920 = torch.ops.aten.add.Tensor(add_1912, index_put_71);  add_1912 = index_put_71 = None
        mul_1609 = torch.ops.aten.mul.Tensor(view_1954, 1.0);  view_1954 = None
        scatter_add_9 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_243, mul_1609);  getitem_243 = mul_1609 = None
        convert_element_type_929 = torch.ops.prims.convert_element_type.default(mm_139, torch.float32);  mm_139 = None
        sub_384 = torch.ops.aten.sub.Tensor(convert_element_type_929, amax_16);  convert_element_type_929 = amax_16 = None
        exp_49 = torch.ops.aten.exp.default(sub_384);  sub_384 = None
        div_81 = torch.ops.aten.div.Tensor(exp_49, sum_65);  exp_49 = sum_65 = None
        mul_1610 = torch.ops.aten.mul.Tensor(scatter_add_9, div_81);  scatter_add_9 = None
        sum_179 = torch.ops.aten.sum.dim_IntList(mul_1610, [1], True)
        neg_82 = torch.ops.aten.neg.default(div_81);  div_81 = None
        fma_9 = torch.ops.prims.fma.default(neg_82, sum_179, mul_1610);  neg_82 = sum_179 = mul_1610 = None
        convert_element_type_2150 = torch.ops.prims.convert_element_type.default(fma_9, torch.bfloat16);  fma_9 = None
        permute_882 = torch.ops.aten.permute.default(convert_element_type_2150, [1, 0])
        mm_368 = torch.ops.aten.mm.default(permute_882, view_1130);  permute_882 = view_1130 = None
        convert_element_type_926 = torch.ops.prims.convert_element_type.default(primals_287, torch.bfloat16);  primals_287 = None
        all_gather_into_tensor_290 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_926, 64, '0');  convert_element_type_926 = None
        wait_tensor_354 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_290);  all_gather_into_tensor_290 = None
        permute_259 = torch.ops.aten.permute.default(wait_tensor_354, [1, 0]);  wait_tensor_354 = None
        permute_884 = torch.ops.aten.permute.default(permute_259, [1, 0]);  permute_259 = None
        mm_369 = torch.ops.aten.mm.default(convert_element_type_2150, permute_884);  convert_element_type_2150 = permute_884 = None
        add_1921 = torch.ops.aten.add.Tensor(add_1920, mm_369);  add_1920 = mm_369 = None
        convert_element_type_2155 = torch.ops.prims.convert_element_type.default(mm_368, torch.float32);  mm_368 = None
        reduce_scatter_tensor_134 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2155, 'avg', 64, '0');  convert_element_type_2155 = None
        wait_tensor_713 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_134);  reduce_scatter_tensor_134 = None
        view_1956 = torch.ops.aten.view.default(add_1921, [2, 4096, 2048]);  add_1921 = None
        convert_element_type_2156 = torch.ops.prims.convert_element_type.default(view_1956, torch.float32);  view_1956 = None
        convert_element_type_923 = torch.ops.prims.convert_element_type.default(primals_285, torch.bfloat16);  primals_285 = None
        all_gather_into_tensor_289 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_923, 64, '0');  convert_element_type_923 = None
        wait_tensor_353 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_289);  all_gather_into_tensor_289 = None
        convert_element_type_2158 = torch.ops.prims.convert_element_type.default(wait_tensor_353, torch.float32);  wait_tensor_353 = None
        mul_1611 = torch.ops.aten.mul.Tensor(convert_element_type_2156, convert_element_type_2158);  convert_element_type_2158 = None
        convert_element_type_924 = torch.ops.prims.convert_element_type.default(add_1096, torch.float32);  add_1096 = None
        mul_799 = torch.ops.aten.mul.Tensor(convert_element_type_924, rsqrt_53);  convert_element_type_924 = None
        mul_1613 = torch.ops.aten.mul.Tensor(mul_799, mul_1611)
        sum_180 = torch.ops.aten.sum.dim_IntList(mul_1613, [2], True);  mul_1613 = None
        div_189 = torch.ops.aten.div.Tensor(mul_799, 2048)
        mul_1614 = torch.ops.aten.mul.Tensor(div_189, sum_180);  div_189 = sum_180 = None
        sub_682 = torch.ops.aten.sub.Tensor(mul_1611, mul_1614);  mul_1611 = mul_1614 = None
        mul_1615 = torch.ops.aten.mul.Tensor(sub_682, rsqrt_53);  sub_682 = rsqrt_53 = None
        mul_1616 = torch.ops.aten.mul.Tensor(convert_element_type_2156, mul_799);  convert_element_type_2156 = mul_799 = None
        sum_181 = torch.ops.aten.sum.dim_IntList(mul_1616, [0, 1]);  mul_1616 = None
        convert_element_type_2159 = torch.ops.prims.convert_element_type.default(mul_1615, torch.bfloat16);  mul_1615 = None
        add_1922 = torch.ops.aten.add.Tensor(add_1909, convert_element_type_2159);  add_1909 = convert_element_type_2159 = None
        convert_element_type_default_54 = torch.ops.prims.convert_element_type.default(sum_181, torch.float32);  sum_181 = None
        reduce_scatter_tensor_135 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_54, 'avg', 64, '0');  convert_element_type_default_54 = None
        wait_tensor_714 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_135);  reduce_scatter_tensor_135 = None
        view_1957 = torch.ops.aten.view.default(add_1922, [8192, 2048])
        permute_886 = torch.ops.aten.permute.default(view_1957, [1, 0])
        permute_257 = torch.ops.aten.permute.default(getitem_239, [0, 2, 1, 3])
        view_1125 = torch.ops.aten.view.default(permute_257, [2, 4096, -1]);  permute_257 = None
        view_1127 = torch.ops.aten.view.default(view_1125, [8192, 2048]);  view_1125 = None
        mm_370 = torch.ops.aten.mm.default(permute_886, view_1127);  permute_886 = view_1127 = None
        convert_element_type_920 = torch.ops.prims.convert_element_type.default(primals_284, torch.bfloat16);  primals_284 = None
        all_gather_into_tensor_288 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_920, 64, '0');  convert_element_type_920 = None
        wait_tensor_352 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_288);  all_gather_into_tensor_288 = None
        permute_258 = torch.ops.aten.permute.default(wait_tensor_352, [1, 0]);  wait_tensor_352 = None
        permute_888 = torch.ops.aten.permute.default(permute_258, [1, 0]);  permute_258 = None
        mm_371 = torch.ops.aten.mm.default(view_1957, permute_888);  view_1957 = permute_888 = None
        view_1958 = torch.ops.aten.view.default(mm_371, [2, 4096, 2048]);  mm_371 = None
        convert_element_type_2166 = torch.ops.prims.convert_element_type.default(mm_370, torch.float32);  mm_370 = None
        reduce_scatter_tensor_136 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2166, 'avg', 64, '0');  convert_element_type_2166 = None
        wait_tensor_715 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_136);  reduce_scatter_tensor_136 = None
        view_1959 = torch.ops.aten.view.default(view_1958, [2, 4096, 16, 128]);  view_1958 = None
        permute_890 = torch.ops.aten.permute.default(view_1959, [0, 2, 1, 3]);  view_1959 = None
        fw_graph9 = self.fw_graph9
        joint_graph9 = self.joint_graph9
        mask_graph9 = self.mask_graph9
        flex_attention_backward_9 = torch.ops.higher_order.flex_attention_backward(permute_254, permute_255, permute_256, getitem_239, getitem_240, permute_890, None, fw_graph9, joint_graph9, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph9), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_254 = permute_255 = permute_256 = getitem_239 = getitem_240 = permute_890 = fw_graph9 = joint_graph9 = mask_graph9 = None
        getitem_409 = flex_attention_backward_9[0]
        getitem_410 = flex_attention_backward_9[1]
        getitem_411 = flex_attention_backward_9[2];  flex_attention_backward_9 = None
        permute_891 = torch.ops.aten.permute.default(getitem_411, [0, 2, 1, 3]);  getitem_411 = None
        permute_892 = torch.ops.aten.permute.default(getitem_410, [0, 2, 1, 3]);  getitem_410 = None
        permute_893 = torch.ops.aten.permute.default(getitem_409, [0, 2, 1, 3]);  getitem_409 = None
        slice_163 = torch.ops.aten.slice.Tensor(permute_892, 3, 0, 128)
        slice_164 = torch.ops.aten.slice.Tensor(permute_892, 3, 128, 192);  permute_892 = None
        sum_182 = torch.ops.aten.sum.dim_IntList(slice_164, [2], True);  slice_164 = None
        cat_107 = torch.ops.aten.cat.default([slice_163, permute_891], 3);  slice_163 = permute_891 = None
        view_1960 = torch.ops.aten.view.default(cat_107, [2, 4096, 4096]);  cat_107 = None
        view_1961 = torch.ops.aten.view.default(view_1960, [8192, 4096]);  view_1960 = None
        permute_894 = torch.ops.aten.permute.default(view_1961, [1, 0])
        mm_372 = torch.ops.aten.mm.default(permute_894, view_1122);  permute_894 = view_1122 = None
        convert_element_type_917 = torch.ops.prims.convert_element_type.default(primals_283, torch.bfloat16);  primals_283 = None
        all_gather_into_tensor_287 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_917, 64, '0');  convert_element_type_917 = None
        wait_tensor_351 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_287);  all_gather_into_tensor_287 = None
        permute_253 = torch.ops.aten.permute.default(wait_tensor_351, [1, 0]);  wait_tensor_351 = None
        permute_896 = torch.ops.aten.permute.default(permute_253, [1, 0]);  permute_253 = None
        mm_373 = torch.ops.aten.mm.default(view_1961, permute_896);  view_1961 = permute_896 = None
        view_1962 = torch.ops.aten.view.default(mm_373, [2, 4096, 512]);  mm_373 = None
        convert_element_type_2171 = torch.ops.prims.convert_element_type.default(mm_372, torch.float32);  mm_372 = None
        reduce_scatter_tensor_137 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2171, 'avg', 64, '0');  convert_element_type_2171 = None
        wait_tensor_716 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_137);  reduce_scatter_tensor_137 = None
        convert_element_type_2172 = torch.ops.prims.convert_element_type.default(view_1962, torch.float32);  view_1962 = None
        convert_element_type_914 = torch.ops.prims.convert_element_type.default(primals_282, torch.bfloat16);  primals_282 = None
        all_gather_into_tensor_286 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_914, 64, '0');  convert_element_type_914 = None
        wait_tensor_350 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_286);  all_gather_into_tensor_286 = None
        convert_element_type_2174 = torch.ops.prims.convert_element_type.default(wait_tensor_350, torch.float32);  wait_tensor_350 = None
        mul_1617 = torch.ops.aten.mul.Tensor(convert_element_type_2172, convert_element_type_2174);  convert_element_type_2174 = None
        convert_element_type_915 = torch.ops.prims.convert_element_type.default(getitem_235, torch.float32);  getitem_235 = None
        mul_797 = torch.ops.aten.mul.Tensor(convert_element_type_915, rsqrt_52);  convert_element_type_915 = None
        mul_1619 = torch.ops.aten.mul.Tensor(mul_797, mul_1617)
        sum_183 = torch.ops.aten.sum.dim_IntList(mul_1619, [2], True);  mul_1619 = None
        div_190 = torch.ops.aten.div.Tensor(mul_797, 512)
        mul_1620 = torch.ops.aten.mul.Tensor(div_190, sum_183);  div_190 = sum_183 = None
        sub_683 = torch.ops.aten.sub.Tensor(mul_1617, mul_1620);  mul_1617 = mul_1620 = None
        mul_1621 = torch.ops.aten.mul.Tensor(sub_683, rsqrt_52);  sub_683 = rsqrt_52 = None
        mul_1622 = torch.ops.aten.mul.Tensor(convert_element_type_2172, mul_797);  convert_element_type_2172 = mul_797 = None
        sum_184 = torch.ops.aten.sum.dim_IntList(mul_1622, [0, 1]);  mul_1622 = None
        convert_element_type_2175 = torch.ops.prims.convert_element_type.default(mul_1621, torch.bfloat16);  mul_1621 = None
        convert_element_type_default_53 = torch.ops.prims.convert_element_type.default(sum_184, torch.float32);  sum_184 = None
        reduce_scatter_tensor_138 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_53, 'avg', 64, '0');  convert_element_type_default_53 = None
        wait_tensor_717 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_138);  reduce_scatter_tensor_138 = None
        convert_element_type_2178 = torch.ops.prims.convert_element_type.default(sum_182, torch.float32);  sum_182 = None
        view_1963 = torch.ops.aten.view.default(convert_element_type_2178, [2, 4096, 1, 32, 2]);  convert_element_type_2178 = None
        view_as_complex_72 = torch.ops.aten.view_as_complex.default(view_1963);  view_1963 = None
        mul_1623 = torch.ops.aten.mul.Tensor(view_as_complex_72, clone_9);  view_as_complex_72 = None
        view_as_real_72 = torch.ops.aten.view_as_real.default(mul_1623);  mul_1623 = None
        view_1964 = torch.ops.aten.view.default(view_as_real_72, [2, 4096, 1, 64]);  view_as_real_72 = None
        convert_element_type_2179 = torch.ops.prims.convert_element_type.default(view_1964, torch.bfloat16);  view_1964 = None
        squeeze_35 = torch.ops.aten.squeeze.dim(convert_element_type_2179, 2);  convert_element_type_2179 = None
        cat_108 = torch.ops.aten.cat.default([convert_element_type_2175, squeeze_35], 2);  convert_element_type_2175 = squeeze_35 = None
        view_1965 = torch.ops.aten.view.default(cat_108, [8192, 576]);  cat_108 = None
        permute_898 = torch.ops.aten.permute.default(view_1965, [1, 0])
        mm_374 = torch.ops.aten.mm.default(permute_898, view_1108);  permute_898 = None
        convert_element_type_909 = torch.ops.prims.convert_element_type.default(primals_281, torch.bfloat16);  primals_281 = None
        all_gather_into_tensor_285 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_909, 64, '0');  convert_element_type_909 = None
        wait_tensor_349 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_285);  all_gather_into_tensor_285 = None
        permute_252 = torch.ops.aten.permute.default(wait_tensor_349, [1, 0]);  wait_tensor_349 = None
        permute_900 = torch.ops.aten.permute.default(permute_252, [1, 0]);  permute_252 = None
        mm_375 = torch.ops.aten.mm.default(view_1965, permute_900);  view_1965 = permute_900 = None
        view_1966 = torch.ops.aten.view.default(mm_375, [2, 4096, 2048]);  mm_375 = None
        convert_element_type_2184 = torch.ops.prims.convert_element_type.default(mm_374, torch.float32);  mm_374 = None
        reduce_scatter_tensor_139 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2184, 'avg', 64, '0');  convert_element_type_2184 = None
        wait_tensor_718 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_139);  reduce_scatter_tensor_139 = None
        slice_165 = torch.ops.aten.slice.Tensor(permute_893, 3, 0, 128)
        slice_166 = torch.ops.aten.slice.Tensor(permute_893, 3, 128, 192);  permute_893 = None
        convert_element_type_2185 = torch.ops.prims.convert_element_type.default(slice_166, torch.float32);  slice_166 = None
        view_1967 = torch.ops.aten.view.default(convert_element_type_2185, [2, 4096, 16, 32, 2]);  convert_element_type_2185 = None
        view_as_complex_73 = torch.ops.aten.view_as_complex.default(view_1967);  view_1967 = None
        mul_1624 = torch.ops.aten.mul.Tensor(view_as_complex_73, clone_9);  view_as_complex_73 = None
        view_as_real_73 = torch.ops.aten.view_as_real.default(mul_1624);  mul_1624 = None
        view_1968 = torch.ops.aten.view.default(view_as_real_73, [2, 4096, 16, 64]);  view_as_real_73 = None
        convert_element_type_2186 = torch.ops.prims.convert_element_type.default(view_1968, torch.bfloat16);  view_1968 = None
        cat_109 = torch.ops.aten.cat.default([slice_165, convert_element_type_2186], 3);  slice_165 = convert_element_type_2186 = None
        view_1969 = torch.ops.aten.view.default(cat_109, [2, 4096, 3072]);  cat_109 = None
        view_1970 = torch.ops.aten.view.default(view_1969, [8192, 3072]);  view_1969 = None
        permute_902 = torch.ops.aten.permute.default(view_1970, [1, 0])
        mm_376 = torch.ops.aten.mm.default(permute_902, view_1108);  permute_902 = view_1108 = None
        convert_element_type_904 = torch.ops.prims.convert_element_type.default(primals_280, torch.bfloat16);  primals_280 = None
        all_gather_into_tensor_284 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_904, 64, '0');  convert_element_type_904 = None
        wait_tensor_348 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_284);  all_gather_into_tensor_284 = None
        permute_251 = torch.ops.aten.permute.default(wait_tensor_348, [1, 0]);  wait_tensor_348 = None
        permute_904 = torch.ops.aten.permute.default(permute_251, [1, 0]);  permute_251 = None
        mm_377 = torch.ops.aten.mm.default(view_1970, permute_904);  view_1970 = permute_904 = None
        view_1971 = torch.ops.aten.view.default(mm_377, [2, 4096, 2048]);  mm_377 = None
        add_1923 = torch.ops.aten.add.Tensor(view_1966, view_1971);  view_1966 = view_1971 = None
        convert_element_type_2191 = torch.ops.prims.convert_element_type.default(mm_376, torch.float32);  mm_376 = None
        reduce_scatter_tensor_140 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2191, 'avg', 64, '0');  convert_element_type_2191 = None
        wait_tensor_719 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_140);  reduce_scatter_tensor_140 = None
        convert_element_type_2192 = torch.ops.prims.convert_element_type.default(add_1923, torch.float32);  add_1923 = None
        convert_element_type_901 = torch.ops.prims.convert_element_type.default(primals_279, torch.bfloat16);  primals_279 = None
        all_gather_into_tensor_283 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_901, 64, '0');  convert_element_type_901 = None
        wait_tensor_347 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_283);  all_gather_into_tensor_283 = None
        convert_element_type_2194 = torch.ops.prims.convert_element_type.default(wait_tensor_347, torch.float32);  wait_tensor_347 = None
        mul_1625 = torch.ops.aten.mul.Tensor(convert_element_type_2192, convert_element_type_2194);  convert_element_type_2194 = None
        convert_element_type_902 = torch.ops.prims.convert_element_type.default(add_1093, torch.float32);  add_1093 = None
        mul_793 = torch.ops.aten.mul.Tensor(convert_element_type_902, rsqrt_51);  convert_element_type_902 = None
        mul_1627 = torch.ops.aten.mul.Tensor(mul_793, mul_1625)
        sum_185 = torch.ops.aten.sum.dim_IntList(mul_1627, [2], True);  mul_1627 = None
        div_191 = torch.ops.aten.div.Tensor(mul_793, 2048)
        mul_1628 = torch.ops.aten.mul.Tensor(div_191, sum_185);  div_191 = sum_185 = None
        sub_684 = torch.ops.aten.sub.Tensor(mul_1625, mul_1628);  mul_1625 = mul_1628 = None
        mul_1629 = torch.ops.aten.mul.Tensor(sub_684, rsqrt_51);  sub_684 = rsqrt_51 = None
        mul_1630 = torch.ops.aten.mul.Tensor(convert_element_type_2192, mul_793);  convert_element_type_2192 = mul_793 = None
        sum_186 = torch.ops.aten.sum.dim_IntList(mul_1630, [0, 1]);  mul_1630 = None
        convert_element_type_2195 = torch.ops.prims.convert_element_type.default(mul_1629, torch.bfloat16);  mul_1629 = None
        add_1924 = torch.ops.aten.add.Tensor(add_1922, convert_element_type_2195);  add_1922 = convert_element_type_2195 = None
        convert_element_type_default_52 = torch.ops.prims.convert_element_type.default(sum_186, torch.float32);  sum_186 = None
        reduce_scatter_tensor_141 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_52, 'avg', 64, '0');  convert_element_type_default_52 = None
        wait_tensor_720 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_141);  reduce_scatter_tensor_141 = None
        view_1972 = torch.ops.aten.view.default(add_1924, [8192, 2048])
        unsqueeze_63 = torch.ops.aten.unsqueeze.default(view_1972, 1)
        convert_element_type_2198 = torch.ops.prims.convert_element_type.default(unsqueeze_63, torch.float32);  unsqueeze_63 = None
        bmm_46 = torch.ops.aten.bmm.default(permute_906, convert_element_type_2198);  permute_906 = None
        bmm_47 = torch.ops.aten.bmm.default(convert_element_type_2198, permute_907);  convert_element_type_2198 = permute_907 = None
        convert_element_type_2199 = torch.ops.prims.convert_element_type.default(bmm_46, torch.bfloat16);  bmm_46 = None
        view_1973 = torch.ops.aten.view.default(bmm_47, [8192, 6]);  bmm_47 = None
        view_1974 = torch.ops.aten.view.default(convert_element_type_2199, [49152, 2048]);  convert_element_type_2199 = None
        index_72 = torch.ops.aten.index.Tensor(view_1974, [getitem_231]);  view_1974 = getitem_231 = None
        permute_908 = torch.ops.aten.permute.default(view_1972, [1, 0])
        mm_378 = torch.ops.aten.mm.default(permute_908, mul_790);  permute_908 = mul_790 = None
        convert_element_type_896 = torch.ops.prims.convert_element_type.default(primals_278, torch.bfloat16);  primals_278 = None
        all_gather_into_tensor_282 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_896, 64, '0');  convert_element_type_896 = None
        wait_tensor_346 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_282);  all_gather_into_tensor_282 = None
        permute_250 = torch.ops.aten.permute.default(wait_tensor_346, [1, 0]);  wait_tensor_346 = None
        permute_910 = torch.ops.aten.permute.default(permute_250, [1, 0]);  permute_250 = None
        mm_379 = torch.ops.aten.mm.default(view_1972, permute_910);  view_1972 = permute_910 = None
        convert_element_type_2204 = torch.ops.prims.convert_element_type.default(mm_378, torch.float32);  mm_378 = None
        reduce_scatter_tensor_142 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2204, 'avg', 64, '0');  convert_element_type_2204 = None
        wait_tensor_721 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_142);  reduce_scatter_tensor_142 = None
        convert_element_type_891 = torch.ops.prims.convert_element_type.default(mm_132, torch.float32);  mm_132 = None
        neg_32 = torch.ops.aten.neg.default(convert_element_type_891)
        exp_48 = torch.ops.aten.exp.default(neg_32);  neg_32 = None
        add_1088 = torch.ops.aten.add.Tensor(exp_48, 1);  exp_48 = None
        div_80 = torch.ops.aten.div.Tensor(convert_element_type_891, add_1088)
        convert_element_type_892 = torch.ops.prims.convert_element_type.default(div_80, torch.bfloat16);  div_80 = None
        mul_1631 = torch.ops.aten.mul.Tensor(mm_379, convert_element_type_892);  convert_element_type_892 = None
        mul_1632 = torch.ops.aten.mul.Tensor(mm_379, mm_133);  mm_379 = mm_133 = None
        permute_912 = torch.ops.aten.permute.default(mul_1631, [1, 0])
        mm_380 = torch.ops.aten.mm.default(permute_912, view_1063);  permute_912 = None
        convert_element_type_893 = torch.ops.prims.convert_element_type.default(primals_277, torch.bfloat16);  primals_277 = None
        all_gather_into_tensor_281 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_893, 64, '0');  convert_element_type_893 = None
        wait_tensor_345 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_281);  all_gather_into_tensor_281 = None
        permute_249 = torch.ops.aten.permute.default(wait_tensor_345, [1, 0]);  wait_tensor_345 = None
        permute_914 = torch.ops.aten.permute.default(permute_249, [1, 0]);  permute_249 = None
        mm_381 = torch.ops.aten.mm.default(mul_1631, permute_914);  mul_1631 = permute_914 = None
        convert_element_type_2209 = torch.ops.prims.convert_element_type.default(mm_380, torch.float32);  mm_380 = None
        reduce_scatter_tensor_143 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2209, 'avg', 64, '0');  convert_element_type_2209 = None
        wait_tensor_722 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_143);  reduce_scatter_tensor_143 = None
        convert_element_type_2210 = torch.ops.prims.convert_element_type.default(mul_1632, torch.float32);  mul_1632 = None
        reciprocal_20 = torch.ops.aten.reciprocal.default(add_1088);  add_1088 = None
        mul_1633 = torch.ops.aten.mul.Tensor(reciprocal_20, 1);  reciprocal_20 = None
        mul_1634 = torch.ops.aten.mul.Tensor(convert_element_type_2210, mul_1633);  convert_element_type_2210 = None
        sub_685 = torch.ops.aten.sub.Tensor(1, mul_1633);  mul_1633 = None
        mul_1635 = torch.ops.aten.mul.Tensor(convert_element_type_891, sub_685);  convert_element_type_891 = sub_685 = None
        add_1926 = torch.ops.aten.add.Tensor(mul_1635, 1);  mul_1635 = None
        mul_1636 = torch.ops.aten.mul.Tensor(mul_1634, add_1926);  mul_1634 = add_1926 = None
        convert_element_type_2212 = torch.ops.prims.convert_element_type.default(mul_1636, torch.bfloat16);  mul_1636 = None
        permute_916 = torch.ops.aten.permute.default(convert_element_type_2212, [1, 0])
        mm_382 = torch.ops.aten.mm.default(permute_916, view_1063);  permute_916 = None
        convert_element_type_888 = torch.ops.prims.convert_element_type.default(primals_276, torch.bfloat16);  primals_276 = None
        all_gather_into_tensor_280 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_888, 64, '0');  convert_element_type_888 = None
        wait_tensor_344 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_280);  all_gather_into_tensor_280 = None
        permute_248 = torch.ops.aten.permute.default(wait_tensor_344, [1, 0]);  wait_tensor_344 = None
        permute_918 = torch.ops.aten.permute.default(permute_248, [1, 0]);  permute_248 = None
        mm_383 = torch.ops.aten.mm.default(convert_element_type_2212, permute_918);  convert_element_type_2212 = permute_918 = None
        add_1927 = torch.ops.aten.add.Tensor(mm_381, mm_383);  mm_381 = mm_383 = None
        convert_element_type_2217 = torch.ops.prims.convert_element_type.default(mm_382, torch.float32);  mm_382 = None
        reduce_scatter_tensor_144 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2217, 'avg', 64, '0');  convert_element_type_2217 = None
        wait_tensor_723 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_144);  reduce_scatter_tensor_144 = None
        all_to_all_single_98 = torch.ops._c10d_functional.all_to_all_single.default(index_72, [_local_scalar_dense_248, _local_scalar_dense_249, _local_scalar_dense_250, _local_scalar_dense_251, _local_scalar_dense_252, _local_scalar_dense_253, _local_scalar_dense_254, _local_scalar_dense_255], [_local_scalar_dense_240, _local_scalar_dense_241, _local_scalar_dense_242, _local_scalar_dense_243, _local_scalar_dense_244, _local_scalar_dense_245, _local_scalar_dense_246, _local_scalar_dense_247], '521');  index_72 = None
        wait_tensor_724 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_98);  all_to_all_single_98 = None
        full_388 = torch.ops.aten.full.default([sym_size_int_61, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_61 = None
        slice_scatter_10 = torch.ops.aten.slice_scatter.default(full_388, wait_tensor_724, 0, 0, -1);  wait_tensor_724 = None
        index_73 = torch.ops.aten.index.Tensor(slice_scatter_10, [getitem_232]);  slice_scatter_10 = None
        permute_920 = torch.ops.aten.permute.default(index_73, [1, 0])
        _grouped_mm_138 = torch.ops.aten._grouped_mm.default(permute_920, mul_770, cumsum_47);  permute_920 = mul_770 = None
        convert_element_type_882 = torch.ops.prims.convert_element_type.default(primals_274, torch.bfloat16);  primals_274 = None
        all_gather_into_tensor_276 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_882, 8, '513');  convert_element_type_882 = None
        wait_tensor_339 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_276);  all_gather_into_tensor_276 = None
        permute_247 = torch.ops.aten.permute.default(wait_tensor_339, [0, 2, 1]);  wait_tensor_339 = None
        permute_922 = torch.ops.aten.permute.default(permute_247, [0, 2, 1]);  permute_247 = None
        _grouped_mm_139 = torch.ops.aten._grouped_mm.default(index_73, permute_922, cumsum_47);  index_73 = permute_922 = None
        convert_element_type_886 = torch.ops.prims.convert_element_type.default(_grouped_mm_45, torch.float32);  _grouped_mm_45 = None
        neg_31 = torch.ops.aten.neg.default(convert_element_type_886)
        exp_47 = torch.ops.aten.exp.default(neg_31);  neg_31 = None
        add_1052 = torch.ops.aten.add.Tensor(exp_47, 1);  exp_47 = None
        div_79 = torch.ops.aten.div.Tensor(convert_element_type_886, add_1052)
        convert_element_type_887 = torch.ops.prims.convert_element_type.default(div_79, torch.bfloat16);  div_79 = None
        mul_1637 = torch.ops.aten.mul.Tensor(_grouped_mm_139, convert_element_type_887);  convert_element_type_887 = None
        mul_1638 = torch.ops.aten.mul.Tensor(_grouped_mm_139, _grouped_mm_46);  _grouped_mm_139 = _grouped_mm_46 = None
        permute_924 = torch.ops.aten.permute.default(mul_1637, [1, 0])
        _grouped_mm_140 = torch.ops.aten._grouped_mm.default(permute_924, index_31, cumsum_47);  permute_924 = None
        convert_element_type_883 = torch.ops.prims.convert_element_type.default(primals_275, torch.bfloat16);  primals_275 = None
        all_gather_into_tensor_277 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_883, 8, '513');  convert_element_type_883 = None
        wait_tensor_340 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_277);  all_gather_into_tensor_277 = None
        permute_246 = torch.ops.aten.permute.default(wait_tensor_340, [0, 2, 1]);  wait_tensor_340 = None
        permute_926 = torch.ops.aten.permute.default(permute_246, [0, 2, 1]);  permute_246 = None
        _grouped_mm_141 = torch.ops.aten._grouped_mm.default(mul_1637, permute_926, cumsum_47);  mul_1637 = permute_926 = None
        convert_element_type_2218 = torch.ops.prims.convert_element_type.default(mul_1638, torch.float32);  mul_1638 = None
        reciprocal_21 = torch.ops.aten.reciprocal.default(add_1052);  add_1052 = None
        mul_1639 = torch.ops.aten.mul.Tensor(reciprocal_21, 1);  reciprocal_21 = None
        mul_1640 = torch.ops.aten.mul.Tensor(convert_element_type_2218, mul_1639);  convert_element_type_2218 = None
        sub_686 = torch.ops.aten.sub.Tensor(1, mul_1639);  mul_1639 = None
        mul_1641 = torch.ops.aten.mul.Tensor(convert_element_type_886, sub_686);  convert_element_type_886 = sub_686 = None
        add_1929 = torch.ops.aten.add.Tensor(mul_1641, 1);  mul_1641 = None
        mul_1642 = torch.ops.aten.mul.Tensor(mul_1640, add_1929);  mul_1640 = add_1929 = None
        convert_element_type_2220 = torch.ops.prims.convert_element_type.default(mul_1642, torch.bfloat16);  mul_1642 = None
        permute_928 = torch.ops.aten.permute.default(convert_element_type_2220, [1, 0])
        _grouped_mm_142 = torch.ops.aten._grouped_mm.default(permute_928, index_31, cumsum_47);  permute_928 = index_31 = None
        convert_element_type_880 = torch.ops.prims.convert_element_type.default(primals_273, torch.bfloat16);  primals_273 = None
        all_gather_into_tensor_274 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_880, 8, '513');  convert_element_type_880 = None
        wait_tensor_337 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_274);  all_gather_into_tensor_274 = None
        permute_245 = torch.ops.aten.permute.default(wait_tensor_337, [0, 2, 1]);  wait_tensor_337 = None
        permute_930 = torch.ops.aten.permute.default(permute_245, [0, 2, 1]);  permute_245 = None
        _grouped_mm_143 = torch.ops.aten._grouped_mm.default(convert_element_type_2220, permute_930, cumsum_47);  convert_element_type_2220 = permute_930 = cumsum_47 = None
        add_1930 = torch.ops.aten.add.Tensor(_grouped_mm_141, _grouped_mm_143);  _grouped_mm_141 = _grouped_mm_143 = None
        convert_element_type_2221 = torch.ops.prims.convert_element_type.default(_grouped_mm_140, torch.float32);  _grouped_mm_140 = None
        div_192 = torch.ops.aten.div.Tensor(convert_element_type_2221, 64);  convert_element_type_2221 = None
        reduce_scatter_tensor_145 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_192, 'sum', 8, '513');  div_192 = None
        wait_tensor_725 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_145);  reduce_scatter_tensor_145 = None
        convert_element_type_2222 = torch.ops.prims.convert_element_type.default(_grouped_mm_138, torch.float32);  _grouped_mm_138 = None
        div_193 = torch.ops.aten.div.Tensor(convert_element_type_2222, 64);  convert_element_type_2222 = None
        reduce_scatter_tensor_146 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_193, 'sum', 8, '513');  div_193 = None
        wait_tensor_726 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_146);  reduce_scatter_tensor_146 = None
        convert_element_type_2223 = torch.ops.prims.convert_element_type.default(_grouped_mm_142, torch.float32);  _grouped_mm_142 = None
        div_194 = torch.ops.aten.div.Tensor(convert_element_type_2223, 64);  convert_element_type_2223 = None
        reduce_scatter_tensor_147 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_194, 'sum', 8, '513');  div_194 = None
        wait_tensor_727 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_147);  reduce_scatter_tensor_147 = None
        index_put_72 = torch.ops.aten.index_put.default(full_388, [getitem_232], add_1930, True);  full_388 = getitem_232 = add_1930 = None
        slice_167 = torch.ops.aten.slice.Tensor(index_put_72, 0, 0, add_1931);  index_put_72 = add_1931 = None
        all_to_all_single_99 = torch.ops._c10d_functional.all_to_all_single.default(slice_167, [_local_scalar_dense_240, _local_scalar_dense_241, _local_scalar_dense_242, _local_scalar_dense_243, _local_scalar_dense_244, _local_scalar_dense_245, _local_scalar_dense_246, _local_scalar_dense_247], [_local_scalar_dense_248, _local_scalar_dense_249, _local_scalar_dense_250, _local_scalar_dense_251, _local_scalar_dense_252, _local_scalar_dense_253, _local_scalar_dense_254, _local_scalar_dense_255], '521');  slice_167 = _local_scalar_dense_240 = _local_scalar_dense_241 = _local_scalar_dense_242 = _local_scalar_dense_243 = _local_scalar_dense_244 = _local_scalar_dense_245 = _local_scalar_dense_246 = _local_scalar_dense_247 = _local_scalar_dense_248 = _local_scalar_dense_249 = _local_scalar_dense_250 = _local_scalar_dense_251 = _local_scalar_dense_252 = _local_scalar_dense_253 = _local_scalar_dense_254 = _local_scalar_dense_255 = None
        wait_tensor_728 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_99);  all_to_all_single_99 = None
        index_put_73 = torch.ops.aten.index_put.default(full_default_52, [div_77], wait_tensor_728, True);  div_77 = wait_tensor_728 = None
        add_1935 = torch.ops.aten.add.Tensor(add_1927, index_put_73);  add_1927 = index_put_73 = None
        mul_1643 = torch.ops.aten.mul.Tensor(view_1973, 1.0);  view_1973 = None
        scatter_add_10 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_229, mul_1643);  getitem_229 = mul_1643 = None
        convert_element_type_875 = torch.ops.prims.convert_element_type.default(mm_131, torch.float32);  mm_131 = None
        sub_360 = torch.ops.aten.sub.Tensor(convert_element_type_875, amax_15);  convert_element_type_875 = amax_15 = None
        exp_46 = torch.ops.aten.exp.default(sub_360);  sub_360 = None
        div_76 = torch.ops.aten.div.Tensor(exp_46, sum_61);  exp_46 = sum_61 = None
        mul_1644 = torch.ops.aten.mul.Tensor(scatter_add_10, div_76);  scatter_add_10 = None
        sum_187 = torch.ops.aten.sum.dim_IntList(mul_1644, [1], True)
        neg_85 = torch.ops.aten.neg.default(div_76);  div_76 = None
        fma_10 = torch.ops.prims.fma.default(neg_85, sum_187, mul_1644);  neg_85 = sum_187 = mul_1644 = None
        convert_element_type_2224 = torch.ops.prims.convert_element_type.default(fma_10, torch.bfloat16);  fma_10 = None
        permute_932 = torch.ops.aten.permute.default(convert_element_type_2224, [1, 0])
        mm_384 = torch.ops.aten.mm.default(permute_932, view_1063);  permute_932 = view_1063 = None
        convert_element_type_872 = torch.ops.prims.convert_element_type.default(primals_271, torch.bfloat16);  primals_271 = None
        all_gather_into_tensor_273 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_872, 64, '0');  convert_element_type_872 = None
        wait_tensor_333 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_273);  all_gather_into_tensor_273 = None
        permute_244 = torch.ops.aten.permute.default(wait_tensor_333, [1, 0]);  wait_tensor_333 = None
        permute_934 = torch.ops.aten.permute.default(permute_244, [1, 0]);  permute_244 = None
        mm_385 = torch.ops.aten.mm.default(convert_element_type_2224, permute_934);  convert_element_type_2224 = permute_934 = None
        add_1936 = torch.ops.aten.add.Tensor(add_1935, mm_385);  add_1935 = mm_385 = None
        convert_element_type_2229 = torch.ops.prims.convert_element_type.default(mm_384, torch.float32);  mm_384 = None
        reduce_scatter_tensor_148 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2229, 'avg', 64, '0');  convert_element_type_2229 = None
        wait_tensor_729 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_148);  reduce_scatter_tensor_148 = None
        view_1975 = torch.ops.aten.view.default(add_1936, [2, 4096, 2048]);  add_1936 = None
        convert_element_type_2230 = torch.ops.prims.convert_element_type.default(view_1975, torch.float32);  view_1975 = None
        convert_element_type_869 = torch.ops.prims.convert_element_type.default(primals_269, torch.bfloat16);  primals_269 = None
        all_gather_into_tensor_272 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_869, 64, '0');  convert_element_type_869 = None
        wait_tensor_332 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_272);  all_gather_into_tensor_272 = None
        convert_element_type_2232 = torch.ops.prims.convert_element_type.default(wait_tensor_332, torch.float32);  wait_tensor_332 = None
        mul_1645 = torch.ops.aten.mul.Tensor(convert_element_type_2230, convert_element_type_2232);  convert_element_type_2232 = None
        convert_element_type_870 = torch.ops.prims.convert_element_type.default(add_1028, torch.float32);  add_1028 = None
        mul_750 = torch.ops.aten.mul.Tensor(convert_element_type_870, rsqrt_50);  convert_element_type_870 = None
        mul_1647 = torch.ops.aten.mul.Tensor(mul_750, mul_1645)
        sum_188 = torch.ops.aten.sum.dim_IntList(mul_1647, [2], True);  mul_1647 = None
        div_195 = torch.ops.aten.div.Tensor(mul_750, 2048)
        mul_1648 = torch.ops.aten.mul.Tensor(div_195, sum_188);  div_195 = sum_188 = None
        sub_688 = torch.ops.aten.sub.Tensor(mul_1645, mul_1648);  mul_1645 = mul_1648 = None
        mul_1649 = torch.ops.aten.mul.Tensor(sub_688, rsqrt_50);  sub_688 = rsqrt_50 = None
        mul_1650 = torch.ops.aten.mul.Tensor(convert_element_type_2230, mul_750);  convert_element_type_2230 = mul_750 = None
        sum_189 = torch.ops.aten.sum.dim_IntList(mul_1650, [0, 1]);  mul_1650 = None
        convert_element_type_2233 = torch.ops.prims.convert_element_type.default(mul_1649, torch.bfloat16);  mul_1649 = None
        add_1937 = torch.ops.aten.add.Tensor(add_1924, convert_element_type_2233);  add_1924 = convert_element_type_2233 = None
        convert_element_type_default_51 = torch.ops.prims.convert_element_type.default(sum_189, torch.float32);  sum_189 = None
        reduce_scatter_tensor_149 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_51, 'avg', 64, '0');  convert_element_type_default_51 = None
        wait_tensor_730 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_149);  reduce_scatter_tensor_149 = None
        view_1976 = torch.ops.aten.view.default(add_1937, [8192, 2048])
        permute_936 = torch.ops.aten.permute.default(view_1976, [1, 0])
        permute_242 = torch.ops.aten.permute.default(getitem_225, [0, 2, 1, 3])
        view_1058 = torch.ops.aten.view.default(permute_242, [2, 4096, -1]);  permute_242 = None
        view_1060 = torch.ops.aten.view.default(view_1058, [8192, 2048]);  view_1058 = None
        mm_386 = torch.ops.aten.mm.default(permute_936, view_1060);  permute_936 = view_1060 = None
        convert_element_type_866 = torch.ops.prims.convert_element_type.default(primals_268, torch.bfloat16);  primals_268 = None
        all_gather_into_tensor_271 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_866, 64, '0');  convert_element_type_866 = None
        wait_tensor_331 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_271);  all_gather_into_tensor_271 = None
        permute_243 = torch.ops.aten.permute.default(wait_tensor_331, [1, 0]);  wait_tensor_331 = None
        permute_938 = torch.ops.aten.permute.default(permute_243, [1, 0]);  permute_243 = None
        mm_387 = torch.ops.aten.mm.default(view_1976, permute_938);  view_1976 = permute_938 = None
        view_1977 = torch.ops.aten.view.default(mm_387, [2, 4096, 2048]);  mm_387 = None
        convert_element_type_2240 = torch.ops.prims.convert_element_type.default(mm_386, torch.float32);  mm_386 = None
        reduce_scatter_tensor_150 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2240, 'avg', 64, '0');  convert_element_type_2240 = None
        wait_tensor_731 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_150);  reduce_scatter_tensor_150 = None
        view_1978 = torch.ops.aten.view.default(view_1977, [2, 4096, 16, 128]);  view_1977 = None
        permute_940 = torch.ops.aten.permute.default(view_1978, [0, 2, 1, 3]);  view_1978 = None
        fw_graph10 = self.fw_graph10
        joint_graph10 = self.joint_graph10
        mask_graph10 = self.mask_graph10
        flex_attention_backward_10 = torch.ops.higher_order.flex_attention_backward(permute_239, permute_240, permute_241, getitem_225, getitem_226, permute_940, None, fw_graph10, joint_graph10, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph10), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_239 = permute_240 = permute_241 = getitem_225 = getitem_226 = permute_940 = fw_graph10 = joint_graph10 = mask_graph10 = None
        getitem_413 = flex_attention_backward_10[0]
        getitem_414 = flex_attention_backward_10[1]
        getitem_415 = flex_attention_backward_10[2];  flex_attention_backward_10 = None
        permute_941 = torch.ops.aten.permute.default(getitem_415, [0, 2, 1, 3]);  getitem_415 = None
        permute_942 = torch.ops.aten.permute.default(getitem_414, [0, 2, 1, 3]);  getitem_414 = None
        permute_943 = torch.ops.aten.permute.default(getitem_413, [0, 2, 1, 3]);  getitem_413 = None
        slice_169 = torch.ops.aten.slice.Tensor(permute_942, 3, 0, 128)
        slice_170 = torch.ops.aten.slice.Tensor(permute_942, 3, 128, 192);  permute_942 = None
        sum_190 = torch.ops.aten.sum.dim_IntList(slice_170, [2], True);  slice_170 = None
        cat_110 = torch.ops.aten.cat.default([slice_169, permute_941], 3);  slice_169 = permute_941 = None
        view_1979 = torch.ops.aten.view.default(cat_110, [2, 4096, 4096]);  cat_110 = None
        view_1980 = torch.ops.aten.view.default(view_1979, [8192, 4096]);  view_1979 = None
        permute_944 = torch.ops.aten.permute.default(view_1980, [1, 0])
        mm_388 = torch.ops.aten.mm.default(permute_944, view_1055);  permute_944 = view_1055 = None
        convert_element_type_863 = torch.ops.prims.convert_element_type.default(primals_267, torch.bfloat16);  primals_267 = None
        all_gather_into_tensor_270 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_863, 64, '0');  convert_element_type_863 = None
        wait_tensor_330 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_270);  all_gather_into_tensor_270 = None
        permute_238 = torch.ops.aten.permute.default(wait_tensor_330, [1, 0]);  wait_tensor_330 = None
        permute_946 = torch.ops.aten.permute.default(permute_238, [1, 0]);  permute_238 = None
        mm_389 = torch.ops.aten.mm.default(view_1980, permute_946);  view_1980 = permute_946 = None
        view_1981 = torch.ops.aten.view.default(mm_389, [2, 4096, 512]);  mm_389 = None
        convert_element_type_2245 = torch.ops.prims.convert_element_type.default(mm_388, torch.float32);  mm_388 = None
        reduce_scatter_tensor_151 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2245, 'avg', 64, '0');  convert_element_type_2245 = None
        wait_tensor_732 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_151);  reduce_scatter_tensor_151 = None
        convert_element_type_2246 = torch.ops.prims.convert_element_type.default(view_1981, torch.float32);  view_1981 = None
        convert_element_type_860 = torch.ops.prims.convert_element_type.default(primals_266, torch.bfloat16);  primals_266 = None
        all_gather_into_tensor_269 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_860, 64, '0');  convert_element_type_860 = None
        wait_tensor_329 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_269);  all_gather_into_tensor_269 = None
        convert_element_type_2248 = torch.ops.prims.convert_element_type.default(wait_tensor_329, torch.float32);  wait_tensor_329 = None
        mul_1651 = torch.ops.aten.mul.Tensor(convert_element_type_2246, convert_element_type_2248);  convert_element_type_2248 = None
        convert_element_type_861 = torch.ops.prims.convert_element_type.default(getitem_221, torch.float32);  getitem_221 = None
        mul_748 = torch.ops.aten.mul.Tensor(convert_element_type_861, rsqrt_49);  convert_element_type_861 = None
        mul_1653 = torch.ops.aten.mul.Tensor(mul_748, mul_1651)
        sum_191 = torch.ops.aten.sum.dim_IntList(mul_1653, [2], True);  mul_1653 = None
        div_196 = torch.ops.aten.div.Tensor(mul_748, 512)
        mul_1654 = torch.ops.aten.mul.Tensor(div_196, sum_191);  div_196 = sum_191 = None
        sub_689 = torch.ops.aten.sub.Tensor(mul_1651, mul_1654);  mul_1651 = mul_1654 = None
        mul_1655 = torch.ops.aten.mul.Tensor(sub_689, rsqrt_49);  sub_689 = rsqrt_49 = None
        mul_1656 = torch.ops.aten.mul.Tensor(convert_element_type_2246, mul_748);  convert_element_type_2246 = mul_748 = None
        sum_192 = torch.ops.aten.sum.dim_IntList(mul_1656, [0, 1]);  mul_1656 = None
        convert_element_type_2249 = torch.ops.prims.convert_element_type.default(mul_1655, torch.bfloat16);  mul_1655 = None
        convert_element_type_default_50 = torch.ops.prims.convert_element_type.default(sum_192, torch.float32);  sum_192 = None
        reduce_scatter_tensor_152 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_50, 'avg', 64, '0');  convert_element_type_default_50 = None
        wait_tensor_733 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_152);  reduce_scatter_tensor_152 = None
        convert_element_type_2252 = torch.ops.prims.convert_element_type.default(sum_190, torch.float32);  sum_190 = None
        view_1982 = torch.ops.aten.view.default(convert_element_type_2252, [2, 4096, 1, 32, 2]);  convert_element_type_2252 = None
        view_as_complex_74 = torch.ops.aten.view_as_complex.default(view_1982);  view_1982 = None
        mul_1657 = torch.ops.aten.mul.Tensor(view_as_complex_74, clone_9);  view_as_complex_74 = None
        view_as_real_74 = torch.ops.aten.view_as_real.default(mul_1657);  mul_1657 = None
        view_1983 = torch.ops.aten.view.default(view_as_real_74, [2, 4096, 1, 64]);  view_as_real_74 = None
        convert_element_type_2253 = torch.ops.prims.convert_element_type.default(view_1983, torch.bfloat16);  view_1983 = None
        squeeze_36 = torch.ops.aten.squeeze.dim(convert_element_type_2253, 2);  convert_element_type_2253 = None
        cat_111 = torch.ops.aten.cat.default([convert_element_type_2249, squeeze_36], 2);  convert_element_type_2249 = squeeze_36 = None
        view_1984 = torch.ops.aten.view.default(cat_111, [8192, 576]);  cat_111 = None
        permute_948 = torch.ops.aten.permute.default(view_1984, [1, 0])
        mm_390 = torch.ops.aten.mm.default(permute_948, view_1041);  permute_948 = None
        convert_element_type_855 = torch.ops.prims.convert_element_type.default(primals_265, torch.bfloat16);  primals_265 = None
        all_gather_into_tensor_268 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_855, 64, '0');  convert_element_type_855 = None
        wait_tensor_328 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_268);  all_gather_into_tensor_268 = None
        permute_237 = torch.ops.aten.permute.default(wait_tensor_328, [1, 0]);  wait_tensor_328 = None
        permute_950 = torch.ops.aten.permute.default(permute_237, [1, 0]);  permute_237 = None
        mm_391 = torch.ops.aten.mm.default(view_1984, permute_950);  view_1984 = permute_950 = None
        view_1985 = torch.ops.aten.view.default(mm_391, [2, 4096, 2048]);  mm_391 = None
        convert_element_type_2258 = torch.ops.prims.convert_element_type.default(mm_390, torch.float32);  mm_390 = None
        reduce_scatter_tensor_153 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2258, 'avg', 64, '0');  convert_element_type_2258 = None
        wait_tensor_734 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_153);  reduce_scatter_tensor_153 = None
        slice_171 = torch.ops.aten.slice.Tensor(permute_943, 3, 0, 128)
        slice_172 = torch.ops.aten.slice.Tensor(permute_943, 3, 128, 192);  permute_943 = None
        convert_element_type_2259 = torch.ops.prims.convert_element_type.default(slice_172, torch.float32);  slice_172 = None
        view_1986 = torch.ops.aten.view.default(convert_element_type_2259, [2, 4096, 16, 32, 2]);  convert_element_type_2259 = None
        view_as_complex_75 = torch.ops.aten.view_as_complex.default(view_1986);  view_1986 = None
        mul_1658 = torch.ops.aten.mul.Tensor(view_as_complex_75, clone_9);  view_as_complex_75 = None
        view_as_real_75 = torch.ops.aten.view_as_real.default(mul_1658);  mul_1658 = None
        view_1987 = torch.ops.aten.view.default(view_as_real_75, [2, 4096, 16, 64]);  view_as_real_75 = None
        convert_element_type_2260 = torch.ops.prims.convert_element_type.default(view_1987, torch.bfloat16);  view_1987 = None
        cat_112 = torch.ops.aten.cat.default([slice_171, convert_element_type_2260], 3);  slice_171 = convert_element_type_2260 = None
        view_1988 = torch.ops.aten.view.default(cat_112, [2, 4096, 3072]);  cat_112 = None
        view_1989 = torch.ops.aten.view.default(view_1988, [8192, 3072]);  view_1988 = None
        permute_952 = torch.ops.aten.permute.default(view_1989, [1, 0])
        mm_392 = torch.ops.aten.mm.default(permute_952, view_1041);  permute_952 = view_1041 = None
        convert_element_type_850 = torch.ops.prims.convert_element_type.default(primals_264, torch.bfloat16);  primals_264 = None
        all_gather_into_tensor_267 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_850, 64, '0');  convert_element_type_850 = None
        wait_tensor_327 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_267);  all_gather_into_tensor_267 = None
        permute_236 = torch.ops.aten.permute.default(wait_tensor_327, [1, 0]);  wait_tensor_327 = None
        permute_954 = torch.ops.aten.permute.default(permute_236, [1, 0]);  permute_236 = None
        mm_393 = torch.ops.aten.mm.default(view_1989, permute_954);  view_1989 = permute_954 = None
        view_1990 = torch.ops.aten.view.default(mm_393, [2, 4096, 2048]);  mm_393 = None
        add_1938 = torch.ops.aten.add.Tensor(view_1985, view_1990);  view_1985 = view_1990 = None
        convert_element_type_2265 = torch.ops.prims.convert_element_type.default(mm_392, torch.float32);  mm_392 = None
        reduce_scatter_tensor_154 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2265, 'avg', 64, '0');  convert_element_type_2265 = None
        wait_tensor_735 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_154);  reduce_scatter_tensor_154 = None
        convert_element_type_2266 = torch.ops.prims.convert_element_type.default(add_1938, torch.float32);  add_1938 = None
        convert_element_type_847 = torch.ops.prims.convert_element_type.default(primals_263, torch.bfloat16);  primals_263 = None
        all_gather_into_tensor_266 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_847, 64, '0');  convert_element_type_847 = None
        wait_tensor_326 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_266);  all_gather_into_tensor_266 = None
        convert_element_type_2268 = torch.ops.prims.convert_element_type.default(wait_tensor_326, torch.float32);  wait_tensor_326 = None
        mul_1659 = torch.ops.aten.mul.Tensor(convert_element_type_2266, convert_element_type_2268);  convert_element_type_2268 = None
        convert_element_type_848 = torch.ops.prims.convert_element_type.default(add_1025, torch.float32);  add_1025 = None
        mul_744 = torch.ops.aten.mul.Tensor(convert_element_type_848, rsqrt_48);  convert_element_type_848 = None
        mul_1661 = torch.ops.aten.mul.Tensor(mul_744, mul_1659)
        sum_193 = torch.ops.aten.sum.dim_IntList(mul_1661, [2], True);  mul_1661 = None
        div_197 = torch.ops.aten.div.Tensor(mul_744, 2048)
        mul_1662 = torch.ops.aten.mul.Tensor(div_197, sum_193);  div_197 = sum_193 = None
        sub_690 = torch.ops.aten.sub.Tensor(mul_1659, mul_1662);  mul_1659 = mul_1662 = None
        mul_1663 = torch.ops.aten.mul.Tensor(sub_690, rsqrt_48);  sub_690 = rsqrt_48 = None
        mul_1664 = torch.ops.aten.mul.Tensor(convert_element_type_2266, mul_744);  convert_element_type_2266 = mul_744 = None
        sum_194 = torch.ops.aten.sum.dim_IntList(mul_1664, [0, 1]);  mul_1664 = None
        convert_element_type_2269 = torch.ops.prims.convert_element_type.default(mul_1663, torch.bfloat16);  mul_1663 = None
        add_1939 = torch.ops.aten.add.Tensor(add_1937, convert_element_type_2269);  add_1937 = convert_element_type_2269 = None
        convert_element_type_default_49 = torch.ops.prims.convert_element_type.default(sum_194, torch.float32);  sum_194 = None
        reduce_scatter_tensor_155 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_49, 'avg', 64, '0');  convert_element_type_default_49 = None
        wait_tensor_736 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_155);  reduce_scatter_tensor_155 = None
        view_1991 = torch.ops.aten.view.default(add_1939, [8192, 2048])
        unsqueeze_64 = torch.ops.aten.unsqueeze.default(view_1991, 1)
        convert_element_type_2272 = torch.ops.prims.convert_element_type.default(unsqueeze_64, torch.float32);  unsqueeze_64 = None
        bmm_48 = torch.ops.aten.bmm.default(permute_956, convert_element_type_2272);  permute_956 = None
        bmm_49 = torch.ops.aten.bmm.default(convert_element_type_2272, permute_957);  convert_element_type_2272 = permute_957 = None
        convert_element_type_2273 = torch.ops.prims.convert_element_type.default(bmm_48, torch.bfloat16);  bmm_48 = None
        view_1992 = torch.ops.aten.view.default(bmm_49, [8192, 6]);  bmm_49 = None
        view_1993 = torch.ops.aten.view.default(convert_element_type_2273, [49152, 2048]);  convert_element_type_2273 = None
        index_74 = torch.ops.aten.index.Tensor(view_1993, [getitem_217]);  view_1993 = getitem_217 = None
        permute_958 = torch.ops.aten.permute.default(view_1991, [1, 0])
        mm_394 = torch.ops.aten.mm.default(permute_958, mul_741);  permute_958 = mul_741 = None
        convert_element_type_842 = torch.ops.prims.convert_element_type.default(primals_262, torch.bfloat16);  primals_262 = None
        all_gather_into_tensor_265 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_842, 64, '0');  convert_element_type_842 = None
        wait_tensor_325 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_265);  all_gather_into_tensor_265 = None
        permute_235 = torch.ops.aten.permute.default(wait_tensor_325, [1, 0]);  wait_tensor_325 = None
        permute_960 = torch.ops.aten.permute.default(permute_235, [1, 0]);  permute_235 = None
        mm_395 = torch.ops.aten.mm.default(view_1991, permute_960);  view_1991 = permute_960 = None
        convert_element_type_2278 = torch.ops.prims.convert_element_type.default(mm_394, torch.float32);  mm_394 = None
        reduce_scatter_tensor_156 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2278, 'avg', 64, '0');  convert_element_type_2278 = None
        wait_tensor_737 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_156);  reduce_scatter_tensor_156 = None
        convert_element_type_837 = torch.ops.prims.convert_element_type.default(mm_124, torch.float32);  mm_124 = None
        neg_30 = torch.ops.aten.neg.default(convert_element_type_837)
        exp_45 = torch.ops.aten.exp.default(neg_30);  neg_30 = None
        add_1020 = torch.ops.aten.add.Tensor(exp_45, 1);  exp_45 = None
        div_75 = torch.ops.aten.div.Tensor(convert_element_type_837, add_1020)
        convert_element_type_838 = torch.ops.prims.convert_element_type.default(div_75, torch.bfloat16);  div_75 = None
        mul_1665 = torch.ops.aten.mul.Tensor(mm_395, convert_element_type_838);  convert_element_type_838 = None
        mul_1666 = torch.ops.aten.mul.Tensor(mm_395, mm_125);  mm_395 = mm_125 = None
        permute_962 = torch.ops.aten.permute.default(mul_1665, [1, 0])
        mm_396 = torch.ops.aten.mm.default(permute_962, view_996);  permute_962 = None
        convert_element_type_839 = torch.ops.prims.convert_element_type.default(primals_261, torch.bfloat16);  primals_261 = None
        all_gather_into_tensor_264 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_839, 64, '0');  convert_element_type_839 = None
        wait_tensor_324 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_264);  all_gather_into_tensor_264 = None
        permute_234 = torch.ops.aten.permute.default(wait_tensor_324, [1, 0]);  wait_tensor_324 = None
        permute_964 = torch.ops.aten.permute.default(permute_234, [1, 0]);  permute_234 = None
        mm_397 = torch.ops.aten.mm.default(mul_1665, permute_964);  mul_1665 = permute_964 = None
        convert_element_type_2283 = torch.ops.prims.convert_element_type.default(mm_396, torch.float32);  mm_396 = None
        reduce_scatter_tensor_157 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2283, 'avg', 64, '0');  convert_element_type_2283 = None
        wait_tensor_738 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_157);  reduce_scatter_tensor_157 = None
        convert_element_type_2284 = torch.ops.prims.convert_element_type.default(mul_1666, torch.float32);  mul_1666 = None
        reciprocal_22 = torch.ops.aten.reciprocal.default(add_1020);  add_1020 = None
        mul_1667 = torch.ops.aten.mul.Tensor(reciprocal_22, 1);  reciprocal_22 = None
        mul_1668 = torch.ops.aten.mul.Tensor(convert_element_type_2284, mul_1667);  convert_element_type_2284 = None
        sub_691 = torch.ops.aten.sub.Tensor(1, mul_1667);  mul_1667 = None
        mul_1669 = torch.ops.aten.mul.Tensor(convert_element_type_837, sub_691);  convert_element_type_837 = sub_691 = None
        add_1941 = torch.ops.aten.add.Tensor(mul_1669, 1);  mul_1669 = None
        mul_1670 = torch.ops.aten.mul.Tensor(mul_1668, add_1941);  mul_1668 = add_1941 = None
        convert_element_type_2286 = torch.ops.prims.convert_element_type.default(mul_1670, torch.bfloat16);  mul_1670 = None
        permute_966 = torch.ops.aten.permute.default(convert_element_type_2286, [1, 0])
        mm_398 = torch.ops.aten.mm.default(permute_966, view_996);  permute_966 = None
        convert_element_type_834 = torch.ops.prims.convert_element_type.default(primals_260, torch.bfloat16);  primals_260 = None
        all_gather_into_tensor_263 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_834, 64, '0');  convert_element_type_834 = None
        wait_tensor_323 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_263);  all_gather_into_tensor_263 = None
        permute_233 = torch.ops.aten.permute.default(wait_tensor_323, [1, 0]);  wait_tensor_323 = None
        permute_968 = torch.ops.aten.permute.default(permute_233, [1, 0]);  permute_233 = None
        mm_399 = torch.ops.aten.mm.default(convert_element_type_2286, permute_968);  convert_element_type_2286 = permute_968 = None
        add_1942 = torch.ops.aten.add.Tensor(mm_397, mm_399);  mm_397 = mm_399 = None
        convert_element_type_2291 = torch.ops.prims.convert_element_type.default(mm_398, torch.float32);  mm_398 = None
        reduce_scatter_tensor_158 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2291, 'avg', 64, '0');  convert_element_type_2291 = None
        wait_tensor_739 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_158);  reduce_scatter_tensor_158 = None
        all_to_all_single_100 = torch.ops._c10d_functional.all_to_all_single.default(index_74, [_local_scalar_dense_232, _local_scalar_dense_233, _local_scalar_dense_234, _local_scalar_dense_235, _local_scalar_dense_236, _local_scalar_dense_237, _local_scalar_dense_238, _local_scalar_dense_239], [_local_scalar_dense_224, _local_scalar_dense_225, _local_scalar_dense_226, _local_scalar_dense_227, _local_scalar_dense_228, _local_scalar_dense_229, _local_scalar_dense_230, _local_scalar_dense_231], '521');  index_74 = None
        wait_tensor_740 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_100);  all_to_all_single_100 = None
        full_392 = torch.ops.aten.full.default([sym_size_int_57, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_57 = None
        slice_scatter_11 = torch.ops.aten.slice_scatter.default(full_392, wait_tensor_740, 0, 0, -1);  wait_tensor_740 = None
        index_75 = torch.ops.aten.index.Tensor(slice_scatter_11, [getitem_218]);  slice_scatter_11 = None
        permute_970 = torch.ops.aten.permute.default(index_75, [1, 0])
        _grouped_mm_144 = torch.ops.aten._grouped_mm.default(permute_970, mul_721, cumsum_44);  permute_970 = mul_721 = None
        convert_element_type_828 = torch.ops.prims.convert_element_type.default(primals_258, torch.bfloat16);  primals_258 = None
        all_gather_into_tensor_259 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_828, 8, '513');  convert_element_type_828 = None
        wait_tensor_318 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_259);  all_gather_into_tensor_259 = None
        permute_232 = torch.ops.aten.permute.default(wait_tensor_318, [0, 2, 1]);  wait_tensor_318 = None
        permute_972 = torch.ops.aten.permute.default(permute_232, [0, 2, 1]);  permute_232 = None
        _grouped_mm_145 = torch.ops.aten._grouped_mm.default(index_75, permute_972, cumsum_44);  index_75 = permute_972 = None
        convert_element_type_832 = torch.ops.prims.convert_element_type.default(_grouped_mm_42, torch.float32);  _grouped_mm_42 = None
        neg_29 = torch.ops.aten.neg.default(convert_element_type_832)
        exp_44 = torch.ops.aten.exp.default(neg_29);  neg_29 = None
        add_984 = torch.ops.aten.add.Tensor(exp_44, 1);  exp_44 = None
        div_74 = torch.ops.aten.div.Tensor(convert_element_type_832, add_984)
        convert_element_type_833 = torch.ops.prims.convert_element_type.default(div_74, torch.bfloat16);  div_74 = None
        mul_1671 = torch.ops.aten.mul.Tensor(_grouped_mm_145, convert_element_type_833);  convert_element_type_833 = None
        mul_1672 = torch.ops.aten.mul.Tensor(_grouped_mm_145, _grouped_mm_43);  _grouped_mm_145 = _grouped_mm_43 = None
        permute_974 = torch.ops.aten.permute.default(mul_1671, [1, 0])
        _grouped_mm_146 = torch.ops.aten._grouped_mm.default(permute_974, index_29, cumsum_44);  permute_974 = None
        convert_element_type_829 = torch.ops.prims.convert_element_type.default(primals_259, torch.bfloat16);  primals_259 = None
        all_gather_into_tensor_260 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_829, 8, '513');  convert_element_type_829 = None
        wait_tensor_319 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_260);  all_gather_into_tensor_260 = None
        permute_231 = torch.ops.aten.permute.default(wait_tensor_319, [0, 2, 1]);  wait_tensor_319 = None
        permute_976 = torch.ops.aten.permute.default(permute_231, [0, 2, 1]);  permute_231 = None
        _grouped_mm_147 = torch.ops.aten._grouped_mm.default(mul_1671, permute_976, cumsum_44);  mul_1671 = permute_976 = None
        convert_element_type_2292 = torch.ops.prims.convert_element_type.default(mul_1672, torch.float32);  mul_1672 = None
        reciprocal_23 = torch.ops.aten.reciprocal.default(add_984);  add_984 = None
        mul_1673 = torch.ops.aten.mul.Tensor(reciprocal_23, 1);  reciprocal_23 = None
        mul_1674 = torch.ops.aten.mul.Tensor(convert_element_type_2292, mul_1673);  convert_element_type_2292 = None
        sub_692 = torch.ops.aten.sub.Tensor(1, mul_1673);  mul_1673 = None
        mul_1675 = torch.ops.aten.mul.Tensor(convert_element_type_832, sub_692);  convert_element_type_832 = sub_692 = None
        add_1944 = torch.ops.aten.add.Tensor(mul_1675, 1);  mul_1675 = None
        mul_1676 = torch.ops.aten.mul.Tensor(mul_1674, add_1944);  mul_1674 = add_1944 = None
        convert_element_type_2294 = torch.ops.prims.convert_element_type.default(mul_1676, torch.bfloat16);  mul_1676 = None
        permute_978 = torch.ops.aten.permute.default(convert_element_type_2294, [1, 0])
        _grouped_mm_148 = torch.ops.aten._grouped_mm.default(permute_978, index_29, cumsum_44);  permute_978 = index_29 = None
        convert_element_type_826 = torch.ops.prims.convert_element_type.default(primals_257, torch.bfloat16);  primals_257 = None
        all_gather_into_tensor_257 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_826, 8, '513');  convert_element_type_826 = None
        wait_tensor_316 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_257);  all_gather_into_tensor_257 = None
        permute_230 = torch.ops.aten.permute.default(wait_tensor_316, [0, 2, 1]);  wait_tensor_316 = None
        permute_980 = torch.ops.aten.permute.default(permute_230, [0, 2, 1]);  permute_230 = None
        _grouped_mm_149 = torch.ops.aten._grouped_mm.default(convert_element_type_2294, permute_980, cumsum_44);  convert_element_type_2294 = permute_980 = cumsum_44 = None
        add_1945 = torch.ops.aten.add.Tensor(_grouped_mm_147, _grouped_mm_149);  _grouped_mm_147 = _grouped_mm_149 = None
        convert_element_type_2295 = torch.ops.prims.convert_element_type.default(_grouped_mm_146, torch.float32);  _grouped_mm_146 = None
        div_198 = torch.ops.aten.div.Tensor(convert_element_type_2295, 64);  convert_element_type_2295 = None
        reduce_scatter_tensor_159 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_198, 'sum', 8, '513');  div_198 = None
        wait_tensor_741 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_159);  reduce_scatter_tensor_159 = None
        convert_element_type_2296 = torch.ops.prims.convert_element_type.default(_grouped_mm_144, torch.float32);  _grouped_mm_144 = None
        div_199 = torch.ops.aten.div.Tensor(convert_element_type_2296, 64);  convert_element_type_2296 = None
        reduce_scatter_tensor_160 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_199, 'sum', 8, '513');  div_199 = None
        wait_tensor_742 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_160);  reduce_scatter_tensor_160 = None
        convert_element_type_2297 = torch.ops.prims.convert_element_type.default(_grouped_mm_148, torch.float32);  _grouped_mm_148 = None
        div_200 = torch.ops.aten.div.Tensor(convert_element_type_2297, 64);  convert_element_type_2297 = None
        reduce_scatter_tensor_161 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_200, 'sum', 8, '513');  div_200 = None
        wait_tensor_743 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_161);  reduce_scatter_tensor_161 = None
        index_put_74 = torch.ops.aten.index_put.default(full_392, [getitem_218], add_1945, True);  full_392 = getitem_218 = add_1945 = None
        slice_173 = torch.ops.aten.slice.Tensor(index_put_74, 0, 0, add_1946);  index_put_74 = add_1946 = None
        all_to_all_single_101 = torch.ops._c10d_functional.all_to_all_single.default(slice_173, [_local_scalar_dense_224, _local_scalar_dense_225, _local_scalar_dense_226, _local_scalar_dense_227, _local_scalar_dense_228, _local_scalar_dense_229, _local_scalar_dense_230, _local_scalar_dense_231], [_local_scalar_dense_232, _local_scalar_dense_233, _local_scalar_dense_234, _local_scalar_dense_235, _local_scalar_dense_236, _local_scalar_dense_237, _local_scalar_dense_238, _local_scalar_dense_239], '521');  slice_173 = _local_scalar_dense_224 = _local_scalar_dense_225 = _local_scalar_dense_226 = _local_scalar_dense_227 = _local_scalar_dense_228 = _local_scalar_dense_229 = _local_scalar_dense_230 = _local_scalar_dense_231 = _local_scalar_dense_232 = _local_scalar_dense_233 = _local_scalar_dense_234 = _local_scalar_dense_235 = _local_scalar_dense_236 = _local_scalar_dense_237 = _local_scalar_dense_238 = _local_scalar_dense_239 = None
        wait_tensor_744 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_101);  all_to_all_single_101 = None
        index_put_75 = torch.ops.aten.index_put.default(full_default_52, [div_72], wait_tensor_744, True);  div_72 = wait_tensor_744 = None
        add_1950 = torch.ops.aten.add.Tensor(add_1942, index_put_75);  add_1942 = index_put_75 = None
        mul_1677 = torch.ops.aten.mul.Tensor(view_1992, 1.0);  view_1992 = None
        scatter_add_11 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_215, mul_1677);  getitem_215 = mul_1677 = None
        convert_element_type_821 = torch.ops.prims.convert_element_type.default(mm_123, torch.float32);  mm_123 = None
        sub_336 = torch.ops.aten.sub.Tensor(convert_element_type_821, amax_14);  convert_element_type_821 = amax_14 = None
        exp_43 = torch.ops.aten.exp.default(sub_336);  sub_336 = None
        div_71 = torch.ops.aten.div.Tensor(exp_43, sum_57);  exp_43 = sum_57 = None
        mul_1678 = torch.ops.aten.mul.Tensor(scatter_add_11, div_71);  scatter_add_11 = None
        sum_195 = torch.ops.aten.sum.dim_IntList(mul_1678, [1], True)
        neg_88 = torch.ops.aten.neg.default(div_71);  div_71 = None
        fma_11 = torch.ops.prims.fma.default(neg_88, sum_195, mul_1678);  neg_88 = sum_195 = mul_1678 = None
        convert_element_type_2298 = torch.ops.prims.convert_element_type.default(fma_11, torch.bfloat16);  fma_11 = None
        permute_982 = torch.ops.aten.permute.default(convert_element_type_2298, [1, 0])
        mm_400 = torch.ops.aten.mm.default(permute_982, view_996);  permute_982 = view_996 = None
        convert_element_type_818 = torch.ops.prims.convert_element_type.default(primals_255, torch.bfloat16);  primals_255 = None
        all_gather_into_tensor_256 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_818, 64, '0');  convert_element_type_818 = None
        wait_tensor_312 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_256);  all_gather_into_tensor_256 = None
        permute_229 = torch.ops.aten.permute.default(wait_tensor_312, [1, 0]);  wait_tensor_312 = None
        permute_984 = torch.ops.aten.permute.default(permute_229, [1, 0]);  permute_229 = None
        mm_401 = torch.ops.aten.mm.default(convert_element_type_2298, permute_984);  convert_element_type_2298 = permute_984 = None
        add_1951 = torch.ops.aten.add.Tensor(add_1950, mm_401);  add_1950 = mm_401 = None
        convert_element_type_2303 = torch.ops.prims.convert_element_type.default(mm_400, torch.float32);  mm_400 = None
        reduce_scatter_tensor_162 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2303, 'avg', 64, '0');  convert_element_type_2303 = None
        wait_tensor_745 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_162);  reduce_scatter_tensor_162 = None
        view_1994 = torch.ops.aten.view.default(add_1951, [2, 4096, 2048]);  add_1951 = None
        convert_element_type_2304 = torch.ops.prims.convert_element_type.default(view_1994, torch.float32);  view_1994 = None
        convert_element_type_815 = torch.ops.prims.convert_element_type.default(primals_253, torch.bfloat16);  primals_253 = None
        all_gather_into_tensor_255 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_815, 64, '0');  convert_element_type_815 = None
        wait_tensor_311 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_255);  all_gather_into_tensor_255 = None
        convert_element_type_2306 = torch.ops.prims.convert_element_type.default(wait_tensor_311, torch.float32);  wait_tensor_311 = None
        mul_1679 = torch.ops.aten.mul.Tensor(convert_element_type_2304, convert_element_type_2306);  convert_element_type_2306 = None
        convert_element_type_816 = torch.ops.prims.convert_element_type.default(add_960, torch.float32);  add_960 = None
        mul_701 = torch.ops.aten.mul.Tensor(convert_element_type_816, rsqrt_47);  convert_element_type_816 = None
        mul_1681 = torch.ops.aten.mul.Tensor(mul_701, mul_1679)
        sum_196 = torch.ops.aten.sum.dim_IntList(mul_1681, [2], True);  mul_1681 = None
        div_201 = torch.ops.aten.div.Tensor(mul_701, 2048)
        mul_1682 = torch.ops.aten.mul.Tensor(div_201, sum_196);  div_201 = sum_196 = None
        sub_694 = torch.ops.aten.sub.Tensor(mul_1679, mul_1682);  mul_1679 = mul_1682 = None
        mul_1683 = torch.ops.aten.mul.Tensor(sub_694, rsqrt_47);  sub_694 = rsqrt_47 = None
        mul_1684 = torch.ops.aten.mul.Tensor(convert_element_type_2304, mul_701);  convert_element_type_2304 = mul_701 = None
        sum_197 = torch.ops.aten.sum.dim_IntList(mul_1684, [0, 1]);  mul_1684 = None
        convert_element_type_2307 = torch.ops.prims.convert_element_type.default(mul_1683, torch.bfloat16);  mul_1683 = None
        add_1952 = torch.ops.aten.add.Tensor(add_1939, convert_element_type_2307);  add_1939 = convert_element_type_2307 = None
        convert_element_type_default_48 = torch.ops.prims.convert_element_type.default(sum_197, torch.float32);  sum_197 = None
        reduce_scatter_tensor_163 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_48, 'avg', 64, '0');  convert_element_type_default_48 = None
        wait_tensor_746 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_163);  reduce_scatter_tensor_163 = None
        view_1995 = torch.ops.aten.view.default(add_1952, [8192, 2048])
        permute_986 = torch.ops.aten.permute.default(view_1995, [1, 0])
        permute_227 = torch.ops.aten.permute.default(getitem_211, [0, 2, 1, 3])
        view_991 = torch.ops.aten.view.default(permute_227, [2, 4096, -1]);  permute_227 = None
        view_993 = torch.ops.aten.view.default(view_991, [8192, 2048]);  view_991 = None
        mm_402 = torch.ops.aten.mm.default(permute_986, view_993);  permute_986 = view_993 = None
        convert_element_type_812 = torch.ops.prims.convert_element_type.default(primals_252, torch.bfloat16);  primals_252 = None
        all_gather_into_tensor_254 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_812, 64, '0');  convert_element_type_812 = None
        wait_tensor_310 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_254);  all_gather_into_tensor_254 = None
        permute_228 = torch.ops.aten.permute.default(wait_tensor_310, [1, 0]);  wait_tensor_310 = None
        permute_988 = torch.ops.aten.permute.default(permute_228, [1, 0]);  permute_228 = None
        mm_403 = torch.ops.aten.mm.default(view_1995, permute_988);  view_1995 = permute_988 = None
        view_1996 = torch.ops.aten.view.default(mm_403, [2, 4096, 2048]);  mm_403 = None
        convert_element_type_2314 = torch.ops.prims.convert_element_type.default(mm_402, torch.float32);  mm_402 = None
        reduce_scatter_tensor_164 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2314, 'avg', 64, '0');  convert_element_type_2314 = None
        wait_tensor_747 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_164);  reduce_scatter_tensor_164 = None
        view_1997 = torch.ops.aten.view.default(view_1996, [2, 4096, 16, 128]);  view_1996 = None
        permute_990 = torch.ops.aten.permute.default(view_1997, [0, 2, 1, 3]);  view_1997 = None
        fw_graph11 = self.fw_graph11
        joint_graph11 = self.joint_graph11
        mask_graph11 = self.mask_graph11
        flex_attention_backward_11 = torch.ops.higher_order.flex_attention_backward(permute_224, permute_225, permute_226, getitem_211, getitem_212, permute_990, None, fw_graph11, joint_graph11, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph11), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_224 = permute_225 = permute_226 = getitem_211 = getitem_212 = permute_990 = fw_graph11 = joint_graph11 = mask_graph11 = None
        getitem_417 = flex_attention_backward_11[0]
        getitem_418 = flex_attention_backward_11[1]
        getitem_419 = flex_attention_backward_11[2];  flex_attention_backward_11 = None
        permute_991 = torch.ops.aten.permute.default(getitem_419, [0, 2, 1, 3]);  getitem_419 = None
        permute_992 = torch.ops.aten.permute.default(getitem_418, [0, 2, 1, 3]);  getitem_418 = None
        permute_993 = torch.ops.aten.permute.default(getitem_417, [0, 2, 1, 3]);  getitem_417 = None
        slice_175 = torch.ops.aten.slice.Tensor(permute_992, 3, 0, 128)
        slice_176 = torch.ops.aten.slice.Tensor(permute_992, 3, 128, 192);  permute_992 = None
        sum_198 = torch.ops.aten.sum.dim_IntList(slice_176, [2], True);  slice_176 = None
        cat_113 = torch.ops.aten.cat.default([slice_175, permute_991], 3);  slice_175 = permute_991 = None
        view_1998 = torch.ops.aten.view.default(cat_113, [2, 4096, 4096]);  cat_113 = None
        view_1999 = torch.ops.aten.view.default(view_1998, [8192, 4096]);  view_1998 = None
        permute_994 = torch.ops.aten.permute.default(view_1999, [1, 0])
        mm_404 = torch.ops.aten.mm.default(permute_994, view_988);  permute_994 = view_988 = None
        convert_element_type_809 = torch.ops.prims.convert_element_type.default(primals_251, torch.bfloat16);  primals_251 = None
        all_gather_into_tensor_253 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_809, 64, '0');  convert_element_type_809 = None
        wait_tensor_309 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_253);  all_gather_into_tensor_253 = None
        permute_223 = torch.ops.aten.permute.default(wait_tensor_309, [1, 0]);  wait_tensor_309 = None
        permute_996 = torch.ops.aten.permute.default(permute_223, [1, 0]);  permute_223 = None
        mm_405 = torch.ops.aten.mm.default(view_1999, permute_996);  view_1999 = permute_996 = None
        view_2000 = torch.ops.aten.view.default(mm_405, [2, 4096, 512]);  mm_405 = None
        convert_element_type_2319 = torch.ops.prims.convert_element_type.default(mm_404, torch.float32);  mm_404 = None
        reduce_scatter_tensor_165 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2319, 'avg', 64, '0');  convert_element_type_2319 = None
        wait_tensor_748 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_165);  reduce_scatter_tensor_165 = None
        convert_element_type_2320 = torch.ops.prims.convert_element_type.default(view_2000, torch.float32);  view_2000 = None
        convert_element_type_806 = torch.ops.prims.convert_element_type.default(primals_250, torch.bfloat16);  primals_250 = None
        all_gather_into_tensor_252 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_806, 64, '0');  convert_element_type_806 = None
        wait_tensor_308 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_252);  all_gather_into_tensor_252 = None
        convert_element_type_2322 = torch.ops.prims.convert_element_type.default(wait_tensor_308, torch.float32);  wait_tensor_308 = None
        mul_1685 = torch.ops.aten.mul.Tensor(convert_element_type_2320, convert_element_type_2322);  convert_element_type_2322 = None
        convert_element_type_807 = torch.ops.prims.convert_element_type.default(getitem_207, torch.float32);  getitem_207 = None
        mul_699 = torch.ops.aten.mul.Tensor(convert_element_type_807, rsqrt_46);  convert_element_type_807 = None
        mul_1687 = torch.ops.aten.mul.Tensor(mul_699, mul_1685)
        sum_199 = torch.ops.aten.sum.dim_IntList(mul_1687, [2], True);  mul_1687 = None
        div_202 = torch.ops.aten.div.Tensor(mul_699, 512)
        mul_1688 = torch.ops.aten.mul.Tensor(div_202, sum_199);  div_202 = sum_199 = None
        sub_695 = torch.ops.aten.sub.Tensor(mul_1685, mul_1688);  mul_1685 = mul_1688 = None
        mul_1689 = torch.ops.aten.mul.Tensor(sub_695, rsqrt_46);  sub_695 = rsqrt_46 = None
        mul_1690 = torch.ops.aten.mul.Tensor(convert_element_type_2320, mul_699);  convert_element_type_2320 = mul_699 = None
        sum_200 = torch.ops.aten.sum.dim_IntList(mul_1690, [0, 1]);  mul_1690 = None
        convert_element_type_2323 = torch.ops.prims.convert_element_type.default(mul_1689, torch.bfloat16);  mul_1689 = None
        convert_element_type_default_47 = torch.ops.prims.convert_element_type.default(sum_200, torch.float32);  sum_200 = None
        reduce_scatter_tensor_166 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_47, 'avg', 64, '0');  convert_element_type_default_47 = None
        wait_tensor_749 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_166);  reduce_scatter_tensor_166 = None
        convert_element_type_2326 = torch.ops.prims.convert_element_type.default(sum_198, torch.float32);  sum_198 = None
        view_2001 = torch.ops.aten.view.default(convert_element_type_2326, [2, 4096, 1, 32, 2]);  convert_element_type_2326 = None
        view_as_complex_76 = torch.ops.aten.view_as_complex.default(view_2001);  view_2001 = None
        mul_1691 = torch.ops.aten.mul.Tensor(view_as_complex_76, clone_9);  view_as_complex_76 = None
        view_as_real_76 = torch.ops.aten.view_as_real.default(mul_1691);  mul_1691 = None
        view_2002 = torch.ops.aten.view.default(view_as_real_76, [2, 4096, 1, 64]);  view_as_real_76 = None
        convert_element_type_2327 = torch.ops.prims.convert_element_type.default(view_2002, torch.bfloat16);  view_2002 = None
        squeeze_37 = torch.ops.aten.squeeze.dim(convert_element_type_2327, 2);  convert_element_type_2327 = None
        cat_114 = torch.ops.aten.cat.default([convert_element_type_2323, squeeze_37], 2);  convert_element_type_2323 = squeeze_37 = None
        view_2003 = torch.ops.aten.view.default(cat_114, [8192, 576]);  cat_114 = None
        permute_998 = torch.ops.aten.permute.default(view_2003, [1, 0])
        mm_406 = torch.ops.aten.mm.default(permute_998, view_974);  permute_998 = None
        convert_element_type_801 = torch.ops.prims.convert_element_type.default(primals_249, torch.bfloat16);  primals_249 = None
        all_gather_into_tensor_251 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_801, 64, '0');  convert_element_type_801 = None
        wait_tensor_307 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_251);  all_gather_into_tensor_251 = None
        permute_222 = torch.ops.aten.permute.default(wait_tensor_307, [1, 0]);  wait_tensor_307 = None
        permute_1000 = torch.ops.aten.permute.default(permute_222, [1, 0]);  permute_222 = None
        mm_407 = torch.ops.aten.mm.default(view_2003, permute_1000);  view_2003 = permute_1000 = None
        view_2004 = torch.ops.aten.view.default(mm_407, [2, 4096, 2048]);  mm_407 = None
        convert_element_type_2332 = torch.ops.prims.convert_element_type.default(mm_406, torch.float32);  mm_406 = None
        reduce_scatter_tensor_167 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2332, 'avg', 64, '0');  convert_element_type_2332 = None
        wait_tensor_750 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_167);  reduce_scatter_tensor_167 = None
        slice_177 = torch.ops.aten.slice.Tensor(permute_993, 3, 0, 128)
        slice_178 = torch.ops.aten.slice.Tensor(permute_993, 3, 128, 192);  permute_993 = None
        convert_element_type_2333 = torch.ops.prims.convert_element_type.default(slice_178, torch.float32);  slice_178 = None
        view_2005 = torch.ops.aten.view.default(convert_element_type_2333, [2, 4096, 16, 32, 2]);  convert_element_type_2333 = None
        view_as_complex_77 = torch.ops.aten.view_as_complex.default(view_2005);  view_2005 = None
        mul_1692 = torch.ops.aten.mul.Tensor(view_as_complex_77, clone_9);  view_as_complex_77 = None
        view_as_real_77 = torch.ops.aten.view_as_real.default(mul_1692);  mul_1692 = None
        view_2006 = torch.ops.aten.view.default(view_as_real_77, [2, 4096, 16, 64]);  view_as_real_77 = None
        convert_element_type_2334 = torch.ops.prims.convert_element_type.default(view_2006, torch.bfloat16);  view_2006 = None
        cat_115 = torch.ops.aten.cat.default([slice_177, convert_element_type_2334], 3);  slice_177 = convert_element_type_2334 = None
        view_2007 = torch.ops.aten.view.default(cat_115, [2, 4096, 3072]);  cat_115 = None
        view_2008 = torch.ops.aten.view.default(view_2007, [8192, 3072]);  view_2007 = None
        permute_1002 = torch.ops.aten.permute.default(view_2008, [1, 0])
        mm_408 = torch.ops.aten.mm.default(permute_1002, view_974);  permute_1002 = view_974 = None
        convert_element_type_796 = torch.ops.prims.convert_element_type.default(primals_248, torch.bfloat16);  primals_248 = None
        all_gather_into_tensor_250 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_796, 64, '0');  convert_element_type_796 = None
        wait_tensor_306 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_250);  all_gather_into_tensor_250 = None
        permute_221 = torch.ops.aten.permute.default(wait_tensor_306, [1, 0]);  wait_tensor_306 = None
        permute_1004 = torch.ops.aten.permute.default(permute_221, [1, 0]);  permute_221 = None
        mm_409 = torch.ops.aten.mm.default(view_2008, permute_1004);  view_2008 = permute_1004 = None
        view_2009 = torch.ops.aten.view.default(mm_409, [2, 4096, 2048]);  mm_409 = None
        add_1953 = torch.ops.aten.add.Tensor(view_2004, view_2009);  view_2004 = view_2009 = None
        convert_element_type_2339 = torch.ops.prims.convert_element_type.default(mm_408, torch.float32);  mm_408 = None
        reduce_scatter_tensor_168 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2339, 'avg', 64, '0');  convert_element_type_2339 = None
        wait_tensor_751 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_168);  reduce_scatter_tensor_168 = None
        convert_element_type_2340 = torch.ops.prims.convert_element_type.default(add_1953, torch.float32);  add_1953 = None
        convert_element_type_793 = torch.ops.prims.convert_element_type.default(primals_247, torch.bfloat16);  primals_247 = None
        all_gather_into_tensor_249 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_793, 64, '0');  convert_element_type_793 = None
        wait_tensor_305 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_249);  all_gather_into_tensor_249 = None
        convert_element_type_2342 = torch.ops.prims.convert_element_type.default(wait_tensor_305, torch.float32);  wait_tensor_305 = None
        mul_1693 = torch.ops.aten.mul.Tensor(convert_element_type_2340, convert_element_type_2342);  convert_element_type_2342 = None
        convert_element_type_794 = torch.ops.prims.convert_element_type.default(add_957, torch.float32);  add_957 = None
        mul_695 = torch.ops.aten.mul.Tensor(convert_element_type_794, rsqrt_45);  convert_element_type_794 = None
        mul_1695 = torch.ops.aten.mul.Tensor(mul_695, mul_1693)
        sum_201 = torch.ops.aten.sum.dim_IntList(mul_1695, [2], True);  mul_1695 = None
        div_203 = torch.ops.aten.div.Tensor(mul_695, 2048)
        mul_1696 = torch.ops.aten.mul.Tensor(div_203, sum_201);  div_203 = sum_201 = None
        sub_696 = torch.ops.aten.sub.Tensor(mul_1693, mul_1696);  mul_1693 = mul_1696 = None
        mul_1697 = torch.ops.aten.mul.Tensor(sub_696, rsqrt_45);  sub_696 = rsqrt_45 = None
        mul_1698 = torch.ops.aten.mul.Tensor(convert_element_type_2340, mul_695);  convert_element_type_2340 = mul_695 = None
        sum_202 = torch.ops.aten.sum.dim_IntList(mul_1698, [0, 1]);  mul_1698 = None
        convert_element_type_2343 = torch.ops.prims.convert_element_type.default(mul_1697, torch.bfloat16);  mul_1697 = None
        add_1954 = torch.ops.aten.add.Tensor(add_1952, convert_element_type_2343);  add_1952 = convert_element_type_2343 = None
        convert_element_type_default_46 = torch.ops.prims.convert_element_type.default(sum_202, torch.float32);  sum_202 = None
        reduce_scatter_tensor_169 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_46, 'avg', 64, '0');  convert_element_type_default_46 = None
        wait_tensor_752 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_169);  reduce_scatter_tensor_169 = None
        view_2010 = torch.ops.aten.view.default(add_1954, [8192, 2048])
        unsqueeze_65 = torch.ops.aten.unsqueeze.default(view_2010, 1)
        convert_element_type_2346 = torch.ops.prims.convert_element_type.default(unsqueeze_65, torch.float32);  unsqueeze_65 = None
        bmm_50 = torch.ops.aten.bmm.default(permute_1006, convert_element_type_2346);  permute_1006 = None
        bmm_51 = torch.ops.aten.bmm.default(convert_element_type_2346, permute_1007);  convert_element_type_2346 = permute_1007 = None
        convert_element_type_2347 = torch.ops.prims.convert_element_type.default(bmm_50, torch.bfloat16);  bmm_50 = None
        view_2011 = torch.ops.aten.view.default(bmm_51, [8192, 6]);  bmm_51 = None
        view_2012 = torch.ops.aten.view.default(convert_element_type_2347, [49152, 2048]);  convert_element_type_2347 = None
        index_76 = torch.ops.aten.index.Tensor(view_2012, [getitem_203]);  view_2012 = getitem_203 = None
        permute_1008 = torch.ops.aten.permute.default(view_2010, [1, 0])
        mm_410 = torch.ops.aten.mm.default(permute_1008, mul_692);  permute_1008 = mul_692 = None
        convert_element_type_788 = torch.ops.prims.convert_element_type.default(primals_246, torch.bfloat16);  primals_246 = None
        all_gather_into_tensor_248 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_788, 64, '0');  convert_element_type_788 = None
        wait_tensor_304 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_248);  all_gather_into_tensor_248 = None
        permute_220 = torch.ops.aten.permute.default(wait_tensor_304, [1, 0]);  wait_tensor_304 = None
        permute_1010 = torch.ops.aten.permute.default(permute_220, [1, 0]);  permute_220 = None
        mm_411 = torch.ops.aten.mm.default(view_2010, permute_1010);  view_2010 = permute_1010 = None
        convert_element_type_2352 = torch.ops.prims.convert_element_type.default(mm_410, torch.float32);  mm_410 = None
        reduce_scatter_tensor_170 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2352, 'avg', 64, '0');  convert_element_type_2352 = None
        wait_tensor_753 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_170);  reduce_scatter_tensor_170 = None
        convert_element_type_783 = torch.ops.prims.convert_element_type.default(mm_116, torch.float32);  mm_116 = None
        neg_28 = torch.ops.aten.neg.default(convert_element_type_783)
        exp_42 = torch.ops.aten.exp.default(neg_28);  neg_28 = None
        add_952 = torch.ops.aten.add.Tensor(exp_42, 1);  exp_42 = None
        div_70 = torch.ops.aten.div.Tensor(convert_element_type_783, add_952)
        convert_element_type_784 = torch.ops.prims.convert_element_type.default(div_70, torch.bfloat16);  div_70 = None
        mul_1699 = torch.ops.aten.mul.Tensor(mm_411, convert_element_type_784);  convert_element_type_784 = None
        mul_1700 = torch.ops.aten.mul.Tensor(mm_411, mm_117);  mm_411 = mm_117 = None
        permute_1012 = torch.ops.aten.permute.default(mul_1699, [1, 0])
        mm_412 = torch.ops.aten.mm.default(permute_1012, view_929);  permute_1012 = None
        convert_element_type_785 = torch.ops.prims.convert_element_type.default(primals_245, torch.bfloat16);  primals_245 = None
        all_gather_into_tensor_247 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_785, 64, '0');  convert_element_type_785 = None
        wait_tensor_303 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_247);  all_gather_into_tensor_247 = None
        permute_219 = torch.ops.aten.permute.default(wait_tensor_303, [1, 0]);  wait_tensor_303 = None
        permute_1014 = torch.ops.aten.permute.default(permute_219, [1, 0]);  permute_219 = None
        mm_413 = torch.ops.aten.mm.default(mul_1699, permute_1014);  mul_1699 = permute_1014 = None
        convert_element_type_2357 = torch.ops.prims.convert_element_type.default(mm_412, torch.float32);  mm_412 = None
        reduce_scatter_tensor_171 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2357, 'avg', 64, '0');  convert_element_type_2357 = None
        wait_tensor_754 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_171);  reduce_scatter_tensor_171 = None
        convert_element_type_2358 = torch.ops.prims.convert_element_type.default(mul_1700, torch.float32);  mul_1700 = None
        reciprocal_24 = torch.ops.aten.reciprocal.default(add_952);  add_952 = None
        mul_1701 = torch.ops.aten.mul.Tensor(reciprocal_24, 1);  reciprocal_24 = None
        mul_1702 = torch.ops.aten.mul.Tensor(convert_element_type_2358, mul_1701);  convert_element_type_2358 = None
        sub_697 = torch.ops.aten.sub.Tensor(1, mul_1701);  mul_1701 = None
        mul_1703 = torch.ops.aten.mul.Tensor(convert_element_type_783, sub_697);  convert_element_type_783 = sub_697 = None
        add_1956 = torch.ops.aten.add.Tensor(mul_1703, 1);  mul_1703 = None
        mul_1704 = torch.ops.aten.mul.Tensor(mul_1702, add_1956);  mul_1702 = add_1956 = None
        convert_element_type_2360 = torch.ops.prims.convert_element_type.default(mul_1704, torch.bfloat16);  mul_1704 = None
        permute_1016 = torch.ops.aten.permute.default(convert_element_type_2360, [1, 0])
        mm_414 = torch.ops.aten.mm.default(permute_1016, view_929);  permute_1016 = None
        convert_element_type_780 = torch.ops.prims.convert_element_type.default(primals_244, torch.bfloat16);  primals_244 = None
        all_gather_into_tensor_246 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_780, 64, '0');  convert_element_type_780 = None
        wait_tensor_302 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_246);  all_gather_into_tensor_246 = None
        permute_218 = torch.ops.aten.permute.default(wait_tensor_302, [1, 0]);  wait_tensor_302 = None
        permute_1018 = torch.ops.aten.permute.default(permute_218, [1, 0]);  permute_218 = None
        mm_415 = torch.ops.aten.mm.default(convert_element_type_2360, permute_1018);  convert_element_type_2360 = permute_1018 = None
        add_1957 = torch.ops.aten.add.Tensor(mm_413, mm_415);  mm_413 = mm_415 = None
        convert_element_type_2365 = torch.ops.prims.convert_element_type.default(mm_414, torch.float32);  mm_414 = None
        reduce_scatter_tensor_172 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2365, 'avg', 64, '0');  convert_element_type_2365 = None
        wait_tensor_755 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_172);  reduce_scatter_tensor_172 = None
        all_to_all_single_102 = torch.ops._c10d_functional.all_to_all_single.default(index_76, [_local_scalar_dense_216, _local_scalar_dense_217, _local_scalar_dense_218, _local_scalar_dense_219, _local_scalar_dense_220, _local_scalar_dense_221, _local_scalar_dense_222, _local_scalar_dense_223], [_local_scalar_dense_208, _local_scalar_dense_209, _local_scalar_dense_210, _local_scalar_dense_211, _local_scalar_dense_212, _local_scalar_dense_213, _local_scalar_dense_214, _local_scalar_dense_215], '521');  index_76 = None
        wait_tensor_756 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_102);  all_to_all_single_102 = None
        full_396 = torch.ops.aten.full.default([sym_size_int_53, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_53 = None
        slice_scatter_12 = torch.ops.aten.slice_scatter.default(full_396, wait_tensor_756, 0, 0, -1);  wait_tensor_756 = None
        index_77 = torch.ops.aten.index.Tensor(slice_scatter_12, [getitem_204]);  slice_scatter_12 = None
        permute_1020 = torch.ops.aten.permute.default(index_77, [1, 0])
        _grouped_mm_150 = torch.ops.aten._grouped_mm.default(permute_1020, mul_672, cumsum_41);  permute_1020 = mul_672 = None
        convert_element_type_774 = torch.ops.prims.convert_element_type.default(primals_242, torch.bfloat16);  primals_242 = None
        all_gather_into_tensor_242 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_774, 8, '513');  convert_element_type_774 = None
        wait_tensor_297 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_242);  all_gather_into_tensor_242 = None
        permute_217 = torch.ops.aten.permute.default(wait_tensor_297, [0, 2, 1]);  wait_tensor_297 = None
        permute_1022 = torch.ops.aten.permute.default(permute_217, [0, 2, 1]);  permute_217 = None
        _grouped_mm_151 = torch.ops.aten._grouped_mm.default(index_77, permute_1022, cumsum_41);  index_77 = permute_1022 = None
        convert_element_type_778 = torch.ops.prims.convert_element_type.default(_grouped_mm_39, torch.float32);  _grouped_mm_39 = None
        neg_27 = torch.ops.aten.neg.default(convert_element_type_778)
        exp_41 = torch.ops.aten.exp.default(neg_27);  neg_27 = None
        add_916 = torch.ops.aten.add.Tensor(exp_41, 1);  exp_41 = None
        div_69 = torch.ops.aten.div.Tensor(convert_element_type_778, add_916)
        convert_element_type_779 = torch.ops.prims.convert_element_type.default(div_69, torch.bfloat16);  div_69 = None
        mul_1705 = torch.ops.aten.mul.Tensor(_grouped_mm_151, convert_element_type_779);  convert_element_type_779 = None
        mul_1706 = torch.ops.aten.mul.Tensor(_grouped_mm_151, _grouped_mm_40);  _grouped_mm_151 = _grouped_mm_40 = None
        permute_1024 = torch.ops.aten.permute.default(mul_1705, [1, 0])
        _grouped_mm_152 = torch.ops.aten._grouped_mm.default(permute_1024, index_27, cumsum_41);  permute_1024 = None
        convert_element_type_775 = torch.ops.prims.convert_element_type.default(primals_243, torch.bfloat16);  primals_243 = None
        all_gather_into_tensor_243 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_775, 8, '513');  convert_element_type_775 = None
        wait_tensor_298 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_243);  all_gather_into_tensor_243 = None
        permute_216 = torch.ops.aten.permute.default(wait_tensor_298, [0, 2, 1]);  wait_tensor_298 = None
        permute_1026 = torch.ops.aten.permute.default(permute_216, [0, 2, 1]);  permute_216 = None
        _grouped_mm_153 = torch.ops.aten._grouped_mm.default(mul_1705, permute_1026, cumsum_41);  mul_1705 = permute_1026 = None
        convert_element_type_2366 = torch.ops.prims.convert_element_type.default(mul_1706, torch.float32);  mul_1706 = None
        reciprocal_25 = torch.ops.aten.reciprocal.default(add_916);  add_916 = None
        mul_1707 = torch.ops.aten.mul.Tensor(reciprocal_25, 1);  reciprocal_25 = None
        mul_1708 = torch.ops.aten.mul.Tensor(convert_element_type_2366, mul_1707);  convert_element_type_2366 = None
        sub_698 = torch.ops.aten.sub.Tensor(1, mul_1707);  mul_1707 = None
        mul_1709 = torch.ops.aten.mul.Tensor(convert_element_type_778, sub_698);  convert_element_type_778 = sub_698 = None
        add_1959 = torch.ops.aten.add.Tensor(mul_1709, 1);  mul_1709 = None
        mul_1710 = torch.ops.aten.mul.Tensor(mul_1708, add_1959);  mul_1708 = add_1959 = None
        convert_element_type_2368 = torch.ops.prims.convert_element_type.default(mul_1710, torch.bfloat16);  mul_1710 = None
        permute_1028 = torch.ops.aten.permute.default(convert_element_type_2368, [1, 0])
        _grouped_mm_154 = torch.ops.aten._grouped_mm.default(permute_1028, index_27, cumsum_41);  permute_1028 = index_27 = None
        convert_element_type_772 = torch.ops.prims.convert_element_type.default(primals_241, torch.bfloat16);  primals_241 = None
        all_gather_into_tensor_240 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_772, 8, '513');  convert_element_type_772 = None
        wait_tensor_295 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_240);  all_gather_into_tensor_240 = None
        permute_215 = torch.ops.aten.permute.default(wait_tensor_295, [0, 2, 1]);  wait_tensor_295 = None
        permute_1030 = torch.ops.aten.permute.default(permute_215, [0, 2, 1]);  permute_215 = None
        _grouped_mm_155 = torch.ops.aten._grouped_mm.default(convert_element_type_2368, permute_1030, cumsum_41);  convert_element_type_2368 = permute_1030 = cumsum_41 = None
        add_1960 = torch.ops.aten.add.Tensor(_grouped_mm_153, _grouped_mm_155);  _grouped_mm_153 = _grouped_mm_155 = None
        convert_element_type_2369 = torch.ops.prims.convert_element_type.default(_grouped_mm_152, torch.float32);  _grouped_mm_152 = None
        div_204 = torch.ops.aten.div.Tensor(convert_element_type_2369, 64);  convert_element_type_2369 = None
        reduce_scatter_tensor_173 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_204, 'sum', 8, '513');  div_204 = None
        wait_tensor_757 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_173);  reduce_scatter_tensor_173 = None
        convert_element_type_2370 = torch.ops.prims.convert_element_type.default(_grouped_mm_150, torch.float32);  _grouped_mm_150 = None
        div_205 = torch.ops.aten.div.Tensor(convert_element_type_2370, 64);  convert_element_type_2370 = None
        reduce_scatter_tensor_174 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_205, 'sum', 8, '513');  div_205 = None
        wait_tensor_758 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_174);  reduce_scatter_tensor_174 = None
        convert_element_type_2371 = torch.ops.prims.convert_element_type.default(_grouped_mm_154, torch.float32);  _grouped_mm_154 = None
        div_206 = torch.ops.aten.div.Tensor(convert_element_type_2371, 64);  convert_element_type_2371 = None
        reduce_scatter_tensor_175 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_206, 'sum', 8, '513');  div_206 = None
        wait_tensor_759 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_175);  reduce_scatter_tensor_175 = None
        index_put_76 = torch.ops.aten.index_put.default(full_396, [getitem_204], add_1960, True);  full_396 = getitem_204 = add_1960 = None
        slice_179 = torch.ops.aten.slice.Tensor(index_put_76, 0, 0, add_1961);  index_put_76 = add_1961 = None
        all_to_all_single_103 = torch.ops._c10d_functional.all_to_all_single.default(slice_179, [_local_scalar_dense_208, _local_scalar_dense_209, _local_scalar_dense_210, _local_scalar_dense_211, _local_scalar_dense_212, _local_scalar_dense_213, _local_scalar_dense_214, _local_scalar_dense_215], [_local_scalar_dense_216, _local_scalar_dense_217, _local_scalar_dense_218, _local_scalar_dense_219, _local_scalar_dense_220, _local_scalar_dense_221, _local_scalar_dense_222, _local_scalar_dense_223], '521');  slice_179 = _local_scalar_dense_208 = _local_scalar_dense_209 = _local_scalar_dense_210 = _local_scalar_dense_211 = _local_scalar_dense_212 = _local_scalar_dense_213 = _local_scalar_dense_214 = _local_scalar_dense_215 = _local_scalar_dense_216 = _local_scalar_dense_217 = _local_scalar_dense_218 = _local_scalar_dense_219 = _local_scalar_dense_220 = _local_scalar_dense_221 = _local_scalar_dense_222 = _local_scalar_dense_223 = None
        wait_tensor_760 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_103);  all_to_all_single_103 = None
        index_put_77 = torch.ops.aten.index_put.default(full_default_52, [div_67], wait_tensor_760, True);  div_67 = wait_tensor_760 = None
        add_1965 = torch.ops.aten.add.Tensor(add_1957, index_put_77);  add_1957 = index_put_77 = None
        mul_1711 = torch.ops.aten.mul.Tensor(view_2011, 1.0);  view_2011 = None
        scatter_add_12 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_201, mul_1711);  getitem_201 = mul_1711 = None
        convert_element_type_767 = torch.ops.prims.convert_element_type.default(mm_115, torch.float32);  mm_115 = None
        sub_312 = torch.ops.aten.sub.Tensor(convert_element_type_767, amax_13);  convert_element_type_767 = amax_13 = None
        exp_40 = torch.ops.aten.exp.default(sub_312);  sub_312 = None
        div_66 = torch.ops.aten.div.Tensor(exp_40, sum_53);  exp_40 = sum_53 = None
        mul_1712 = torch.ops.aten.mul.Tensor(scatter_add_12, div_66);  scatter_add_12 = None
        sum_203 = torch.ops.aten.sum.dim_IntList(mul_1712, [1], True)
        neg_91 = torch.ops.aten.neg.default(div_66);  div_66 = None
        fma_12 = torch.ops.prims.fma.default(neg_91, sum_203, mul_1712);  neg_91 = sum_203 = mul_1712 = None
        convert_element_type_2372 = torch.ops.prims.convert_element_type.default(fma_12, torch.bfloat16);  fma_12 = None
        permute_1032 = torch.ops.aten.permute.default(convert_element_type_2372, [1, 0])
        mm_416 = torch.ops.aten.mm.default(permute_1032, view_929);  permute_1032 = view_929 = None
        convert_element_type_764 = torch.ops.prims.convert_element_type.default(primals_239, torch.bfloat16);  primals_239 = None
        all_gather_into_tensor_239 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_764, 64, '0');  convert_element_type_764 = None
        wait_tensor_291 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_239);  all_gather_into_tensor_239 = None
        permute_214 = torch.ops.aten.permute.default(wait_tensor_291, [1, 0]);  wait_tensor_291 = None
        permute_1034 = torch.ops.aten.permute.default(permute_214, [1, 0]);  permute_214 = None
        mm_417 = torch.ops.aten.mm.default(convert_element_type_2372, permute_1034);  convert_element_type_2372 = permute_1034 = None
        add_1966 = torch.ops.aten.add.Tensor(add_1965, mm_417);  add_1965 = mm_417 = None
        convert_element_type_2377 = torch.ops.prims.convert_element_type.default(mm_416, torch.float32);  mm_416 = None
        reduce_scatter_tensor_176 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2377, 'avg', 64, '0');  convert_element_type_2377 = None
        wait_tensor_761 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_176);  reduce_scatter_tensor_176 = None
        view_2013 = torch.ops.aten.view.default(add_1966, [2, 4096, 2048]);  add_1966 = None
        convert_element_type_2378 = torch.ops.prims.convert_element_type.default(view_2013, torch.float32);  view_2013 = None
        convert_element_type_761 = torch.ops.prims.convert_element_type.default(primals_237, torch.bfloat16);  primals_237 = None
        all_gather_into_tensor_238 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_761, 64, '0');  convert_element_type_761 = None
        wait_tensor_290 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_238);  all_gather_into_tensor_238 = None
        convert_element_type_2380 = torch.ops.prims.convert_element_type.default(wait_tensor_290, torch.float32);  wait_tensor_290 = None
        mul_1713 = torch.ops.aten.mul.Tensor(convert_element_type_2378, convert_element_type_2380);  convert_element_type_2380 = None
        convert_element_type_762 = torch.ops.prims.convert_element_type.default(add_892, torch.float32);  add_892 = None
        mul_652 = torch.ops.aten.mul.Tensor(convert_element_type_762, rsqrt_44);  convert_element_type_762 = None
        mul_1715 = torch.ops.aten.mul.Tensor(mul_652, mul_1713)
        sum_204 = torch.ops.aten.sum.dim_IntList(mul_1715, [2], True);  mul_1715 = None
        div_207 = torch.ops.aten.div.Tensor(mul_652, 2048)
        mul_1716 = torch.ops.aten.mul.Tensor(div_207, sum_204);  div_207 = sum_204 = None
        sub_700 = torch.ops.aten.sub.Tensor(mul_1713, mul_1716);  mul_1713 = mul_1716 = None
        mul_1717 = torch.ops.aten.mul.Tensor(sub_700, rsqrt_44);  sub_700 = rsqrt_44 = None
        mul_1718 = torch.ops.aten.mul.Tensor(convert_element_type_2378, mul_652);  convert_element_type_2378 = mul_652 = None
        sum_205 = torch.ops.aten.sum.dim_IntList(mul_1718, [0, 1]);  mul_1718 = None
        convert_element_type_2381 = torch.ops.prims.convert_element_type.default(mul_1717, torch.bfloat16);  mul_1717 = None
        add_1967 = torch.ops.aten.add.Tensor(add_1954, convert_element_type_2381);  add_1954 = convert_element_type_2381 = None
        convert_element_type_default_45 = torch.ops.prims.convert_element_type.default(sum_205, torch.float32);  sum_205 = None
        reduce_scatter_tensor_177 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_45, 'avg', 64, '0');  convert_element_type_default_45 = None
        wait_tensor_762 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_177);  reduce_scatter_tensor_177 = None
        view_2014 = torch.ops.aten.view.default(add_1967, [8192, 2048])
        permute_1036 = torch.ops.aten.permute.default(view_2014, [1, 0])
        permute_212 = torch.ops.aten.permute.default(getitem_197, [0, 2, 1, 3])
        view_924 = torch.ops.aten.view.default(permute_212, [2, 4096, -1]);  permute_212 = None
        view_926 = torch.ops.aten.view.default(view_924, [8192, 2048]);  view_924 = None
        mm_418 = torch.ops.aten.mm.default(permute_1036, view_926);  permute_1036 = view_926 = None
        convert_element_type_758 = torch.ops.prims.convert_element_type.default(primals_236, torch.bfloat16);  primals_236 = None
        all_gather_into_tensor_237 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_758, 64, '0');  convert_element_type_758 = None
        wait_tensor_289 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_237);  all_gather_into_tensor_237 = None
        permute_213 = torch.ops.aten.permute.default(wait_tensor_289, [1, 0]);  wait_tensor_289 = None
        permute_1038 = torch.ops.aten.permute.default(permute_213, [1, 0]);  permute_213 = None
        mm_419 = torch.ops.aten.mm.default(view_2014, permute_1038);  view_2014 = permute_1038 = None
        view_2015 = torch.ops.aten.view.default(mm_419, [2, 4096, 2048]);  mm_419 = None
        convert_element_type_2388 = torch.ops.prims.convert_element_type.default(mm_418, torch.float32);  mm_418 = None
        reduce_scatter_tensor_178 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2388, 'avg', 64, '0');  convert_element_type_2388 = None
        wait_tensor_763 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_178);  reduce_scatter_tensor_178 = None
        view_2016 = torch.ops.aten.view.default(view_2015, [2, 4096, 16, 128]);  view_2015 = None
        permute_1040 = torch.ops.aten.permute.default(view_2016, [0, 2, 1, 3]);  view_2016 = None
        fw_graph12 = self.fw_graph12
        joint_graph12 = self.joint_graph12
        mask_graph12 = self.mask_graph12
        flex_attention_backward_12 = torch.ops.higher_order.flex_attention_backward(permute_209, permute_210, permute_211, getitem_197, getitem_198, permute_1040, None, fw_graph12, joint_graph12, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph12), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_209 = permute_210 = permute_211 = getitem_197 = getitem_198 = permute_1040 = fw_graph12 = joint_graph12 = mask_graph12 = None
        getitem_421 = flex_attention_backward_12[0]
        getitem_422 = flex_attention_backward_12[1]
        getitem_423 = flex_attention_backward_12[2];  flex_attention_backward_12 = None
        permute_1041 = torch.ops.aten.permute.default(getitem_423, [0, 2, 1, 3]);  getitem_423 = None
        permute_1042 = torch.ops.aten.permute.default(getitem_422, [0, 2, 1, 3]);  getitem_422 = None
        permute_1043 = torch.ops.aten.permute.default(getitem_421, [0, 2, 1, 3]);  getitem_421 = None
        slice_181 = torch.ops.aten.slice.Tensor(permute_1042, 3, 0, 128)
        slice_182 = torch.ops.aten.slice.Tensor(permute_1042, 3, 128, 192);  permute_1042 = None
        sum_206 = torch.ops.aten.sum.dim_IntList(slice_182, [2], True);  slice_182 = None
        cat_116 = torch.ops.aten.cat.default([slice_181, permute_1041], 3);  slice_181 = permute_1041 = None
        view_2017 = torch.ops.aten.view.default(cat_116, [2, 4096, 4096]);  cat_116 = None
        view_2018 = torch.ops.aten.view.default(view_2017, [8192, 4096]);  view_2017 = None
        permute_1044 = torch.ops.aten.permute.default(view_2018, [1, 0])
        mm_420 = torch.ops.aten.mm.default(permute_1044, view_921);  permute_1044 = view_921 = None
        convert_element_type_755 = torch.ops.prims.convert_element_type.default(primals_235, torch.bfloat16);  primals_235 = None
        all_gather_into_tensor_236 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_755, 64, '0');  convert_element_type_755 = None
        wait_tensor_288 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_236);  all_gather_into_tensor_236 = None
        permute_208 = torch.ops.aten.permute.default(wait_tensor_288, [1, 0]);  wait_tensor_288 = None
        permute_1046 = torch.ops.aten.permute.default(permute_208, [1, 0]);  permute_208 = None
        mm_421 = torch.ops.aten.mm.default(view_2018, permute_1046);  view_2018 = permute_1046 = None
        view_2019 = torch.ops.aten.view.default(mm_421, [2, 4096, 512]);  mm_421 = None
        convert_element_type_2393 = torch.ops.prims.convert_element_type.default(mm_420, torch.float32);  mm_420 = None
        reduce_scatter_tensor_179 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2393, 'avg', 64, '0');  convert_element_type_2393 = None
        wait_tensor_764 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_179);  reduce_scatter_tensor_179 = None
        convert_element_type_2394 = torch.ops.prims.convert_element_type.default(view_2019, torch.float32);  view_2019 = None
        convert_element_type_752 = torch.ops.prims.convert_element_type.default(primals_234, torch.bfloat16);  primals_234 = None
        all_gather_into_tensor_235 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_752, 64, '0');  convert_element_type_752 = None
        wait_tensor_287 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_235);  all_gather_into_tensor_235 = None
        convert_element_type_2396 = torch.ops.prims.convert_element_type.default(wait_tensor_287, torch.float32);  wait_tensor_287 = None
        mul_1719 = torch.ops.aten.mul.Tensor(convert_element_type_2394, convert_element_type_2396);  convert_element_type_2396 = None
        convert_element_type_753 = torch.ops.prims.convert_element_type.default(getitem_193, torch.float32);  getitem_193 = None
        mul_650 = torch.ops.aten.mul.Tensor(convert_element_type_753, rsqrt_43);  convert_element_type_753 = None
        mul_1721 = torch.ops.aten.mul.Tensor(mul_650, mul_1719)
        sum_207 = torch.ops.aten.sum.dim_IntList(mul_1721, [2], True);  mul_1721 = None
        div_208 = torch.ops.aten.div.Tensor(mul_650, 512)
        mul_1722 = torch.ops.aten.mul.Tensor(div_208, sum_207);  div_208 = sum_207 = None
        sub_701 = torch.ops.aten.sub.Tensor(mul_1719, mul_1722);  mul_1719 = mul_1722 = None
        mul_1723 = torch.ops.aten.mul.Tensor(sub_701, rsqrt_43);  sub_701 = rsqrt_43 = None
        mul_1724 = torch.ops.aten.mul.Tensor(convert_element_type_2394, mul_650);  convert_element_type_2394 = mul_650 = None
        sum_208 = torch.ops.aten.sum.dim_IntList(mul_1724, [0, 1]);  mul_1724 = None
        convert_element_type_2397 = torch.ops.prims.convert_element_type.default(mul_1723, torch.bfloat16);  mul_1723 = None
        convert_element_type_default_44 = torch.ops.prims.convert_element_type.default(sum_208, torch.float32);  sum_208 = None
        reduce_scatter_tensor_180 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_44, 'avg', 64, '0');  convert_element_type_default_44 = None
        wait_tensor_765 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_180);  reduce_scatter_tensor_180 = None
        convert_element_type_2400 = torch.ops.prims.convert_element_type.default(sum_206, torch.float32);  sum_206 = None
        view_2020 = torch.ops.aten.view.default(convert_element_type_2400, [2, 4096, 1, 32, 2]);  convert_element_type_2400 = None
        view_as_complex_78 = torch.ops.aten.view_as_complex.default(view_2020);  view_2020 = None
        mul_1725 = torch.ops.aten.mul.Tensor(view_as_complex_78, clone_9);  view_as_complex_78 = None
        view_as_real_78 = torch.ops.aten.view_as_real.default(mul_1725);  mul_1725 = None
        view_2021 = torch.ops.aten.view.default(view_as_real_78, [2, 4096, 1, 64]);  view_as_real_78 = None
        convert_element_type_2401 = torch.ops.prims.convert_element_type.default(view_2021, torch.bfloat16);  view_2021 = None
        squeeze_38 = torch.ops.aten.squeeze.dim(convert_element_type_2401, 2);  convert_element_type_2401 = None
        cat_117 = torch.ops.aten.cat.default([convert_element_type_2397, squeeze_38], 2);  convert_element_type_2397 = squeeze_38 = None
        view_2022 = torch.ops.aten.view.default(cat_117, [8192, 576]);  cat_117 = None
        permute_1048 = torch.ops.aten.permute.default(view_2022, [1, 0])
        mm_422 = torch.ops.aten.mm.default(permute_1048, view_907);  permute_1048 = None
        convert_element_type_747 = torch.ops.prims.convert_element_type.default(primals_233, torch.bfloat16);  primals_233 = None
        all_gather_into_tensor_234 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_747, 64, '0');  convert_element_type_747 = None
        wait_tensor_286 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_234);  all_gather_into_tensor_234 = None
        permute_207 = torch.ops.aten.permute.default(wait_tensor_286, [1, 0]);  wait_tensor_286 = None
        permute_1050 = torch.ops.aten.permute.default(permute_207, [1, 0]);  permute_207 = None
        mm_423 = torch.ops.aten.mm.default(view_2022, permute_1050);  view_2022 = permute_1050 = None
        view_2023 = torch.ops.aten.view.default(mm_423, [2, 4096, 2048]);  mm_423 = None
        convert_element_type_2406 = torch.ops.prims.convert_element_type.default(mm_422, torch.float32);  mm_422 = None
        reduce_scatter_tensor_181 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2406, 'avg', 64, '0');  convert_element_type_2406 = None
        wait_tensor_766 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_181);  reduce_scatter_tensor_181 = None
        slice_183 = torch.ops.aten.slice.Tensor(permute_1043, 3, 0, 128)
        slice_184 = torch.ops.aten.slice.Tensor(permute_1043, 3, 128, 192);  permute_1043 = None
        convert_element_type_2407 = torch.ops.prims.convert_element_type.default(slice_184, torch.float32);  slice_184 = None
        view_2024 = torch.ops.aten.view.default(convert_element_type_2407, [2, 4096, 16, 32, 2]);  convert_element_type_2407 = None
        view_as_complex_79 = torch.ops.aten.view_as_complex.default(view_2024);  view_2024 = None
        mul_1726 = torch.ops.aten.mul.Tensor(view_as_complex_79, clone_9);  view_as_complex_79 = None
        view_as_real_79 = torch.ops.aten.view_as_real.default(mul_1726);  mul_1726 = None
        view_2025 = torch.ops.aten.view.default(view_as_real_79, [2, 4096, 16, 64]);  view_as_real_79 = None
        convert_element_type_2408 = torch.ops.prims.convert_element_type.default(view_2025, torch.bfloat16);  view_2025 = None
        cat_118 = torch.ops.aten.cat.default([slice_183, convert_element_type_2408], 3);  slice_183 = convert_element_type_2408 = None
        view_2026 = torch.ops.aten.view.default(cat_118, [2, 4096, 3072]);  cat_118 = None
        view_2027 = torch.ops.aten.view.default(view_2026, [8192, 3072]);  view_2026 = None
        permute_1052 = torch.ops.aten.permute.default(view_2027, [1, 0])
        mm_424 = torch.ops.aten.mm.default(permute_1052, view_907);  permute_1052 = view_907 = None
        convert_element_type_742 = torch.ops.prims.convert_element_type.default(primals_232, torch.bfloat16);  primals_232 = None
        all_gather_into_tensor_233 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_742, 64, '0');  convert_element_type_742 = None
        wait_tensor_285 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_233);  all_gather_into_tensor_233 = None
        permute_206 = torch.ops.aten.permute.default(wait_tensor_285, [1, 0]);  wait_tensor_285 = None
        permute_1054 = torch.ops.aten.permute.default(permute_206, [1, 0]);  permute_206 = None
        mm_425 = torch.ops.aten.mm.default(view_2027, permute_1054);  view_2027 = permute_1054 = None
        view_2028 = torch.ops.aten.view.default(mm_425, [2, 4096, 2048]);  mm_425 = None
        add_1968 = torch.ops.aten.add.Tensor(view_2023, view_2028);  view_2023 = view_2028 = None
        convert_element_type_2413 = torch.ops.prims.convert_element_type.default(mm_424, torch.float32);  mm_424 = None
        reduce_scatter_tensor_182 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2413, 'avg', 64, '0');  convert_element_type_2413 = None
        wait_tensor_767 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_182);  reduce_scatter_tensor_182 = None
        convert_element_type_2414 = torch.ops.prims.convert_element_type.default(add_1968, torch.float32);  add_1968 = None
        convert_element_type_739 = torch.ops.prims.convert_element_type.default(primals_231, torch.bfloat16);  primals_231 = None
        all_gather_into_tensor_232 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_739, 64, '0');  convert_element_type_739 = None
        wait_tensor_284 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_232);  all_gather_into_tensor_232 = None
        convert_element_type_2416 = torch.ops.prims.convert_element_type.default(wait_tensor_284, torch.float32);  wait_tensor_284 = None
        mul_1727 = torch.ops.aten.mul.Tensor(convert_element_type_2414, convert_element_type_2416);  convert_element_type_2416 = None
        convert_element_type_740 = torch.ops.prims.convert_element_type.default(add_889, torch.float32);  add_889 = None
        mul_646 = torch.ops.aten.mul.Tensor(convert_element_type_740, rsqrt_42);  convert_element_type_740 = None
        mul_1729 = torch.ops.aten.mul.Tensor(mul_646, mul_1727)
        sum_209 = torch.ops.aten.sum.dim_IntList(mul_1729, [2], True);  mul_1729 = None
        div_209 = torch.ops.aten.div.Tensor(mul_646, 2048)
        mul_1730 = torch.ops.aten.mul.Tensor(div_209, sum_209);  div_209 = sum_209 = None
        sub_702 = torch.ops.aten.sub.Tensor(mul_1727, mul_1730);  mul_1727 = mul_1730 = None
        mul_1731 = torch.ops.aten.mul.Tensor(sub_702, rsqrt_42);  sub_702 = rsqrt_42 = None
        mul_1732 = torch.ops.aten.mul.Tensor(convert_element_type_2414, mul_646);  convert_element_type_2414 = mul_646 = None
        sum_210 = torch.ops.aten.sum.dim_IntList(mul_1732, [0, 1]);  mul_1732 = None
        convert_element_type_2417 = torch.ops.prims.convert_element_type.default(mul_1731, torch.bfloat16);  mul_1731 = None
        add_1969 = torch.ops.aten.add.Tensor(add_1967, convert_element_type_2417);  add_1967 = convert_element_type_2417 = None
        convert_element_type_default_43 = torch.ops.prims.convert_element_type.default(sum_210, torch.float32);  sum_210 = None
        reduce_scatter_tensor_183 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_43, 'avg', 64, '0');  convert_element_type_default_43 = None
        wait_tensor_768 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_183);  reduce_scatter_tensor_183 = None
        view_2029 = torch.ops.aten.view.default(add_1969, [8192, 2048])
        unsqueeze_66 = torch.ops.aten.unsqueeze.default(view_2029, 1)
        convert_element_type_2420 = torch.ops.prims.convert_element_type.default(unsqueeze_66, torch.float32);  unsqueeze_66 = None
        bmm_52 = torch.ops.aten.bmm.default(permute_1056, convert_element_type_2420);  permute_1056 = None
        bmm_53 = torch.ops.aten.bmm.default(convert_element_type_2420, permute_1057);  convert_element_type_2420 = permute_1057 = None
        convert_element_type_2421 = torch.ops.prims.convert_element_type.default(bmm_52, torch.bfloat16);  bmm_52 = None
        view_2030 = torch.ops.aten.view.default(bmm_53, [8192, 6]);  bmm_53 = None
        view_2031 = torch.ops.aten.view.default(convert_element_type_2421, [49152, 2048]);  convert_element_type_2421 = None
        index_78 = torch.ops.aten.index.Tensor(view_2031, [getitem_189]);  view_2031 = getitem_189 = None
        permute_1058 = torch.ops.aten.permute.default(view_2029, [1, 0])
        mm_426 = torch.ops.aten.mm.default(permute_1058, mul_643);  permute_1058 = mul_643 = None
        convert_element_type_734 = torch.ops.prims.convert_element_type.default(primals_230, torch.bfloat16);  primals_230 = None
        all_gather_into_tensor_231 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_734, 64, '0');  convert_element_type_734 = None
        wait_tensor_283 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_231);  all_gather_into_tensor_231 = None
        permute_205 = torch.ops.aten.permute.default(wait_tensor_283, [1, 0]);  wait_tensor_283 = None
        permute_1060 = torch.ops.aten.permute.default(permute_205, [1, 0]);  permute_205 = None
        mm_427 = torch.ops.aten.mm.default(view_2029, permute_1060);  view_2029 = permute_1060 = None
        convert_element_type_2426 = torch.ops.prims.convert_element_type.default(mm_426, torch.float32);  mm_426 = None
        reduce_scatter_tensor_184 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2426, 'avg', 64, '0');  convert_element_type_2426 = None
        wait_tensor_769 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_184);  reduce_scatter_tensor_184 = None
        convert_element_type_729 = torch.ops.prims.convert_element_type.default(mm_108, torch.float32);  mm_108 = None
        neg_26 = torch.ops.aten.neg.default(convert_element_type_729)
        exp_39 = torch.ops.aten.exp.default(neg_26);  neg_26 = None
        add_884 = torch.ops.aten.add.Tensor(exp_39, 1);  exp_39 = None
        div_65 = torch.ops.aten.div.Tensor(convert_element_type_729, add_884)
        convert_element_type_730 = torch.ops.prims.convert_element_type.default(div_65, torch.bfloat16);  div_65 = None
        mul_1733 = torch.ops.aten.mul.Tensor(mm_427, convert_element_type_730);  convert_element_type_730 = None
        mul_1734 = torch.ops.aten.mul.Tensor(mm_427, mm_109);  mm_427 = mm_109 = None
        permute_1062 = torch.ops.aten.permute.default(mul_1733, [1, 0])
        mm_428 = torch.ops.aten.mm.default(permute_1062, view_862);  permute_1062 = None
        convert_element_type_731 = torch.ops.prims.convert_element_type.default(primals_229, torch.bfloat16);  primals_229 = None
        all_gather_into_tensor_230 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_731, 64, '0');  convert_element_type_731 = None
        wait_tensor_282 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_230);  all_gather_into_tensor_230 = None
        permute_204 = torch.ops.aten.permute.default(wait_tensor_282, [1, 0]);  wait_tensor_282 = None
        permute_1064 = torch.ops.aten.permute.default(permute_204, [1, 0]);  permute_204 = None
        mm_429 = torch.ops.aten.mm.default(mul_1733, permute_1064);  mul_1733 = permute_1064 = None
        convert_element_type_2431 = torch.ops.prims.convert_element_type.default(mm_428, torch.float32);  mm_428 = None
        reduce_scatter_tensor_185 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2431, 'avg', 64, '0');  convert_element_type_2431 = None
        wait_tensor_770 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_185);  reduce_scatter_tensor_185 = None
        convert_element_type_2432 = torch.ops.prims.convert_element_type.default(mul_1734, torch.float32);  mul_1734 = None
        reciprocal_26 = torch.ops.aten.reciprocal.default(add_884);  add_884 = None
        mul_1735 = torch.ops.aten.mul.Tensor(reciprocal_26, 1);  reciprocal_26 = None
        mul_1736 = torch.ops.aten.mul.Tensor(convert_element_type_2432, mul_1735);  convert_element_type_2432 = None
        sub_703 = torch.ops.aten.sub.Tensor(1, mul_1735);  mul_1735 = None
        mul_1737 = torch.ops.aten.mul.Tensor(convert_element_type_729, sub_703);  convert_element_type_729 = sub_703 = None
        add_1971 = torch.ops.aten.add.Tensor(mul_1737, 1);  mul_1737 = None
        mul_1738 = torch.ops.aten.mul.Tensor(mul_1736, add_1971);  mul_1736 = add_1971 = None
        convert_element_type_2434 = torch.ops.prims.convert_element_type.default(mul_1738, torch.bfloat16);  mul_1738 = None
        permute_1066 = torch.ops.aten.permute.default(convert_element_type_2434, [1, 0])
        mm_430 = torch.ops.aten.mm.default(permute_1066, view_862);  permute_1066 = None
        convert_element_type_726 = torch.ops.prims.convert_element_type.default(primals_228, torch.bfloat16);  primals_228 = None
        all_gather_into_tensor_229 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_726, 64, '0');  convert_element_type_726 = None
        wait_tensor_281 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_229);  all_gather_into_tensor_229 = None
        permute_203 = torch.ops.aten.permute.default(wait_tensor_281, [1, 0]);  wait_tensor_281 = None
        permute_1068 = torch.ops.aten.permute.default(permute_203, [1, 0]);  permute_203 = None
        mm_431 = torch.ops.aten.mm.default(convert_element_type_2434, permute_1068);  convert_element_type_2434 = permute_1068 = None
        add_1972 = torch.ops.aten.add.Tensor(mm_429, mm_431);  mm_429 = mm_431 = None
        convert_element_type_2439 = torch.ops.prims.convert_element_type.default(mm_430, torch.float32);  mm_430 = None
        reduce_scatter_tensor_186 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2439, 'avg', 64, '0');  convert_element_type_2439 = None
        wait_tensor_771 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_186);  reduce_scatter_tensor_186 = None
        all_to_all_single_104 = torch.ops._c10d_functional.all_to_all_single.default(index_78, [_local_scalar_dense_200, _local_scalar_dense_201, _local_scalar_dense_202, _local_scalar_dense_203, _local_scalar_dense_204, _local_scalar_dense_205, _local_scalar_dense_206, _local_scalar_dense_207], [_local_scalar_dense_192, _local_scalar_dense_193, _local_scalar_dense_194, _local_scalar_dense_195, _local_scalar_dense_196, _local_scalar_dense_197, _local_scalar_dense_198, _local_scalar_dense_199], '521');  index_78 = None
        wait_tensor_772 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_104);  all_to_all_single_104 = None
        full_400 = torch.ops.aten.full.default([sym_size_int_49, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_49 = None
        slice_scatter_13 = torch.ops.aten.slice_scatter.default(full_400, wait_tensor_772, 0, 0, -1);  wait_tensor_772 = None
        index_79 = torch.ops.aten.index.Tensor(slice_scatter_13, [getitem_190]);  slice_scatter_13 = None
        permute_1070 = torch.ops.aten.permute.default(index_79, [1, 0])
        _grouped_mm_156 = torch.ops.aten._grouped_mm.default(permute_1070, mul_623, cumsum_38);  permute_1070 = mul_623 = None
        convert_element_type_720 = torch.ops.prims.convert_element_type.default(primals_226, torch.bfloat16);  primals_226 = None
        all_gather_into_tensor_225 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_720, 8, '513');  convert_element_type_720 = None
        wait_tensor_276 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_225);  all_gather_into_tensor_225 = None
        permute_202 = torch.ops.aten.permute.default(wait_tensor_276, [0, 2, 1]);  wait_tensor_276 = None
        permute_1072 = torch.ops.aten.permute.default(permute_202, [0, 2, 1]);  permute_202 = None
        _grouped_mm_157 = torch.ops.aten._grouped_mm.default(index_79, permute_1072, cumsum_38);  index_79 = permute_1072 = None
        convert_element_type_724 = torch.ops.prims.convert_element_type.default(_grouped_mm_36, torch.float32);  _grouped_mm_36 = None
        neg_25 = torch.ops.aten.neg.default(convert_element_type_724)
        exp_38 = torch.ops.aten.exp.default(neg_25);  neg_25 = None
        add_848 = torch.ops.aten.add.Tensor(exp_38, 1);  exp_38 = None
        div_64 = torch.ops.aten.div.Tensor(convert_element_type_724, add_848)
        convert_element_type_725 = torch.ops.prims.convert_element_type.default(div_64, torch.bfloat16);  div_64 = None
        mul_1739 = torch.ops.aten.mul.Tensor(_grouped_mm_157, convert_element_type_725);  convert_element_type_725 = None
        mul_1740 = torch.ops.aten.mul.Tensor(_grouped_mm_157, _grouped_mm_37);  _grouped_mm_157 = _grouped_mm_37 = None
        permute_1074 = torch.ops.aten.permute.default(mul_1739, [1, 0])
        _grouped_mm_158 = torch.ops.aten._grouped_mm.default(permute_1074, index_25, cumsum_38);  permute_1074 = None
        convert_element_type_721 = torch.ops.prims.convert_element_type.default(primals_227, torch.bfloat16);  primals_227 = None
        all_gather_into_tensor_226 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_721, 8, '513');  convert_element_type_721 = None
        wait_tensor_277 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_226);  all_gather_into_tensor_226 = None
        permute_201 = torch.ops.aten.permute.default(wait_tensor_277, [0, 2, 1]);  wait_tensor_277 = None
        permute_1076 = torch.ops.aten.permute.default(permute_201, [0, 2, 1]);  permute_201 = None
        _grouped_mm_159 = torch.ops.aten._grouped_mm.default(mul_1739, permute_1076, cumsum_38);  mul_1739 = permute_1076 = None
        convert_element_type_2440 = torch.ops.prims.convert_element_type.default(mul_1740, torch.float32);  mul_1740 = None
        reciprocal_27 = torch.ops.aten.reciprocal.default(add_848);  add_848 = None
        mul_1741 = torch.ops.aten.mul.Tensor(reciprocal_27, 1);  reciprocal_27 = None
        mul_1742 = torch.ops.aten.mul.Tensor(convert_element_type_2440, mul_1741);  convert_element_type_2440 = None
        sub_704 = torch.ops.aten.sub.Tensor(1, mul_1741);  mul_1741 = None
        mul_1743 = torch.ops.aten.mul.Tensor(convert_element_type_724, sub_704);  convert_element_type_724 = sub_704 = None
        add_1974 = torch.ops.aten.add.Tensor(mul_1743, 1);  mul_1743 = None
        mul_1744 = torch.ops.aten.mul.Tensor(mul_1742, add_1974);  mul_1742 = add_1974 = None
        convert_element_type_2442 = torch.ops.prims.convert_element_type.default(mul_1744, torch.bfloat16);  mul_1744 = None
        permute_1078 = torch.ops.aten.permute.default(convert_element_type_2442, [1, 0])
        _grouped_mm_160 = torch.ops.aten._grouped_mm.default(permute_1078, index_25, cumsum_38);  permute_1078 = index_25 = None
        convert_element_type_718 = torch.ops.prims.convert_element_type.default(primals_225, torch.bfloat16);  primals_225 = None
        all_gather_into_tensor_223 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_718, 8, '513');  convert_element_type_718 = None
        wait_tensor_274 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_223);  all_gather_into_tensor_223 = None
        permute_200 = torch.ops.aten.permute.default(wait_tensor_274, [0, 2, 1]);  wait_tensor_274 = None
        permute_1080 = torch.ops.aten.permute.default(permute_200, [0, 2, 1]);  permute_200 = None
        _grouped_mm_161 = torch.ops.aten._grouped_mm.default(convert_element_type_2442, permute_1080, cumsum_38);  convert_element_type_2442 = permute_1080 = cumsum_38 = None
        add_1975 = torch.ops.aten.add.Tensor(_grouped_mm_159, _grouped_mm_161);  _grouped_mm_159 = _grouped_mm_161 = None
        convert_element_type_2443 = torch.ops.prims.convert_element_type.default(_grouped_mm_158, torch.float32);  _grouped_mm_158 = None
        div_210 = torch.ops.aten.div.Tensor(convert_element_type_2443, 64);  convert_element_type_2443 = None
        reduce_scatter_tensor_187 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_210, 'sum', 8, '513');  div_210 = None
        wait_tensor_773 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_187);  reduce_scatter_tensor_187 = None
        convert_element_type_2444 = torch.ops.prims.convert_element_type.default(_grouped_mm_156, torch.float32);  _grouped_mm_156 = None
        div_211 = torch.ops.aten.div.Tensor(convert_element_type_2444, 64);  convert_element_type_2444 = None
        reduce_scatter_tensor_188 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_211, 'sum', 8, '513');  div_211 = None
        wait_tensor_774 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_188);  reduce_scatter_tensor_188 = None
        convert_element_type_2445 = torch.ops.prims.convert_element_type.default(_grouped_mm_160, torch.float32);  _grouped_mm_160 = None
        div_212 = torch.ops.aten.div.Tensor(convert_element_type_2445, 64);  convert_element_type_2445 = None
        reduce_scatter_tensor_189 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_212, 'sum', 8, '513');  div_212 = None
        wait_tensor_775 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_189);  reduce_scatter_tensor_189 = None
        index_put_78 = torch.ops.aten.index_put.default(full_400, [getitem_190], add_1975, True);  full_400 = getitem_190 = add_1975 = None
        slice_185 = torch.ops.aten.slice.Tensor(index_put_78, 0, 0, add_1976);  index_put_78 = add_1976 = None
        all_to_all_single_105 = torch.ops._c10d_functional.all_to_all_single.default(slice_185, [_local_scalar_dense_192, _local_scalar_dense_193, _local_scalar_dense_194, _local_scalar_dense_195, _local_scalar_dense_196, _local_scalar_dense_197, _local_scalar_dense_198, _local_scalar_dense_199], [_local_scalar_dense_200, _local_scalar_dense_201, _local_scalar_dense_202, _local_scalar_dense_203, _local_scalar_dense_204, _local_scalar_dense_205, _local_scalar_dense_206, _local_scalar_dense_207], '521');  slice_185 = _local_scalar_dense_192 = _local_scalar_dense_193 = _local_scalar_dense_194 = _local_scalar_dense_195 = _local_scalar_dense_196 = _local_scalar_dense_197 = _local_scalar_dense_198 = _local_scalar_dense_199 = _local_scalar_dense_200 = _local_scalar_dense_201 = _local_scalar_dense_202 = _local_scalar_dense_203 = _local_scalar_dense_204 = _local_scalar_dense_205 = _local_scalar_dense_206 = _local_scalar_dense_207 = None
        wait_tensor_776 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_105);  all_to_all_single_105 = None
        index_put_79 = torch.ops.aten.index_put.default(full_default_52, [div_62], wait_tensor_776, True);  div_62 = wait_tensor_776 = None
        add_1980 = torch.ops.aten.add.Tensor(add_1972, index_put_79);  add_1972 = index_put_79 = None
        mul_1745 = torch.ops.aten.mul.Tensor(view_2030, 1.0);  view_2030 = None
        scatter_add_13 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_187, mul_1745);  getitem_187 = mul_1745 = None
        convert_element_type_713 = torch.ops.prims.convert_element_type.default(mm_107, torch.float32);  mm_107 = None
        sub_288 = torch.ops.aten.sub.Tensor(convert_element_type_713, amax_12);  convert_element_type_713 = amax_12 = None
        exp_37 = torch.ops.aten.exp.default(sub_288);  sub_288 = None
        div_61 = torch.ops.aten.div.Tensor(exp_37, sum_49);  exp_37 = sum_49 = None
        mul_1746 = torch.ops.aten.mul.Tensor(scatter_add_13, div_61);  scatter_add_13 = None
        sum_211 = torch.ops.aten.sum.dim_IntList(mul_1746, [1], True)
        neg_94 = torch.ops.aten.neg.default(div_61);  div_61 = None
        fma_13 = torch.ops.prims.fma.default(neg_94, sum_211, mul_1746);  neg_94 = sum_211 = mul_1746 = None
        convert_element_type_2446 = torch.ops.prims.convert_element_type.default(fma_13, torch.bfloat16);  fma_13 = None
        permute_1082 = torch.ops.aten.permute.default(convert_element_type_2446, [1, 0])
        mm_432 = torch.ops.aten.mm.default(permute_1082, view_862);  permute_1082 = view_862 = None
        convert_element_type_710 = torch.ops.prims.convert_element_type.default(primals_223, torch.bfloat16);  primals_223 = None
        all_gather_into_tensor_222 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_710, 64, '0');  convert_element_type_710 = None
        wait_tensor_270 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_222);  all_gather_into_tensor_222 = None
        permute_199 = torch.ops.aten.permute.default(wait_tensor_270, [1, 0]);  wait_tensor_270 = None
        permute_1084 = torch.ops.aten.permute.default(permute_199, [1, 0]);  permute_199 = None
        mm_433 = torch.ops.aten.mm.default(convert_element_type_2446, permute_1084);  convert_element_type_2446 = permute_1084 = None
        add_1981 = torch.ops.aten.add.Tensor(add_1980, mm_433);  add_1980 = mm_433 = None
        convert_element_type_2451 = torch.ops.prims.convert_element_type.default(mm_432, torch.float32);  mm_432 = None
        reduce_scatter_tensor_190 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2451, 'avg', 64, '0');  convert_element_type_2451 = None
        wait_tensor_777 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_190);  reduce_scatter_tensor_190 = None
        view_2032 = torch.ops.aten.view.default(add_1981, [2, 4096, 2048]);  add_1981 = None
        convert_element_type_2452 = torch.ops.prims.convert_element_type.default(view_2032, torch.float32);  view_2032 = None
        convert_element_type_707 = torch.ops.prims.convert_element_type.default(primals_221, torch.bfloat16);  primals_221 = None
        all_gather_into_tensor_221 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_707, 64, '0');  convert_element_type_707 = None
        wait_tensor_269 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_221);  all_gather_into_tensor_221 = None
        convert_element_type_2454 = torch.ops.prims.convert_element_type.default(wait_tensor_269, torch.float32);  wait_tensor_269 = None
        mul_1747 = torch.ops.aten.mul.Tensor(convert_element_type_2452, convert_element_type_2454);  convert_element_type_2454 = None
        convert_element_type_708 = torch.ops.prims.convert_element_type.default(add_824, torch.float32);  add_824 = None
        mul_603 = torch.ops.aten.mul.Tensor(convert_element_type_708, rsqrt_41);  convert_element_type_708 = None
        mul_1749 = torch.ops.aten.mul.Tensor(mul_603, mul_1747)
        sum_212 = torch.ops.aten.sum.dim_IntList(mul_1749, [2], True);  mul_1749 = None
        div_213 = torch.ops.aten.div.Tensor(mul_603, 2048)
        mul_1750 = torch.ops.aten.mul.Tensor(div_213, sum_212);  div_213 = sum_212 = None
        sub_706 = torch.ops.aten.sub.Tensor(mul_1747, mul_1750);  mul_1747 = mul_1750 = None
        mul_1751 = torch.ops.aten.mul.Tensor(sub_706, rsqrt_41);  sub_706 = rsqrt_41 = None
        mul_1752 = torch.ops.aten.mul.Tensor(convert_element_type_2452, mul_603);  convert_element_type_2452 = mul_603 = None
        sum_213 = torch.ops.aten.sum.dim_IntList(mul_1752, [0, 1]);  mul_1752 = None
        convert_element_type_2455 = torch.ops.prims.convert_element_type.default(mul_1751, torch.bfloat16);  mul_1751 = None
        add_1982 = torch.ops.aten.add.Tensor(add_1969, convert_element_type_2455);  add_1969 = convert_element_type_2455 = None
        convert_element_type_default_42 = torch.ops.prims.convert_element_type.default(sum_213, torch.float32);  sum_213 = None
        reduce_scatter_tensor_191 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_42, 'avg', 64, '0');  convert_element_type_default_42 = None
        wait_tensor_778 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_191);  reduce_scatter_tensor_191 = None
        view_2033 = torch.ops.aten.view.default(add_1982, [8192, 2048])
        permute_1086 = torch.ops.aten.permute.default(view_2033, [1, 0])
        permute_197 = torch.ops.aten.permute.default(getitem_183, [0, 2, 1, 3])
        view_857 = torch.ops.aten.view.default(permute_197, [2, 4096, -1]);  permute_197 = None
        view_859 = torch.ops.aten.view.default(view_857, [8192, 2048]);  view_857 = None
        mm_434 = torch.ops.aten.mm.default(permute_1086, view_859);  permute_1086 = view_859 = None
        convert_element_type_704 = torch.ops.prims.convert_element_type.default(primals_220, torch.bfloat16);  primals_220 = None
        all_gather_into_tensor_220 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_704, 64, '0');  convert_element_type_704 = None
        wait_tensor_268 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_220);  all_gather_into_tensor_220 = None
        permute_198 = torch.ops.aten.permute.default(wait_tensor_268, [1, 0]);  wait_tensor_268 = None
        permute_1088 = torch.ops.aten.permute.default(permute_198, [1, 0]);  permute_198 = None
        mm_435 = torch.ops.aten.mm.default(view_2033, permute_1088);  view_2033 = permute_1088 = None
        view_2034 = torch.ops.aten.view.default(mm_435, [2, 4096, 2048]);  mm_435 = None
        convert_element_type_2462 = torch.ops.prims.convert_element_type.default(mm_434, torch.float32);  mm_434 = None
        reduce_scatter_tensor_192 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2462, 'avg', 64, '0');  convert_element_type_2462 = None
        wait_tensor_779 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_192);  reduce_scatter_tensor_192 = None
        view_2035 = torch.ops.aten.view.default(view_2034, [2, 4096, 16, 128]);  view_2034 = None
        permute_1090 = torch.ops.aten.permute.default(view_2035, [0, 2, 1, 3]);  view_2035 = None
        fw_graph13 = self.fw_graph13
        joint_graph13 = self.joint_graph13
        mask_graph13 = self.mask_graph13
        flex_attention_backward_13 = torch.ops.higher_order.flex_attention_backward(permute_194, permute_195, permute_196, getitem_183, getitem_184, permute_1090, None, fw_graph13, joint_graph13, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph13), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_194 = permute_195 = permute_196 = getitem_183 = getitem_184 = permute_1090 = fw_graph13 = joint_graph13 = mask_graph13 = None
        getitem_425 = flex_attention_backward_13[0]
        getitem_426 = flex_attention_backward_13[1]
        getitem_427 = flex_attention_backward_13[2];  flex_attention_backward_13 = None
        permute_1091 = torch.ops.aten.permute.default(getitem_427, [0, 2, 1, 3]);  getitem_427 = None
        permute_1092 = torch.ops.aten.permute.default(getitem_426, [0, 2, 1, 3]);  getitem_426 = None
        permute_1093 = torch.ops.aten.permute.default(getitem_425, [0, 2, 1, 3]);  getitem_425 = None
        slice_187 = torch.ops.aten.slice.Tensor(permute_1092, 3, 0, 128)
        slice_188 = torch.ops.aten.slice.Tensor(permute_1092, 3, 128, 192);  permute_1092 = None
        sum_214 = torch.ops.aten.sum.dim_IntList(slice_188, [2], True);  slice_188 = None
        cat_119 = torch.ops.aten.cat.default([slice_187, permute_1091], 3);  slice_187 = permute_1091 = None
        view_2036 = torch.ops.aten.view.default(cat_119, [2, 4096, 4096]);  cat_119 = None
        view_2037 = torch.ops.aten.view.default(view_2036, [8192, 4096]);  view_2036 = None
        permute_1094 = torch.ops.aten.permute.default(view_2037, [1, 0])
        mm_436 = torch.ops.aten.mm.default(permute_1094, view_854);  permute_1094 = view_854 = None
        convert_element_type_701 = torch.ops.prims.convert_element_type.default(primals_219, torch.bfloat16);  primals_219 = None
        all_gather_into_tensor_219 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_701, 64, '0');  convert_element_type_701 = None
        wait_tensor_267 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_219);  all_gather_into_tensor_219 = None
        permute_193 = torch.ops.aten.permute.default(wait_tensor_267, [1, 0]);  wait_tensor_267 = None
        permute_1096 = torch.ops.aten.permute.default(permute_193, [1, 0]);  permute_193 = None
        mm_437 = torch.ops.aten.mm.default(view_2037, permute_1096);  view_2037 = permute_1096 = None
        view_2038 = torch.ops.aten.view.default(mm_437, [2, 4096, 512]);  mm_437 = None
        convert_element_type_2467 = torch.ops.prims.convert_element_type.default(mm_436, torch.float32);  mm_436 = None
        reduce_scatter_tensor_193 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2467, 'avg', 64, '0');  convert_element_type_2467 = None
        wait_tensor_780 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_193);  reduce_scatter_tensor_193 = None
        convert_element_type_2468 = torch.ops.prims.convert_element_type.default(view_2038, torch.float32);  view_2038 = None
        convert_element_type_698 = torch.ops.prims.convert_element_type.default(primals_218, torch.bfloat16);  primals_218 = None
        all_gather_into_tensor_218 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_698, 64, '0');  convert_element_type_698 = None
        wait_tensor_266 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_218);  all_gather_into_tensor_218 = None
        convert_element_type_2470 = torch.ops.prims.convert_element_type.default(wait_tensor_266, torch.float32);  wait_tensor_266 = None
        mul_1753 = torch.ops.aten.mul.Tensor(convert_element_type_2468, convert_element_type_2470);  convert_element_type_2470 = None
        convert_element_type_699 = torch.ops.prims.convert_element_type.default(getitem_179, torch.float32);  getitem_179 = None
        mul_601 = torch.ops.aten.mul.Tensor(convert_element_type_699, rsqrt_40);  convert_element_type_699 = None
        mul_1755 = torch.ops.aten.mul.Tensor(mul_601, mul_1753)
        sum_215 = torch.ops.aten.sum.dim_IntList(mul_1755, [2], True);  mul_1755 = None
        div_214 = torch.ops.aten.div.Tensor(mul_601, 512)
        mul_1756 = torch.ops.aten.mul.Tensor(div_214, sum_215);  div_214 = sum_215 = None
        sub_707 = torch.ops.aten.sub.Tensor(mul_1753, mul_1756);  mul_1753 = mul_1756 = None
        mul_1757 = torch.ops.aten.mul.Tensor(sub_707, rsqrt_40);  sub_707 = rsqrt_40 = None
        mul_1758 = torch.ops.aten.mul.Tensor(convert_element_type_2468, mul_601);  convert_element_type_2468 = mul_601 = None
        sum_216 = torch.ops.aten.sum.dim_IntList(mul_1758, [0, 1]);  mul_1758 = None
        convert_element_type_2471 = torch.ops.prims.convert_element_type.default(mul_1757, torch.bfloat16);  mul_1757 = None
        convert_element_type_default_41 = torch.ops.prims.convert_element_type.default(sum_216, torch.float32);  sum_216 = None
        reduce_scatter_tensor_194 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_41, 'avg', 64, '0');  convert_element_type_default_41 = None
        wait_tensor_781 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_194);  reduce_scatter_tensor_194 = None
        convert_element_type_2474 = torch.ops.prims.convert_element_type.default(sum_214, torch.float32);  sum_214 = None
        view_2039 = torch.ops.aten.view.default(convert_element_type_2474, [2, 4096, 1, 32, 2]);  convert_element_type_2474 = None
        view_as_complex_80 = torch.ops.aten.view_as_complex.default(view_2039);  view_2039 = None
        mul_1759 = torch.ops.aten.mul.Tensor(view_as_complex_80, clone_9);  view_as_complex_80 = None
        view_as_real_80 = torch.ops.aten.view_as_real.default(mul_1759);  mul_1759 = None
        view_2040 = torch.ops.aten.view.default(view_as_real_80, [2, 4096, 1, 64]);  view_as_real_80 = None
        convert_element_type_2475 = torch.ops.prims.convert_element_type.default(view_2040, torch.bfloat16);  view_2040 = None
        squeeze_39 = torch.ops.aten.squeeze.dim(convert_element_type_2475, 2);  convert_element_type_2475 = None
        cat_120 = torch.ops.aten.cat.default([convert_element_type_2471, squeeze_39], 2);  convert_element_type_2471 = squeeze_39 = None
        view_2041 = torch.ops.aten.view.default(cat_120, [8192, 576]);  cat_120 = None
        permute_1098 = torch.ops.aten.permute.default(view_2041, [1, 0])
        mm_438 = torch.ops.aten.mm.default(permute_1098, view_840);  permute_1098 = None
        convert_element_type_693 = torch.ops.prims.convert_element_type.default(primals_217, torch.bfloat16);  primals_217 = None
        all_gather_into_tensor_217 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_693, 64, '0');  convert_element_type_693 = None
        wait_tensor_265 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_217);  all_gather_into_tensor_217 = None
        permute_192 = torch.ops.aten.permute.default(wait_tensor_265, [1, 0]);  wait_tensor_265 = None
        permute_1100 = torch.ops.aten.permute.default(permute_192, [1, 0]);  permute_192 = None
        mm_439 = torch.ops.aten.mm.default(view_2041, permute_1100);  view_2041 = permute_1100 = None
        view_2042 = torch.ops.aten.view.default(mm_439, [2, 4096, 2048]);  mm_439 = None
        convert_element_type_2480 = torch.ops.prims.convert_element_type.default(mm_438, torch.float32);  mm_438 = None
        reduce_scatter_tensor_195 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2480, 'avg', 64, '0');  convert_element_type_2480 = None
        wait_tensor_782 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_195);  reduce_scatter_tensor_195 = None
        slice_189 = torch.ops.aten.slice.Tensor(permute_1093, 3, 0, 128)
        slice_190 = torch.ops.aten.slice.Tensor(permute_1093, 3, 128, 192);  permute_1093 = None
        convert_element_type_2481 = torch.ops.prims.convert_element_type.default(slice_190, torch.float32);  slice_190 = None
        view_2043 = torch.ops.aten.view.default(convert_element_type_2481, [2, 4096, 16, 32, 2]);  convert_element_type_2481 = None
        view_as_complex_81 = torch.ops.aten.view_as_complex.default(view_2043);  view_2043 = None
        mul_1760 = torch.ops.aten.mul.Tensor(view_as_complex_81, clone_9);  view_as_complex_81 = None
        view_as_real_81 = torch.ops.aten.view_as_real.default(mul_1760);  mul_1760 = None
        view_2044 = torch.ops.aten.view.default(view_as_real_81, [2, 4096, 16, 64]);  view_as_real_81 = None
        convert_element_type_2482 = torch.ops.prims.convert_element_type.default(view_2044, torch.bfloat16);  view_2044 = None
        cat_121 = torch.ops.aten.cat.default([slice_189, convert_element_type_2482], 3);  slice_189 = convert_element_type_2482 = None
        view_2045 = torch.ops.aten.view.default(cat_121, [2, 4096, 3072]);  cat_121 = None
        view_2046 = torch.ops.aten.view.default(view_2045, [8192, 3072]);  view_2045 = None
        permute_1102 = torch.ops.aten.permute.default(view_2046, [1, 0])
        mm_440 = torch.ops.aten.mm.default(permute_1102, view_840);  permute_1102 = view_840 = None
        convert_element_type_688 = torch.ops.prims.convert_element_type.default(primals_216, torch.bfloat16);  primals_216 = None
        all_gather_into_tensor_216 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_688, 64, '0');  convert_element_type_688 = None
        wait_tensor_264 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_216);  all_gather_into_tensor_216 = None
        permute_191 = torch.ops.aten.permute.default(wait_tensor_264, [1, 0]);  wait_tensor_264 = None
        permute_1104 = torch.ops.aten.permute.default(permute_191, [1, 0]);  permute_191 = None
        mm_441 = torch.ops.aten.mm.default(view_2046, permute_1104);  view_2046 = permute_1104 = None
        view_2047 = torch.ops.aten.view.default(mm_441, [2, 4096, 2048]);  mm_441 = None
        add_1983 = torch.ops.aten.add.Tensor(view_2042, view_2047);  view_2042 = view_2047 = None
        convert_element_type_2487 = torch.ops.prims.convert_element_type.default(mm_440, torch.float32);  mm_440 = None
        reduce_scatter_tensor_196 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2487, 'avg', 64, '0');  convert_element_type_2487 = None
        wait_tensor_783 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_196);  reduce_scatter_tensor_196 = None
        convert_element_type_2488 = torch.ops.prims.convert_element_type.default(add_1983, torch.float32);  add_1983 = None
        convert_element_type_685 = torch.ops.prims.convert_element_type.default(primals_215, torch.bfloat16);  primals_215 = None
        all_gather_into_tensor_215 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_685, 64, '0');  convert_element_type_685 = None
        wait_tensor_263 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_215);  all_gather_into_tensor_215 = None
        convert_element_type_2490 = torch.ops.prims.convert_element_type.default(wait_tensor_263, torch.float32);  wait_tensor_263 = None
        mul_1761 = torch.ops.aten.mul.Tensor(convert_element_type_2488, convert_element_type_2490);  convert_element_type_2490 = None
        convert_element_type_686 = torch.ops.prims.convert_element_type.default(add_821, torch.float32);  add_821 = None
        mul_597 = torch.ops.aten.mul.Tensor(convert_element_type_686, rsqrt_39);  convert_element_type_686 = None
        mul_1763 = torch.ops.aten.mul.Tensor(mul_597, mul_1761)
        sum_217 = torch.ops.aten.sum.dim_IntList(mul_1763, [2], True);  mul_1763 = None
        div_215 = torch.ops.aten.div.Tensor(mul_597, 2048)
        mul_1764 = torch.ops.aten.mul.Tensor(div_215, sum_217);  div_215 = sum_217 = None
        sub_708 = torch.ops.aten.sub.Tensor(mul_1761, mul_1764);  mul_1761 = mul_1764 = None
        mul_1765 = torch.ops.aten.mul.Tensor(sub_708, rsqrt_39);  sub_708 = rsqrt_39 = None
        mul_1766 = torch.ops.aten.mul.Tensor(convert_element_type_2488, mul_597);  convert_element_type_2488 = mul_597 = None
        sum_218 = torch.ops.aten.sum.dim_IntList(mul_1766, [0, 1]);  mul_1766 = None
        convert_element_type_2491 = torch.ops.prims.convert_element_type.default(mul_1765, torch.bfloat16);  mul_1765 = None
        add_1984 = torch.ops.aten.add.Tensor(add_1982, convert_element_type_2491);  add_1982 = convert_element_type_2491 = None
        convert_element_type_default_40 = torch.ops.prims.convert_element_type.default(sum_218, torch.float32);  sum_218 = None
        reduce_scatter_tensor_197 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_40, 'avg', 64, '0');  convert_element_type_default_40 = None
        wait_tensor_784 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_197);  reduce_scatter_tensor_197 = None
        view_2048 = torch.ops.aten.view.default(add_1984, [8192, 2048])
        unsqueeze_67 = torch.ops.aten.unsqueeze.default(view_2048, 1)
        convert_element_type_2494 = torch.ops.prims.convert_element_type.default(unsqueeze_67, torch.float32);  unsqueeze_67 = None
        bmm_54 = torch.ops.aten.bmm.default(permute_1106, convert_element_type_2494);  permute_1106 = None
        bmm_55 = torch.ops.aten.bmm.default(convert_element_type_2494, permute_1107);  convert_element_type_2494 = permute_1107 = None
        convert_element_type_2495 = torch.ops.prims.convert_element_type.default(bmm_54, torch.bfloat16);  bmm_54 = None
        view_2049 = torch.ops.aten.view.default(bmm_55, [8192, 6]);  bmm_55 = None
        view_2050 = torch.ops.aten.view.default(convert_element_type_2495, [49152, 2048]);  convert_element_type_2495 = None
        index_80 = torch.ops.aten.index.Tensor(view_2050, [getitem_175]);  view_2050 = getitem_175 = None
        permute_1108 = torch.ops.aten.permute.default(view_2048, [1, 0])
        mm_442 = torch.ops.aten.mm.default(permute_1108, mul_594);  permute_1108 = mul_594 = None
        convert_element_type_680 = torch.ops.prims.convert_element_type.default(primals_214, torch.bfloat16);  primals_214 = None
        all_gather_into_tensor_214 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_680, 64, '0');  convert_element_type_680 = None
        wait_tensor_262 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_214);  all_gather_into_tensor_214 = None
        permute_190 = torch.ops.aten.permute.default(wait_tensor_262, [1, 0]);  wait_tensor_262 = None
        permute_1110 = torch.ops.aten.permute.default(permute_190, [1, 0]);  permute_190 = None
        mm_443 = torch.ops.aten.mm.default(view_2048, permute_1110);  view_2048 = permute_1110 = None
        convert_element_type_2500 = torch.ops.prims.convert_element_type.default(mm_442, torch.float32);  mm_442 = None
        reduce_scatter_tensor_198 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2500, 'avg', 64, '0');  convert_element_type_2500 = None
        wait_tensor_785 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_198);  reduce_scatter_tensor_198 = None
        convert_element_type_675 = torch.ops.prims.convert_element_type.default(mm_100, torch.float32);  mm_100 = None
        neg_24 = torch.ops.aten.neg.default(convert_element_type_675)
        exp_36 = torch.ops.aten.exp.default(neg_24);  neg_24 = None
        add_816 = torch.ops.aten.add.Tensor(exp_36, 1);  exp_36 = None
        div_60 = torch.ops.aten.div.Tensor(convert_element_type_675, add_816)
        convert_element_type_676 = torch.ops.prims.convert_element_type.default(div_60, torch.bfloat16);  div_60 = None
        mul_1767 = torch.ops.aten.mul.Tensor(mm_443, convert_element_type_676);  convert_element_type_676 = None
        mul_1768 = torch.ops.aten.mul.Tensor(mm_443, mm_101);  mm_443 = mm_101 = None
        permute_1112 = torch.ops.aten.permute.default(mul_1767, [1, 0])
        mm_444 = torch.ops.aten.mm.default(permute_1112, view_795);  permute_1112 = None
        convert_element_type_677 = torch.ops.prims.convert_element_type.default(primals_213, torch.bfloat16);  primals_213 = None
        all_gather_into_tensor_213 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_677, 64, '0');  convert_element_type_677 = None
        wait_tensor_261 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_213);  all_gather_into_tensor_213 = None
        permute_189 = torch.ops.aten.permute.default(wait_tensor_261, [1, 0]);  wait_tensor_261 = None
        permute_1114 = torch.ops.aten.permute.default(permute_189, [1, 0]);  permute_189 = None
        mm_445 = torch.ops.aten.mm.default(mul_1767, permute_1114);  mul_1767 = permute_1114 = None
        convert_element_type_2505 = torch.ops.prims.convert_element_type.default(mm_444, torch.float32);  mm_444 = None
        reduce_scatter_tensor_199 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2505, 'avg', 64, '0');  convert_element_type_2505 = None
        wait_tensor_786 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_199);  reduce_scatter_tensor_199 = None
        convert_element_type_2506 = torch.ops.prims.convert_element_type.default(mul_1768, torch.float32);  mul_1768 = None
        reciprocal_28 = torch.ops.aten.reciprocal.default(add_816);  add_816 = None
        mul_1769 = torch.ops.aten.mul.Tensor(reciprocal_28, 1);  reciprocal_28 = None
        mul_1770 = torch.ops.aten.mul.Tensor(convert_element_type_2506, mul_1769);  convert_element_type_2506 = None
        sub_709 = torch.ops.aten.sub.Tensor(1, mul_1769);  mul_1769 = None
        mul_1771 = torch.ops.aten.mul.Tensor(convert_element_type_675, sub_709);  convert_element_type_675 = sub_709 = None
        add_1986 = torch.ops.aten.add.Tensor(mul_1771, 1);  mul_1771 = None
        mul_1772 = torch.ops.aten.mul.Tensor(mul_1770, add_1986);  mul_1770 = add_1986 = None
        convert_element_type_2508 = torch.ops.prims.convert_element_type.default(mul_1772, torch.bfloat16);  mul_1772 = None
        permute_1116 = torch.ops.aten.permute.default(convert_element_type_2508, [1, 0])
        mm_446 = torch.ops.aten.mm.default(permute_1116, view_795);  permute_1116 = None
        convert_element_type_672 = torch.ops.prims.convert_element_type.default(primals_212, torch.bfloat16);  primals_212 = None
        all_gather_into_tensor_212 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_672, 64, '0');  convert_element_type_672 = None
        wait_tensor_260 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_212);  all_gather_into_tensor_212 = None
        permute_188 = torch.ops.aten.permute.default(wait_tensor_260, [1, 0]);  wait_tensor_260 = None
        permute_1118 = torch.ops.aten.permute.default(permute_188, [1, 0]);  permute_188 = None
        mm_447 = torch.ops.aten.mm.default(convert_element_type_2508, permute_1118);  convert_element_type_2508 = permute_1118 = None
        add_1987 = torch.ops.aten.add.Tensor(mm_445, mm_447);  mm_445 = mm_447 = None
        convert_element_type_2513 = torch.ops.prims.convert_element_type.default(mm_446, torch.float32);  mm_446 = None
        reduce_scatter_tensor_200 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2513, 'avg', 64, '0');  convert_element_type_2513 = None
        wait_tensor_787 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_200);  reduce_scatter_tensor_200 = None
        all_to_all_single_106 = torch.ops._c10d_functional.all_to_all_single.default(index_80, [_local_scalar_dense_184, _local_scalar_dense_185, _local_scalar_dense_186, _local_scalar_dense_187, _local_scalar_dense_188, _local_scalar_dense_189, _local_scalar_dense_190, _local_scalar_dense_191], [_local_scalar_dense_176, _local_scalar_dense_177, _local_scalar_dense_178, _local_scalar_dense_179, _local_scalar_dense_180, _local_scalar_dense_181, _local_scalar_dense_182, _local_scalar_dense_183], '521');  index_80 = None
        wait_tensor_788 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_106);  all_to_all_single_106 = None
        full_404 = torch.ops.aten.full.default([sym_size_int_45, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_45 = None
        slice_scatter_14 = torch.ops.aten.slice_scatter.default(full_404, wait_tensor_788, 0, 0, -1);  wait_tensor_788 = None
        index_81 = torch.ops.aten.index.Tensor(slice_scatter_14, [getitem_176]);  slice_scatter_14 = None
        permute_1120 = torch.ops.aten.permute.default(index_81, [1, 0])
        _grouped_mm_162 = torch.ops.aten._grouped_mm.default(permute_1120, mul_574, cumsum_35);  permute_1120 = mul_574 = None
        convert_element_type_666 = torch.ops.prims.convert_element_type.default(primals_210, torch.bfloat16);  primals_210 = None
        all_gather_into_tensor_208 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_666, 8, '513');  convert_element_type_666 = None
        wait_tensor_255 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_208);  all_gather_into_tensor_208 = None
        permute_187 = torch.ops.aten.permute.default(wait_tensor_255, [0, 2, 1]);  wait_tensor_255 = None
        permute_1122 = torch.ops.aten.permute.default(permute_187, [0, 2, 1]);  permute_187 = None
        _grouped_mm_163 = torch.ops.aten._grouped_mm.default(index_81, permute_1122, cumsum_35);  index_81 = permute_1122 = None
        convert_element_type_670 = torch.ops.prims.convert_element_type.default(_grouped_mm_33, torch.float32);  _grouped_mm_33 = None
        neg_23 = torch.ops.aten.neg.default(convert_element_type_670)
        exp_35 = torch.ops.aten.exp.default(neg_23);  neg_23 = None
        add_780 = torch.ops.aten.add.Tensor(exp_35, 1);  exp_35 = None
        div_59 = torch.ops.aten.div.Tensor(convert_element_type_670, add_780)
        convert_element_type_671 = torch.ops.prims.convert_element_type.default(div_59, torch.bfloat16);  div_59 = None
        mul_1773 = torch.ops.aten.mul.Tensor(_grouped_mm_163, convert_element_type_671);  convert_element_type_671 = None
        mul_1774 = torch.ops.aten.mul.Tensor(_grouped_mm_163, _grouped_mm_34);  _grouped_mm_163 = _grouped_mm_34 = None
        permute_1124 = torch.ops.aten.permute.default(mul_1773, [1, 0])
        _grouped_mm_164 = torch.ops.aten._grouped_mm.default(permute_1124, index_23, cumsum_35);  permute_1124 = None
        convert_element_type_667 = torch.ops.prims.convert_element_type.default(primals_211, torch.bfloat16);  primals_211 = None
        all_gather_into_tensor_209 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_667, 8, '513');  convert_element_type_667 = None
        wait_tensor_256 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_209);  all_gather_into_tensor_209 = None
        permute_186 = torch.ops.aten.permute.default(wait_tensor_256, [0, 2, 1]);  wait_tensor_256 = None
        permute_1126 = torch.ops.aten.permute.default(permute_186, [0, 2, 1]);  permute_186 = None
        _grouped_mm_165 = torch.ops.aten._grouped_mm.default(mul_1773, permute_1126, cumsum_35);  mul_1773 = permute_1126 = None
        convert_element_type_2514 = torch.ops.prims.convert_element_type.default(mul_1774, torch.float32);  mul_1774 = None
        reciprocal_29 = torch.ops.aten.reciprocal.default(add_780);  add_780 = None
        mul_1775 = torch.ops.aten.mul.Tensor(reciprocal_29, 1);  reciprocal_29 = None
        mul_1776 = torch.ops.aten.mul.Tensor(convert_element_type_2514, mul_1775);  convert_element_type_2514 = None
        sub_710 = torch.ops.aten.sub.Tensor(1, mul_1775);  mul_1775 = None
        mul_1777 = torch.ops.aten.mul.Tensor(convert_element_type_670, sub_710);  convert_element_type_670 = sub_710 = None
        add_1989 = torch.ops.aten.add.Tensor(mul_1777, 1);  mul_1777 = None
        mul_1778 = torch.ops.aten.mul.Tensor(mul_1776, add_1989);  mul_1776 = add_1989 = None
        convert_element_type_2516 = torch.ops.prims.convert_element_type.default(mul_1778, torch.bfloat16);  mul_1778 = None
        permute_1128 = torch.ops.aten.permute.default(convert_element_type_2516, [1, 0])
        _grouped_mm_166 = torch.ops.aten._grouped_mm.default(permute_1128, index_23, cumsum_35);  permute_1128 = index_23 = None
        convert_element_type_664 = torch.ops.prims.convert_element_type.default(primals_209, torch.bfloat16);  primals_209 = None
        all_gather_into_tensor_206 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_664, 8, '513');  convert_element_type_664 = None
        wait_tensor_253 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_206);  all_gather_into_tensor_206 = None
        permute_185 = torch.ops.aten.permute.default(wait_tensor_253, [0, 2, 1]);  wait_tensor_253 = None
        permute_1130 = torch.ops.aten.permute.default(permute_185, [0, 2, 1]);  permute_185 = None
        _grouped_mm_167 = torch.ops.aten._grouped_mm.default(convert_element_type_2516, permute_1130, cumsum_35);  convert_element_type_2516 = permute_1130 = cumsum_35 = None
        add_1990 = torch.ops.aten.add.Tensor(_grouped_mm_165, _grouped_mm_167);  _grouped_mm_165 = _grouped_mm_167 = None
        convert_element_type_2517 = torch.ops.prims.convert_element_type.default(_grouped_mm_164, torch.float32);  _grouped_mm_164 = None
        div_216 = torch.ops.aten.div.Tensor(convert_element_type_2517, 64);  convert_element_type_2517 = None
        reduce_scatter_tensor_201 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_216, 'sum', 8, '513');  div_216 = None
        wait_tensor_789 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_201);  reduce_scatter_tensor_201 = None
        convert_element_type_2518 = torch.ops.prims.convert_element_type.default(_grouped_mm_162, torch.float32);  _grouped_mm_162 = None
        div_217 = torch.ops.aten.div.Tensor(convert_element_type_2518, 64);  convert_element_type_2518 = None
        reduce_scatter_tensor_202 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_217, 'sum', 8, '513');  div_217 = None
        wait_tensor_790 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_202);  reduce_scatter_tensor_202 = None
        convert_element_type_2519 = torch.ops.prims.convert_element_type.default(_grouped_mm_166, torch.float32);  _grouped_mm_166 = None
        div_218 = torch.ops.aten.div.Tensor(convert_element_type_2519, 64);  convert_element_type_2519 = None
        reduce_scatter_tensor_203 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_218, 'sum', 8, '513');  div_218 = None
        wait_tensor_791 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_203);  reduce_scatter_tensor_203 = None
        index_put_80 = torch.ops.aten.index_put.default(full_404, [getitem_176], add_1990, True);  full_404 = getitem_176 = add_1990 = None
        slice_191 = torch.ops.aten.slice.Tensor(index_put_80, 0, 0, add_1991);  index_put_80 = add_1991 = None
        all_to_all_single_107 = torch.ops._c10d_functional.all_to_all_single.default(slice_191, [_local_scalar_dense_176, _local_scalar_dense_177, _local_scalar_dense_178, _local_scalar_dense_179, _local_scalar_dense_180, _local_scalar_dense_181, _local_scalar_dense_182, _local_scalar_dense_183], [_local_scalar_dense_184, _local_scalar_dense_185, _local_scalar_dense_186, _local_scalar_dense_187, _local_scalar_dense_188, _local_scalar_dense_189, _local_scalar_dense_190, _local_scalar_dense_191], '521');  slice_191 = _local_scalar_dense_176 = _local_scalar_dense_177 = _local_scalar_dense_178 = _local_scalar_dense_179 = _local_scalar_dense_180 = _local_scalar_dense_181 = _local_scalar_dense_182 = _local_scalar_dense_183 = _local_scalar_dense_184 = _local_scalar_dense_185 = _local_scalar_dense_186 = _local_scalar_dense_187 = _local_scalar_dense_188 = _local_scalar_dense_189 = _local_scalar_dense_190 = _local_scalar_dense_191 = None
        wait_tensor_792 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_107);  all_to_all_single_107 = None
        index_put_81 = torch.ops.aten.index_put.default(full_default_52, [div_57], wait_tensor_792, True);  div_57 = wait_tensor_792 = None
        add_1995 = torch.ops.aten.add.Tensor(add_1987, index_put_81);  add_1987 = index_put_81 = None
        mul_1779 = torch.ops.aten.mul.Tensor(view_2049, 1.0);  view_2049 = None
        scatter_add_14 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_173, mul_1779);  getitem_173 = mul_1779 = None
        convert_element_type_659 = torch.ops.prims.convert_element_type.default(mm_99, torch.float32);  mm_99 = None
        sub_264 = torch.ops.aten.sub.Tensor(convert_element_type_659, amax_11);  convert_element_type_659 = amax_11 = None
        exp_34 = torch.ops.aten.exp.default(sub_264);  sub_264 = None
        div_56 = torch.ops.aten.div.Tensor(exp_34, sum_45);  exp_34 = sum_45 = None
        mul_1780 = torch.ops.aten.mul.Tensor(scatter_add_14, div_56);  scatter_add_14 = None
        sum_219 = torch.ops.aten.sum.dim_IntList(mul_1780, [1], True)
        neg_97 = torch.ops.aten.neg.default(div_56);  div_56 = None
        fma_14 = torch.ops.prims.fma.default(neg_97, sum_219, mul_1780);  neg_97 = sum_219 = mul_1780 = None
        convert_element_type_2520 = torch.ops.prims.convert_element_type.default(fma_14, torch.bfloat16);  fma_14 = None
        permute_1132 = torch.ops.aten.permute.default(convert_element_type_2520, [1, 0])
        mm_448 = torch.ops.aten.mm.default(permute_1132, view_795);  permute_1132 = view_795 = None
        convert_element_type_656 = torch.ops.prims.convert_element_type.default(primals_207, torch.bfloat16);  primals_207 = None
        all_gather_into_tensor_205 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_656, 64, '0');  convert_element_type_656 = None
        wait_tensor_249 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_205);  all_gather_into_tensor_205 = None
        permute_184 = torch.ops.aten.permute.default(wait_tensor_249, [1, 0]);  wait_tensor_249 = None
        permute_1134 = torch.ops.aten.permute.default(permute_184, [1, 0]);  permute_184 = None
        mm_449 = torch.ops.aten.mm.default(convert_element_type_2520, permute_1134);  convert_element_type_2520 = permute_1134 = None
        add_1996 = torch.ops.aten.add.Tensor(add_1995, mm_449);  add_1995 = mm_449 = None
        convert_element_type_2525 = torch.ops.prims.convert_element_type.default(mm_448, torch.float32);  mm_448 = None
        reduce_scatter_tensor_204 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2525, 'avg', 64, '0');  convert_element_type_2525 = None
        wait_tensor_793 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_204);  reduce_scatter_tensor_204 = None
        view_2051 = torch.ops.aten.view.default(add_1996, [2, 4096, 2048]);  add_1996 = None
        convert_element_type_2526 = torch.ops.prims.convert_element_type.default(view_2051, torch.float32);  view_2051 = None
        convert_element_type_653 = torch.ops.prims.convert_element_type.default(primals_205, torch.bfloat16);  primals_205 = None
        all_gather_into_tensor_204 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_653, 64, '0');  convert_element_type_653 = None
        wait_tensor_248 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_204);  all_gather_into_tensor_204 = None
        convert_element_type_2528 = torch.ops.prims.convert_element_type.default(wait_tensor_248, torch.float32);  wait_tensor_248 = None
        mul_1781 = torch.ops.aten.mul.Tensor(convert_element_type_2526, convert_element_type_2528);  convert_element_type_2528 = None
        convert_element_type_654 = torch.ops.prims.convert_element_type.default(add_756, torch.float32);  add_756 = None
        mul_554 = torch.ops.aten.mul.Tensor(convert_element_type_654, rsqrt_38);  convert_element_type_654 = None
        mul_1783 = torch.ops.aten.mul.Tensor(mul_554, mul_1781)
        sum_220 = torch.ops.aten.sum.dim_IntList(mul_1783, [2], True);  mul_1783 = None
        div_219 = torch.ops.aten.div.Tensor(mul_554, 2048)
        mul_1784 = torch.ops.aten.mul.Tensor(div_219, sum_220);  div_219 = sum_220 = None
        sub_712 = torch.ops.aten.sub.Tensor(mul_1781, mul_1784);  mul_1781 = mul_1784 = None
        mul_1785 = torch.ops.aten.mul.Tensor(sub_712, rsqrt_38);  sub_712 = rsqrt_38 = None
        mul_1786 = torch.ops.aten.mul.Tensor(convert_element_type_2526, mul_554);  convert_element_type_2526 = mul_554 = None
        sum_221 = torch.ops.aten.sum.dim_IntList(mul_1786, [0, 1]);  mul_1786 = None
        convert_element_type_2529 = torch.ops.prims.convert_element_type.default(mul_1785, torch.bfloat16);  mul_1785 = None
        add_1997 = torch.ops.aten.add.Tensor(add_1984, convert_element_type_2529);  add_1984 = convert_element_type_2529 = None
        convert_element_type_default_39 = torch.ops.prims.convert_element_type.default(sum_221, torch.float32);  sum_221 = None
        reduce_scatter_tensor_205 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_39, 'avg', 64, '0');  convert_element_type_default_39 = None
        wait_tensor_794 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_205);  reduce_scatter_tensor_205 = None
        view_2052 = torch.ops.aten.view.default(add_1997, [8192, 2048])
        permute_1136 = torch.ops.aten.permute.default(view_2052, [1, 0])
        permute_182 = torch.ops.aten.permute.default(getitem_169, [0, 2, 1, 3])
        view_790 = torch.ops.aten.view.default(permute_182, [2, 4096, -1]);  permute_182 = None
        view_792 = torch.ops.aten.view.default(view_790, [8192, 2048]);  view_790 = None
        mm_450 = torch.ops.aten.mm.default(permute_1136, view_792);  permute_1136 = view_792 = None
        convert_element_type_650 = torch.ops.prims.convert_element_type.default(primals_204, torch.bfloat16);  primals_204 = None
        all_gather_into_tensor_203 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_650, 64, '0');  convert_element_type_650 = None
        wait_tensor_247 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_203);  all_gather_into_tensor_203 = None
        permute_183 = torch.ops.aten.permute.default(wait_tensor_247, [1, 0]);  wait_tensor_247 = None
        permute_1138 = torch.ops.aten.permute.default(permute_183, [1, 0]);  permute_183 = None
        mm_451 = torch.ops.aten.mm.default(view_2052, permute_1138);  view_2052 = permute_1138 = None
        view_2053 = torch.ops.aten.view.default(mm_451, [2, 4096, 2048]);  mm_451 = None
        convert_element_type_2536 = torch.ops.prims.convert_element_type.default(mm_450, torch.float32);  mm_450 = None
        reduce_scatter_tensor_206 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2536, 'avg', 64, '0');  convert_element_type_2536 = None
        wait_tensor_795 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_206);  reduce_scatter_tensor_206 = None
        view_2054 = torch.ops.aten.view.default(view_2053, [2, 4096, 16, 128]);  view_2053 = None
        permute_1140 = torch.ops.aten.permute.default(view_2054, [0, 2, 1, 3]);  view_2054 = None
        fw_graph14 = self.fw_graph14
        joint_graph14 = self.joint_graph14
        mask_graph14 = self.mask_graph14
        flex_attention_backward_14 = torch.ops.higher_order.flex_attention_backward(permute_179, permute_180, permute_181, getitem_169, getitem_170, permute_1140, None, fw_graph14, joint_graph14, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph14), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_179 = permute_180 = permute_181 = getitem_169 = getitem_170 = permute_1140 = fw_graph14 = joint_graph14 = mask_graph14 = None
        getitem_429 = flex_attention_backward_14[0]
        getitem_430 = flex_attention_backward_14[1]
        getitem_431 = flex_attention_backward_14[2];  flex_attention_backward_14 = None
        permute_1141 = torch.ops.aten.permute.default(getitem_431, [0, 2, 1, 3]);  getitem_431 = None
        permute_1142 = torch.ops.aten.permute.default(getitem_430, [0, 2, 1, 3]);  getitem_430 = None
        permute_1143 = torch.ops.aten.permute.default(getitem_429, [0, 2, 1, 3]);  getitem_429 = None
        slice_193 = torch.ops.aten.slice.Tensor(permute_1142, 3, 0, 128)
        slice_194 = torch.ops.aten.slice.Tensor(permute_1142, 3, 128, 192);  permute_1142 = None
        sum_222 = torch.ops.aten.sum.dim_IntList(slice_194, [2], True);  slice_194 = None
        cat_122 = torch.ops.aten.cat.default([slice_193, permute_1141], 3);  slice_193 = permute_1141 = None
        view_2055 = torch.ops.aten.view.default(cat_122, [2, 4096, 4096]);  cat_122 = None
        view_2056 = torch.ops.aten.view.default(view_2055, [8192, 4096]);  view_2055 = None
        permute_1144 = torch.ops.aten.permute.default(view_2056, [1, 0])
        mm_452 = torch.ops.aten.mm.default(permute_1144, view_787);  permute_1144 = view_787 = None
        convert_element_type_647 = torch.ops.prims.convert_element_type.default(primals_203, torch.bfloat16);  primals_203 = None
        all_gather_into_tensor_202 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_647, 64, '0');  convert_element_type_647 = None
        wait_tensor_246 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_202);  all_gather_into_tensor_202 = None
        permute_178 = torch.ops.aten.permute.default(wait_tensor_246, [1, 0]);  wait_tensor_246 = None
        permute_1146 = torch.ops.aten.permute.default(permute_178, [1, 0]);  permute_178 = None
        mm_453 = torch.ops.aten.mm.default(view_2056, permute_1146);  view_2056 = permute_1146 = None
        view_2057 = torch.ops.aten.view.default(mm_453, [2, 4096, 512]);  mm_453 = None
        convert_element_type_2541 = torch.ops.prims.convert_element_type.default(mm_452, torch.float32);  mm_452 = None
        reduce_scatter_tensor_207 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2541, 'avg', 64, '0');  convert_element_type_2541 = None
        wait_tensor_796 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_207);  reduce_scatter_tensor_207 = None
        convert_element_type_2542 = torch.ops.prims.convert_element_type.default(view_2057, torch.float32);  view_2057 = None
        convert_element_type_644 = torch.ops.prims.convert_element_type.default(primals_202, torch.bfloat16);  primals_202 = None
        all_gather_into_tensor_201 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_644, 64, '0');  convert_element_type_644 = None
        wait_tensor_245 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_201);  all_gather_into_tensor_201 = None
        convert_element_type_2544 = torch.ops.prims.convert_element_type.default(wait_tensor_245, torch.float32);  wait_tensor_245 = None
        mul_1787 = torch.ops.aten.mul.Tensor(convert_element_type_2542, convert_element_type_2544);  convert_element_type_2544 = None
        convert_element_type_645 = torch.ops.prims.convert_element_type.default(getitem_165, torch.float32);  getitem_165 = None
        mul_552 = torch.ops.aten.mul.Tensor(convert_element_type_645, rsqrt_37);  convert_element_type_645 = None
        mul_1789 = torch.ops.aten.mul.Tensor(mul_552, mul_1787)
        sum_223 = torch.ops.aten.sum.dim_IntList(mul_1789, [2], True);  mul_1789 = None
        div_220 = torch.ops.aten.div.Tensor(mul_552, 512)
        mul_1790 = torch.ops.aten.mul.Tensor(div_220, sum_223);  div_220 = sum_223 = None
        sub_713 = torch.ops.aten.sub.Tensor(mul_1787, mul_1790);  mul_1787 = mul_1790 = None
        mul_1791 = torch.ops.aten.mul.Tensor(sub_713, rsqrt_37);  sub_713 = rsqrt_37 = None
        mul_1792 = torch.ops.aten.mul.Tensor(convert_element_type_2542, mul_552);  convert_element_type_2542 = mul_552 = None
        sum_224 = torch.ops.aten.sum.dim_IntList(mul_1792, [0, 1]);  mul_1792 = None
        convert_element_type_2545 = torch.ops.prims.convert_element_type.default(mul_1791, torch.bfloat16);  mul_1791 = None
        convert_element_type_default_38 = torch.ops.prims.convert_element_type.default(sum_224, torch.float32);  sum_224 = None
        reduce_scatter_tensor_208 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_38, 'avg', 64, '0');  convert_element_type_default_38 = None
        wait_tensor_797 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_208);  reduce_scatter_tensor_208 = None
        convert_element_type_2548 = torch.ops.prims.convert_element_type.default(sum_222, torch.float32);  sum_222 = None
        view_2058 = torch.ops.aten.view.default(convert_element_type_2548, [2, 4096, 1, 32, 2]);  convert_element_type_2548 = None
        view_as_complex_82 = torch.ops.aten.view_as_complex.default(view_2058);  view_2058 = None
        mul_1793 = torch.ops.aten.mul.Tensor(view_as_complex_82, clone_9);  view_as_complex_82 = None
        view_as_real_82 = torch.ops.aten.view_as_real.default(mul_1793);  mul_1793 = None
        view_2059 = torch.ops.aten.view.default(view_as_real_82, [2, 4096, 1, 64]);  view_as_real_82 = None
        convert_element_type_2549 = torch.ops.prims.convert_element_type.default(view_2059, torch.bfloat16);  view_2059 = None
        squeeze_40 = torch.ops.aten.squeeze.dim(convert_element_type_2549, 2);  convert_element_type_2549 = None
        cat_123 = torch.ops.aten.cat.default([convert_element_type_2545, squeeze_40], 2);  convert_element_type_2545 = squeeze_40 = None
        view_2060 = torch.ops.aten.view.default(cat_123, [8192, 576]);  cat_123 = None
        permute_1148 = torch.ops.aten.permute.default(view_2060, [1, 0])
        mm_454 = torch.ops.aten.mm.default(permute_1148, view_773);  permute_1148 = None
        convert_element_type_639 = torch.ops.prims.convert_element_type.default(primals_201, torch.bfloat16);  primals_201 = None
        all_gather_into_tensor_200 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_639, 64, '0');  convert_element_type_639 = None
        wait_tensor_244 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_200);  all_gather_into_tensor_200 = None
        permute_177 = torch.ops.aten.permute.default(wait_tensor_244, [1, 0]);  wait_tensor_244 = None
        permute_1150 = torch.ops.aten.permute.default(permute_177, [1, 0]);  permute_177 = None
        mm_455 = torch.ops.aten.mm.default(view_2060, permute_1150);  view_2060 = permute_1150 = None
        view_2061 = torch.ops.aten.view.default(mm_455, [2, 4096, 2048]);  mm_455 = None
        convert_element_type_2554 = torch.ops.prims.convert_element_type.default(mm_454, torch.float32);  mm_454 = None
        reduce_scatter_tensor_209 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2554, 'avg', 64, '0');  convert_element_type_2554 = None
        wait_tensor_798 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_209);  reduce_scatter_tensor_209 = None
        slice_195 = torch.ops.aten.slice.Tensor(permute_1143, 3, 0, 128)
        slice_196 = torch.ops.aten.slice.Tensor(permute_1143, 3, 128, 192);  permute_1143 = None
        convert_element_type_2555 = torch.ops.prims.convert_element_type.default(slice_196, torch.float32);  slice_196 = None
        view_2062 = torch.ops.aten.view.default(convert_element_type_2555, [2, 4096, 16, 32, 2]);  convert_element_type_2555 = None
        view_as_complex_83 = torch.ops.aten.view_as_complex.default(view_2062);  view_2062 = None
        mul_1794 = torch.ops.aten.mul.Tensor(view_as_complex_83, clone_9);  view_as_complex_83 = None
        view_as_real_83 = torch.ops.aten.view_as_real.default(mul_1794);  mul_1794 = None
        view_2063 = torch.ops.aten.view.default(view_as_real_83, [2, 4096, 16, 64]);  view_as_real_83 = None
        convert_element_type_2556 = torch.ops.prims.convert_element_type.default(view_2063, torch.bfloat16);  view_2063 = None
        cat_124 = torch.ops.aten.cat.default([slice_195, convert_element_type_2556], 3);  slice_195 = convert_element_type_2556 = None
        view_2064 = torch.ops.aten.view.default(cat_124, [2, 4096, 3072]);  cat_124 = None
        view_2065 = torch.ops.aten.view.default(view_2064, [8192, 3072]);  view_2064 = None
        permute_1152 = torch.ops.aten.permute.default(view_2065, [1, 0])
        mm_456 = torch.ops.aten.mm.default(permute_1152, view_773);  permute_1152 = view_773 = None
        convert_element_type_634 = torch.ops.prims.convert_element_type.default(primals_200, torch.bfloat16);  primals_200 = None
        all_gather_into_tensor_199 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_634, 64, '0');  convert_element_type_634 = None
        wait_tensor_243 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_199);  all_gather_into_tensor_199 = None
        permute_176 = torch.ops.aten.permute.default(wait_tensor_243, [1, 0]);  wait_tensor_243 = None
        permute_1154 = torch.ops.aten.permute.default(permute_176, [1, 0]);  permute_176 = None
        mm_457 = torch.ops.aten.mm.default(view_2065, permute_1154);  view_2065 = permute_1154 = None
        view_2066 = torch.ops.aten.view.default(mm_457, [2, 4096, 2048]);  mm_457 = None
        add_1998 = torch.ops.aten.add.Tensor(view_2061, view_2066);  view_2061 = view_2066 = None
        convert_element_type_2561 = torch.ops.prims.convert_element_type.default(mm_456, torch.float32);  mm_456 = None
        reduce_scatter_tensor_210 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2561, 'avg', 64, '0');  convert_element_type_2561 = None
        wait_tensor_799 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_210);  reduce_scatter_tensor_210 = None
        convert_element_type_2562 = torch.ops.prims.convert_element_type.default(add_1998, torch.float32);  add_1998 = None
        convert_element_type_631 = torch.ops.prims.convert_element_type.default(primals_199, torch.bfloat16);  primals_199 = None
        all_gather_into_tensor_198 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_631, 64, '0');  convert_element_type_631 = None
        wait_tensor_242 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_198);  all_gather_into_tensor_198 = None
        convert_element_type_2564 = torch.ops.prims.convert_element_type.default(wait_tensor_242, torch.float32);  wait_tensor_242 = None
        mul_1795 = torch.ops.aten.mul.Tensor(convert_element_type_2562, convert_element_type_2564);  convert_element_type_2564 = None
        convert_element_type_632 = torch.ops.prims.convert_element_type.default(add_753, torch.float32);  add_753 = None
        mul_548 = torch.ops.aten.mul.Tensor(convert_element_type_632, rsqrt_36);  convert_element_type_632 = None
        mul_1797 = torch.ops.aten.mul.Tensor(mul_548, mul_1795)
        sum_225 = torch.ops.aten.sum.dim_IntList(mul_1797, [2], True);  mul_1797 = None
        div_221 = torch.ops.aten.div.Tensor(mul_548, 2048)
        mul_1798 = torch.ops.aten.mul.Tensor(div_221, sum_225);  div_221 = sum_225 = None
        sub_714 = torch.ops.aten.sub.Tensor(mul_1795, mul_1798);  mul_1795 = mul_1798 = None
        mul_1799 = torch.ops.aten.mul.Tensor(sub_714, rsqrt_36);  sub_714 = rsqrt_36 = None
        mul_1800 = torch.ops.aten.mul.Tensor(convert_element_type_2562, mul_548);  convert_element_type_2562 = mul_548 = None
        sum_226 = torch.ops.aten.sum.dim_IntList(mul_1800, [0, 1]);  mul_1800 = None
        convert_element_type_2565 = torch.ops.prims.convert_element_type.default(mul_1799, torch.bfloat16);  mul_1799 = None
        add_1999 = torch.ops.aten.add.Tensor(add_1997, convert_element_type_2565);  add_1997 = convert_element_type_2565 = None
        convert_element_type_default_37 = torch.ops.prims.convert_element_type.default(sum_226, torch.float32);  sum_226 = None
        reduce_scatter_tensor_211 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_37, 'avg', 64, '0');  convert_element_type_default_37 = None
        wait_tensor_800 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_211);  reduce_scatter_tensor_211 = None
        view_2067 = torch.ops.aten.view.default(add_1999, [8192, 2048])
        unsqueeze_68 = torch.ops.aten.unsqueeze.default(view_2067, 1)
        convert_element_type_2568 = torch.ops.prims.convert_element_type.default(unsqueeze_68, torch.float32);  unsqueeze_68 = None
        bmm_56 = torch.ops.aten.bmm.default(permute_1156, convert_element_type_2568);  permute_1156 = None
        bmm_57 = torch.ops.aten.bmm.default(convert_element_type_2568, permute_1157);  convert_element_type_2568 = permute_1157 = None
        convert_element_type_2569 = torch.ops.prims.convert_element_type.default(bmm_56, torch.bfloat16);  bmm_56 = None
        view_2068 = torch.ops.aten.view.default(bmm_57, [8192, 6]);  bmm_57 = None
        view_2069 = torch.ops.aten.view.default(convert_element_type_2569, [49152, 2048]);  convert_element_type_2569 = None
        index_82 = torch.ops.aten.index.Tensor(view_2069, [getitem_161]);  view_2069 = getitem_161 = None
        permute_1158 = torch.ops.aten.permute.default(view_2067, [1, 0])
        mm_458 = torch.ops.aten.mm.default(permute_1158, mul_545);  permute_1158 = mul_545 = None
        convert_element_type_626 = torch.ops.prims.convert_element_type.default(primals_198, torch.bfloat16);  primals_198 = None
        all_gather_into_tensor_197 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_626, 64, '0');  convert_element_type_626 = None
        wait_tensor_241 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_197);  all_gather_into_tensor_197 = None
        permute_175 = torch.ops.aten.permute.default(wait_tensor_241, [1, 0]);  wait_tensor_241 = None
        permute_1160 = torch.ops.aten.permute.default(permute_175, [1, 0]);  permute_175 = None
        mm_459 = torch.ops.aten.mm.default(view_2067, permute_1160);  view_2067 = permute_1160 = None
        convert_element_type_2574 = torch.ops.prims.convert_element_type.default(mm_458, torch.float32);  mm_458 = None
        reduce_scatter_tensor_212 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2574, 'avg', 64, '0');  convert_element_type_2574 = None
        wait_tensor_801 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_212);  reduce_scatter_tensor_212 = None
        convert_element_type_621 = torch.ops.prims.convert_element_type.default(mm_92, torch.float32);  mm_92 = None
        neg_22 = torch.ops.aten.neg.default(convert_element_type_621)
        exp_33 = torch.ops.aten.exp.default(neg_22);  neg_22 = None
        add_748 = torch.ops.aten.add.Tensor(exp_33, 1);  exp_33 = None
        div_55 = torch.ops.aten.div.Tensor(convert_element_type_621, add_748)
        convert_element_type_622 = torch.ops.prims.convert_element_type.default(div_55, torch.bfloat16);  div_55 = None
        mul_1801 = torch.ops.aten.mul.Tensor(mm_459, convert_element_type_622);  convert_element_type_622 = None
        mul_1802 = torch.ops.aten.mul.Tensor(mm_459, mm_93);  mm_459 = mm_93 = None
        permute_1162 = torch.ops.aten.permute.default(mul_1801, [1, 0])
        mm_460 = torch.ops.aten.mm.default(permute_1162, view_728);  permute_1162 = None
        convert_element_type_623 = torch.ops.prims.convert_element_type.default(primals_197, torch.bfloat16);  primals_197 = None
        all_gather_into_tensor_196 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_623, 64, '0');  convert_element_type_623 = None
        wait_tensor_240 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_196);  all_gather_into_tensor_196 = None
        permute_174 = torch.ops.aten.permute.default(wait_tensor_240, [1, 0]);  wait_tensor_240 = None
        permute_1164 = torch.ops.aten.permute.default(permute_174, [1, 0]);  permute_174 = None
        mm_461 = torch.ops.aten.mm.default(mul_1801, permute_1164);  mul_1801 = permute_1164 = None
        convert_element_type_2579 = torch.ops.prims.convert_element_type.default(mm_460, torch.float32);  mm_460 = None
        reduce_scatter_tensor_213 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2579, 'avg', 64, '0');  convert_element_type_2579 = None
        wait_tensor_802 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_213);  reduce_scatter_tensor_213 = None
        convert_element_type_2580 = torch.ops.prims.convert_element_type.default(mul_1802, torch.float32);  mul_1802 = None
        reciprocal_30 = torch.ops.aten.reciprocal.default(add_748);  add_748 = None
        mul_1803 = torch.ops.aten.mul.Tensor(reciprocal_30, 1);  reciprocal_30 = None
        mul_1804 = torch.ops.aten.mul.Tensor(convert_element_type_2580, mul_1803);  convert_element_type_2580 = None
        sub_715 = torch.ops.aten.sub.Tensor(1, mul_1803);  mul_1803 = None
        mul_1805 = torch.ops.aten.mul.Tensor(convert_element_type_621, sub_715);  convert_element_type_621 = sub_715 = None
        add_2001 = torch.ops.aten.add.Tensor(mul_1805, 1);  mul_1805 = None
        mul_1806 = torch.ops.aten.mul.Tensor(mul_1804, add_2001);  mul_1804 = add_2001 = None
        convert_element_type_2582 = torch.ops.prims.convert_element_type.default(mul_1806, torch.bfloat16);  mul_1806 = None
        permute_1166 = torch.ops.aten.permute.default(convert_element_type_2582, [1, 0])
        mm_462 = torch.ops.aten.mm.default(permute_1166, view_728);  permute_1166 = None
        convert_element_type_618 = torch.ops.prims.convert_element_type.default(primals_196, torch.bfloat16);  primals_196 = None
        all_gather_into_tensor_195 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_618, 64, '0');  convert_element_type_618 = None
        wait_tensor_239 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_195);  all_gather_into_tensor_195 = None
        permute_173 = torch.ops.aten.permute.default(wait_tensor_239, [1, 0]);  wait_tensor_239 = None
        permute_1168 = torch.ops.aten.permute.default(permute_173, [1, 0]);  permute_173 = None
        mm_463 = torch.ops.aten.mm.default(convert_element_type_2582, permute_1168);  convert_element_type_2582 = permute_1168 = None
        add_2002 = torch.ops.aten.add.Tensor(mm_461, mm_463);  mm_461 = mm_463 = None
        convert_element_type_2587 = torch.ops.prims.convert_element_type.default(mm_462, torch.float32);  mm_462 = None
        reduce_scatter_tensor_214 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2587, 'avg', 64, '0');  convert_element_type_2587 = None
        wait_tensor_803 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_214);  reduce_scatter_tensor_214 = None
        all_to_all_single_108 = torch.ops._c10d_functional.all_to_all_single.default(index_82, [_local_scalar_dense_168, _local_scalar_dense_169, _local_scalar_dense_170, _local_scalar_dense_171, _local_scalar_dense_172, _local_scalar_dense_173, _local_scalar_dense_174, _local_scalar_dense_175], [_local_scalar_dense_160, _local_scalar_dense_161, _local_scalar_dense_162, _local_scalar_dense_163, _local_scalar_dense_164, _local_scalar_dense_165, _local_scalar_dense_166, _local_scalar_dense_167], '521');  index_82 = None
        wait_tensor_804 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_108);  all_to_all_single_108 = None
        full_408 = torch.ops.aten.full.default([sym_size_int_41, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_41 = None
        slice_scatter_15 = torch.ops.aten.slice_scatter.default(full_408, wait_tensor_804, 0, 0, -1);  wait_tensor_804 = None
        index_83 = torch.ops.aten.index.Tensor(slice_scatter_15, [getitem_162]);  slice_scatter_15 = None
        permute_1170 = torch.ops.aten.permute.default(index_83, [1, 0])
        _grouped_mm_168 = torch.ops.aten._grouped_mm.default(permute_1170, mul_525, cumsum_32);  permute_1170 = mul_525 = None
        convert_element_type_612 = torch.ops.prims.convert_element_type.default(primals_194, torch.bfloat16);  primals_194 = None
        all_gather_into_tensor_191 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_612, 8, '513');  convert_element_type_612 = None
        wait_tensor_234 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_191);  all_gather_into_tensor_191 = None
        permute_172 = torch.ops.aten.permute.default(wait_tensor_234, [0, 2, 1]);  wait_tensor_234 = None
        permute_1172 = torch.ops.aten.permute.default(permute_172, [0, 2, 1]);  permute_172 = None
        _grouped_mm_169 = torch.ops.aten._grouped_mm.default(index_83, permute_1172, cumsum_32);  index_83 = permute_1172 = None
        convert_element_type_616 = torch.ops.prims.convert_element_type.default(_grouped_mm_30, torch.float32);  _grouped_mm_30 = None
        neg_21 = torch.ops.aten.neg.default(convert_element_type_616)
        exp_32 = torch.ops.aten.exp.default(neg_21);  neg_21 = None
        add_712 = torch.ops.aten.add.Tensor(exp_32, 1);  exp_32 = None
        div_54 = torch.ops.aten.div.Tensor(convert_element_type_616, add_712)
        convert_element_type_617 = torch.ops.prims.convert_element_type.default(div_54, torch.bfloat16);  div_54 = None
        mul_1807 = torch.ops.aten.mul.Tensor(_grouped_mm_169, convert_element_type_617);  convert_element_type_617 = None
        mul_1808 = torch.ops.aten.mul.Tensor(_grouped_mm_169, _grouped_mm_31);  _grouped_mm_169 = _grouped_mm_31 = None
        permute_1174 = torch.ops.aten.permute.default(mul_1807, [1, 0])
        _grouped_mm_170 = torch.ops.aten._grouped_mm.default(permute_1174, index_21, cumsum_32);  permute_1174 = None
        convert_element_type_613 = torch.ops.prims.convert_element_type.default(primals_195, torch.bfloat16);  primals_195 = None
        all_gather_into_tensor_192 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_613, 8, '513');  convert_element_type_613 = None
        wait_tensor_235 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_192);  all_gather_into_tensor_192 = None
        permute_171 = torch.ops.aten.permute.default(wait_tensor_235, [0, 2, 1]);  wait_tensor_235 = None
        permute_1176 = torch.ops.aten.permute.default(permute_171, [0, 2, 1]);  permute_171 = None
        _grouped_mm_171 = torch.ops.aten._grouped_mm.default(mul_1807, permute_1176, cumsum_32);  mul_1807 = permute_1176 = None
        convert_element_type_2588 = torch.ops.prims.convert_element_type.default(mul_1808, torch.float32);  mul_1808 = None
        reciprocal_31 = torch.ops.aten.reciprocal.default(add_712);  add_712 = None
        mul_1809 = torch.ops.aten.mul.Tensor(reciprocal_31, 1);  reciprocal_31 = None
        mul_1810 = torch.ops.aten.mul.Tensor(convert_element_type_2588, mul_1809);  convert_element_type_2588 = None
        sub_716 = torch.ops.aten.sub.Tensor(1, mul_1809);  mul_1809 = None
        mul_1811 = torch.ops.aten.mul.Tensor(convert_element_type_616, sub_716);  convert_element_type_616 = sub_716 = None
        add_2004 = torch.ops.aten.add.Tensor(mul_1811, 1);  mul_1811 = None
        mul_1812 = torch.ops.aten.mul.Tensor(mul_1810, add_2004);  mul_1810 = add_2004 = None
        convert_element_type_2590 = torch.ops.prims.convert_element_type.default(mul_1812, torch.bfloat16);  mul_1812 = None
        permute_1178 = torch.ops.aten.permute.default(convert_element_type_2590, [1, 0])
        _grouped_mm_172 = torch.ops.aten._grouped_mm.default(permute_1178, index_21, cumsum_32);  permute_1178 = index_21 = None
        convert_element_type_610 = torch.ops.prims.convert_element_type.default(primals_193, torch.bfloat16);  primals_193 = None
        all_gather_into_tensor_189 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_610, 8, '513');  convert_element_type_610 = None
        wait_tensor_232 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_189);  all_gather_into_tensor_189 = None
        permute_170 = torch.ops.aten.permute.default(wait_tensor_232, [0, 2, 1]);  wait_tensor_232 = None
        permute_1180 = torch.ops.aten.permute.default(permute_170, [0, 2, 1]);  permute_170 = None
        _grouped_mm_173 = torch.ops.aten._grouped_mm.default(convert_element_type_2590, permute_1180, cumsum_32);  convert_element_type_2590 = permute_1180 = cumsum_32 = None
        add_2005 = torch.ops.aten.add.Tensor(_grouped_mm_171, _grouped_mm_173);  _grouped_mm_171 = _grouped_mm_173 = None
        convert_element_type_2591 = torch.ops.prims.convert_element_type.default(_grouped_mm_170, torch.float32);  _grouped_mm_170 = None
        div_222 = torch.ops.aten.div.Tensor(convert_element_type_2591, 64);  convert_element_type_2591 = None
        reduce_scatter_tensor_215 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_222, 'sum', 8, '513');  div_222 = None
        wait_tensor_805 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_215);  reduce_scatter_tensor_215 = None
        convert_element_type_2592 = torch.ops.prims.convert_element_type.default(_grouped_mm_168, torch.float32);  _grouped_mm_168 = None
        div_223 = torch.ops.aten.div.Tensor(convert_element_type_2592, 64);  convert_element_type_2592 = None
        reduce_scatter_tensor_216 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_223, 'sum', 8, '513');  div_223 = None
        wait_tensor_806 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_216);  reduce_scatter_tensor_216 = None
        convert_element_type_2593 = torch.ops.prims.convert_element_type.default(_grouped_mm_172, torch.float32);  _grouped_mm_172 = None
        div_224 = torch.ops.aten.div.Tensor(convert_element_type_2593, 64);  convert_element_type_2593 = None
        reduce_scatter_tensor_217 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_224, 'sum', 8, '513');  div_224 = None
        wait_tensor_807 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_217);  reduce_scatter_tensor_217 = None
        index_put_82 = torch.ops.aten.index_put.default(full_408, [getitem_162], add_2005, True);  full_408 = getitem_162 = add_2005 = None
        slice_197 = torch.ops.aten.slice.Tensor(index_put_82, 0, 0, add_2006);  index_put_82 = add_2006 = None
        all_to_all_single_109 = torch.ops._c10d_functional.all_to_all_single.default(slice_197, [_local_scalar_dense_160, _local_scalar_dense_161, _local_scalar_dense_162, _local_scalar_dense_163, _local_scalar_dense_164, _local_scalar_dense_165, _local_scalar_dense_166, _local_scalar_dense_167], [_local_scalar_dense_168, _local_scalar_dense_169, _local_scalar_dense_170, _local_scalar_dense_171, _local_scalar_dense_172, _local_scalar_dense_173, _local_scalar_dense_174, _local_scalar_dense_175], '521');  slice_197 = _local_scalar_dense_160 = _local_scalar_dense_161 = _local_scalar_dense_162 = _local_scalar_dense_163 = _local_scalar_dense_164 = _local_scalar_dense_165 = _local_scalar_dense_166 = _local_scalar_dense_167 = _local_scalar_dense_168 = _local_scalar_dense_169 = _local_scalar_dense_170 = _local_scalar_dense_171 = _local_scalar_dense_172 = _local_scalar_dense_173 = _local_scalar_dense_174 = _local_scalar_dense_175 = None
        wait_tensor_808 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_109);  all_to_all_single_109 = None
        index_put_83 = torch.ops.aten.index_put.default(full_default_52, [div_52], wait_tensor_808, True);  div_52 = wait_tensor_808 = None
        add_2010 = torch.ops.aten.add.Tensor(add_2002, index_put_83);  add_2002 = index_put_83 = None
        mul_1813 = torch.ops.aten.mul.Tensor(view_2068, 1.0);  view_2068 = None
        scatter_add_15 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_159, mul_1813);  getitem_159 = mul_1813 = None
        convert_element_type_605 = torch.ops.prims.convert_element_type.default(mm_91, torch.float32);  mm_91 = None
        sub_240 = torch.ops.aten.sub.Tensor(convert_element_type_605, amax_10);  convert_element_type_605 = amax_10 = None
        exp_31 = torch.ops.aten.exp.default(sub_240);  sub_240 = None
        div_51 = torch.ops.aten.div.Tensor(exp_31, sum_41);  exp_31 = sum_41 = None
        mul_1814 = torch.ops.aten.mul.Tensor(scatter_add_15, div_51);  scatter_add_15 = None
        sum_227 = torch.ops.aten.sum.dim_IntList(mul_1814, [1], True)
        neg_100 = torch.ops.aten.neg.default(div_51);  div_51 = None
        fma_15 = torch.ops.prims.fma.default(neg_100, sum_227, mul_1814);  neg_100 = sum_227 = mul_1814 = None
        convert_element_type_2594 = torch.ops.prims.convert_element_type.default(fma_15, torch.bfloat16);  fma_15 = None
        permute_1182 = torch.ops.aten.permute.default(convert_element_type_2594, [1, 0])
        mm_464 = torch.ops.aten.mm.default(permute_1182, view_728);  permute_1182 = view_728 = None
        convert_element_type_602 = torch.ops.prims.convert_element_type.default(primals_191, torch.bfloat16);  primals_191 = None
        all_gather_into_tensor_188 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_602, 64, '0');  convert_element_type_602 = None
        wait_tensor_228 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_188);  all_gather_into_tensor_188 = None
        permute_169 = torch.ops.aten.permute.default(wait_tensor_228, [1, 0]);  wait_tensor_228 = None
        permute_1184 = torch.ops.aten.permute.default(permute_169, [1, 0]);  permute_169 = None
        mm_465 = torch.ops.aten.mm.default(convert_element_type_2594, permute_1184);  convert_element_type_2594 = permute_1184 = None
        add_2011 = torch.ops.aten.add.Tensor(add_2010, mm_465);  add_2010 = mm_465 = None
        convert_element_type_2599 = torch.ops.prims.convert_element_type.default(mm_464, torch.float32);  mm_464 = None
        reduce_scatter_tensor_218 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2599, 'avg', 64, '0');  convert_element_type_2599 = None
        wait_tensor_809 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_218);  reduce_scatter_tensor_218 = None
        view_2070 = torch.ops.aten.view.default(add_2011, [2, 4096, 2048]);  add_2011 = None
        convert_element_type_2600 = torch.ops.prims.convert_element_type.default(view_2070, torch.float32);  view_2070 = None
        convert_element_type_599 = torch.ops.prims.convert_element_type.default(primals_189, torch.bfloat16);  primals_189 = None
        all_gather_into_tensor_187 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_599, 64, '0');  convert_element_type_599 = None
        wait_tensor_227 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_187);  all_gather_into_tensor_187 = None
        convert_element_type_2602 = torch.ops.prims.convert_element_type.default(wait_tensor_227, torch.float32);  wait_tensor_227 = None
        mul_1815 = torch.ops.aten.mul.Tensor(convert_element_type_2600, convert_element_type_2602);  convert_element_type_2602 = None
        convert_element_type_600 = torch.ops.prims.convert_element_type.default(add_688, torch.float32);  add_688 = None
        mul_505 = torch.ops.aten.mul.Tensor(convert_element_type_600, rsqrt_35);  convert_element_type_600 = None
        mul_1817 = torch.ops.aten.mul.Tensor(mul_505, mul_1815)
        sum_228 = torch.ops.aten.sum.dim_IntList(mul_1817, [2], True);  mul_1817 = None
        div_225 = torch.ops.aten.div.Tensor(mul_505, 2048)
        mul_1818 = torch.ops.aten.mul.Tensor(div_225, sum_228);  div_225 = sum_228 = None
        sub_718 = torch.ops.aten.sub.Tensor(mul_1815, mul_1818);  mul_1815 = mul_1818 = None
        mul_1819 = torch.ops.aten.mul.Tensor(sub_718, rsqrt_35);  sub_718 = rsqrt_35 = None
        mul_1820 = torch.ops.aten.mul.Tensor(convert_element_type_2600, mul_505);  convert_element_type_2600 = mul_505 = None
        sum_229 = torch.ops.aten.sum.dim_IntList(mul_1820, [0, 1]);  mul_1820 = None
        convert_element_type_2603 = torch.ops.prims.convert_element_type.default(mul_1819, torch.bfloat16);  mul_1819 = None
        add_2012 = torch.ops.aten.add.Tensor(add_1999, convert_element_type_2603);  add_1999 = convert_element_type_2603 = None
        convert_element_type_default_36 = torch.ops.prims.convert_element_type.default(sum_229, torch.float32);  sum_229 = None
        reduce_scatter_tensor_219 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_36, 'avg', 64, '0');  convert_element_type_default_36 = None
        wait_tensor_810 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_219);  reduce_scatter_tensor_219 = None
        view_2071 = torch.ops.aten.view.default(add_2012, [8192, 2048])
        permute_1186 = torch.ops.aten.permute.default(view_2071, [1, 0])
        permute_167 = torch.ops.aten.permute.default(getitem_155, [0, 2, 1, 3])
        view_723 = torch.ops.aten.view.default(permute_167, [2, 4096, -1]);  permute_167 = None
        view_725 = torch.ops.aten.view.default(view_723, [8192, 2048]);  view_723 = None
        mm_466 = torch.ops.aten.mm.default(permute_1186, view_725);  permute_1186 = view_725 = None
        convert_element_type_596 = torch.ops.prims.convert_element_type.default(primals_188, torch.bfloat16);  primals_188 = None
        all_gather_into_tensor_186 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_596, 64, '0');  convert_element_type_596 = None
        wait_tensor_226 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_186);  all_gather_into_tensor_186 = None
        permute_168 = torch.ops.aten.permute.default(wait_tensor_226, [1, 0]);  wait_tensor_226 = None
        permute_1188 = torch.ops.aten.permute.default(permute_168, [1, 0]);  permute_168 = None
        mm_467 = torch.ops.aten.mm.default(view_2071, permute_1188);  view_2071 = permute_1188 = None
        view_2072 = torch.ops.aten.view.default(mm_467, [2, 4096, 2048]);  mm_467 = None
        convert_element_type_2610 = torch.ops.prims.convert_element_type.default(mm_466, torch.float32);  mm_466 = None
        reduce_scatter_tensor_220 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2610, 'avg', 64, '0');  convert_element_type_2610 = None
        wait_tensor_811 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_220);  reduce_scatter_tensor_220 = None
        view_2073 = torch.ops.aten.view.default(view_2072, [2, 4096, 16, 128]);  view_2072 = None
        permute_1190 = torch.ops.aten.permute.default(view_2073, [0, 2, 1, 3]);  view_2073 = None
        fw_graph15 = self.fw_graph15
        joint_graph15 = self.joint_graph15
        mask_graph15 = self.mask_graph15
        flex_attention_backward_15 = torch.ops.higher_order.flex_attention_backward(permute_164, permute_165, permute_166, getitem_155, getitem_156, permute_1190, None, fw_graph15, joint_graph15, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph15), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_164 = permute_165 = permute_166 = getitem_155 = getitem_156 = permute_1190 = fw_graph15 = joint_graph15 = mask_graph15 = None
        getitem_433 = flex_attention_backward_15[0]
        getitem_434 = flex_attention_backward_15[1]
        getitem_435 = flex_attention_backward_15[2];  flex_attention_backward_15 = None
        permute_1191 = torch.ops.aten.permute.default(getitem_435, [0, 2, 1, 3]);  getitem_435 = None
        permute_1192 = torch.ops.aten.permute.default(getitem_434, [0, 2, 1, 3]);  getitem_434 = None
        permute_1193 = torch.ops.aten.permute.default(getitem_433, [0, 2, 1, 3]);  getitem_433 = None
        slice_199 = torch.ops.aten.slice.Tensor(permute_1192, 3, 0, 128)
        slice_200 = torch.ops.aten.slice.Tensor(permute_1192, 3, 128, 192);  permute_1192 = None
        sum_230 = torch.ops.aten.sum.dim_IntList(slice_200, [2], True);  slice_200 = None
        cat_125 = torch.ops.aten.cat.default([slice_199, permute_1191], 3);  slice_199 = permute_1191 = None
        view_2074 = torch.ops.aten.view.default(cat_125, [2, 4096, 4096]);  cat_125 = None
        view_2075 = torch.ops.aten.view.default(view_2074, [8192, 4096]);  view_2074 = None
        permute_1194 = torch.ops.aten.permute.default(view_2075, [1, 0])
        mm_468 = torch.ops.aten.mm.default(permute_1194, view_720);  permute_1194 = view_720 = None
        convert_element_type_593 = torch.ops.prims.convert_element_type.default(primals_187, torch.bfloat16);  primals_187 = None
        all_gather_into_tensor_185 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_593, 64, '0');  convert_element_type_593 = None
        wait_tensor_225 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_185);  all_gather_into_tensor_185 = None
        permute_163 = torch.ops.aten.permute.default(wait_tensor_225, [1, 0]);  wait_tensor_225 = None
        permute_1196 = torch.ops.aten.permute.default(permute_163, [1, 0]);  permute_163 = None
        mm_469 = torch.ops.aten.mm.default(view_2075, permute_1196);  view_2075 = permute_1196 = None
        view_2076 = torch.ops.aten.view.default(mm_469, [2, 4096, 512]);  mm_469 = None
        convert_element_type_2615 = torch.ops.prims.convert_element_type.default(mm_468, torch.float32);  mm_468 = None
        reduce_scatter_tensor_221 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2615, 'avg', 64, '0');  convert_element_type_2615 = None
        wait_tensor_812 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_221);  reduce_scatter_tensor_221 = None
        convert_element_type_2616 = torch.ops.prims.convert_element_type.default(view_2076, torch.float32);  view_2076 = None
        convert_element_type_590 = torch.ops.prims.convert_element_type.default(primals_186, torch.bfloat16);  primals_186 = None
        all_gather_into_tensor_184 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_590, 64, '0');  convert_element_type_590 = None
        wait_tensor_224 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_184);  all_gather_into_tensor_184 = None
        convert_element_type_2618 = torch.ops.prims.convert_element_type.default(wait_tensor_224, torch.float32);  wait_tensor_224 = None
        mul_1821 = torch.ops.aten.mul.Tensor(convert_element_type_2616, convert_element_type_2618);  convert_element_type_2618 = None
        convert_element_type_591 = torch.ops.prims.convert_element_type.default(getitem_151, torch.float32);  getitem_151 = None
        mul_503 = torch.ops.aten.mul.Tensor(convert_element_type_591, rsqrt_34);  convert_element_type_591 = None
        mul_1823 = torch.ops.aten.mul.Tensor(mul_503, mul_1821)
        sum_231 = torch.ops.aten.sum.dim_IntList(mul_1823, [2], True);  mul_1823 = None
        div_226 = torch.ops.aten.div.Tensor(mul_503, 512)
        mul_1824 = torch.ops.aten.mul.Tensor(div_226, sum_231);  div_226 = sum_231 = None
        sub_719 = torch.ops.aten.sub.Tensor(mul_1821, mul_1824);  mul_1821 = mul_1824 = None
        mul_1825 = torch.ops.aten.mul.Tensor(sub_719, rsqrt_34);  sub_719 = rsqrt_34 = None
        mul_1826 = torch.ops.aten.mul.Tensor(convert_element_type_2616, mul_503);  convert_element_type_2616 = mul_503 = None
        sum_232 = torch.ops.aten.sum.dim_IntList(mul_1826, [0, 1]);  mul_1826 = None
        convert_element_type_2619 = torch.ops.prims.convert_element_type.default(mul_1825, torch.bfloat16);  mul_1825 = None
        convert_element_type_default_35 = torch.ops.prims.convert_element_type.default(sum_232, torch.float32);  sum_232 = None
        reduce_scatter_tensor_222 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_35, 'avg', 64, '0');  convert_element_type_default_35 = None
        wait_tensor_813 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_222);  reduce_scatter_tensor_222 = None
        convert_element_type_2622 = torch.ops.prims.convert_element_type.default(sum_230, torch.float32);  sum_230 = None
        view_2077 = torch.ops.aten.view.default(convert_element_type_2622, [2, 4096, 1, 32, 2]);  convert_element_type_2622 = None
        view_as_complex_84 = torch.ops.aten.view_as_complex.default(view_2077);  view_2077 = None
        mul_1827 = torch.ops.aten.mul.Tensor(view_as_complex_84, clone_9);  view_as_complex_84 = None
        view_as_real_84 = torch.ops.aten.view_as_real.default(mul_1827);  mul_1827 = None
        view_2078 = torch.ops.aten.view.default(view_as_real_84, [2, 4096, 1, 64]);  view_as_real_84 = None
        convert_element_type_2623 = torch.ops.prims.convert_element_type.default(view_2078, torch.bfloat16);  view_2078 = None
        squeeze_41 = torch.ops.aten.squeeze.dim(convert_element_type_2623, 2);  convert_element_type_2623 = None
        cat_126 = torch.ops.aten.cat.default([convert_element_type_2619, squeeze_41], 2);  convert_element_type_2619 = squeeze_41 = None
        view_2079 = torch.ops.aten.view.default(cat_126, [8192, 576]);  cat_126 = None
        permute_1198 = torch.ops.aten.permute.default(view_2079, [1, 0])
        mm_470 = torch.ops.aten.mm.default(permute_1198, view_706);  permute_1198 = None
        convert_element_type_585 = torch.ops.prims.convert_element_type.default(primals_185, torch.bfloat16);  primals_185 = None
        all_gather_into_tensor_183 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_585, 64, '0');  convert_element_type_585 = None
        wait_tensor_223 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_183);  all_gather_into_tensor_183 = None
        permute_162 = torch.ops.aten.permute.default(wait_tensor_223, [1, 0]);  wait_tensor_223 = None
        permute_1200 = torch.ops.aten.permute.default(permute_162, [1, 0]);  permute_162 = None
        mm_471 = torch.ops.aten.mm.default(view_2079, permute_1200);  view_2079 = permute_1200 = None
        view_2080 = torch.ops.aten.view.default(mm_471, [2, 4096, 2048]);  mm_471 = None
        convert_element_type_2628 = torch.ops.prims.convert_element_type.default(mm_470, torch.float32);  mm_470 = None
        reduce_scatter_tensor_223 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2628, 'avg', 64, '0');  convert_element_type_2628 = None
        wait_tensor_814 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_223);  reduce_scatter_tensor_223 = None
        slice_201 = torch.ops.aten.slice.Tensor(permute_1193, 3, 0, 128)
        slice_202 = torch.ops.aten.slice.Tensor(permute_1193, 3, 128, 192);  permute_1193 = None
        convert_element_type_2629 = torch.ops.prims.convert_element_type.default(slice_202, torch.float32);  slice_202 = None
        view_2081 = torch.ops.aten.view.default(convert_element_type_2629, [2, 4096, 16, 32, 2]);  convert_element_type_2629 = None
        view_as_complex_85 = torch.ops.aten.view_as_complex.default(view_2081);  view_2081 = None
        mul_1828 = torch.ops.aten.mul.Tensor(view_as_complex_85, clone_9);  view_as_complex_85 = None
        view_as_real_85 = torch.ops.aten.view_as_real.default(mul_1828);  mul_1828 = None
        view_2082 = torch.ops.aten.view.default(view_as_real_85, [2, 4096, 16, 64]);  view_as_real_85 = None
        convert_element_type_2630 = torch.ops.prims.convert_element_type.default(view_2082, torch.bfloat16);  view_2082 = None
        cat_127 = torch.ops.aten.cat.default([slice_201, convert_element_type_2630], 3);  slice_201 = convert_element_type_2630 = None
        view_2083 = torch.ops.aten.view.default(cat_127, [2, 4096, 3072]);  cat_127 = None
        view_2084 = torch.ops.aten.view.default(view_2083, [8192, 3072]);  view_2083 = None
        permute_1202 = torch.ops.aten.permute.default(view_2084, [1, 0])
        mm_472 = torch.ops.aten.mm.default(permute_1202, view_706);  permute_1202 = view_706 = None
        convert_element_type_580 = torch.ops.prims.convert_element_type.default(primals_184, torch.bfloat16);  primals_184 = None
        all_gather_into_tensor_182 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_580, 64, '0');  convert_element_type_580 = None
        wait_tensor_222 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_182);  all_gather_into_tensor_182 = None
        permute_161 = torch.ops.aten.permute.default(wait_tensor_222, [1, 0]);  wait_tensor_222 = None
        permute_1204 = torch.ops.aten.permute.default(permute_161, [1, 0]);  permute_161 = None
        mm_473 = torch.ops.aten.mm.default(view_2084, permute_1204);  view_2084 = permute_1204 = None
        view_2085 = torch.ops.aten.view.default(mm_473, [2, 4096, 2048]);  mm_473 = None
        add_2013 = torch.ops.aten.add.Tensor(view_2080, view_2085);  view_2080 = view_2085 = None
        convert_element_type_2635 = torch.ops.prims.convert_element_type.default(mm_472, torch.float32);  mm_472 = None
        reduce_scatter_tensor_224 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2635, 'avg', 64, '0');  convert_element_type_2635 = None
        wait_tensor_815 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_224);  reduce_scatter_tensor_224 = None
        convert_element_type_2636 = torch.ops.prims.convert_element_type.default(add_2013, torch.float32);  add_2013 = None
        convert_element_type_577 = torch.ops.prims.convert_element_type.default(primals_183, torch.bfloat16);  primals_183 = None
        all_gather_into_tensor_181 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_577, 64, '0');  convert_element_type_577 = None
        wait_tensor_221 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_181);  all_gather_into_tensor_181 = None
        convert_element_type_2638 = torch.ops.prims.convert_element_type.default(wait_tensor_221, torch.float32);  wait_tensor_221 = None
        mul_1829 = torch.ops.aten.mul.Tensor(convert_element_type_2636, convert_element_type_2638);  convert_element_type_2638 = None
        convert_element_type_578 = torch.ops.prims.convert_element_type.default(add_685, torch.float32);  add_685 = None
        mul_499 = torch.ops.aten.mul.Tensor(convert_element_type_578, rsqrt_33);  convert_element_type_578 = None
        mul_1831 = torch.ops.aten.mul.Tensor(mul_499, mul_1829)
        sum_233 = torch.ops.aten.sum.dim_IntList(mul_1831, [2], True);  mul_1831 = None
        div_227 = torch.ops.aten.div.Tensor(mul_499, 2048)
        mul_1832 = torch.ops.aten.mul.Tensor(div_227, sum_233);  div_227 = sum_233 = None
        sub_720 = torch.ops.aten.sub.Tensor(mul_1829, mul_1832);  mul_1829 = mul_1832 = None
        mul_1833 = torch.ops.aten.mul.Tensor(sub_720, rsqrt_33);  sub_720 = rsqrt_33 = None
        mul_1834 = torch.ops.aten.mul.Tensor(convert_element_type_2636, mul_499);  convert_element_type_2636 = mul_499 = None
        sum_234 = torch.ops.aten.sum.dim_IntList(mul_1834, [0, 1]);  mul_1834 = None
        convert_element_type_2639 = torch.ops.prims.convert_element_type.default(mul_1833, torch.bfloat16);  mul_1833 = None
        add_2014 = torch.ops.aten.add.Tensor(add_2012, convert_element_type_2639);  add_2012 = convert_element_type_2639 = None
        convert_element_type_default_34 = torch.ops.prims.convert_element_type.default(sum_234, torch.float32);  sum_234 = None
        reduce_scatter_tensor_225 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_34, 'avg', 64, '0');  convert_element_type_default_34 = None
        wait_tensor_816 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_225);  reduce_scatter_tensor_225 = None
        view_2086 = torch.ops.aten.view.default(add_2014, [8192, 2048])
        unsqueeze_69 = torch.ops.aten.unsqueeze.default(view_2086, 1)
        convert_element_type_2642 = torch.ops.prims.convert_element_type.default(unsqueeze_69, torch.float32);  unsqueeze_69 = None
        bmm_58 = torch.ops.aten.bmm.default(permute_1206, convert_element_type_2642);  permute_1206 = None
        bmm_59 = torch.ops.aten.bmm.default(convert_element_type_2642, permute_1207);  convert_element_type_2642 = permute_1207 = None
        convert_element_type_2643 = torch.ops.prims.convert_element_type.default(bmm_58, torch.bfloat16);  bmm_58 = None
        view_2087 = torch.ops.aten.view.default(bmm_59, [8192, 6]);  bmm_59 = None
        view_2088 = torch.ops.aten.view.default(convert_element_type_2643, [49152, 2048]);  convert_element_type_2643 = None
        index_84 = torch.ops.aten.index.Tensor(view_2088, [getitem_147]);  view_2088 = getitem_147 = None
        permute_1208 = torch.ops.aten.permute.default(view_2086, [1, 0])
        mm_474 = torch.ops.aten.mm.default(permute_1208, mul_496);  permute_1208 = mul_496 = None
        convert_element_type_572 = torch.ops.prims.convert_element_type.default(primals_182, torch.bfloat16);  primals_182 = None
        all_gather_into_tensor_180 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_572, 64, '0');  convert_element_type_572 = None
        wait_tensor_220 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_180);  all_gather_into_tensor_180 = None
        permute_160 = torch.ops.aten.permute.default(wait_tensor_220, [1, 0]);  wait_tensor_220 = None
        permute_1210 = torch.ops.aten.permute.default(permute_160, [1, 0]);  permute_160 = None
        mm_475 = torch.ops.aten.mm.default(view_2086, permute_1210);  view_2086 = permute_1210 = None
        convert_element_type_2648 = torch.ops.prims.convert_element_type.default(mm_474, torch.float32);  mm_474 = None
        reduce_scatter_tensor_226 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2648, 'avg', 64, '0');  convert_element_type_2648 = None
        wait_tensor_817 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_226);  reduce_scatter_tensor_226 = None
        convert_element_type_567 = torch.ops.prims.convert_element_type.default(mm_84, torch.float32);  mm_84 = None
        neg_20 = torch.ops.aten.neg.default(convert_element_type_567)
        exp_30 = torch.ops.aten.exp.default(neg_20);  neg_20 = None
        add_680 = torch.ops.aten.add.Tensor(exp_30, 1);  exp_30 = None
        div_50 = torch.ops.aten.div.Tensor(convert_element_type_567, add_680)
        convert_element_type_568 = torch.ops.prims.convert_element_type.default(div_50, torch.bfloat16);  div_50 = None
        mul_1835 = torch.ops.aten.mul.Tensor(mm_475, convert_element_type_568);  convert_element_type_568 = None
        mul_1836 = torch.ops.aten.mul.Tensor(mm_475, mm_85);  mm_475 = mm_85 = None
        permute_1212 = torch.ops.aten.permute.default(mul_1835, [1, 0])
        mm_476 = torch.ops.aten.mm.default(permute_1212, view_661);  permute_1212 = None
        convert_element_type_569 = torch.ops.prims.convert_element_type.default(primals_181, torch.bfloat16);  primals_181 = None
        all_gather_into_tensor_179 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_569, 64, '0');  convert_element_type_569 = None
        wait_tensor_219 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_179);  all_gather_into_tensor_179 = None
        permute_159 = torch.ops.aten.permute.default(wait_tensor_219, [1, 0]);  wait_tensor_219 = None
        permute_1214 = torch.ops.aten.permute.default(permute_159, [1, 0]);  permute_159 = None
        mm_477 = torch.ops.aten.mm.default(mul_1835, permute_1214);  mul_1835 = permute_1214 = None
        convert_element_type_2653 = torch.ops.prims.convert_element_type.default(mm_476, torch.float32);  mm_476 = None
        reduce_scatter_tensor_227 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2653, 'avg', 64, '0');  convert_element_type_2653 = None
        wait_tensor_818 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_227);  reduce_scatter_tensor_227 = None
        convert_element_type_2654 = torch.ops.prims.convert_element_type.default(mul_1836, torch.float32);  mul_1836 = None
        reciprocal_32 = torch.ops.aten.reciprocal.default(add_680);  add_680 = None
        mul_1837 = torch.ops.aten.mul.Tensor(reciprocal_32, 1);  reciprocal_32 = None
        mul_1838 = torch.ops.aten.mul.Tensor(convert_element_type_2654, mul_1837);  convert_element_type_2654 = None
        sub_721 = torch.ops.aten.sub.Tensor(1, mul_1837);  mul_1837 = None
        mul_1839 = torch.ops.aten.mul.Tensor(convert_element_type_567, sub_721);  convert_element_type_567 = sub_721 = None
        add_2016 = torch.ops.aten.add.Tensor(mul_1839, 1);  mul_1839 = None
        mul_1840 = torch.ops.aten.mul.Tensor(mul_1838, add_2016);  mul_1838 = add_2016 = None
        convert_element_type_2656 = torch.ops.prims.convert_element_type.default(mul_1840, torch.bfloat16);  mul_1840 = None
        permute_1216 = torch.ops.aten.permute.default(convert_element_type_2656, [1, 0])
        mm_478 = torch.ops.aten.mm.default(permute_1216, view_661);  permute_1216 = None
        convert_element_type_564 = torch.ops.prims.convert_element_type.default(primals_180, torch.bfloat16);  primals_180 = None
        all_gather_into_tensor_178 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_564, 64, '0');  convert_element_type_564 = None
        wait_tensor_218 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_178);  all_gather_into_tensor_178 = None
        permute_158 = torch.ops.aten.permute.default(wait_tensor_218, [1, 0]);  wait_tensor_218 = None
        permute_1218 = torch.ops.aten.permute.default(permute_158, [1, 0]);  permute_158 = None
        mm_479 = torch.ops.aten.mm.default(convert_element_type_2656, permute_1218);  convert_element_type_2656 = permute_1218 = None
        add_2017 = torch.ops.aten.add.Tensor(mm_477, mm_479);  mm_477 = mm_479 = None
        convert_element_type_2661 = torch.ops.prims.convert_element_type.default(mm_478, torch.float32);  mm_478 = None
        reduce_scatter_tensor_228 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2661, 'avg', 64, '0');  convert_element_type_2661 = None
        wait_tensor_819 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_228);  reduce_scatter_tensor_228 = None
        all_to_all_single_110 = torch.ops._c10d_functional.all_to_all_single.default(index_84, [_local_scalar_dense_152, _local_scalar_dense_153, _local_scalar_dense_154, _local_scalar_dense_155, _local_scalar_dense_156, _local_scalar_dense_157, _local_scalar_dense_158, _local_scalar_dense_159], [_local_scalar_dense_144, _local_scalar_dense_145, _local_scalar_dense_146, _local_scalar_dense_147, _local_scalar_dense_148, _local_scalar_dense_149, _local_scalar_dense_150, _local_scalar_dense_151], '521');  index_84 = None
        wait_tensor_820 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_110);  all_to_all_single_110 = None
        full_412 = torch.ops.aten.full.default([sym_size_int_37, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_37 = None
        slice_scatter_16 = torch.ops.aten.slice_scatter.default(full_412, wait_tensor_820, 0, 0, -1);  wait_tensor_820 = None
        index_85 = torch.ops.aten.index.Tensor(slice_scatter_16, [getitem_148]);  slice_scatter_16 = None
        permute_1220 = torch.ops.aten.permute.default(index_85, [1, 0])
        _grouped_mm_174 = torch.ops.aten._grouped_mm.default(permute_1220, mul_476, cumsum_29);  permute_1220 = mul_476 = None
        convert_element_type_558 = torch.ops.prims.convert_element_type.default(primals_178, torch.bfloat16);  primals_178 = None
        all_gather_into_tensor_174 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_558, 8, '513');  convert_element_type_558 = None
        wait_tensor_213 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_174);  all_gather_into_tensor_174 = None
        permute_157 = torch.ops.aten.permute.default(wait_tensor_213, [0, 2, 1]);  wait_tensor_213 = None
        permute_1222 = torch.ops.aten.permute.default(permute_157, [0, 2, 1]);  permute_157 = None
        _grouped_mm_175 = torch.ops.aten._grouped_mm.default(index_85, permute_1222, cumsum_29);  index_85 = permute_1222 = None
        convert_element_type_562 = torch.ops.prims.convert_element_type.default(_grouped_mm_27, torch.float32);  _grouped_mm_27 = None
        neg_19 = torch.ops.aten.neg.default(convert_element_type_562)
        exp_29 = torch.ops.aten.exp.default(neg_19);  neg_19 = None
        add_644 = torch.ops.aten.add.Tensor(exp_29, 1);  exp_29 = None
        div_49 = torch.ops.aten.div.Tensor(convert_element_type_562, add_644)
        convert_element_type_563 = torch.ops.prims.convert_element_type.default(div_49, torch.bfloat16);  div_49 = None
        mul_1841 = torch.ops.aten.mul.Tensor(_grouped_mm_175, convert_element_type_563);  convert_element_type_563 = None
        mul_1842 = torch.ops.aten.mul.Tensor(_grouped_mm_175, _grouped_mm_28);  _grouped_mm_175 = _grouped_mm_28 = None
        permute_1224 = torch.ops.aten.permute.default(mul_1841, [1, 0])
        _grouped_mm_176 = torch.ops.aten._grouped_mm.default(permute_1224, index_19, cumsum_29);  permute_1224 = None
        convert_element_type_559 = torch.ops.prims.convert_element_type.default(primals_179, torch.bfloat16);  primals_179 = None
        all_gather_into_tensor_175 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_559, 8, '513');  convert_element_type_559 = None
        wait_tensor_214 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_175);  all_gather_into_tensor_175 = None
        permute_156 = torch.ops.aten.permute.default(wait_tensor_214, [0, 2, 1]);  wait_tensor_214 = None
        permute_1226 = torch.ops.aten.permute.default(permute_156, [0, 2, 1]);  permute_156 = None
        _grouped_mm_177 = torch.ops.aten._grouped_mm.default(mul_1841, permute_1226, cumsum_29);  mul_1841 = permute_1226 = None
        convert_element_type_2662 = torch.ops.prims.convert_element_type.default(mul_1842, torch.float32);  mul_1842 = None
        reciprocal_33 = torch.ops.aten.reciprocal.default(add_644);  add_644 = None
        mul_1843 = torch.ops.aten.mul.Tensor(reciprocal_33, 1);  reciprocal_33 = None
        mul_1844 = torch.ops.aten.mul.Tensor(convert_element_type_2662, mul_1843);  convert_element_type_2662 = None
        sub_722 = torch.ops.aten.sub.Tensor(1, mul_1843);  mul_1843 = None
        mul_1845 = torch.ops.aten.mul.Tensor(convert_element_type_562, sub_722);  convert_element_type_562 = sub_722 = None
        add_2019 = torch.ops.aten.add.Tensor(mul_1845, 1);  mul_1845 = None
        mul_1846 = torch.ops.aten.mul.Tensor(mul_1844, add_2019);  mul_1844 = add_2019 = None
        convert_element_type_2664 = torch.ops.prims.convert_element_type.default(mul_1846, torch.bfloat16);  mul_1846 = None
        permute_1228 = torch.ops.aten.permute.default(convert_element_type_2664, [1, 0])
        _grouped_mm_178 = torch.ops.aten._grouped_mm.default(permute_1228, index_19, cumsum_29);  permute_1228 = index_19 = None
        convert_element_type_556 = torch.ops.prims.convert_element_type.default(primals_177, torch.bfloat16);  primals_177 = None
        all_gather_into_tensor_172 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_556, 8, '513');  convert_element_type_556 = None
        wait_tensor_211 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_172);  all_gather_into_tensor_172 = None
        permute_155 = torch.ops.aten.permute.default(wait_tensor_211, [0, 2, 1]);  wait_tensor_211 = None
        permute_1230 = torch.ops.aten.permute.default(permute_155, [0, 2, 1]);  permute_155 = None
        _grouped_mm_179 = torch.ops.aten._grouped_mm.default(convert_element_type_2664, permute_1230, cumsum_29);  convert_element_type_2664 = permute_1230 = cumsum_29 = None
        add_2020 = torch.ops.aten.add.Tensor(_grouped_mm_177, _grouped_mm_179);  _grouped_mm_177 = _grouped_mm_179 = None
        convert_element_type_2665 = torch.ops.prims.convert_element_type.default(_grouped_mm_176, torch.float32);  _grouped_mm_176 = None
        div_228 = torch.ops.aten.div.Tensor(convert_element_type_2665, 64);  convert_element_type_2665 = None
        reduce_scatter_tensor_229 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_228, 'sum', 8, '513');  div_228 = None
        wait_tensor_821 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_229);  reduce_scatter_tensor_229 = None
        convert_element_type_2666 = torch.ops.prims.convert_element_type.default(_grouped_mm_174, torch.float32);  _grouped_mm_174 = None
        div_229 = torch.ops.aten.div.Tensor(convert_element_type_2666, 64);  convert_element_type_2666 = None
        reduce_scatter_tensor_230 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_229, 'sum', 8, '513');  div_229 = None
        wait_tensor_822 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_230);  reduce_scatter_tensor_230 = None
        convert_element_type_2667 = torch.ops.prims.convert_element_type.default(_grouped_mm_178, torch.float32);  _grouped_mm_178 = None
        div_230 = torch.ops.aten.div.Tensor(convert_element_type_2667, 64);  convert_element_type_2667 = None
        reduce_scatter_tensor_231 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_230, 'sum', 8, '513');  div_230 = None
        wait_tensor_823 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_231);  reduce_scatter_tensor_231 = None
        index_put_84 = torch.ops.aten.index_put.default(full_412, [getitem_148], add_2020, True);  full_412 = getitem_148 = add_2020 = None
        slice_203 = torch.ops.aten.slice.Tensor(index_put_84, 0, 0, add_2021);  index_put_84 = add_2021 = None
        all_to_all_single_111 = torch.ops._c10d_functional.all_to_all_single.default(slice_203, [_local_scalar_dense_144, _local_scalar_dense_145, _local_scalar_dense_146, _local_scalar_dense_147, _local_scalar_dense_148, _local_scalar_dense_149, _local_scalar_dense_150, _local_scalar_dense_151], [_local_scalar_dense_152, _local_scalar_dense_153, _local_scalar_dense_154, _local_scalar_dense_155, _local_scalar_dense_156, _local_scalar_dense_157, _local_scalar_dense_158, _local_scalar_dense_159], '521');  slice_203 = _local_scalar_dense_144 = _local_scalar_dense_145 = _local_scalar_dense_146 = _local_scalar_dense_147 = _local_scalar_dense_148 = _local_scalar_dense_149 = _local_scalar_dense_150 = _local_scalar_dense_151 = _local_scalar_dense_152 = _local_scalar_dense_153 = _local_scalar_dense_154 = _local_scalar_dense_155 = _local_scalar_dense_156 = _local_scalar_dense_157 = _local_scalar_dense_158 = _local_scalar_dense_159 = None
        wait_tensor_824 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_111);  all_to_all_single_111 = None
        index_put_85 = torch.ops.aten.index_put.default(full_default_52, [div_47], wait_tensor_824, True);  div_47 = wait_tensor_824 = None
        add_2025 = torch.ops.aten.add.Tensor(add_2017, index_put_85);  add_2017 = index_put_85 = None
        mul_1847 = torch.ops.aten.mul.Tensor(view_2087, 1.0);  view_2087 = None
        scatter_add_16 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_145, mul_1847);  getitem_145 = mul_1847 = None
        convert_element_type_551 = torch.ops.prims.convert_element_type.default(mm_83, torch.float32);  mm_83 = None
        sub_216 = torch.ops.aten.sub.Tensor(convert_element_type_551, amax_9);  convert_element_type_551 = amax_9 = None
        exp_28 = torch.ops.aten.exp.default(sub_216);  sub_216 = None
        div_46 = torch.ops.aten.div.Tensor(exp_28, sum_37);  exp_28 = sum_37 = None
        mul_1848 = torch.ops.aten.mul.Tensor(scatter_add_16, div_46);  scatter_add_16 = None
        sum_235 = torch.ops.aten.sum.dim_IntList(mul_1848, [1], True)
        neg_103 = torch.ops.aten.neg.default(div_46);  div_46 = None
        fma_16 = torch.ops.prims.fma.default(neg_103, sum_235, mul_1848);  neg_103 = sum_235 = mul_1848 = None
        convert_element_type_2668 = torch.ops.prims.convert_element_type.default(fma_16, torch.bfloat16);  fma_16 = None
        permute_1232 = torch.ops.aten.permute.default(convert_element_type_2668, [1, 0])
        mm_480 = torch.ops.aten.mm.default(permute_1232, view_661);  permute_1232 = view_661 = None
        convert_element_type_548 = torch.ops.prims.convert_element_type.default(primals_175, torch.bfloat16);  primals_175 = None
        all_gather_into_tensor_171 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_548, 64, '0');  convert_element_type_548 = None
        wait_tensor_207 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_171);  all_gather_into_tensor_171 = None
        permute_154 = torch.ops.aten.permute.default(wait_tensor_207, [1, 0]);  wait_tensor_207 = None
        permute_1234 = torch.ops.aten.permute.default(permute_154, [1, 0]);  permute_154 = None
        mm_481 = torch.ops.aten.mm.default(convert_element_type_2668, permute_1234);  convert_element_type_2668 = permute_1234 = None
        add_2026 = torch.ops.aten.add.Tensor(add_2025, mm_481);  add_2025 = mm_481 = None
        convert_element_type_2673 = torch.ops.prims.convert_element_type.default(mm_480, torch.float32);  mm_480 = None
        reduce_scatter_tensor_232 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2673, 'avg', 64, '0');  convert_element_type_2673 = None
        wait_tensor_825 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_232);  reduce_scatter_tensor_232 = None
        view_2089 = torch.ops.aten.view.default(add_2026, [2, 4096, 2048]);  add_2026 = None
        convert_element_type_2674 = torch.ops.prims.convert_element_type.default(view_2089, torch.float32);  view_2089 = None
        convert_element_type_545 = torch.ops.prims.convert_element_type.default(primals_173, torch.bfloat16);  primals_173 = None
        all_gather_into_tensor_170 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_545, 64, '0');  convert_element_type_545 = None
        wait_tensor_206 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_170);  all_gather_into_tensor_170 = None
        convert_element_type_2676 = torch.ops.prims.convert_element_type.default(wait_tensor_206, torch.float32);  wait_tensor_206 = None
        mul_1849 = torch.ops.aten.mul.Tensor(convert_element_type_2674, convert_element_type_2676);  convert_element_type_2676 = None
        convert_element_type_546 = torch.ops.prims.convert_element_type.default(add_620, torch.float32);  add_620 = None
        mul_456 = torch.ops.aten.mul.Tensor(convert_element_type_546, rsqrt_32);  convert_element_type_546 = None
        mul_1851 = torch.ops.aten.mul.Tensor(mul_456, mul_1849)
        sum_236 = torch.ops.aten.sum.dim_IntList(mul_1851, [2], True);  mul_1851 = None
        div_231 = torch.ops.aten.div.Tensor(mul_456, 2048)
        mul_1852 = torch.ops.aten.mul.Tensor(div_231, sum_236);  div_231 = sum_236 = None
        sub_724 = torch.ops.aten.sub.Tensor(mul_1849, mul_1852);  mul_1849 = mul_1852 = None
        mul_1853 = torch.ops.aten.mul.Tensor(sub_724, rsqrt_32);  sub_724 = rsqrt_32 = None
        mul_1854 = torch.ops.aten.mul.Tensor(convert_element_type_2674, mul_456);  convert_element_type_2674 = mul_456 = None
        sum_237 = torch.ops.aten.sum.dim_IntList(mul_1854, [0, 1]);  mul_1854 = None
        convert_element_type_2677 = torch.ops.prims.convert_element_type.default(mul_1853, torch.bfloat16);  mul_1853 = None
        add_2027 = torch.ops.aten.add.Tensor(add_2014, convert_element_type_2677);  add_2014 = convert_element_type_2677 = None
        convert_element_type_default_33 = torch.ops.prims.convert_element_type.default(sum_237, torch.float32);  sum_237 = None
        reduce_scatter_tensor_233 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_33, 'avg', 64, '0');  convert_element_type_default_33 = None
        wait_tensor_826 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_233);  reduce_scatter_tensor_233 = None
        view_2090 = torch.ops.aten.view.default(add_2027, [8192, 2048])
        permute_1236 = torch.ops.aten.permute.default(view_2090, [1, 0])
        permute_152 = torch.ops.aten.permute.default(getitem_141, [0, 2, 1, 3])
        view_656 = torch.ops.aten.view.default(permute_152, [2, 4096, -1]);  permute_152 = None
        view_658 = torch.ops.aten.view.default(view_656, [8192, 2048]);  view_656 = None
        mm_482 = torch.ops.aten.mm.default(permute_1236, view_658);  permute_1236 = view_658 = None
        convert_element_type_542 = torch.ops.prims.convert_element_type.default(primals_172, torch.bfloat16);  primals_172 = None
        all_gather_into_tensor_169 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_542, 64, '0');  convert_element_type_542 = None
        wait_tensor_205 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_169);  all_gather_into_tensor_169 = None
        permute_153 = torch.ops.aten.permute.default(wait_tensor_205, [1, 0]);  wait_tensor_205 = None
        permute_1238 = torch.ops.aten.permute.default(permute_153, [1, 0]);  permute_153 = None
        mm_483 = torch.ops.aten.mm.default(view_2090, permute_1238);  view_2090 = permute_1238 = None
        view_2091 = torch.ops.aten.view.default(mm_483, [2, 4096, 2048]);  mm_483 = None
        convert_element_type_2684 = torch.ops.prims.convert_element_type.default(mm_482, torch.float32);  mm_482 = None
        reduce_scatter_tensor_234 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2684, 'avg', 64, '0');  convert_element_type_2684 = None
        wait_tensor_827 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_234);  reduce_scatter_tensor_234 = None
        view_2092 = torch.ops.aten.view.default(view_2091, [2, 4096, 16, 128]);  view_2091 = None
        permute_1240 = torch.ops.aten.permute.default(view_2092, [0, 2, 1, 3]);  view_2092 = None
        fw_graph16 = self.fw_graph16
        joint_graph16 = self.joint_graph16
        mask_graph16 = self.mask_graph16
        flex_attention_backward_16 = torch.ops.higher_order.flex_attention_backward(permute_149, permute_150, permute_151, getitem_141, getitem_142, permute_1240, None, fw_graph16, joint_graph16, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph16), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_149 = permute_150 = permute_151 = getitem_141 = getitem_142 = permute_1240 = fw_graph16 = joint_graph16 = mask_graph16 = None
        getitem_437 = flex_attention_backward_16[0]
        getitem_438 = flex_attention_backward_16[1]
        getitem_439 = flex_attention_backward_16[2];  flex_attention_backward_16 = None
        permute_1241 = torch.ops.aten.permute.default(getitem_439, [0, 2, 1, 3]);  getitem_439 = None
        permute_1242 = torch.ops.aten.permute.default(getitem_438, [0, 2, 1, 3]);  getitem_438 = None
        permute_1243 = torch.ops.aten.permute.default(getitem_437, [0, 2, 1, 3]);  getitem_437 = None
        slice_205 = torch.ops.aten.slice.Tensor(permute_1242, 3, 0, 128)
        slice_206 = torch.ops.aten.slice.Tensor(permute_1242, 3, 128, 192);  permute_1242 = None
        sum_238 = torch.ops.aten.sum.dim_IntList(slice_206, [2], True);  slice_206 = None
        cat_128 = torch.ops.aten.cat.default([slice_205, permute_1241], 3);  slice_205 = permute_1241 = None
        view_2093 = torch.ops.aten.view.default(cat_128, [2, 4096, 4096]);  cat_128 = None
        view_2094 = torch.ops.aten.view.default(view_2093, [8192, 4096]);  view_2093 = None
        permute_1244 = torch.ops.aten.permute.default(view_2094, [1, 0])
        mm_484 = torch.ops.aten.mm.default(permute_1244, view_653);  permute_1244 = view_653 = None
        convert_element_type_539 = torch.ops.prims.convert_element_type.default(primals_171, torch.bfloat16);  primals_171 = None
        all_gather_into_tensor_168 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_539, 64, '0');  convert_element_type_539 = None
        wait_tensor_204 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_168);  all_gather_into_tensor_168 = None
        permute_148 = torch.ops.aten.permute.default(wait_tensor_204, [1, 0]);  wait_tensor_204 = None
        permute_1246 = torch.ops.aten.permute.default(permute_148, [1, 0]);  permute_148 = None
        mm_485 = torch.ops.aten.mm.default(view_2094, permute_1246);  view_2094 = permute_1246 = None
        view_2095 = torch.ops.aten.view.default(mm_485, [2, 4096, 512]);  mm_485 = None
        convert_element_type_2689 = torch.ops.prims.convert_element_type.default(mm_484, torch.float32);  mm_484 = None
        reduce_scatter_tensor_235 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2689, 'avg', 64, '0');  convert_element_type_2689 = None
        wait_tensor_828 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_235);  reduce_scatter_tensor_235 = None
        convert_element_type_2690 = torch.ops.prims.convert_element_type.default(view_2095, torch.float32);  view_2095 = None
        convert_element_type_536 = torch.ops.prims.convert_element_type.default(primals_170, torch.bfloat16);  primals_170 = None
        all_gather_into_tensor_167 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_536, 64, '0');  convert_element_type_536 = None
        wait_tensor_203 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_167);  all_gather_into_tensor_167 = None
        convert_element_type_2692 = torch.ops.prims.convert_element_type.default(wait_tensor_203, torch.float32);  wait_tensor_203 = None
        mul_1855 = torch.ops.aten.mul.Tensor(convert_element_type_2690, convert_element_type_2692);  convert_element_type_2692 = None
        convert_element_type_537 = torch.ops.prims.convert_element_type.default(getitem_137, torch.float32);  getitem_137 = None
        mul_454 = torch.ops.aten.mul.Tensor(convert_element_type_537, rsqrt_31);  convert_element_type_537 = None
        mul_1857 = torch.ops.aten.mul.Tensor(mul_454, mul_1855)
        sum_239 = torch.ops.aten.sum.dim_IntList(mul_1857, [2], True);  mul_1857 = None
        div_232 = torch.ops.aten.div.Tensor(mul_454, 512)
        mul_1858 = torch.ops.aten.mul.Tensor(div_232, sum_239);  div_232 = sum_239 = None
        sub_725 = torch.ops.aten.sub.Tensor(mul_1855, mul_1858);  mul_1855 = mul_1858 = None
        mul_1859 = torch.ops.aten.mul.Tensor(sub_725, rsqrt_31);  sub_725 = rsqrt_31 = None
        mul_1860 = torch.ops.aten.mul.Tensor(convert_element_type_2690, mul_454);  convert_element_type_2690 = mul_454 = None
        sum_240 = torch.ops.aten.sum.dim_IntList(mul_1860, [0, 1]);  mul_1860 = None
        convert_element_type_2693 = torch.ops.prims.convert_element_type.default(mul_1859, torch.bfloat16);  mul_1859 = None
        convert_element_type_default_32 = torch.ops.prims.convert_element_type.default(sum_240, torch.float32);  sum_240 = None
        reduce_scatter_tensor_236 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_32, 'avg', 64, '0');  convert_element_type_default_32 = None
        wait_tensor_829 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_236);  reduce_scatter_tensor_236 = None
        convert_element_type_2696 = torch.ops.prims.convert_element_type.default(sum_238, torch.float32);  sum_238 = None
        view_2096 = torch.ops.aten.view.default(convert_element_type_2696, [2, 4096, 1, 32, 2]);  convert_element_type_2696 = None
        view_as_complex_86 = torch.ops.aten.view_as_complex.default(view_2096);  view_2096 = None
        mul_1861 = torch.ops.aten.mul.Tensor(view_as_complex_86, clone_9);  view_as_complex_86 = None
        view_as_real_86 = torch.ops.aten.view_as_real.default(mul_1861);  mul_1861 = None
        view_2097 = torch.ops.aten.view.default(view_as_real_86, [2, 4096, 1, 64]);  view_as_real_86 = None
        convert_element_type_2697 = torch.ops.prims.convert_element_type.default(view_2097, torch.bfloat16);  view_2097 = None
        squeeze_42 = torch.ops.aten.squeeze.dim(convert_element_type_2697, 2);  convert_element_type_2697 = None
        cat_129 = torch.ops.aten.cat.default([convert_element_type_2693, squeeze_42], 2);  convert_element_type_2693 = squeeze_42 = None
        view_2098 = torch.ops.aten.view.default(cat_129, [8192, 576]);  cat_129 = None
        permute_1248 = torch.ops.aten.permute.default(view_2098, [1, 0])
        mm_486 = torch.ops.aten.mm.default(permute_1248, view_639);  permute_1248 = None
        convert_element_type_531 = torch.ops.prims.convert_element_type.default(primals_169, torch.bfloat16);  primals_169 = None
        all_gather_into_tensor_166 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_531, 64, '0');  convert_element_type_531 = None
        wait_tensor_202 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_166);  all_gather_into_tensor_166 = None
        permute_147 = torch.ops.aten.permute.default(wait_tensor_202, [1, 0]);  wait_tensor_202 = None
        permute_1250 = torch.ops.aten.permute.default(permute_147, [1, 0]);  permute_147 = None
        mm_487 = torch.ops.aten.mm.default(view_2098, permute_1250);  view_2098 = permute_1250 = None
        view_2099 = torch.ops.aten.view.default(mm_487, [2, 4096, 2048]);  mm_487 = None
        convert_element_type_2702 = torch.ops.prims.convert_element_type.default(mm_486, torch.float32);  mm_486 = None
        reduce_scatter_tensor_237 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2702, 'avg', 64, '0');  convert_element_type_2702 = None
        wait_tensor_830 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_237);  reduce_scatter_tensor_237 = None
        slice_207 = torch.ops.aten.slice.Tensor(permute_1243, 3, 0, 128)
        slice_208 = torch.ops.aten.slice.Tensor(permute_1243, 3, 128, 192);  permute_1243 = None
        convert_element_type_2703 = torch.ops.prims.convert_element_type.default(slice_208, torch.float32);  slice_208 = None
        view_2100 = torch.ops.aten.view.default(convert_element_type_2703, [2, 4096, 16, 32, 2]);  convert_element_type_2703 = None
        view_as_complex_87 = torch.ops.aten.view_as_complex.default(view_2100);  view_2100 = None
        mul_1862 = torch.ops.aten.mul.Tensor(view_as_complex_87, clone_9);  view_as_complex_87 = None
        view_as_real_87 = torch.ops.aten.view_as_real.default(mul_1862);  mul_1862 = None
        view_2101 = torch.ops.aten.view.default(view_as_real_87, [2, 4096, 16, 64]);  view_as_real_87 = None
        convert_element_type_2704 = torch.ops.prims.convert_element_type.default(view_2101, torch.bfloat16);  view_2101 = None
        cat_130 = torch.ops.aten.cat.default([slice_207, convert_element_type_2704], 3);  slice_207 = convert_element_type_2704 = None
        view_2102 = torch.ops.aten.view.default(cat_130, [2, 4096, 3072]);  cat_130 = None
        view_2103 = torch.ops.aten.view.default(view_2102, [8192, 3072]);  view_2102 = None
        permute_1252 = torch.ops.aten.permute.default(view_2103, [1, 0])
        mm_488 = torch.ops.aten.mm.default(permute_1252, view_639);  permute_1252 = view_639 = None
        convert_element_type_526 = torch.ops.prims.convert_element_type.default(primals_168, torch.bfloat16);  primals_168 = None
        all_gather_into_tensor_165 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_526, 64, '0');  convert_element_type_526 = None
        wait_tensor_201 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_165);  all_gather_into_tensor_165 = None
        permute_146 = torch.ops.aten.permute.default(wait_tensor_201, [1, 0]);  wait_tensor_201 = None
        permute_1254 = torch.ops.aten.permute.default(permute_146, [1, 0]);  permute_146 = None
        mm_489 = torch.ops.aten.mm.default(view_2103, permute_1254);  view_2103 = permute_1254 = None
        view_2104 = torch.ops.aten.view.default(mm_489, [2, 4096, 2048]);  mm_489 = None
        add_2028 = torch.ops.aten.add.Tensor(view_2099, view_2104);  view_2099 = view_2104 = None
        convert_element_type_2709 = torch.ops.prims.convert_element_type.default(mm_488, torch.float32);  mm_488 = None
        reduce_scatter_tensor_238 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2709, 'avg', 64, '0');  convert_element_type_2709 = None
        wait_tensor_831 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_238);  reduce_scatter_tensor_238 = None
        convert_element_type_2710 = torch.ops.prims.convert_element_type.default(add_2028, torch.float32);  add_2028 = None
        convert_element_type_523 = torch.ops.prims.convert_element_type.default(primals_167, torch.bfloat16);  primals_167 = None
        all_gather_into_tensor_164 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_523, 64, '0');  convert_element_type_523 = None
        wait_tensor_200 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_164);  all_gather_into_tensor_164 = None
        convert_element_type_2712 = torch.ops.prims.convert_element_type.default(wait_tensor_200, torch.float32);  wait_tensor_200 = None
        mul_1863 = torch.ops.aten.mul.Tensor(convert_element_type_2710, convert_element_type_2712);  convert_element_type_2712 = None
        convert_element_type_524 = torch.ops.prims.convert_element_type.default(add_617, torch.float32);  add_617 = None
        mul_450 = torch.ops.aten.mul.Tensor(convert_element_type_524, rsqrt_30);  convert_element_type_524 = None
        mul_1865 = torch.ops.aten.mul.Tensor(mul_450, mul_1863)
        sum_241 = torch.ops.aten.sum.dim_IntList(mul_1865, [2], True);  mul_1865 = None
        div_233 = torch.ops.aten.div.Tensor(mul_450, 2048)
        mul_1866 = torch.ops.aten.mul.Tensor(div_233, sum_241);  div_233 = sum_241 = None
        sub_726 = torch.ops.aten.sub.Tensor(mul_1863, mul_1866);  mul_1863 = mul_1866 = None
        mul_1867 = torch.ops.aten.mul.Tensor(sub_726, rsqrt_30);  sub_726 = rsqrt_30 = None
        mul_1868 = torch.ops.aten.mul.Tensor(convert_element_type_2710, mul_450);  convert_element_type_2710 = mul_450 = None
        sum_242 = torch.ops.aten.sum.dim_IntList(mul_1868, [0, 1]);  mul_1868 = None
        convert_element_type_2713 = torch.ops.prims.convert_element_type.default(mul_1867, torch.bfloat16);  mul_1867 = None
        add_2029 = torch.ops.aten.add.Tensor(add_2027, convert_element_type_2713);  add_2027 = convert_element_type_2713 = None
        convert_element_type_default_31 = torch.ops.prims.convert_element_type.default(sum_242, torch.float32);  sum_242 = None
        reduce_scatter_tensor_239 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_31, 'avg', 64, '0');  convert_element_type_default_31 = None
        wait_tensor_832 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_239);  reduce_scatter_tensor_239 = None
        view_2105 = torch.ops.aten.view.default(add_2029, [8192, 2048])
        unsqueeze_70 = torch.ops.aten.unsqueeze.default(view_2105, 1)
        convert_element_type_2716 = torch.ops.prims.convert_element_type.default(unsqueeze_70, torch.float32);  unsqueeze_70 = None
        bmm_60 = torch.ops.aten.bmm.default(permute_1256, convert_element_type_2716);  permute_1256 = None
        bmm_61 = torch.ops.aten.bmm.default(convert_element_type_2716, permute_1257);  convert_element_type_2716 = permute_1257 = None
        convert_element_type_2717 = torch.ops.prims.convert_element_type.default(bmm_60, torch.bfloat16);  bmm_60 = None
        view_2106 = torch.ops.aten.view.default(bmm_61, [8192, 6]);  bmm_61 = None
        view_2107 = torch.ops.aten.view.default(convert_element_type_2717, [49152, 2048]);  convert_element_type_2717 = None
        index_86 = torch.ops.aten.index.Tensor(view_2107, [getitem_133]);  view_2107 = getitem_133 = None
        permute_1258 = torch.ops.aten.permute.default(view_2105, [1, 0])
        mm_490 = torch.ops.aten.mm.default(permute_1258, mul_447);  permute_1258 = mul_447 = None
        convert_element_type_518 = torch.ops.prims.convert_element_type.default(primals_166, torch.bfloat16);  primals_166 = None
        all_gather_into_tensor_163 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_518, 64, '0');  convert_element_type_518 = None
        wait_tensor_199 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_163);  all_gather_into_tensor_163 = None
        permute_145 = torch.ops.aten.permute.default(wait_tensor_199, [1, 0]);  wait_tensor_199 = None
        permute_1260 = torch.ops.aten.permute.default(permute_145, [1, 0]);  permute_145 = None
        mm_491 = torch.ops.aten.mm.default(view_2105, permute_1260);  view_2105 = permute_1260 = None
        convert_element_type_2722 = torch.ops.prims.convert_element_type.default(mm_490, torch.float32);  mm_490 = None
        reduce_scatter_tensor_240 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2722, 'avg', 64, '0');  convert_element_type_2722 = None
        wait_tensor_833 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_240);  reduce_scatter_tensor_240 = None
        convert_element_type_513 = torch.ops.prims.convert_element_type.default(mm_76, torch.float32);  mm_76 = None
        neg_18 = torch.ops.aten.neg.default(convert_element_type_513)
        exp_27 = torch.ops.aten.exp.default(neg_18);  neg_18 = None
        add_612 = torch.ops.aten.add.Tensor(exp_27, 1);  exp_27 = None
        div_45 = torch.ops.aten.div.Tensor(convert_element_type_513, add_612)
        convert_element_type_514 = torch.ops.prims.convert_element_type.default(div_45, torch.bfloat16);  div_45 = None
        mul_1869 = torch.ops.aten.mul.Tensor(mm_491, convert_element_type_514);  convert_element_type_514 = None
        mul_1870 = torch.ops.aten.mul.Tensor(mm_491, mm_77);  mm_491 = mm_77 = None
        permute_1262 = torch.ops.aten.permute.default(mul_1869, [1, 0])
        mm_492 = torch.ops.aten.mm.default(permute_1262, view_594);  permute_1262 = None
        convert_element_type_515 = torch.ops.prims.convert_element_type.default(primals_165, torch.bfloat16);  primals_165 = None
        all_gather_into_tensor_162 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_515, 64, '0');  convert_element_type_515 = None
        wait_tensor_198 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_162);  all_gather_into_tensor_162 = None
        permute_144 = torch.ops.aten.permute.default(wait_tensor_198, [1, 0]);  wait_tensor_198 = None
        permute_1264 = torch.ops.aten.permute.default(permute_144, [1, 0]);  permute_144 = None
        mm_493 = torch.ops.aten.mm.default(mul_1869, permute_1264);  mul_1869 = permute_1264 = None
        convert_element_type_2727 = torch.ops.prims.convert_element_type.default(mm_492, torch.float32);  mm_492 = None
        reduce_scatter_tensor_241 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2727, 'avg', 64, '0');  convert_element_type_2727 = None
        wait_tensor_834 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_241);  reduce_scatter_tensor_241 = None
        convert_element_type_2728 = torch.ops.prims.convert_element_type.default(mul_1870, torch.float32);  mul_1870 = None
        reciprocal_34 = torch.ops.aten.reciprocal.default(add_612);  add_612 = None
        mul_1871 = torch.ops.aten.mul.Tensor(reciprocal_34, 1);  reciprocal_34 = None
        mul_1872 = torch.ops.aten.mul.Tensor(convert_element_type_2728, mul_1871);  convert_element_type_2728 = None
        sub_727 = torch.ops.aten.sub.Tensor(1, mul_1871);  mul_1871 = None
        mul_1873 = torch.ops.aten.mul.Tensor(convert_element_type_513, sub_727);  convert_element_type_513 = sub_727 = None
        add_2031 = torch.ops.aten.add.Tensor(mul_1873, 1);  mul_1873 = None
        mul_1874 = torch.ops.aten.mul.Tensor(mul_1872, add_2031);  mul_1872 = add_2031 = None
        convert_element_type_2730 = torch.ops.prims.convert_element_type.default(mul_1874, torch.bfloat16);  mul_1874 = None
        permute_1266 = torch.ops.aten.permute.default(convert_element_type_2730, [1, 0])
        mm_494 = torch.ops.aten.mm.default(permute_1266, view_594);  permute_1266 = None
        convert_element_type_510 = torch.ops.prims.convert_element_type.default(primals_164, torch.bfloat16);  primals_164 = None
        all_gather_into_tensor_161 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_510, 64, '0');  convert_element_type_510 = None
        wait_tensor_197 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_161);  all_gather_into_tensor_161 = None
        permute_143 = torch.ops.aten.permute.default(wait_tensor_197, [1, 0]);  wait_tensor_197 = None
        permute_1268 = torch.ops.aten.permute.default(permute_143, [1, 0]);  permute_143 = None
        mm_495 = torch.ops.aten.mm.default(convert_element_type_2730, permute_1268);  convert_element_type_2730 = permute_1268 = None
        add_2032 = torch.ops.aten.add.Tensor(mm_493, mm_495);  mm_493 = mm_495 = None
        convert_element_type_2735 = torch.ops.prims.convert_element_type.default(mm_494, torch.float32);  mm_494 = None
        reduce_scatter_tensor_242 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2735, 'avg', 64, '0');  convert_element_type_2735 = None
        wait_tensor_835 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_242);  reduce_scatter_tensor_242 = None
        all_to_all_single_112 = torch.ops._c10d_functional.all_to_all_single.default(index_86, [_local_scalar_dense_136, _local_scalar_dense_137, _local_scalar_dense_138, _local_scalar_dense_139, _local_scalar_dense_140, _local_scalar_dense_141, _local_scalar_dense_142, _local_scalar_dense_143], [_local_scalar_dense_128, _local_scalar_dense_129, _local_scalar_dense_130, _local_scalar_dense_131, _local_scalar_dense_132, _local_scalar_dense_133, _local_scalar_dense_134, _local_scalar_dense_135], '521');  index_86 = None
        wait_tensor_836 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_112);  all_to_all_single_112 = None
        full_416 = torch.ops.aten.full.default([sym_size_int_33, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_33 = None
        slice_scatter_17 = torch.ops.aten.slice_scatter.default(full_416, wait_tensor_836, 0, 0, -1);  wait_tensor_836 = None
        index_87 = torch.ops.aten.index.Tensor(slice_scatter_17, [getitem_134]);  slice_scatter_17 = None
        permute_1270 = torch.ops.aten.permute.default(index_87, [1, 0])
        _grouped_mm_180 = torch.ops.aten._grouped_mm.default(permute_1270, mul_427, cumsum_26);  permute_1270 = mul_427 = None
        convert_element_type_504 = torch.ops.prims.convert_element_type.default(primals_162, torch.bfloat16);  primals_162 = None
        all_gather_into_tensor_157 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_504, 8, '513');  convert_element_type_504 = None
        wait_tensor_192 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_157);  all_gather_into_tensor_157 = None
        permute_142 = torch.ops.aten.permute.default(wait_tensor_192, [0, 2, 1]);  wait_tensor_192 = None
        permute_1272 = torch.ops.aten.permute.default(permute_142, [0, 2, 1]);  permute_142 = None
        _grouped_mm_181 = torch.ops.aten._grouped_mm.default(index_87, permute_1272, cumsum_26);  index_87 = permute_1272 = None
        convert_element_type_508 = torch.ops.prims.convert_element_type.default(_grouped_mm_24, torch.float32);  _grouped_mm_24 = None
        neg_17 = torch.ops.aten.neg.default(convert_element_type_508)
        exp_26 = torch.ops.aten.exp.default(neg_17);  neg_17 = None
        add_576 = torch.ops.aten.add.Tensor(exp_26, 1);  exp_26 = None
        div_44 = torch.ops.aten.div.Tensor(convert_element_type_508, add_576)
        convert_element_type_509 = torch.ops.prims.convert_element_type.default(div_44, torch.bfloat16);  div_44 = None
        mul_1875 = torch.ops.aten.mul.Tensor(_grouped_mm_181, convert_element_type_509);  convert_element_type_509 = None
        mul_1876 = torch.ops.aten.mul.Tensor(_grouped_mm_181, _grouped_mm_25);  _grouped_mm_181 = _grouped_mm_25 = None
        permute_1274 = torch.ops.aten.permute.default(mul_1875, [1, 0])
        _grouped_mm_182 = torch.ops.aten._grouped_mm.default(permute_1274, index_17, cumsum_26);  permute_1274 = None
        convert_element_type_505 = torch.ops.prims.convert_element_type.default(primals_163, torch.bfloat16);  primals_163 = None
        all_gather_into_tensor_158 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_505, 8, '513');  convert_element_type_505 = None
        wait_tensor_193 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_158);  all_gather_into_tensor_158 = None
        permute_141 = torch.ops.aten.permute.default(wait_tensor_193, [0, 2, 1]);  wait_tensor_193 = None
        permute_1276 = torch.ops.aten.permute.default(permute_141, [0, 2, 1]);  permute_141 = None
        _grouped_mm_183 = torch.ops.aten._grouped_mm.default(mul_1875, permute_1276, cumsum_26);  mul_1875 = permute_1276 = None
        convert_element_type_2736 = torch.ops.prims.convert_element_type.default(mul_1876, torch.float32);  mul_1876 = None
        reciprocal_35 = torch.ops.aten.reciprocal.default(add_576);  add_576 = None
        mul_1877 = torch.ops.aten.mul.Tensor(reciprocal_35, 1);  reciprocal_35 = None
        mul_1878 = torch.ops.aten.mul.Tensor(convert_element_type_2736, mul_1877);  convert_element_type_2736 = None
        sub_728 = torch.ops.aten.sub.Tensor(1, mul_1877);  mul_1877 = None
        mul_1879 = torch.ops.aten.mul.Tensor(convert_element_type_508, sub_728);  convert_element_type_508 = sub_728 = None
        add_2034 = torch.ops.aten.add.Tensor(mul_1879, 1);  mul_1879 = None
        mul_1880 = torch.ops.aten.mul.Tensor(mul_1878, add_2034);  mul_1878 = add_2034 = None
        convert_element_type_2738 = torch.ops.prims.convert_element_type.default(mul_1880, torch.bfloat16);  mul_1880 = None
        permute_1278 = torch.ops.aten.permute.default(convert_element_type_2738, [1, 0])
        _grouped_mm_184 = torch.ops.aten._grouped_mm.default(permute_1278, index_17, cumsum_26);  permute_1278 = index_17 = None
        convert_element_type_502 = torch.ops.prims.convert_element_type.default(primals_161, torch.bfloat16);  primals_161 = None
        all_gather_into_tensor_155 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_502, 8, '513');  convert_element_type_502 = None
        wait_tensor_190 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_155);  all_gather_into_tensor_155 = None
        permute_140 = torch.ops.aten.permute.default(wait_tensor_190, [0, 2, 1]);  wait_tensor_190 = None
        permute_1280 = torch.ops.aten.permute.default(permute_140, [0, 2, 1]);  permute_140 = None
        _grouped_mm_185 = torch.ops.aten._grouped_mm.default(convert_element_type_2738, permute_1280, cumsum_26);  convert_element_type_2738 = permute_1280 = cumsum_26 = None
        add_2035 = torch.ops.aten.add.Tensor(_grouped_mm_183, _grouped_mm_185);  _grouped_mm_183 = _grouped_mm_185 = None
        convert_element_type_2739 = torch.ops.prims.convert_element_type.default(_grouped_mm_182, torch.float32);  _grouped_mm_182 = None
        div_234 = torch.ops.aten.div.Tensor(convert_element_type_2739, 64);  convert_element_type_2739 = None
        reduce_scatter_tensor_243 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_234, 'sum', 8, '513');  div_234 = None
        wait_tensor_837 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_243);  reduce_scatter_tensor_243 = None
        convert_element_type_2740 = torch.ops.prims.convert_element_type.default(_grouped_mm_180, torch.float32);  _grouped_mm_180 = None
        div_235 = torch.ops.aten.div.Tensor(convert_element_type_2740, 64);  convert_element_type_2740 = None
        reduce_scatter_tensor_244 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_235, 'sum', 8, '513');  div_235 = None
        wait_tensor_838 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_244);  reduce_scatter_tensor_244 = None
        convert_element_type_2741 = torch.ops.prims.convert_element_type.default(_grouped_mm_184, torch.float32);  _grouped_mm_184 = None
        div_236 = torch.ops.aten.div.Tensor(convert_element_type_2741, 64);  convert_element_type_2741 = None
        reduce_scatter_tensor_245 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_236, 'sum', 8, '513');  div_236 = None
        wait_tensor_839 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_245);  reduce_scatter_tensor_245 = None
        index_put_86 = torch.ops.aten.index_put.default(full_416, [getitem_134], add_2035, True);  full_416 = getitem_134 = add_2035 = None
        slice_209 = torch.ops.aten.slice.Tensor(index_put_86, 0, 0, add_2036);  index_put_86 = add_2036 = None
        all_to_all_single_113 = torch.ops._c10d_functional.all_to_all_single.default(slice_209, [_local_scalar_dense_128, _local_scalar_dense_129, _local_scalar_dense_130, _local_scalar_dense_131, _local_scalar_dense_132, _local_scalar_dense_133, _local_scalar_dense_134, _local_scalar_dense_135], [_local_scalar_dense_136, _local_scalar_dense_137, _local_scalar_dense_138, _local_scalar_dense_139, _local_scalar_dense_140, _local_scalar_dense_141, _local_scalar_dense_142, _local_scalar_dense_143], '521');  slice_209 = _local_scalar_dense_128 = _local_scalar_dense_129 = _local_scalar_dense_130 = _local_scalar_dense_131 = _local_scalar_dense_132 = _local_scalar_dense_133 = _local_scalar_dense_134 = _local_scalar_dense_135 = _local_scalar_dense_136 = _local_scalar_dense_137 = _local_scalar_dense_138 = _local_scalar_dense_139 = _local_scalar_dense_140 = _local_scalar_dense_141 = _local_scalar_dense_142 = _local_scalar_dense_143 = None
        wait_tensor_840 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_113);  all_to_all_single_113 = None
        index_put_87 = torch.ops.aten.index_put.default(full_default_52, [div_42], wait_tensor_840, True);  div_42 = wait_tensor_840 = None
        add_2040 = torch.ops.aten.add.Tensor(add_2032, index_put_87);  add_2032 = index_put_87 = None
        mul_1881 = torch.ops.aten.mul.Tensor(view_2106, 1.0);  view_2106 = None
        scatter_add_17 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_131, mul_1881);  getitem_131 = mul_1881 = None
        convert_element_type_497 = torch.ops.prims.convert_element_type.default(mm_75, torch.float32);  mm_75 = None
        sub_192 = torch.ops.aten.sub.Tensor(convert_element_type_497, amax_8);  convert_element_type_497 = amax_8 = None
        exp_25 = torch.ops.aten.exp.default(sub_192);  sub_192 = None
        div_41 = torch.ops.aten.div.Tensor(exp_25, sum_33);  exp_25 = sum_33 = None
        mul_1882 = torch.ops.aten.mul.Tensor(scatter_add_17, div_41);  scatter_add_17 = None
        sum_243 = torch.ops.aten.sum.dim_IntList(mul_1882, [1], True)
        neg_106 = torch.ops.aten.neg.default(div_41);  div_41 = None
        fma_17 = torch.ops.prims.fma.default(neg_106, sum_243, mul_1882);  neg_106 = sum_243 = mul_1882 = None
        convert_element_type_2742 = torch.ops.prims.convert_element_type.default(fma_17, torch.bfloat16);  fma_17 = None
        permute_1282 = torch.ops.aten.permute.default(convert_element_type_2742, [1, 0])
        mm_496 = torch.ops.aten.mm.default(permute_1282, view_594);  permute_1282 = view_594 = None
        convert_element_type_494 = torch.ops.prims.convert_element_type.default(primals_159, torch.bfloat16);  primals_159 = None
        all_gather_into_tensor_154 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_494, 64, '0');  convert_element_type_494 = None
        wait_tensor_186 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_154);  all_gather_into_tensor_154 = None
        permute_139 = torch.ops.aten.permute.default(wait_tensor_186, [1, 0]);  wait_tensor_186 = None
        permute_1284 = torch.ops.aten.permute.default(permute_139, [1, 0]);  permute_139 = None
        mm_497 = torch.ops.aten.mm.default(convert_element_type_2742, permute_1284);  convert_element_type_2742 = permute_1284 = None
        add_2041 = torch.ops.aten.add.Tensor(add_2040, mm_497);  add_2040 = mm_497 = None
        convert_element_type_2747 = torch.ops.prims.convert_element_type.default(mm_496, torch.float32);  mm_496 = None
        reduce_scatter_tensor_246 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2747, 'avg', 64, '0');  convert_element_type_2747 = None
        wait_tensor_841 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_246);  reduce_scatter_tensor_246 = None
        view_2108 = torch.ops.aten.view.default(add_2041, [2, 4096, 2048]);  add_2041 = None
        convert_element_type_2748 = torch.ops.prims.convert_element_type.default(view_2108, torch.float32);  view_2108 = None
        convert_element_type_491 = torch.ops.prims.convert_element_type.default(primals_157, torch.bfloat16);  primals_157 = None
        all_gather_into_tensor_153 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_491, 64, '0');  convert_element_type_491 = None
        wait_tensor_185 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_153);  all_gather_into_tensor_153 = None
        convert_element_type_2750 = torch.ops.prims.convert_element_type.default(wait_tensor_185, torch.float32);  wait_tensor_185 = None
        mul_1883 = torch.ops.aten.mul.Tensor(convert_element_type_2748, convert_element_type_2750);  convert_element_type_2750 = None
        convert_element_type_492 = torch.ops.prims.convert_element_type.default(add_552, torch.float32);  add_552 = None
        mul_407 = torch.ops.aten.mul.Tensor(convert_element_type_492, rsqrt_29);  convert_element_type_492 = None
        mul_1885 = torch.ops.aten.mul.Tensor(mul_407, mul_1883)
        sum_244 = torch.ops.aten.sum.dim_IntList(mul_1885, [2], True);  mul_1885 = None
        div_237 = torch.ops.aten.div.Tensor(mul_407, 2048)
        mul_1886 = torch.ops.aten.mul.Tensor(div_237, sum_244);  div_237 = sum_244 = None
        sub_730 = torch.ops.aten.sub.Tensor(mul_1883, mul_1886);  mul_1883 = mul_1886 = None
        mul_1887 = torch.ops.aten.mul.Tensor(sub_730, rsqrt_29);  sub_730 = rsqrt_29 = None
        mul_1888 = torch.ops.aten.mul.Tensor(convert_element_type_2748, mul_407);  convert_element_type_2748 = mul_407 = None
        sum_245 = torch.ops.aten.sum.dim_IntList(mul_1888, [0, 1]);  mul_1888 = None
        convert_element_type_2751 = torch.ops.prims.convert_element_type.default(mul_1887, torch.bfloat16);  mul_1887 = None
        add_2042 = torch.ops.aten.add.Tensor(add_2029, convert_element_type_2751);  add_2029 = convert_element_type_2751 = None
        convert_element_type_default_30 = torch.ops.prims.convert_element_type.default(sum_245, torch.float32);  sum_245 = None
        reduce_scatter_tensor_247 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_30, 'avg', 64, '0');  convert_element_type_default_30 = None
        wait_tensor_842 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_247);  reduce_scatter_tensor_247 = None
        view_2109 = torch.ops.aten.view.default(add_2042, [8192, 2048])
        permute_1286 = torch.ops.aten.permute.default(view_2109, [1, 0])
        permute_137 = torch.ops.aten.permute.default(getitem_127, [0, 2, 1, 3])
        view_589 = torch.ops.aten.view.default(permute_137, [2, 4096, -1]);  permute_137 = None
        view_591 = torch.ops.aten.view.default(view_589, [8192, 2048]);  view_589 = None
        mm_498 = torch.ops.aten.mm.default(permute_1286, view_591);  permute_1286 = view_591 = None
        convert_element_type_488 = torch.ops.prims.convert_element_type.default(primals_156, torch.bfloat16);  primals_156 = None
        all_gather_into_tensor_152 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_488, 64, '0');  convert_element_type_488 = None
        wait_tensor_184 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_152);  all_gather_into_tensor_152 = None
        permute_138 = torch.ops.aten.permute.default(wait_tensor_184, [1, 0]);  wait_tensor_184 = None
        permute_1288 = torch.ops.aten.permute.default(permute_138, [1, 0]);  permute_138 = None
        mm_499 = torch.ops.aten.mm.default(view_2109, permute_1288);  view_2109 = permute_1288 = None
        view_2110 = torch.ops.aten.view.default(mm_499, [2, 4096, 2048]);  mm_499 = None
        convert_element_type_2758 = torch.ops.prims.convert_element_type.default(mm_498, torch.float32);  mm_498 = None
        reduce_scatter_tensor_248 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2758, 'avg', 64, '0');  convert_element_type_2758 = None
        wait_tensor_843 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_248);  reduce_scatter_tensor_248 = None
        view_2111 = torch.ops.aten.view.default(view_2110, [2, 4096, 16, 128]);  view_2110 = None
        permute_1290 = torch.ops.aten.permute.default(view_2111, [0, 2, 1, 3]);  view_2111 = None
        fw_graph17 = self.fw_graph17
        joint_graph17 = self.joint_graph17
        mask_graph17 = self.mask_graph17
        flex_attention_backward_17 = torch.ops.higher_order.flex_attention_backward(permute_134, permute_135, permute_136, getitem_127, getitem_128, permute_1290, None, fw_graph17, joint_graph17, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph17), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_134 = permute_135 = permute_136 = getitem_127 = getitem_128 = permute_1290 = fw_graph17 = joint_graph17 = mask_graph17 = None
        getitem_441 = flex_attention_backward_17[0]
        getitem_442 = flex_attention_backward_17[1]
        getitem_443 = flex_attention_backward_17[2];  flex_attention_backward_17 = None
        permute_1291 = torch.ops.aten.permute.default(getitem_443, [0, 2, 1, 3]);  getitem_443 = None
        permute_1292 = torch.ops.aten.permute.default(getitem_442, [0, 2, 1, 3]);  getitem_442 = None
        permute_1293 = torch.ops.aten.permute.default(getitem_441, [0, 2, 1, 3]);  getitem_441 = None
        slice_211 = torch.ops.aten.slice.Tensor(permute_1292, 3, 0, 128)
        slice_212 = torch.ops.aten.slice.Tensor(permute_1292, 3, 128, 192);  permute_1292 = None
        sum_246 = torch.ops.aten.sum.dim_IntList(slice_212, [2], True);  slice_212 = None
        cat_131 = torch.ops.aten.cat.default([slice_211, permute_1291], 3);  slice_211 = permute_1291 = None
        view_2112 = torch.ops.aten.view.default(cat_131, [2, 4096, 4096]);  cat_131 = None
        view_2113 = torch.ops.aten.view.default(view_2112, [8192, 4096]);  view_2112 = None
        permute_1294 = torch.ops.aten.permute.default(view_2113, [1, 0])
        mm_500 = torch.ops.aten.mm.default(permute_1294, view_586);  permute_1294 = view_586 = None
        convert_element_type_485 = torch.ops.prims.convert_element_type.default(primals_155, torch.bfloat16);  primals_155 = None
        all_gather_into_tensor_151 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_485, 64, '0');  convert_element_type_485 = None
        wait_tensor_183 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_151);  all_gather_into_tensor_151 = None
        permute_133 = torch.ops.aten.permute.default(wait_tensor_183, [1, 0]);  wait_tensor_183 = None
        permute_1296 = torch.ops.aten.permute.default(permute_133, [1, 0]);  permute_133 = None
        mm_501 = torch.ops.aten.mm.default(view_2113, permute_1296);  view_2113 = permute_1296 = None
        view_2114 = torch.ops.aten.view.default(mm_501, [2, 4096, 512]);  mm_501 = None
        convert_element_type_2763 = torch.ops.prims.convert_element_type.default(mm_500, torch.float32);  mm_500 = None
        reduce_scatter_tensor_249 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2763, 'avg', 64, '0');  convert_element_type_2763 = None
        wait_tensor_844 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_249);  reduce_scatter_tensor_249 = None
        convert_element_type_2764 = torch.ops.prims.convert_element_type.default(view_2114, torch.float32);  view_2114 = None
        convert_element_type_482 = torch.ops.prims.convert_element_type.default(primals_154, torch.bfloat16);  primals_154 = None
        all_gather_into_tensor_150 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_482, 64, '0');  convert_element_type_482 = None
        wait_tensor_182 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_150);  all_gather_into_tensor_150 = None
        convert_element_type_2766 = torch.ops.prims.convert_element_type.default(wait_tensor_182, torch.float32);  wait_tensor_182 = None
        mul_1889 = torch.ops.aten.mul.Tensor(convert_element_type_2764, convert_element_type_2766);  convert_element_type_2766 = None
        convert_element_type_483 = torch.ops.prims.convert_element_type.default(getitem_123, torch.float32);  getitem_123 = None
        mul_405 = torch.ops.aten.mul.Tensor(convert_element_type_483, rsqrt_28);  convert_element_type_483 = None
        mul_1891 = torch.ops.aten.mul.Tensor(mul_405, mul_1889)
        sum_247 = torch.ops.aten.sum.dim_IntList(mul_1891, [2], True);  mul_1891 = None
        div_238 = torch.ops.aten.div.Tensor(mul_405, 512)
        mul_1892 = torch.ops.aten.mul.Tensor(div_238, sum_247);  div_238 = sum_247 = None
        sub_731 = torch.ops.aten.sub.Tensor(mul_1889, mul_1892);  mul_1889 = mul_1892 = None
        mul_1893 = torch.ops.aten.mul.Tensor(sub_731, rsqrt_28);  sub_731 = rsqrt_28 = None
        mul_1894 = torch.ops.aten.mul.Tensor(convert_element_type_2764, mul_405);  convert_element_type_2764 = mul_405 = None
        sum_248 = torch.ops.aten.sum.dim_IntList(mul_1894, [0, 1]);  mul_1894 = None
        convert_element_type_2767 = torch.ops.prims.convert_element_type.default(mul_1893, torch.bfloat16);  mul_1893 = None
        convert_element_type_default_29 = torch.ops.prims.convert_element_type.default(sum_248, torch.float32);  sum_248 = None
        reduce_scatter_tensor_250 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_29, 'avg', 64, '0');  convert_element_type_default_29 = None
        wait_tensor_845 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_250);  reduce_scatter_tensor_250 = None
        convert_element_type_2770 = torch.ops.prims.convert_element_type.default(sum_246, torch.float32);  sum_246 = None
        view_2115 = torch.ops.aten.view.default(convert_element_type_2770, [2, 4096, 1, 32, 2]);  convert_element_type_2770 = None
        view_as_complex_88 = torch.ops.aten.view_as_complex.default(view_2115);  view_2115 = None
        mul_1895 = torch.ops.aten.mul.Tensor(view_as_complex_88, clone_9);  view_as_complex_88 = None
        view_as_real_88 = torch.ops.aten.view_as_real.default(mul_1895);  mul_1895 = None
        view_2116 = torch.ops.aten.view.default(view_as_real_88, [2, 4096, 1, 64]);  view_as_real_88 = None
        convert_element_type_2771 = torch.ops.prims.convert_element_type.default(view_2116, torch.bfloat16);  view_2116 = None
        squeeze_43 = torch.ops.aten.squeeze.dim(convert_element_type_2771, 2);  convert_element_type_2771 = None
        cat_132 = torch.ops.aten.cat.default([convert_element_type_2767, squeeze_43], 2);  convert_element_type_2767 = squeeze_43 = None
        view_2117 = torch.ops.aten.view.default(cat_132, [8192, 576]);  cat_132 = None
        permute_1298 = torch.ops.aten.permute.default(view_2117, [1, 0])
        mm_502 = torch.ops.aten.mm.default(permute_1298, view_572);  permute_1298 = None
        convert_element_type_477 = torch.ops.prims.convert_element_type.default(primals_153, torch.bfloat16);  primals_153 = None
        all_gather_into_tensor_149 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_477, 64, '0');  convert_element_type_477 = None
        wait_tensor_181 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_149);  all_gather_into_tensor_149 = None
        permute_132 = torch.ops.aten.permute.default(wait_tensor_181, [1, 0]);  wait_tensor_181 = None
        permute_1300 = torch.ops.aten.permute.default(permute_132, [1, 0]);  permute_132 = None
        mm_503 = torch.ops.aten.mm.default(view_2117, permute_1300);  view_2117 = permute_1300 = None
        view_2118 = torch.ops.aten.view.default(mm_503, [2, 4096, 2048]);  mm_503 = None
        convert_element_type_2776 = torch.ops.prims.convert_element_type.default(mm_502, torch.float32);  mm_502 = None
        reduce_scatter_tensor_251 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2776, 'avg', 64, '0');  convert_element_type_2776 = None
        wait_tensor_846 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_251);  reduce_scatter_tensor_251 = None
        slice_213 = torch.ops.aten.slice.Tensor(permute_1293, 3, 0, 128)
        slice_214 = torch.ops.aten.slice.Tensor(permute_1293, 3, 128, 192);  permute_1293 = None
        convert_element_type_2777 = torch.ops.prims.convert_element_type.default(slice_214, torch.float32);  slice_214 = None
        view_2119 = torch.ops.aten.view.default(convert_element_type_2777, [2, 4096, 16, 32, 2]);  convert_element_type_2777 = None
        view_as_complex_89 = torch.ops.aten.view_as_complex.default(view_2119);  view_2119 = None
        mul_1896 = torch.ops.aten.mul.Tensor(view_as_complex_89, clone_9);  view_as_complex_89 = None
        view_as_real_89 = torch.ops.aten.view_as_real.default(mul_1896);  mul_1896 = None
        view_2120 = torch.ops.aten.view.default(view_as_real_89, [2, 4096, 16, 64]);  view_as_real_89 = None
        convert_element_type_2778 = torch.ops.prims.convert_element_type.default(view_2120, torch.bfloat16);  view_2120 = None
        cat_133 = torch.ops.aten.cat.default([slice_213, convert_element_type_2778], 3);  slice_213 = convert_element_type_2778 = None
        view_2121 = torch.ops.aten.view.default(cat_133, [2, 4096, 3072]);  cat_133 = None
        view_2122 = torch.ops.aten.view.default(view_2121, [8192, 3072]);  view_2121 = None
        permute_1302 = torch.ops.aten.permute.default(view_2122, [1, 0])
        mm_504 = torch.ops.aten.mm.default(permute_1302, view_572);  permute_1302 = view_572 = None
        convert_element_type_472 = torch.ops.prims.convert_element_type.default(primals_152, torch.bfloat16);  primals_152 = None
        all_gather_into_tensor_148 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_472, 64, '0');  convert_element_type_472 = None
        wait_tensor_180 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_148);  all_gather_into_tensor_148 = None
        permute_131 = torch.ops.aten.permute.default(wait_tensor_180, [1, 0]);  wait_tensor_180 = None
        permute_1304 = torch.ops.aten.permute.default(permute_131, [1, 0]);  permute_131 = None
        mm_505 = torch.ops.aten.mm.default(view_2122, permute_1304);  view_2122 = permute_1304 = None
        view_2123 = torch.ops.aten.view.default(mm_505, [2, 4096, 2048]);  mm_505 = None
        add_2043 = torch.ops.aten.add.Tensor(view_2118, view_2123);  view_2118 = view_2123 = None
        convert_element_type_2783 = torch.ops.prims.convert_element_type.default(mm_504, torch.float32);  mm_504 = None
        reduce_scatter_tensor_252 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2783, 'avg', 64, '0');  convert_element_type_2783 = None
        wait_tensor_847 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_252);  reduce_scatter_tensor_252 = None
        convert_element_type_2784 = torch.ops.prims.convert_element_type.default(add_2043, torch.float32);  add_2043 = None
        convert_element_type_469 = torch.ops.prims.convert_element_type.default(primals_151, torch.bfloat16);  primals_151 = None
        all_gather_into_tensor_147 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_469, 64, '0');  convert_element_type_469 = None
        wait_tensor_179 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_147);  all_gather_into_tensor_147 = None
        convert_element_type_2786 = torch.ops.prims.convert_element_type.default(wait_tensor_179, torch.float32);  wait_tensor_179 = None
        mul_1897 = torch.ops.aten.mul.Tensor(convert_element_type_2784, convert_element_type_2786);  convert_element_type_2786 = None
        convert_element_type_470 = torch.ops.prims.convert_element_type.default(add_549, torch.float32);  add_549 = None
        mul_401 = torch.ops.aten.mul.Tensor(convert_element_type_470, rsqrt_27);  convert_element_type_470 = None
        mul_1899 = torch.ops.aten.mul.Tensor(mul_401, mul_1897)
        sum_249 = torch.ops.aten.sum.dim_IntList(mul_1899, [2], True);  mul_1899 = None
        div_239 = torch.ops.aten.div.Tensor(mul_401, 2048)
        mul_1900 = torch.ops.aten.mul.Tensor(div_239, sum_249);  div_239 = sum_249 = None
        sub_732 = torch.ops.aten.sub.Tensor(mul_1897, mul_1900);  mul_1897 = mul_1900 = None
        mul_1901 = torch.ops.aten.mul.Tensor(sub_732, rsqrt_27);  sub_732 = rsqrt_27 = None
        mul_1902 = torch.ops.aten.mul.Tensor(convert_element_type_2784, mul_401);  convert_element_type_2784 = mul_401 = None
        sum_250 = torch.ops.aten.sum.dim_IntList(mul_1902, [0, 1]);  mul_1902 = None
        convert_element_type_2787 = torch.ops.prims.convert_element_type.default(mul_1901, torch.bfloat16);  mul_1901 = None
        add_2044 = torch.ops.aten.add.Tensor(add_2042, convert_element_type_2787);  add_2042 = convert_element_type_2787 = None
        convert_element_type_default_28 = torch.ops.prims.convert_element_type.default(sum_250, torch.float32);  sum_250 = None
        reduce_scatter_tensor_253 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_28, 'avg', 64, '0');  convert_element_type_default_28 = None
        wait_tensor_848 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_253);  reduce_scatter_tensor_253 = None
        view_2124 = torch.ops.aten.view.default(add_2044, [8192, 2048])
        unsqueeze_71 = torch.ops.aten.unsqueeze.default(view_2124, 1)
        convert_element_type_2790 = torch.ops.prims.convert_element_type.default(unsqueeze_71, torch.float32);  unsqueeze_71 = None
        bmm_62 = torch.ops.aten.bmm.default(permute_1306, convert_element_type_2790);  permute_1306 = None
        bmm_63 = torch.ops.aten.bmm.default(convert_element_type_2790, permute_1307);  convert_element_type_2790 = permute_1307 = None
        convert_element_type_2791 = torch.ops.prims.convert_element_type.default(bmm_62, torch.bfloat16);  bmm_62 = None
        view_2125 = torch.ops.aten.view.default(bmm_63, [8192, 6]);  bmm_63 = None
        view_2126 = torch.ops.aten.view.default(convert_element_type_2791, [49152, 2048]);  convert_element_type_2791 = None
        index_88 = torch.ops.aten.index.Tensor(view_2126, [getitem_119]);  view_2126 = getitem_119 = None
        permute_1308 = torch.ops.aten.permute.default(view_2124, [1, 0])
        mm_506 = torch.ops.aten.mm.default(permute_1308, mul_398);  permute_1308 = mul_398 = None
        convert_element_type_464 = torch.ops.prims.convert_element_type.default(primals_150, torch.bfloat16);  primals_150 = None
        all_gather_into_tensor_146 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_464, 64, '0');  convert_element_type_464 = None
        wait_tensor_178 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_146);  all_gather_into_tensor_146 = None
        permute_130 = torch.ops.aten.permute.default(wait_tensor_178, [1, 0]);  wait_tensor_178 = None
        permute_1310 = torch.ops.aten.permute.default(permute_130, [1, 0]);  permute_130 = None
        mm_507 = torch.ops.aten.mm.default(view_2124, permute_1310);  view_2124 = permute_1310 = None
        convert_element_type_2796 = torch.ops.prims.convert_element_type.default(mm_506, torch.float32);  mm_506 = None
        reduce_scatter_tensor_254 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2796, 'avg', 64, '0');  convert_element_type_2796 = None
        wait_tensor_849 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_254);  reduce_scatter_tensor_254 = None
        convert_element_type_459 = torch.ops.prims.convert_element_type.default(mm_68, torch.float32);  mm_68 = None
        neg_16 = torch.ops.aten.neg.default(convert_element_type_459)
        exp_24 = torch.ops.aten.exp.default(neg_16);  neg_16 = None
        add_544 = torch.ops.aten.add.Tensor(exp_24, 1);  exp_24 = None
        div_40 = torch.ops.aten.div.Tensor(convert_element_type_459, add_544)
        convert_element_type_460 = torch.ops.prims.convert_element_type.default(div_40, torch.bfloat16);  div_40 = None
        mul_1903 = torch.ops.aten.mul.Tensor(mm_507, convert_element_type_460);  convert_element_type_460 = None
        mul_1904 = torch.ops.aten.mul.Tensor(mm_507, mm_69);  mm_507 = mm_69 = None
        permute_1312 = torch.ops.aten.permute.default(mul_1903, [1, 0])
        mm_508 = torch.ops.aten.mm.default(permute_1312, view_527);  permute_1312 = None
        convert_element_type_461 = torch.ops.prims.convert_element_type.default(primals_149, torch.bfloat16);  primals_149 = None
        all_gather_into_tensor_145 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_461, 64, '0');  convert_element_type_461 = None
        wait_tensor_177 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_145);  all_gather_into_tensor_145 = None
        permute_129 = torch.ops.aten.permute.default(wait_tensor_177, [1, 0]);  wait_tensor_177 = None
        permute_1314 = torch.ops.aten.permute.default(permute_129, [1, 0]);  permute_129 = None
        mm_509 = torch.ops.aten.mm.default(mul_1903, permute_1314);  mul_1903 = permute_1314 = None
        convert_element_type_2801 = torch.ops.prims.convert_element_type.default(mm_508, torch.float32);  mm_508 = None
        reduce_scatter_tensor_255 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2801, 'avg', 64, '0');  convert_element_type_2801 = None
        wait_tensor_850 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_255);  reduce_scatter_tensor_255 = None
        convert_element_type_2802 = torch.ops.prims.convert_element_type.default(mul_1904, torch.float32);  mul_1904 = None
        reciprocal_36 = torch.ops.aten.reciprocal.default(add_544);  add_544 = None
        mul_1905 = torch.ops.aten.mul.Tensor(reciprocal_36, 1);  reciprocal_36 = None
        mul_1906 = torch.ops.aten.mul.Tensor(convert_element_type_2802, mul_1905);  convert_element_type_2802 = None
        sub_733 = torch.ops.aten.sub.Tensor(1, mul_1905);  mul_1905 = None
        mul_1907 = torch.ops.aten.mul.Tensor(convert_element_type_459, sub_733);  convert_element_type_459 = sub_733 = None
        add_2046 = torch.ops.aten.add.Tensor(mul_1907, 1);  mul_1907 = None
        mul_1908 = torch.ops.aten.mul.Tensor(mul_1906, add_2046);  mul_1906 = add_2046 = None
        convert_element_type_2804 = torch.ops.prims.convert_element_type.default(mul_1908, torch.bfloat16);  mul_1908 = None
        permute_1316 = torch.ops.aten.permute.default(convert_element_type_2804, [1, 0])
        mm_510 = torch.ops.aten.mm.default(permute_1316, view_527);  permute_1316 = None
        convert_element_type_456 = torch.ops.prims.convert_element_type.default(primals_148, torch.bfloat16);  primals_148 = None
        all_gather_into_tensor_144 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_456, 64, '0');  convert_element_type_456 = None
        wait_tensor_176 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_144);  all_gather_into_tensor_144 = None
        permute_128 = torch.ops.aten.permute.default(wait_tensor_176, [1, 0]);  wait_tensor_176 = None
        permute_1318 = torch.ops.aten.permute.default(permute_128, [1, 0]);  permute_128 = None
        mm_511 = torch.ops.aten.mm.default(convert_element_type_2804, permute_1318);  convert_element_type_2804 = permute_1318 = None
        add_2047 = torch.ops.aten.add.Tensor(mm_509, mm_511);  mm_509 = mm_511 = None
        convert_element_type_2809 = torch.ops.prims.convert_element_type.default(mm_510, torch.float32);  mm_510 = None
        reduce_scatter_tensor_256 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2809, 'avg', 64, '0');  convert_element_type_2809 = None
        wait_tensor_851 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_256);  reduce_scatter_tensor_256 = None
        all_to_all_single_114 = torch.ops._c10d_functional.all_to_all_single.default(index_88, [_local_scalar_dense_120, _local_scalar_dense_121, _local_scalar_dense_122, _local_scalar_dense_123, _local_scalar_dense_124, _local_scalar_dense_125, _local_scalar_dense_126, _local_scalar_dense_127], [_local_scalar_dense_112, _local_scalar_dense_113, _local_scalar_dense_114, _local_scalar_dense_115, _local_scalar_dense_116, _local_scalar_dense_117, _local_scalar_dense_118, _local_scalar_dense_119], '521');  index_88 = None
        wait_tensor_852 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_114);  all_to_all_single_114 = None
        full_420 = torch.ops.aten.full.default([sym_size_int_29, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_29 = None
        slice_scatter_18 = torch.ops.aten.slice_scatter.default(full_420, wait_tensor_852, 0, 0, -1);  wait_tensor_852 = None
        index_89 = torch.ops.aten.index.Tensor(slice_scatter_18, [getitem_120]);  slice_scatter_18 = None
        permute_1320 = torch.ops.aten.permute.default(index_89, [1, 0])
        _grouped_mm_186 = torch.ops.aten._grouped_mm.default(permute_1320, mul_378, cumsum_23);  permute_1320 = mul_378 = None
        convert_element_type_450 = torch.ops.prims.convert_element_type.default(primals_146, torch.bfloat16);  primals_146 = None
        all_gather_into_tensor_140 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_450, 8, '513');  convert_element_type_450 = None
        wait_tensor_171 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_140);  all_gather_into_tensor_140 = None
        permute_127 = torch.ops.aten.permute.default(wait_tensor_171, [0, 2, 1]);  wait_tensor_171 = None
        permute_1322 = torch.ops.aten.permute.default(permute_127, [0, 2, 1]);  permute_127 = None
        _grouped_mm_187 = torch.ops.aten._grouped_mm.default(index_89, permute_1322, cumsum_23);  index_89 = permute_1322 = None
        convert_element_type_454 = torch.ops.prims.convert_element_type.default(_grouped_mm_21, torch.float32);  _grouped_mm_21 = None
        neg_15 = torch.ops.aten.neg.default(convert_element_type_454)
        exp_23 = torch.ops.aten.exp.default(neg_15);  neg_15 = None
        add_508 = torch.ops.aten.add.Tensor(exp_23, 1);  exp_23 = None
        div_39 = torch.ops.aten.div.Tensor(convert_element_type_454, add_508)
        convert_element_type_455 = torch.ops.prims.convert_element_type.default(div_39, torch.bfloat16);  div_39 = None
        mul_1909 = torch.ops.aten.mul.Tensor(_grouped_mm_187, convert_element_type_455);  convert_element_type_455 = None
        mul_1910 = torch.ops.aten.mul.Tensor(_grouped_mm_187, _grouped_mm_22);  _grouped_mm_187 = _grouped_mm_22 = None
        permute_1324 = torch.ops.aten.permute.default(mul_1909, [1, 0])
        _grouped_mm_188 = torch.ops.aten._grouped_mm.default(permute_1324, index_15, cumsum_23);  permute_1324 = None
        convert_element_type_451 = torch.ops.prims.convert_element_type.default(primals_147, torch.bfloat16);  primals_147 = None
        all_gather_into_tensor_141 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_451, 8, '513');  convert_element_type_451 = None
        wait_tensor_172 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_141);  all_gather_into_tensor_141 = None
        permute_126 = torch.ops.aten.permute.default(wait_tensor_172, [0, 2, 1]);  wait_tensor_172 = None
        permute_1326 = torch.ops.aten.permute.default(permute_126, [0, 2, 1]);  permute_126 = None
        _grouped_mm_189 = torch.ops.aten._grouped_mm.default(mul_1909, permute_1326, cumsum_23);  mul_1909 = permute_1326 = None
        convert_element_type_2810 = torch.ops.prims.convert_element_type.default(mul_1910, torch.float32);  mul_1910 = None
        reciprocal_37 = torch.ops.aten.reciprocal.default(add_508);  add_508 = None
        mul_1911 = torch.ops.aten.mul.Tensor(reciprocal_37, 1);  reciprocal_37 = None
        mul_1912 = torch.ops.aten.mul.Tensor(convert_element_type_2810, mul_1911);  convert_element_type_2810 = None
        sub_734 = torch.ops.aten.sub.Tensor(1, mul_1911);  mul_1911 = None
        mul_1913 = torch.ops.aten.mul.Tensor(convert_element_type_454, sub_734);  convert_element_type_454 = sub_734 = None
        add_2049 = torch.ops.aten.add.Tensor(mul_1913, 1);  mul_1913 = None
        mul_1914 = torch.ops.aten.mul.Tensor(mul_1912, add_2049);  mul_1912 = add_2049 = None
        convert_element_type_2812 = torch.ops.prims.convert_element_type.default(mul_1914, torch.bfloat16);  mul_1914 = None
        permute_1328 = torch.ops.aten.permute.default(convert_element_type_2812, [1, 0])
        _grouped_mm_190 = torch.ops.aten._grouped_mm.default(permute_1328, index_15, cumsum_23);  permute_1328 = index_15 = None
        convert_element_type_448 = torch.ops.prims.convert_element_type.default(primals_145, torch.bfloat16);  primals_145 = None
        all_gather_into_tensor_138 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_448, 8, '513');  convert_element_type_448 = None
        wait_tensor_169 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_138);  all_gather_into_tensor_138 = None
        permute_125 = torch.ops.aten.permute.default(wait_tensor_169, [0, 2, 1]);  wait_tensor_169 = None
        permute_1330 = torch.ops.aten.permute.default(permute_125, [0, 2, 1]);  permute_125 = None
        _grouped_mm_191 = torch.ops.aten._grouped_mm.default(convert_element_type_2812, permute_1330, cumsum_23);  convert_element_type_2812 = permute_1330 = cumsum_23 = None
        add_2050 = torch.ops.aten.add.Tensor(_grouped_mm_189, _grouped_mm_191);  _grouped_mm_189 = _grouped_mm_191 = None
        convert_element_type_2813 = torch.ops.prims.convert_element_type.default(_grouped_mm_188, torch.float32);  _grouped_mm_188 = None
        div_240 = torch.ops.aten.div.Tensor(convert_element_type_2813, 64);  convert_element_type_2813 = None
        reduce_scatter_tensor_257 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_240, 'sum', 8, '513');  div_240 = None
        wait_tensor_853 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_257);  reduce_scatter_tensor_257 = None
        convert_element_type_2814 = torch.ops.prims.convert_element_type.default(_grouped_mm_186, torch.float32);  _grouped_mm_186 = None
        div_241 = torch.ops.aten.div.Tensor(convert_element_type_2814, 64);  convert_element_type_2814 = None
        reduce_scatter_tensor_258 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_241, 'sum', 8, '513');  div_241 = None
        wait_tensor_854 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_258);  reduce_scatter_tensor_258 = None
        convert_element_type_2815 = torch.ops.prims.convert_element_type.default(_grouped_mm_190, torch.float32);  _grouped_mm_190 = None
        div_242 = torch.ops.aten.div.Tensor(convert_element_type_2815, 64);  convert_element_type_2815 = None
        reduce_scatter_tensor_259 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_242, 'sum', 8, '513');  div_242 = None
        wait_tensor_855 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_259);  reduce_scatter_tensor_259 = None
        index_put_88 = torch.ops.aten.index_put.default(full_420, [getitem_120], add_2050, True);  full_420 = getitem_120 = add_2050 = None
        slice_215 = torch.ops.aten.slice.Tensor(index_put_88, 0, 0, add_2051);  index_put_88 = add_2051 = None
        all_to_all_single_115 = torch.ops._c10d_functional.all_to_all_single.default(slice_215, [_local_scalar_dense_112, _local_scalar_dense_113, _local_scalar_dense_114, _local_scalar_dense_115, _local_scalar_dense_116, _local_scalar_dense_117, _local_scalar_dense_118, _local_scalar_dense_119], [_local_scalar_dense_120, _local_scalar_dense_121, _local_scalar_dense_122, _local_scalar_dense_123, _local_scalar_dense_124, _local_scalar_dense_125, _local_scalar_dense_126, _local_scalar_dense_127], '521');  slice_215 = _local_scalar_dense_112 = _local_scalar_dense_113 = _local_scalar_dense_114 = _local_scalar_dense_115 = _local_scalar_dense_116 = _local_scalar_dense_117 = _local_scalar_dense_118 = _local_scalar_dense_119 = _local_scalar_dense_120 = _local_scalar_dense_121 = _local_scalar_dense_122 = _local_scalar_dense_123 = _local_scalar_dense_124 = _local_scalar_dense_125 = _local_scalar_dense_126 = _local_scalar_dense_127 = None
        wait_tensor_856 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_115);  all_to_all_single_115 = None
        index_put_89 = torch.ops.aten.index_put.default(full_default_52, [div_37], wait_tensor_856, True);  div_37 = wait_tensor_856 = None
        add_2055 = torch.ops.aten.add.Tensor(add_2047, index_put_89);  add_2047 = index_put_89 = None
        mul_1915 = torch.ops.aten.mul.Tensor(view_2125, 1.0);  view_2125 = None
        scatter_add_18 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_117, mul_1915);  getitem_117 = mul_1915 = None
        convert_element_type_443 = torch.ops.prims.convert_element_type.default(mm_67, torch.float32);  mm_67 = None
        sub_168 = torch.ops.aten.sub.Tensor(convert_element_type_443, amax_7);  convert_element_type_443 = amax_7 = None
        exp_22 = torch.ops.aten.exp.default(sub_168);  sub_168 = None
        div_36 = torch.ops.aten.div.Tensor(exp_22, sum_29);  exp_22 = sum_29 = None
        mul_1916 = torch.ops.aten.mul.Tensor(scatter_add_18, div_36);  scatter_add_18 = None
        sum_251 = torch.ops.aten.sum.dim_IntList(mul_1916, [1], True)
        neg_109 = torch.ops.aten.neg.default(div_36);  div_36 = None
        fma_18 = torch.ops.prims.fma.default(neg_109, sum_251, mul_1916);  neg_109 = sum_251 = mul_1916 = None
        convert_element_type_2816 = torch.ops.prims.convert_element_type.default(fma_18, torch.bfloat16);  fma_18 = None
        permute_1332 = torch.ops.aten.permute.default(convert_element_type_2816, [1, 0])
        mm_512 = torch.ops.aten.mm.default(permute_1332, view_527);  permute_1332 = view_527 = None
        convert_element_type_440 = torch.ops.prims.convert_element_type.default(primals_143, torch.bfloat16);  primals_143 = None
        all_gather_into_tensor_137 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_440, 64, '0');  convert_element_type_440 = None
        wait_tensor_165 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_137);  all_gather_into_tensor_137 = None
        permute_124 = torch.ops.aten.permute.default(wait_tensor_165, [1, 0]);  wait_tensor_165 = None
        permute_1334 = torch.ops.aten.permute.default(permute_124, [1, 0]);  permute_124 = None
        mm_513 = torch.ops.aten.mm.default(convert_element_type_2816, permute_1334);  convert_element_type_2816 = permute_1334 = None
        add_2056 = torch.ops.aten.add.Tensor(add_2055, mm_513);  add_2055 = mm_513 = None
        convert_element_type_2821 = torch.ops.prims.convert_element_type.default(mm_512, torch.float32);  mm_512 = None
        reduce_scatter_tensor_260 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2821, 'avg', 64, '0');  convert_element_type_2821 = None
        wait_tensor_857 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_260);  reduce_scatter_tensor_260 = None
        view_2127 = torch.ops.aten.view.default(add_2056, [2, 4096, 2048]);  add_2056 = None
        convert_element_type_2822 = torch.ops.prims.convert_element_type.default(view_2127, torch.float32);  view_2127 = None
        convert_element_type_437 = torch.ops.prims.convert_element_type.default(primals_141, torch.bfloat16);  primals_141 = None
        all_gather_into_tensor_136 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_437, 64, '0');  convert_element_type_437 = None
        wait_tensor_164 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_136);  all_gather_into_tensor_136 = None
        convert_element_type_2824 = torch.ops.prims.convert_element_type.default(wait_tensor_164, torch.float32);  wait_tensor_164 = None
        mul_1917 = torch.ops.aten.mul.Tensor(convert_element_type_2822, convert_element_type_2824);  convert_element_type_2824 = None
        convert_element_type_438 = torch.ops.prims.convert_element_type.default(add_484, torch.float32);  add_484 = None
        mul_358 = torch.ops.aten.mul.Tensor(convert_element_type_438, rsqrt_26);  convert_element_type_438 = None
        mul_1919 = torch.ops.aten.mul.Tensor(mul_358, mul_1917)
        sum_252 = torch.ops.aten.sum.dim_IntList(mul_1919, [2], True);  mul_1919 = None
        div_243 = torch.ops.aten.div.Tensor(mul_358, 2048)
        mul_1920 = torch.ops.aten.mul.Tensor(div_243, sum_252);  div_243 = sum_252 = None
        sub_736 = torch.ops.aten.sub.Tensor(mul_1917, mul_1920);  mul_1917 = mul_1920 = None
        mul_1921 = torch.ops.aten.mul.Tensor(sub_736, rsqrt_26);  sub_736 = rsqrt_26 = None
        mul_1922 = torch.ops.aten.mul.Tensor(convert_element_type_2822, mul_358);  convert_element_type_2822 = mul_358 = None
        sum_253 = torch.ops.aten.sum.dim_IntList(mul_1922, [0, 1]);  mul_1922 = None
        convert_element_type_2825 = torch.ops.prims.convert_element_type.default(mul_1921, torch.bfloat16);  mul_1921 = None
        add_2057 = torch.ops.aten.add.Tensor(add_2044, convert_element_type_2825);  add_2044 = convert_element_type_2825 = None
        convert_element_type_default_27 = torch.ops.prims.convert_element_type.default(sum_253, torch.float32);  sum_253 = None
        reduce_scatter_tensor_261 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_27, 'avg', 64, '0');  convert_element_type_default_27 = None
        wait_tensor_858 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_261);  reduce_scatter_tensor_261 = None
        view_2128 = torch.ops.aten.view.default(add_2057, [8192, 2048])
        permute_1336 = torch.ops.aten.permute.default(view_2128, [1, 0])
        permute_122 = torch.ops.aten.permute.default(getitem_113, [0, 2, 1, 3])
        view_522 = torch.ops.aten.view.default(permute_122, [2, 4096, -1]);  permute_122 = None
        view_524 = torch.ops.aten.view.default(view_522, [8192, 2048]);  view_522 = None
        mm_514 = torch.ops.aten.mm.default(permute_1336, view_524);  permute_1336 = view_524 = None
        convert_element_type_434 = torch.ops.prims.convert_element_type.default(primals_140, torch.bfloat16);  primals_140 = None
        all_gather_into_tensor_135 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_434, 64, '0');  convert_element_type_434 = None
        wait_tensor_163 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_135);  all_gather_into_tensor_135 = None
        permute_123 = torch.ops.aten.permute.default(wait_tensor_163, [1, 0]);  wait_tensor_163 = None
        permute_1338 = torch.ops.aten.permute.default(permute_123, [1, 0]);  permute_123 = None
        mm_515 = torch.ops.aten.mm.default(view_2128, permute_1338);  view_2128 = permute_1338 = None
        view_2129 = torch.ops.aten.view.default(mm_515, [2, 4096, 2048]);  mm_515 = None
        convert_element_type_2832 = torch.ops.prims.convert_element_type.default(mm_514, torch.float32);  mm_514 = None
        reduce_scatter_tensor_262 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2832, 'avg', 64, '0');  convert_element_type_2832 = None
        wait_tensor_859 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_262);  reduce_scatter_tensor_262 = None
        view_2130 = torch.ops.aten.view.default(view_2129, [2, 4096, 16, 128]);  view_2129 = None
        permute_1340 = torch.ops.aten.permute.default(view_2130, [0, 2, 1, 3]);  view_2130 = None
        fw_graph18 = self.fw_graph18
        joint_graph18 = self.joint_graph18
        mask_graph18 = self.mask_graph18
        flex_attention_backward_18 = torch.ops.higher_order.flex_attention_backward(permute_119, permute_120, permute_121, getitem_113, getitem_114, permute_1340, None, fw_graph18, joint_graph18, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph18), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_119 = permute_120 = permute_121 = getitem_113 = getitem_114 = permute_1340 = fw_graph18 = joint_graph18 = mask_graph18 = None
        getitem_445 = flex_attention_backward_18[0]
        getitem_446 = flex_attention_backward_18[1]
        getitem_447 = flex_attention_backward_18[2];  flex_attention_backward_18 = None
        permute_1341 = torch.ops.aten.permute.default(getitem_447, [0, 2, 1, 3]);  getitem_447 = None
        permute_1342 = torch.ops.aten.permute.default(getitem_446, [0, 2, 1, 3]);  getitem_446 = None
        permute_1343 = torch.ops.aten.permute.default(getitem_445, [0, 2, 1, 3]);  getitem_445 = None
        slice_217 = torch.ops.aten.slice.Tensor(permute_1342, 3, 0, 128)
        slice_218 = torch.ops.aten.slice.Tensor(permute_1342, 3, 128, 192);  permute_1342 = None
        sum_254 = torch.ops.aten.sum.dim_IntList(slice_218, [2], True);  slice_218 = None
        cat_134 = torch.ops.aten.cat.default([slice_217, permute_1341], 3);  slice_217 = permute_1341 = None
        view_2131 = torch.ops.aten.view.default(cat_134, [2, 4096, 4096]);  cat_134 = None
        view_2132 = torch.ops.aten.view.default(view_2131, [8192, 4096]);  view_2131 = None
        permute_1344 = torch.ops.aten.permute.default(view_2132, [1, 0])
        mm_516 = torch.ops.aten.mm.default(permute_1344, view_519);  permute_1344 = view_519 = None
        convert_element_type_431 = torch.ops.prims.convert_element_type.default(primals_139, torch.bfloat16);  primals_139 = None
        all_gather_into_tensor_134 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_431, 64, '0');  convert_element_type_431 = None
        wait_tensor_162 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_134);  all_gather_into_tensor_134 = None
        permute_118 = torch.ops.aten.permute.default(wait_tensor_162, [1, 0]);  wait_tensor_162 = None
        permute_1346 = torch.ops.aten.permute.default(permute_118, [1, 0]);  permute_118 = None
        mm_517 = torch.ops.aten.mm.default(view_2132, permute_1346);  view_2132 = permute_1346 = None
        view_2133 = torch.ops.aten.view.default(mm_517, [2, 4096, 512]);  mm_517 = None
        convert_element_type_2837 = torch.ops.prims.convert_element_type.default(mm_516, torch.float32);  mm_516 = None
        reduce_scatter_tensor_263 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2837, 'avg', 64, '0');  convert_element_type_2837 = None
        wait_tensor_860 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_263);  reduce_scatter_tensor_263 = None
        convert_element_type_2838 = torch.ops.prims.convert_element_type.default(view_2133, torch.float32);  view_2133 = None
        convert_element_type_428 = torch.ops.prims.convert_element_type.default(primals_138, torch.bfloat16);  primals_138 = None
        all_gather_into_tensor_133 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_428, 64, '0');  convert_element_type_428 = None
        wait_tensor_161 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_133);  all_gather_into_tensor_133 = None
        convert_element_type_2840 = torch.ops.prims.convert_element_type.default(wait_tensor_161, torch.float32);  wait_tensor_161 = None
        mul_1923 = torch.ops.aten.mul.Tensor(convert_element_type_2838, convert_element_type_2840);  convert_element_type_2840 = None
        convert_element_type_429 = torch.ops.prims.convert_element_type.default(getitem_109, torch.float32);  getitem_109 = None
        mul_356 = torch.ops.aten.mul.Tensor(convert_element_type_429, rsqrt_25);  convert_element_type_429 = None
        mul_1925 = torch.ops.aten.mul.Tensor(mul_356, mul_1923)
        sum_255 = torch.ops.aten.sum.dim_IntList(mul_1925, [2], True);  mul_1925 = None
        div_244 = torch.ops.aten.div.Tensor(mul_356, 512)
        mul_1926 = torch.ops.aten.mul.Tensor(div_244, sum_255);  div_244 = sum_255 = None
        sub_737 = torch.ops.aten.sub.Tensor(mul_1923, mul_1926);  mul_1923 = mul_1926 = None
        mul_1927 = torch.ops.aten.mul.Tensor(sub_737, rsqrt_25);  sub_737 = rsqrt_25 = None
        mul_1928 = torch.ops.aten.mul.Tensor(convert_element_type_2838, mul_356);  convert_element_type_2838 = mul_356 = None
        sum_256 = torch.ops.aten.sum.dim_IntList(mul_1928, [0, 1]);  mul_1928 = None
        convert_element_type_2841 = torch.ops.prims.convert_element_type.default(mul_1927, torch.bfloat16);  mul_1927 = None
        convert_element_type_default_26 = torch.ops.prims.convert_element_type.default(sum_256, torch.float32);  sum_256 = None
        reduce_scatter_tensor_264 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_26, 'avg', 64, '0');  convert_element_type_default_26 = None
        wait_tensor_861 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_264);  reduce_scatter_tensor_264 = None
        convert_element_type_2844 = torch.ops.prims.convert_element_type.default(sum_254, torch.float32);  sum_254 = None
        view_2134 = torch.ops.aten.view.default(convert_element_type_2844, [2, 4096, 1, 32, 2]);  convert_element_type_2844 = None
        view_as_complex_90 = torch.ops.aten.view_as_complex.default(view_2134);  view_2134 = None
        mul_1929 = torch.ops.aten.mul.Tensor(view_as_complex_90, clone_9);  view_as_complex_90 = None
        view_as_real_90 = torch.ops.aten.view_as_real.default(mul_1929);  mul_1929 = None
        view_2135 = torch.ops.aten.view.default(view_as_real_90, [2, 4096, 1, 64]);  view_as_real_90 = None
        convert_element_type_2845 = torch.ops.prims.convert_element_type.default(view_2135, torch.bfloat16);  view_2135 = None
        squeeze_44 = torch.ops.aten.squeeze.dim(convert_element_type_2845, 2);  convert_element_type_2845 = None
        cat_135 = torch.ops.aten.cat.default([convert_element_type_2841, squeeze_44], 2);  convert_element_type_2841 = squeeze_44 = None
        view_2136 = torch.ops.aten.view.default(cat_135, [8192, 576]);  cat_135 = None
        permute_1348 = torch.ops.aten.permute.default(view_2136, [1, 0])
        mm_518 = torch.ops.aten.mm.default(permute_1348, view_505);  permute_1348 = None
        convert_element_type_423 = torch.ops.prims.convert_element_type.default(primals_137, torch.bfloat16);  primals_137 = None
        all_gather_into_tensor_132 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_423, 64, '0');  convert_element_type_423 = None
        wait_tensor_160 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_132);  all_gather_into_tensor_132 = None
        permute_117 = torch.ops.aten.permute.default(wait_tensor_160, [1, 0]);  wait_tensor_160 = None
        permute_1350 = torch.ops.aten.permute.default(permute_117, [1, 0]);  permute_117 = None
        mm_519 = torch.ops.aten.mm.default(view_2136, permute_1350);  view_2136 = permute_1350 = None
        view_2137 = torch.ops.aten.view.default(mm_519, [2, 4096, 2048]);  mm_519 = None
        convert_element_type_2850 = torch.ops.prims.convert_element_type.default(mm_518, torch.float32);  mm_518 = None
        reduce_scatter_tensor_265 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2850, 'avg', 64, '0');  convert_element_type_2850 = None
        wait_tensor_862 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_265);  reduce_scatter_tensor_265 = None
        slice_219 = torch.ops.aten.slice.Tensor(permute_1343, 3, 0, 128)
        slice_220 = torch.ops.aten.slice.Tensor(permute_1343, 3, 128, 192);  permute_1343 = None
        convert_element_type_2851 = torch.ops.prims.convert_element_type.default(slice_220, torch.float32);  slice_220 = None
        view_2138 = torch.ops.aten.view.default(convert_element_type_2851, [2, 4096, 16, 32, 2]);  convert_element_type_2851 = None
        view_as_complex_91 = torch.ops.aten.view_as_complex.default(view_2138);  view_2138 = None
        mul_1930 = torch.ops.aten.mul.Tensor(view_as_complex_91, clone_9);  view_as_complex_91 = None
        view_as_real_91 = torch.ops.aten.view_as_real.default(mul_1930);  mul_1930 = None
        view_2139 = torch.ops.aten.view.default(view_as_real_91, [2, 4096, 16, 64]);  view_as_real_91 = None
        convert_element_type_2852 = torch.ops.prims.convert_element_type.default(view_2139, torch.bfloat16);  view_2139 = None
        cat_136 = torch.ops.aten.cat.default([slice_219, convert_element_type_2852], 3);  slice_219 = convert_element_type_2852 = None
        view_2140 = torch.ops.aten.view.default(cat_136, [2, 4096, 3072]);  cat_136 = None
        view_2141 = torch.ops.aten.view.default(view_2140, [8192, 3072]);  view_2140 = None
        permute_1352 = torch.ops.aten.permute.default(view_2141, [1, 0])
        mm_520 = torch.ops.aten.mm.default(permute_1352, view_505);  permute_1352 = view_505 = None
        convert_element_type_418 = torch.ops.prims.convert_element_type.default(primals_136, torch.bfloat16);  primals_136 = None
        all_gather_into_tensor_131 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_418, 64, '0');  convert_element_type_418 = None
        wait_tensor_159 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_131);  all_gather_into_tensor_131 = None
        permute_116 = torch.ops.aten.permute.default(wait_tensor_159, [1, 0]);  wait_tensor_159 = None
        permute_1354 = torch.ops.aten.permute.default(permute_116, [1, 0]);  permute_116 = None
        mm_521 = torch.ops.aten.mm.default(view_2141, permute_1354);  view_2141 = permute_1354 = None
        view_2142 = torch.ops.aten.view.default(mm_521, [2, 4096, 2048]);  mm_521 = None
        add_2058 = torch.ops.aten.add.Tensor(view_2137, view_2142);  view_2137 = view_2142 = None
        convert_element_type_2857 = torch.ops.prims.convert_element_type.default(mm_520, torch.float32);  mm_520 = None
        reduce_scatter_tensor_266 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2857, 'avg', 64, '0');  convert_element_type_2857 = None
        wait_tensor_863 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_266);  reduce_scatter_tensor_266 = None
        convert_element_type_2858 = torch.ops.prims.convert_element_type.default(add_2058, torch.float32);  add_2058 = None
        convert_element_type_415 = torch.ops.prims.convert_element_type.default(primals_135, torch.bfloat16);  primals_135 = None
        all_gather_into_tensor_130 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_415, 64, '0');  convert_element_type_415 = None
        wait_tensor_158 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_130);  all_gather_into_tensor_130 = None
        convert_element_type_2860 = torch.ops.prims.convert_element_type.default(wait_tensor_158, torch.float32);  wait_tensor_158 = None
        mul_1931 = torch.ops.aten.mul.Tensor(convert_element_type_2858, convert_element_type_2860);  convert_element_type_2860 = None
        convert_element_type_416 = torch.ops.prims.convert_element_type.default(add_481, torch.float32);  add_481 = None
        mul_352 = torch.ops.aten.mul.Tensor(convert_element_type_416, rsqrt_24);  convert_element_type_416 = None
        mul_1933 = torch.ops.aten.mul.Tensor(mul_352, mul_1931)
        sum_257 = torch.ops.aten.sum.dim_IntList(mul_1933, [2], True);  mul_1933 = None
        div_245 = torch.ops.aten.div.Tensor(mul_352, 2048)
        mul_1934 = torch.ops.aten.mul.Tensor(div_245, sum_257);  div_245 = sum_257 = None
        sub_738 = torch.ops.aten.sub.Tensor(mul_1931, mul_1934);  mul_1931 = mul_1934 = None
        mul_1935 = torch.ops.aten.mul.Tensor(sub_738, rsqrt_24);  sub_738 = rsqrt_24 = None
        mul_1936 = torch.ops.aten.mul.Tensor(convert_element_type_2858, mul_352);  convert_element_type_2858 = mul_352 = None
        sum_258 = torch.ops.aten.sum.dim_IntList(mul_1936, [0, 1]);  mul_1936 = None
        convert_element_type_2861 = torch.ops.prims.convert_element_type.default(mul_1935, torch.bfloat16);  mul_1935 = None
        add_2059 = torch.ops.aten.add.Tensor(add_2057, convert_element_type_2861);  add_2057 = convert_element_type_2861 = None
        convert_element_type_default_25 = torch.ops.prims.convert_element_type.default(sum_258, torch.float32);  sum_258 = None
        reduce_scatter_tensor_267 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_25, 'avg', 64, '0');  convert_element_type_default_25 = None
        wait_tensor_864 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_267);  reduce_scatter_tensor_267 = None
        view_2143 = torch.ops.aten.view.default(add_2059, [8192, 2048])
        unsqueeze_72 = torch.ops.aten.unsqueeze.default(view_2143, 1)
        convert_element_type_2864 = torch.ops.prims.convert_element_type.default(unsqueeze_72, torch.float32);  unsqueeze_72 = None
        bmm_64 = torch.ops.aten.bmm.default(permute_1356, convert_element_type_2864);  permute_1356 = None
        bmm_65 = torch.ops.aten.bmm.default(convert_element_type_2864, permute_1357);  convert_element_type_2864 = permute_1357 = None
        convert_element_type_2865 = torch.ops.prims.convert_element_type.default(bmm_64, torch.bfloat16);  bmm_64 = None
        view_2144 = torch.ops.aten.view.default(bmm_65, [8192, 6]);  bmm_65 = None
        view_2145 = torch.ops.aten.view.default(convert_element_type_2865, [49152, 2048]);  convert_element_type_2865 = None
        index_90 = torch.ops.aten.index.Tensor(view_2145, [getitem_105]);  view_2145 = getitem_105 = None
        permute_1358 = torch.ops.aten.permute.default(view_2143, [1, 0])
        mm_522 = torch.ops.aten.mm.default(permute_1358, mul_349);  permute_1358 = mul_349 = None
        convert_element_type_410 = torch.ops.prims.convert_element_type.default(primals_134, torch.bfloat16);  primals_134 = None
        all_gather_into_tensor_129 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_410, 64, '0');  convert_element_type_410 = None
        wait_tensor_157 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_129);  all_gather_into_tensor_129 = None
        permute_115 = torch.ops.aten.permute.default(wait_tensor_157, [1, 0]);  wait_tensor_157 = None
        permute_1360 = torch.ops.aten.permute.default(permute_115, [1, 0]);  permute_115 = None
        mm_523 = torch.ops.aten.mm.default(view_2143, permute_1360);  view_2143 = permute_1360 = None
        convert_element_type_2870 = torch.ops.prims.convert_element_type.default(mm_522, torch.float32);  mm_522 = None
        reduce_scatter_tensor_268 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2870, 'avg', 64, '0');  convert_element_type_2870 = None
        wait_tensor_865 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_268);  reduce_scatter_tensor_268 = None
        convert_element_type_405 = torch.ops.prims.convert_element_type.default(mm_60, torch.float32);  mm_60 = None
        neg_14 = torch.ops.aten.neg.default(convert_element_type_405)
        exp_21 = torch.ops.aten.exp.default(neg_14);  neg_14 = None
        add_476 = torch.ops.aten.add.Tensor(exp_21, 1);  exp_21 = None
        div_35 = torch.ops.aten.div.Tensor(convert_element_type_405, add_476)
        convert_element_type_406 = torch.ops.prims.convert_element_type.default(div_35, torch.bfloat16);  div_35 = None
        mul_1937 = torch.ops.aten.mul.Tensor(mm_523, convert_element_type_406);  convert_element_type_406 = None
        mul_1938 = torch.ops.aten.mul.Tensor(mm_523, mm_61);  mm_523 = mm_61 = None
        permute_1362 = torch.ops.aten.permute.default(mul_1937, [1, 0])
        mm_524 = torch.ops.aten.mm.default(permute_1362, view_460);  permute_1362 = None
        convert_element_type_407 = torch.ops.prims.convert_element_type.default(primals_133, torch.bfloat16);  primals_133 = None
        all_gather_into_tensor_128 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_407, 64, '0');  convert_element_type_407 = None
        wait_tensor_156 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_128);  all_gather_into_tensor_128 = None
        permute_114 = torch.ops.aten.permute.default(wait_tensor_156, [1, 0]);  wait_tensor_156 = None
        permute_1364 = torch.ops.aten.permute.default(permute_114, [1, 0]);  permute_114 = None
        mm_525 = torch.ops.aten.mm.default(mul_1937, permute_1364);  mul_1937 = permute_1364 = None
        convert_element_type_2875 = torch.ops.prims.convert_element_type.default(mm_524, torch.float32);  mm_524 = None
        reduce_scatter_tensor_269 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2875, 'avg', 64, '0');  convert_element_type_2875 = None
        wait_tensor_866 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_269);  reduce_scatter_tensor_269 = None
        convert_element_type_2876 = torch.ops.prims.convert_element_type.default(mul_1938, torch.float32);  mul_1938 = None
        reciprocal_38 = torch.ops.aten.reciprocal.default(add_476);  add_476 = None
        mul_1939 = torch.ops.aten.mul.Tensor(reciprocal_38, 1);  reciprocal_38 = None
        mul_1940 = torch.ops.aten.mul.Tensor(convert_element_type_2876, mul_1939);  convert_element_type_2876 = None
        sub_739 = torch.ops.aten.sub.Tensor(1, mul_1939);  mul_1939 = None
        mul_1941 = torch.ops.aten.mul.Tensor(convert_element_type_405, sub_739);  convert_element_type_405 = sub_739 = None
        add_2061 = torch.ops.aten.add.Tensor(mul_1941, 1);  mul_1941 = None
        mul_1942 = torch.ops.aten.mul.Tensor(mul_1940, add_2061);  mul_1940 = add_2061 = None
        convert_element_type_2878 = torch.ops.prims.convert_element_type.default(mul_1942, torch.bfloat16);  mul_1942 = None
        permute_1366 = torch.ops.aten.permute.default(convert_element_type_2878, [1, 0])
        mm_526 = torch.ops.aten.mm.default(permute_1366, view_460);  permute_1366 = None
        convert_element_type_402 = torch.ops.prims.convert_element_type.default(primals_132, torch.bfloat16);  primals_132 = None
        all_gather_into_tensor_127 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_402, 64, '0');  convert_element_type_402 = None
        wait_tensor_155 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_127);  all_gather_into_tensor_127 = None
        permute_113 = torch.ops.aten.permute.default(wait_tensor_155, [1, 0]);  wait_tensor_155 = None
        permute_1368 = torch.ops.aten.permute.default(permute_113, [1, 0]);  permute_113 = None
        mm_527 = torch.ops.aten.mm.default(convert_element_type_2878, permute_1368);  convert_element_type_2878 = permute_1368 = None
        add_2062 = torch.ops.aten.add.Tensor(mm_525, mm_527);  mm_525 = mm_527 = None
        convert_element_type_2883 = torch.ops.prims.convert_element_type.default(mm_526, torch.float32);  mm_526 = None
        reduce_scatter_tensor_270 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2883, 'avg', 64, '0');  convert_element_type_2883 = None
        wait_tensor_867 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_270);  reduce_scatter_tensor_270 = None
        all_to_all_single_116 = torch.ops._c10d_functional.all_to_all_single.default(index_90, [_local_scalar_dense_104, _local_scalar_dense_105, _local_scalar_dense_106, _local_scalar_dense_107, _local_scalar_dense_108, _local_scalar_dense_109, _local_scalar_dense_110, _local_scalar_dense_111], [_local_scalar_dense_96, _local_scalar_dense_97, _local_scalar_dense_98, _local_scalar_dense_99, _local_scalar_dense_100, _local_scalar_dense_101, _local_scalar_dense_102, _local_scalar_dense_103], '521');  index_90 = None
        wait_tensor_868 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_116);  all_to_all_single_116 = None
        full_424 = torch.ops.aten.full.default([sym_size_int_25, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_25 = None
        slice_scatter_19 = torch.ops.aten.slice_scatter.default(full_424, wait_tensor_868, 0, 0, -1);  wait_tensor_868 = None
        index_91 = torch.ops.aten.index.Tensor(slice_scatter_19, [getitem_106]);  slice_scatter_19 = None
        permute_1370 = torch.ops.aten.permute.default(index_91, [1, 0])
        _grouped_mm_192 = torch.ops.aten._grouped_mm.default(permute_1370, mul_329, cumsum_20);  permute_1370 = mul_329 = None
        convert_element_type_396 = torch.ops.prims.convert_element_type.default(primals_130, torch.bfloat16);  primals_130 = None
        all_gather_into_tensor_123 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_396, 8, '513');  convert_element_type_396 = None
        wait_tensor_150 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_123);  all_gather_into_tensor_123 = None
        permute_112 = torch.ops.aten.permute.default(wait_tensor_150, [0, 2, 1]);  wait_tensor_150 = None
        permute_1372 = torch.ops.aten.permute.default(permute_112, [0, 2, 1]);  permute_112 = None
        _grouped_mm_193 = torch.ops.aten._grouped_mm.default(index_91, permute_1372, cumsum_20);  index_91 = permute_1372 = None
        convert_element_type_400 = torch.ops.prims.convert_element_type.default(_grouped_mm_18, torch.float32);  _grouped_mm_18 = None
        neg_13 = torch.ops.aten.neg.default(convert_element_type_400)
        exp_20 = torch.ops.aten.exp.default(neg_13);  neg_13 = None
        add_440 = torch.ops.aten.add.Tensor(exp_20, 1);  exp_20 = None
        div_34 = torch.ops.aten.div.Tensor(convert_element_type_400, add_440)
        convert_element_type_401 = torch.ops.prims.convert_element_type.default(div_34, torch.bfloat16);  div_34 = None
        mul_1943 = torch.ops.aten.mul.Tensor(_grouped_mm_193, convert_element_type_401);  convert_element_type_401 = None
        mul_1944 = torch.ops.aten.mul.Tensor(_grouped_mm_193, _grouped_mm_19);  _grouped_mm_193 = _grouped_mm_19 = None
        permute_1374 = torch.ops.aten.permute.default(mul_1943, [1, 0])
        _grouped_mm_194 = torch.ops.aten._grouped_mm.default(permute_1374, index_13, cumsum_20);  permute_1374 = None
        convert_element_type_397 = torch.ops.prims.convert_element_type.default(primals_131, torch.bfloat16);  primals_131 = None
        all_gather_into_tensor_124 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_397, 8, '513');  convert_element_type_397 = None
        wait_tensor_151 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_124);  all_gather_into_tensor_124 = None
        permute_111 = torch.ops.aten.permute.default(wait_tensor_151, [0, 2, 1]);  wait_tensor_151 = None
        permute_1376 = torch.ops.aten.permute.default(permute_111, [0, 2, 1]);  permute_111 = None
        _grouped_mm_195 = torch.ops.aten._grouped_mm.default(mul_1943, permute_1376, cumsum_20);  mul_1943 = permute_1376 = None
        convert_element_type_2884 = torch.ops.prims.convert_element_type.default(mul_1944, torch.float32);  mul_1944 = None
        reciprocal_39 = torch.ops.aten.reciprocal.default(add_440);  add_440 = None
        mul_1945 = torch.ops.aten.mul.Tensor(reciprocal_39, 1);  reciprocal_39 = None
        mul_1946 = torch.ops.aten.mul.Tensor(convert_element_type_2884, mul_1945);  convert_element_type_2884 = None
        sub_740 = torch.ops.aten.sub.Tensor(1, mul_1945);  mul_1945 = None
        mul_1947 = torch.ops.aten.mul.Tensor(convert_element_type_400, sub_740);  convert_element_type_400 = sub_740 = None
        add_2064 = torch.ops.aten.add.Tensor(mul_1947, 1);  mul_1947 = None
        mul_1948 = torch.ops.aten.mul.Tensor(mul_1946, add_2064);  mul_1946 = add_2064 = None
        convert_element_type_2886 = torch.ops.prims.convert_element_type.default(mul_1948, torch.bfloat16);  mul_1948 = None
        permute_1378 = torch.ops.aten.permute.default(convert_element_type_2886, [1, 0])
        _grouped_mm_196 = torch.ops.aten._grouped_mm.default(permute_1378, index_13, cumsum_20);  permute_1378 = index_13 = None
        convert_element_type_394 = torch.ops.prims.convert_element_type.default(primals_129, torch.bfloat16);  primals_129 = None
        all_gather_into_tensor_121 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_394, 8, '513');  convert_element_type_394 = None
        wait_tensor_148 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_121);  all_gather_into_tensor_121 = None
        permute_110 = torch.ops.aten.permute.default(wait_tensor_148, [0, 2, 1]);  wait_tensor_148 = None
        permute_1380 = torch.ops.aten.permute.default(permute_110, [0, 2, 1]);  permute_110 = None
        _grouped_mm_197 = torch.ops.aten._grouped_mm.default(convert_element_type_2886, permute_1380, cumsum_20);  convert_element_type_2886 = permute_1380 = cumsum_20 = None
        add_2065 = torch.ops.aten.add.Tensor(_grouped_mm_195, _grouped_mm_197);  _grouped_mm_195 = _grouped_mm_197 = None
        convert_element_type_2887 = torch.ops.prims.convert_element_type.default(_grouped_mm_194, torch.float32);  _grouped_mm_194 = None
        div_246 = torch.ops.aten.div.Tensor(convert_element_type_2887, 64);  convert_element_type_2887 = None
        reduce_scatter_tensor_271 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_246, 'sum', 8, '513');  div_246 = None
        wait_tensor_869 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_271);  reduce_scatter_tensor_271 = None
        convert_element_type_2888 = torch.ops.prims.convert_element_type.default(_grouped_mm_192, torch.float32);  _grouped_mm_192 = None
        div_247 = torch.ops.aten.div.Tensor(convert_element_type_2888, 64);  convert_element_type_2888 = None
        reduce_scatter_tensor_272 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_247, 'sum', 8, '513');  div_247 = None
        wait_tensor_870 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_272);  reduce_scatter_tensor_272 = None
        convert_element_type_2889 = torch.ops.prims.convert_element_type.default(_grouped_mm_196, torch.float32);  _grouped_mm_196 = None
        div_248 = torch.ops.aten.div.Tensor(convert_element_type_2889, 64);  convert_element_type_2889 = None
        reduce_scatter_tensor_273 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_248, 'sum', 8, '513');  div_248 = None
        wait_tensor_871 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_273);  reduce_scatter_tensor_273 = None
        index_put_90 = torch.ops.aten.index_put.default(full_424, [getitem_106], add_2065, True);  full_424 = getitem_106 = add_2065 = None
        slice_221 = torch.ops.aten.slice.Tensor(index_put_90, 0, 0, add_2066);  index_put_90 = add_2066 = None
        all_to_all_single_117 = torch.ops._c10d_functional.all_to_all_single.default(slice_221, [_local_scalar_dense_96, _local_scalar_dense_97, _local_scalar_dense_98, _local_scalar_dense_99, _local_scalar_dense_100, _local_scalar_dense_101, _local_scalar_dense_102, _local_scalar_dense_103], [_local_scalar_dense_104, _local_scalar_dense_105, _local_scalar_dense_106, _local_scalar_dense_107, _local_scalar_dense_108, _local_scalar_dense_109, _local_scalar_dense_110, _local_scalar_dense_111], '521');  slice_221 = _local_scalar_dense_96 = _local_scalar_dense_97 = _local_scalar_dense_98 = _local_scalar_dense_99 = _local_scalar_dense_100 = _local_scalar_dense_101 = _local_scalar_dense_102 = _local_scalar_dense_103 = _local_scalar_dense_104 = _local_scalar_dense_105 = _local_scalar_dense_106 = _local_scalar_dense_107 = _local_scalar_dense_108 = _local_scalar_dense_109 = _local_scalar_dense_110 = _local_scalar_dense_111 = None
        wait_tensor_872 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_117);  all_to_all_single_117 = None
        index_put_91 = torch.ops.aten.index_put.default(full_default_52, [div_32], wait_tensor_872, True);  div_32 = wait_tensor_872 = None
        add_2070 = torch.ops.aten.add.Tensor(add_2062, index_put_91);  add_2062 = index_put_91 = None
        mul_1949 = torch.ops.aten.mul.Tensor(view_2144, 1.0);  view_2144 = None
        scatter_add_19 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_103, mul_1949);  getitem_103 = mul_1949 = None
        convert_element_type_389 = torch.ops.prims.convert_element_type.default(mm_59, torch.float32);  mm_59 = None
        sub_144 = torch.ops.aten.sub.Tensor(convert_element_type_389, amax_6);  convert_element_type_389 = amax_6 = None
        exp_19 = torch.ops.aten.exp.default(sub_144);  sub_144 = None
        div_31 = torch.ops.aten.div.Tensor(exp_19, sum_25);  exp_19 = sum_25 = None
        mul_1950 = torch.ops.aten.mul.Tensor(scatter_add_19, div_31);  scatter_add_19 = None
        sum_259 = torch.ops.aten.sum.dim_IntList(mul_1950, [1], True)
        neg_112 = torch.ops.aten.neg.default(div_31);  div_31 = None
        fma_19 = torch.ops.prims.fma.default(neg_112, sum_259, mul_1950);  neg_112 = sum_259 = mul_1950 = None
        convert_element_type_2890 = torch.ops.prims.convert_element_type.default(fma_19, torch.bfloat16);  fma_19 = None
        permute_1382 = torch.ops.aten.permute.default(convert_element_type_2890, [1, 0])
        mm_528 = torch.ops.aten.mm.default(permute_1382, view_460);  permute_1382 = view_460 = None
        convert_element_type_386 = torch.ops.prims.convert_element_type.default(primals_127, torch.bfloat16);  primals_127 = None
        all_gather_into_tensor_120 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_386, 64, '0');  convert_element_type_386 = None
        wait_tensor_144 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_120);  all_gather_into_tensor_120 = None
        permute_109 = torch.ops.aten.permute.default(wait_tensor_144, [1, 0]);  wait_tensor_144 = None
        permute_1384 = torch.ops.aten.permute.default(permute_109, [1, 0]);  permute_109 = None
        mm_529 = torch.ops.aten.mm.default(convert_element_type_2890, permute_1384);  convert_element_type_2890 = permute_1384 = None
        add_2071 = torch.ops.aten.add.Tensor(add_2070, mm_529);  add_2070 = mm_529 = None
        convert_element_type_2895 = torch.ops.prims.convert_element_type.default(mm_528, torch.float32);  mm_528 = None
        reduce_scatter_tensor_274 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2895, 'avg', 64, '0');  convert_element_type_2895 = None
        wait_tensor_873 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_274);  reduce_scatter_tensor_274 = None
        view_2146 = torch.ops.aten.view.default(add_2071, [2, 4096, 2048]);  add_2071 = None
        convert_element_type_2896 = torch.ops.prims.convert_element_type.default(view_2146, torch.float32);  view_2146 = None
        convert_element_type_383 = torch.ops.prims.convert_element_type.default(primals_125, torch.bfloat16);  primals_125 = None
        all_gather_into_tensor_119 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_383, 64, '0');  convert_element_type_383 = None
        wait_tensor_143 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_119);  all_gather_into_tensor_119 = None
        convert_element_type_2898 = torch.ops.prims.convert_element_type.default(wait_tensor_143, torch.float32);  wait_tensor_143 = None
        mul_1951 = torch.ops.aten.mul.Tensor(convert_element_type_2896, convert_element_type_2898);  convert_element_type_2898 = None
        convert_element_type_384 = torch.ops.prims.convert_element_type.default(add_416, torch.float32);  add_416 = None
        mul_309 = torch.ops.aten.mul.Tensor(convert_element_type_384, rsqrt_23);  convert_element_type_384 = None
        mul_1953 = torch.ops.aten.mul.Tensor(mul_309, mul_1951)
        sum_260 = torch.ops.aten.sum.dim_IntList(mul_1953, [2], True);  mul_1953 = None
        div_249 = torch.ops.aten.div.Tensor(mul_309, 2048)
        mul_1954 = torch.ops.aten.mul.Tensor(div_249, sum_260);  div_249 = sum_260 = None
        sub_742 = torch.ops.aten.sub.Tensor(mul_1951, mul_1954);  mul_1951 = mul_1954 = None
        mul_1955 = torch.ops.aten.mul.Tensor(sub_742, rsqrt_23);  sub_742 = rsqrt_23 = None
        mul_1956 = torch.ops.aten.mul.Tensor(convert_element_type_2896, mul_309);  convert_element_type_2896 = mul_309 = None
        sum_261 = torch.ops.aten.sum.dim_IntList(mul_1956, [0, 1]);  mul_1956 = None
        convert_element_type_2899 = torch.ops.prims.convert_element_type.default(mul_1955, torch.bfloat16);  mul_1955 = None
        add_2072 = torch.ops.aten.add.Tensor(add_2059, convert_element_type_2899);  add_2059 = convert_element_type_2899 = None
        convert_element_type_default_24 = torch.ops.prims.convert_element_type.default(sum_261, torch.float32);  sum_261 = None
        reduce_scatter_tensor_275 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_24, 'avg', 64, '0');  convert_element_type_default_24 = None
        wait_tensor_874 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_275);  reduce_scatter_tensor_275 = None
        view_2147 = torch.ops.aten.view.default(add_2072, [8192, 2048])
        permute_1386 = torch.ops.aten.permute.default(view_2147, [1, 0])
        permute_107 = torch.ops.aten.permute.default(getitem_99, [0, 2, 1, 3])
        view_455 = torch.ops.aten.view.default(permute_107, [2, 4096, -1]);  permute_107 = None
        view_457 = torch.ops.aten.view.default(view_455, [8192, 2048]);  view_455 = None
        mm_530 = torch.ops.aten.mm.default(permute_1386, view_457);  permute_1386 = view_457 = None
        convert_element_type_380 = torch.ops.prims.convert_element_type.default(primals_124, torch.bfloat16);  primals_124 = None
        all_gather_into_tensor_118 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_380, 64, '0');  convert_element_type_380 = None
        wait_tensor_142 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_118);  all_gather_into_tensor_118 = None
        permute_108 = torch.ops.aten.permute.default(wait_tensor_142, [1, 0]);  wait_tensor_142 = None
        permute_1388 = torch.ops.aten.permute.default(permute_108, [1, 0]);  permute_108 = None
        mm_531 = torch.ops.aten.mm.default(view_2147, permute_1388);  view_2147 = permute_1388 = None
        view_2148 = torch.ops.aten.view.default(mm_531, [2, 4096, 2048]);  mm_531 = None
        convert_element_type_2906 = torch.ops.prims.convert_element_type.default(mm_530, torch.float32);  mm_530 = None
        reduce_scatter_tensor_276 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2906, 'avg', 64, '0');  convert_element_type_2906 = None
        wait_tensor_875 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_276);  reduce_scatter_tensor_276 = None
        view_2149 = torch.ops.aten.view.default(view_2148, [2, 4096, 16, 128]);  view_2148 = None
        permute_1390 = torch.ops.aten.permute.default(view_2149, [0, 2, 1, 3]);  view_2149 = None
        fw_graph19 = self.fw_graph19
        joint_graph19 = self.joint_graph19
        mask_graph19 = self.mask_graph19
        flex_attention_backward_19 = torch.ops.higher_order.flex_attention_backward(permute_104, permute_105, permute_106, getitem_99, getitem_100, permute_1390, None, fw_graph19, joint_graph19, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph19), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_104 = permute_105 = permute_106 = getitem_99 = getitem_100 = permute_1390 = fw_graph19 = joint_graph19 = mask_graph19 = None
        getitem_449 = flex_attention_backward_19[0]
        getitem_450 = flex_attention_backward_19[1]
        getitem_451 = flex_attention_backward_19[2];  flex_attention_backward_19 = None
        permute_1391 = torch.ops.aten.permute.default(getitem_451, [0, 2, 1, 3]);  getitem_451 = None
        permute_1392 = torch.ops.aten.permute.default(getitem_450, [0, 2, 1, 3]);  getitem_450 = None
        permute_1393 = torch.ops.aten.permute.default(getitem_449, [0, 2, 1, 3]);  getitem_449 = None
        slice_223 = torch.ops.aten.slice.Tensor(permute_1392, 3, 0, 128)
        slice_224 = torch.ops.aten.slice.Tensor(permute_1392, 3, 128, 192);  permute_1392 = None
        sum_262 = torch.ops.aten.sum.dim_IntList(slice_224, [2], True);  slice_224 = None
        cat_137 = torch.ops.aten.cat.default([slice_223, permute_1391], 3);  slice_223 = permute_1391 = None
        view_2150 = torch.ops.aten.view.default(cat_137, [2, 4096, 4096]);  cat_137 = None
        view_2151 = torch.ops.aten.view.default(view_2150, [8192, 4096]);  view_2150 = None
        permute_1394 = torch.ops.aten.permute.default(view_2151, [1, 0])
        mm_532 = torch.ops.aten.mm.default(permute_1394, view_452);  permute_1394 = view_452 = None
        convert_element_type_377 = torch.ops.prims.convert_element_type.default(primals_123, torch.bfloat16);  primals_123 = None
        all_gather_into_tensor_117 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_377, 64, '0');  convert_element_type_377 = None
        wait_tensor_141 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_117);  all_gather_into_tensor_117 = None
        permute_103 = torch.ops.aten.permute.default(wait_tensor_141, [1, 0]);  wait_tensor_141 = None
        permute_1396 = torch.ops.aten.permute.default(permute_103, [1, 0]);  permute_103 = None
        mm_533 = torch.ops.aten.mm.default(view_2151, permute_1396);  view_2151 = permute_1396 = None
        view_2152 = torch.ops.aten.view.default(mm_533, [2, 4096, 512]);  mm_533 = None
        convert_element_type_2911 = torch.ops.prims.convert_element_type.default(mm_532, torch.float32);  mm_532 = None
        reduce_scatter_tensor_277 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2911, 'avg', 64, '0');  convert_element_type_2911 = None
        wait_tensor_876 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_277);  reduce_scatter_tensor_277 = None
        convert_element_type_2912 = torch.ops.prims.convert_element_type.default(view_2152, torch.float32);  view_2152 = None
        convert_element_type_374 = torch.ops.prims.convert_element_type.default(primals_122, torch.bfloat16);  primals_122 = None
        all_gather_into_tensor_116 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_374, 64, '0');  convert_element_type_374 = None
        wait_tensor_140 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_116);  all_gather_into_tensor_116 = None
        convert_element_type_2914 = torch.ops.prims.convert_element_type.default(wait_tensor_140, torch.float32);  wait_tensor_140 = None
        mul_1957 = torch.ops.aten.mul.Tensor(convert_element_type_2912, convert_element_type_2914);  convert_element_type_2914 = None
        convert_element_type_375 = torch.ops.prims.convert_element_type.default(getitem_95, torch.float32);  getitem_95 = None
        mul_307 = torch.ops.aten.mul.Tensor(convert_element_type_375, rsqrt_22);  convert_element_type_375 = None
        mul_1959 = torch.ops.aten.mul.Tensor(mul_307, mul_1957)
        sum_263 = torch.ops.aten.sum.dim_IntList(mul_1959, [2], True);  mul_1959 = None
        div_250 = torch.ops.aten.div.Tensor(mul_307, 512)
        mul_1960 = torch.ops.aten.mul.Tensor(div_250, sum_263);  div_250 = sum_263 = None
        sub_743 = torch.ops.aten.sub.Tensor(mul_1957, mul_1960);  mul_1957 = mul_1960 = None
        mul_1961 = torch.ops.aten.mul.Tensor(sub_743, rsqrt_22);  sub_743 = rsqrt_22 = None
        mul_1962 = torch.ops.aten.mul.Tensor(convert_element_type_2912, mul_307);  convert_element_type_2912 = mul_307 = None
        sum_264 = torch.ops.aten.sum.dim_IntList(mul_1962, [0, 1]);  mul_1962 = None
        convert_element_type_2915 = torch.ops.prims.convert_element_type.default(mul_1961, torch.bfloat16);  mul_1961 = None
        convert_element_type_default_23 = torch.ops.prims.convert_element_type.default(sum_264, torch.float32);  sum_264 = None
        reduce_scatter_tensor_278 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_23, 'avg', 64, '0');  convert_element_type_default_23 = None
        wait_tensor_877 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_278);  reduce_scatter_tensor_278 = None
        convert_element_type_2918 = torch.ops.prims.convert_element_type.default(sum_262, torch.float32);  sum_262 = None
        view_2153 = torch.ops.aten.view.default(convert_element_type_2918, [2, 4096, 1, 32, 2]);  convert_element_type_2918 = None
        view_as_complex_92 = torch.ops.aten.view_as_complex.default(view_2153);  view_2153 = None
        mul_1963 = torch.ops.aten.mul.Tensor(view_as_complex_92, clone_9);  view_as_complex_92 = None
        view_as_real_92 = torch.ops.aten.view_as_real.default(mul_1963);  mul_1963 = None
        view_2154 = torch.ops.aten.view.default(view_as_real_92, [2, 4096, 1, 64]);  view_as_real_92 = None
        convert_element_type_2919 = torch.ops.prims.convert_element_type.default(view_2154, torch.bfloat16);  view_2154 = None
        squeeze_45 = torch.ops.aten.squeeze.dim(convert_element_type_2919, 2);  convert_element_type_2919 = None
        cat_138 = torch.ops.aten.cat.default([convert_element_type_2915, squeeze_45], 2);  convert_element_type_2915 = squeeze_45 = None
        view_2155 = torch.ops.aten.view.default(cat_138, [8192, 576]);  cat_138 = None
        permute_1398 = torch.ops.aten.permute.default(view_2155, [1, 0])
        mm_534 = torch.ops.aten.mm.default(permute_1398, view_438);  permute_1398 = None
        convert_element_type_369 = torch.ops.prims.convert_element_type.default(primals_121, torch.bfloat16);  primals_121 = None
        all_gather_into_tensor_115 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_369, 64, '0');  convert_element_type_369 = None
        wait_tensor_139 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_115);  all_gather_into_tensor_115 = None
        permute_102 = torch.ops.aten.permute.default(wait_tensor_139, [1, 0]);  wait_tensor_139 = None
        permute_1400 = torch.ops.aten.permute.default(permute_102, [1, 0]);  permute_102 = None
        mm_535 = torch.ops.aten.mm.default(view_2155, permute_1400);  view_2155 = permute_1400 = None
        view_2156 = torch.ops.aten.view.default(mm_535, [2, 4096, 2048]);  mm_535 = None
        convert_element_type_2924 = torch.ops.prims.convert_element_type.default(mm_534, torch.float32);  mm_534 = None
        reduce_scatter_tensor_279 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2924, 'avg', 64, '0');  convert_element_type_2924 = None
        wait_tensor_878 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_279);  reduce_scatter_tensor_279 = None
        slice_225 = torch.ops.aten.slice.Tensor(permute_1393, 3, 0, 128)
        slice_226 = torch.ops.aten.slice.Tensor(permute_1393, 3, 128, 192);  permute_1393 = None
        convert_element_type_2925 = torch.ops.prims.convert_element_type.default(slice_226, torch.float32);  slice_226 = None
        view_2157 = torch.ops.aten.view.default(convert_element_type_2925, [2, 4096, 16, 32, 2]);  convert_element_type_2925 = None
        view_as_complex_93 = torch.ops.aten.view_as_complex.default(view_2157);  view_2157 = None
        mul_1964 = torch.ops.aten.mul.Tensor(view_as_complex_93, clone_9);  view_as_complex_93 = None
        view_as_real_93 = torch.ops.aten.view_as_real.default(mul_1964);  mul_1964 = None
        view_2158 = torch.ops.aten.view.default(view_as_real_93, [2, 4096, 16, 64]);  view_as_real_93 = None
        convert_element_type_2926 = torch.ops.prims.convert_element_type.default(view_2158, torch.bfloat16);  view_2158 = None
        cat_139 = torch.ops.aten.cat.default([slice_225, convert_element_type_2926], 3);  slice_225 = convert_element_type_2926 = None
        view_2159 = torch.ops.aten.view.default(cat_139, [2, 4096, 3072]);  cat_139 = None
        view_2160 = torch.ops.aten.view.default(view_2159, [8192, 3072]);  view_2159 = None
        permute_1402 = torch.ops.aten.permute.default(view_2160, [1, 0])
        mm_536 = torch.ops.aten.mm.default(permute_1402, view_438);  permute_1402 = view_438 = None
        convert_element_type_364 = torch.ops.prims.convert_element_type.default(primals_120, torch.bfloat16);  primals_120 = None
        all_gather_into_tensor_114 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_364, 64, '0');  convert_element_type_364 = None
        wait_tensor_138 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_114);  all_gather_into_tensor_114 = None
        permute_101 = torch.ops.aten.permute.default(wait_tensor_138, [1, 0]);  wait_tensor_138 = None
        permute_1404 = torch.ops.aten.permute.default(permute_101, [1, 0]);  permute_101 = None
        mm_537 = torch.ops.aten.mm.default(view_2160, permute_1404);  view_2160 = permute_1404 = None
        view_2161 = torch.ops.aten.view.default(mm_537, [2, 4096, 2048]);  mm_537 = None
        add_2073 = torch.ops.aten.add.Tensor(view_2156, view_2161);  view_2156 = view_2161 = None
        convert_element_type_2931 = torch.ops.prims.convert_element_type.default(mm_536, torch.float32);  mm_536 = None
        reduce_scatter_tensor_280 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2931, 'avg', 64, '0');  convert_element_type_2931 = None
        wait_tensor_879 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_280);  reduce_scatter_tensor_280 = None
        convert_element_type_2932 = torch.ops.prims.convert_element_type.default(add_2073, torch.float32);  add_2073 = None
        convert_element_type_361 = torch.ops.prims.convert_element_type.default(primals_119, torch.bfloat16);  primals_119 = None
        all_gather_into_tensor_113 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_361, 64, '0');  convert_element_type_361 = None
        wait_tensor_137 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_113);  all_gather_into_tensor_113 = None
        convert_element_type_2934 = torch.ops.prims.convert_element_type.default(wait_tensor_137, torch.float32);  wait_tensor_137 = None
        mul_1965 = torch.ops.aten.mul.Tensor(convert_element_type_2932, convert_element_type_2934);  convert_element_type_2934 = None
        convert_element_type_362 = torch.ops.prims.convert_element_type.default(add_413, torch.float32);  add_413 = None
        mul_303 = torch.ops.aten.mul.Tensor(convert_element_type_362, rsqrt_21);  convert_element_type_362 = None
        mul_1967 = torch.ops.aten.mul.Tensor(mul_303, mul_1965)
        sum_265 = torch.ops.aten.sum.dim_IntList(mul_1967, [2], True);  mul_1967 = None
        div_251 = torch.ops.aten.div.Tensor(mul_303, 2048)
        mul_1968 = torch.ops.aten.mul.Tensor(div_251, sum_265);  div_251 = sum_265 = None
        sub_744 = torch.ops.aten.sub.Tensor(mul_1965, mul_1968);  mul_1965 = mul_1968 = None
        mul_1969 = torch.ops.aten.mul.Tensor(sub_744, rsqrt_21);  sub_744 = rsqrt_21 = None
        mul_1970 = torch.ops.aten.mul.Tensor(convert_element_type_2932, mul_303);  convert_element_type_2932 = mul_303 = None
        sum_266 = torch.ops.aten.sum.dim_IntList(mul_1970, [0, 1]);  mul_1970 = None
        convert_element_type_2935 = torch.ops.prims.convert_element_type.default(mul_1969, torch.bfloat16);  mul_1969 = None
        add_2074 = torch.ops.aten.add.Tensor(add_2072, convert_element_type_2935);  add_2072 = convert_element_type_2935 = None
        convert_element_type_default_22 = torch.ops.prims.convert_element_type.default(sum_266, torch.float32);  sum_266 = None
        reduce_scatter_tensor_281 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_22, 'avg', 64, '0');  convert_element_type_default_22 = None
        wait_tensor_880 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_281);  reduce_scatter_tensor_281 = None
        view_2162 = torch.ops.aten.view.default(add_2074, [8192, 2048])
        unsqueeze_73 = torch.ops.aten.unsqueeze.default(view_2162, 1)
        convert_element_type_2938 = torch.ops.prims.convert_element_type.default(unsqueeze_73, torch.float32);  unsqueeze_73 = None
        bmm_66 = torch.ops.aten.bmm.default(permute_1406, convert_element_type_2938);  permute_1406 = None
        bmm_67 = torch.ops.aten.bmm.default(convert_element_type_2938, permute_1407);  convert_element_type_2938 = permute_1407 = None
        convert_element_type_2939 = torch.ops.prims.convert_element_type.default(bmm_66, torch.bfloat16);  bmm_66 = None
        view_2163 = torch.ops.aten.view.default(bmm_67, [8192, 6]);  bmm_67 = None
        view_2164 = torch.ops.aten.view.default(convert_element_type_2939, [49152, 2048]);  convert_element_type_2939 = None
        index_92 = torch.ops.aten.index.Tensor(view_2164, [getitem_91]);  view_2164 = getitem_91 = None
        permute_1408 = torch.ops.aten.permute.default(view_2162, [1, 0])
        mm_538 = torch.ops.aten.mm.default(permute_1408, mul_300);  permute_1408 = mul_300 = None
        convert_element_type_356 = torch.ops.prims.convert_element_type.default(primals_118, torch.bfloat16);  primals_118 = None
        all_gather_into_tensor_112 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_356, 64, '0');  convert_element_type_356 = None
        wait_tensor_136 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_112);  all_gather_into_tensor_112 = None
        permute_100 = torch.ops.aten.permute.default(wait_tensor_136, [1, 0]);  wait_tensor_136 = None
        permute_1410 = torch.ops.aten.permute.default(permute_100, [1, 0]);  permute_100 = None
        mm_539 = torch.ops.aten.mm.default(view_2162, permute_1410);  view_2162 = permute_1410 = None
        convert_element_type_2944 = torch.ops.prims.convert_element_type.default(mm_538, torch.float32);  mm_538 = None
        reduce_scatter_tensor_282 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2944, 'avg', 64, '0');  convert_element_type_2944 = None
        wait_tensor_881 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_282);  reduce_scatter_tensor_282 = None
        convert_element_type_351 = torch.ops.prims.convert_element_type.default(mm_52, torch.float32);  mm_52 = None
        neg_12 = torch.ops.aten.neg.default(convert_element_type_351)
        exp_18 = torch.ops.aten.exp.default(neg_12);  neg_12 = None
        add_408 = torch.ops.aten.add.Tensor(exp_18, 1);  exp_18 = None
        div_30 = torch.ops.aten.div.Tensor(convert_element_type_351, add_408)
        convert_element_type_352 = torch.ops.prims.convert_element_type.default(div_30, torch.bfloat16);  div_30 = None
        mul_1971 = torch.ops.aten.mul.Tensor(mm_539, convert_element_type_352);  convert_element_type_352 = None
        mul_1972 = torch.ops.aten.mul.Tensor(mm_539, mm_53);  mm_539 = mm_53 = None
        permute_1412 = torch.ops.aten.permute.default(mul_1971, [1, 0])
        mm_540 = torch.ops.aten.mm.default(permute_1412, view_393);  permute_1412 = None
        convert_element_type_353 = torch.ops.prims.convert_element_type.default(primals_117, torch.bfloat16);  primals_117 = None
        all_gather_into_tensor_111 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_353, 64, '0');  convert_element_type_353 = None
        wait_tensor_135 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_111);  all_gather_into_tensor_111 = None
        permute_99 = torch.ops.aten.permute.default(wait_tensor_135, [1, 0]);  wait_tensor_135 = None
        permute_1414 = torch.ops.aten.permute.default(permute_99, [1, 0]);  permute_99 = None
        mm_541 = torch.ops.aten.mm.default(mul_1971, permute_1414);  mul_1971 = permute_1414 = None
        convert_element_type_2949 = torch.ops.prims.convert_element_type.default(mm_540, torch.float32);  mm_540 = None
        reduce_scatter_tensor_283 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2949, 'avg', 64, '0');  convert_element_type_2949 = None
        wait_tensor_882 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_283);  reduce_scatter_tensor_283 = None
        convert_element_type_2950 = torch.ops.prims.convert_element_type.default(mul_1972, torch.float32);  mul_1972 = None
        reciprocal_40 = torch.ops.aten.reciprocal.default(add_408);  add_408 = None
        mul_1973 = torch.ops.aten.mul.Tensor(reciprocal_40, 1);  reciprocal_40 = None
        mul_1974 = torch.ops.aten.mul.Tensor(convert_element_type_2950, mul_1973);  convert_element_type_2950 = None
        sub_745 = torch.ops.aten.sub.Tensor(1, mul_1973);  mul_1973 = None
        mul_1975 = torch.ops.aten.mul.Tensor(convert_element_type_351, sub_745);  convert_element_type_351 = sub_745 = None
        add_2076 = torch.ops.aten.add.Tensor(mul_1975, 1);  mul_1975 = None
        mul_1976 = torch.ops.aten.mul.Tensor(mul_1974, add_2076);  mul_1974 = add_2076 = None
        convert_element_type_2952 = torch.ops.prims.convert_element_type.default(mul_1976, torch.bfloat16);  mul_1976 = None
        permute_1416 = torch.ops.aten.permute.default(convert_element_type_2952, [1, 0])
        mm_542 = torch.ops.aten.mm.default(permute_1416, view_393);  permute_1416 = None
        convert_element_type_348 = torch.ops.prims.convert_element_type.default(primals_116, torch.bfloat16);  primals_116 = None
        all_gather_into_tensor_110 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_348, 64, '0');  convert_element_type_348 = None
        wait_tensor_134 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_110);  all_gather_into_tensor_110 = None
        permute_98 = torch.ops.aten.permute.default(wait_tensor_134, [1, 0]);  wait_tensor_134 = None
        permute_1418 = torch.ops.aten.permute.default(permute_98, [1, 0]);  permute_98 = None
        mm_543 = torch.ops.aten.mm.default(convert_element_type_2952, permute_1418);  convert_element_type_2952 = permute_1418 = None
        add_2077 = torch.ops.aten.add.Tensor(mm_541, mm_543);  mm_541 = mm_543 = None
        convert_element_type_2957 = torch.ops.prims.convert_element_type.default(mm_542, torch.float32);  mm_542 = None
        reduce_scatter_tensor_284 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2957, 'avg', 64, '0');  convert_element_type_2957 = None
        wait_tensor_883 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_284);  reduce_scatter_tensor_284 = None
        all_to_all_single_118 = torch.ops._c10d_functional.all_to_all_single.default(index_92, [_local_scalar_dense_88, _local_scalar_dense_89, _local_scalar_dense_90, _local_scalar_dense_91, _local_scalar_dense_92, _local_scalar_dense_93, _local_scalar_dense_94, _local_scalar_dense_95], [_local_scalar_dense_80, _local_scalar_dense_81, _local_scalar_dense_82, _local_scalar_dense_83, _local_scalar_dense_84, _local_scalar_dense_85, _local_scalar_dense_86, _local_scalar_dense_87], '521');  index_92 = None
        wait_tensor_884 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_118);  all_to_all_single_118 = None
        full_428 = torch.ops.aten.full.default([sym_size_int_21, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_21 = None
        slice_scatter_20 = torch.ops.aten.slice_scatter.default(full_428, wait_tensor_884, 0, 0, -1);  wait_tensor_884 = None
        index_93 = torch.ops.aten.index.Tensor(slice_scatter_20, [getitem_92]);  slice_scatter_20 = None
        permute_1420 = torch.ops.aten.permute.default(index_93, [1, 0])
        _grouped_mm_198 = torch.ops.aten._grouped_mm.default(permute_1420, mul_280, cumsum_17);  permute_1420 = mul_280 = None
        convert_element_type_342 = torch.ops.prims.convert_element_type.default(primals_114, torch.bfloat16);  primals_114 = None
        all_gather_into_tensor_106 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_342, 8, '513');  convert_element_type_342 = None
        wait_tensor_129 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_106);  all_gather_into_tensor_106 = None
        permute_97 = torch.ops.aten.permute.default(wait_tensor_129, [0, 2, 1]);  wait_tensor_129 = None
        permute_1422 = torch.ops.aten.permute.default(permute_97, [0, 2, 1]);  permute_97 = None
        _grouped_mm_199 = torch.ops.aten._grouped_mm.default(index_93, permute_1422, cumsum_17);  index_93 = permute_1422 = None
        convert_element_type_346 = torch.ops.prims.convert_element_type.default(_grouped_mm_15, torch.float32);  _grouped_mm_15 = None
        neg_11 = torch.ops.aten.neg.default(convert_element_type_346)
        exp_17 = torch.ops.aten.exp.default(neg_11);  neg_11 = None
        add_372 = torch.ops.aten.add.Tensor(exp_17, 1);  exp_17 = None
        div_29 = torch.ops.aten.div.Tensor(convert_element_type_346, add_372)
        convert_element_type_347 = torch.ops.prims.convert_element_type.default(div_29, torch.bfloat16);  div_29 = None
        mul_1977 = torch.ops.aten.mul.Tensor(_grouped_mm_199, convert_element_type_347);  convert_element_type_347 = None
        mul_1978 = torch.ops.aten.mul.Tensor(_grouped_mm_199, _grouped_mm_16);  _grouped_mm_199 = _grouped_mm_16 = None
        permute_1424 = torch.ops.aten.permute.default(mul_1977, [1, 0])
        _grouped_mm_200 = torch.ops.aten._grouped_mm.default(permute_1424, index_11, cumsum_17);  permute_1424 = None
        convert_element_type_343 = torch.ops.prims.convert_element_type.default(primals_115, torch.bfloat16);  primals_115 = None
        all_gather_into_tensor_107 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_343, 8, '513');  convert_element_type_343 = None
        wait_tensor_130 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_107);  all_gather_into_tensor_107 = None
        permute_96 = torch.ops.aten.permute.default(wait_tensor_130, [0, 2, 1]);  wait_tensor_130 = None
        permute_1426 = torch.ops.aten.permute.default(permute_96, [0, 2, 1]);  permute_96 = None
        _grouped_mm_201 = torch.ops.aten._grouped_mm.default(mul_1977, permute_1426, cumsum_17);  mul_1977 = permute_1426 = None
        convert_element_type_2958 = torch.ops.prims.convert_element_type.default(mul_1978, torch.float32);  mul_1978 = None
        reciprocal_41 = torch.ops.aten.reciprocal.default(add_372);  add_372 = None
        mul_1979 = torch.ops.aten.mul.Tensor(reciprocal_41, 1);  reciprocal_41 = None
        mul_1980 = torch.ops.aten.mul.Tensor(convert_element_type_2958, mul_1979);  convert_element_type_2958 = None
        sub_746 = torch.ops.aten.sub.Tensor(1, mul_1979);  mul_1979 = None
        mul_1981 = torch.ops.aten.mul.Tensor(convert_element_type_346, sub_746);  convert_element_type_346 = sub_746 = None
        add_2079 = torch.ops.aten.add.Tensor(mul_1981, 1);  mul_1981 = None
        mul_1982 = torch.ops.aten.mul.Tensor(mul_1980, add_2079);  mul_1980 = add_2079 = None
        convert_element_type_2960 = torch.ops.prims.convert_element_type.default(mul_1982, torch.bfloat16);  mul_1982 = None
        permute_1428 = torch.ops.aten.permute.default(convert_element_type_2960, [1, 0])
        _grouped_mm_202 = torch.ops.aten._grouped_mm.default(permute_1428, index_11, cumsum_17);  permute_1428 = index_11 = None
        convert_element_type_340 = torch.ops.prims.convert_element_type.default(primals_113, torch.bfloat16);  primals_113 = None
        all_gather_into_tensor_104 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_340, 8, '513');  convert_element_type_340 = None
        wait_tensor_127 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_104);  all_gather_into_tensor_104 = None
        permute_95 = torch.ops.aten.permute.default(wait_tensor_127, [0, 2, 1]);  wait_tensor_127 = None
        permute_1430 = torch.ops.aten.permute.default(permute_95, [0, 2, 1]);  permute_95 = None
        _grouped_mm_203 = torch.ops.aten._grouped_mm.default(convert_element_type_2960, permute_1430, cumsum_17);  convert_element_type_2960 = permute_1430 = cumsum_17 = None
        add_2080 = torch.ops.aten.add.Tensor(_grouped_mm_201, _grouped_mm_203);  _grouped_mm_201 = _grouped_mm_203 = None
        convert_element_type_2961 = torch.ops.prims.convert_element_type.default(_grouped_mm_200, torch.float32);  _grouped_mm_200 = None
        div_252 = torch.ops.aten.div.Tensor(convert_element_type_2961, 64);  convert_element_type_2961 = None
        reduce_scatter_tensor_285 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_252, 'sum', 8, '513');  div_252 = None
        wait_tensor_885 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_285);  reduce_scatter_tensor_285 = None
        convert_element_type_2962 = torch.ops.prims.convert_element_type.default(_grouped_mm_198, torch.float32);  _grouped_mm_198 = None
        div_253 = torch.ops.aten.div.Tensor(convert_element_type_2962, 64);  convert_element_type_2962 = None
        reduce_scatter_tensor_286 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_253, 'sum', 8, '513');  div_253 = None
        wait_tensor_886 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_286);  reduce_scatter_tensor_286 = None
        convert_element_type_2963 = torch.ops.prims.convert_element_type.default(_grouped_mm_202, torch.float32);  _grouped_mm_202 = None
        div_254 = torch.ops.aten.div.Tensor(convert_element_type_2963, 64);  convert_element_type_2963 = None
        reduce_scatter_tensor_287 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_254, 'sum', 8, '513');  div_254 = None
        wait_tensor_887 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_287);  reduce_scatter_tensor_287 = None
        index_put_92 = torch.ops.aten.index_put.default(full_428, [getitem_92], add_2080, True);  full_428 = getitem_92 = add_2080 = None
        slice_227 = torch.ops.aten.slice.Tensor(index_put_92, 0, 0, add_2081);  index_put_92 = add_2081 = None
        all_to_all_single_119 = torch.ops._c10d_functional.all_to_all_single.default(slice_227, [_local_scalar_dense_80, _local_scalar_dense_81, _local_scalar_dense_82, _local_scalar_dense_83, _local_scalar_dense_84, _local_scalar_dense_85, _local_scalar_dense_86, _local_scalar_dense_87], [_local_scalar_dense_88, _local_scalar_dense_89, _local_scalar_dense_90, _local_scalar_dense_91, _local_scalar_dense_92, _local_scalar_dense_93, _local_scalar_dense_94, _local_scalar_dense_95], '521');  slice_227 = _local_scalar_dense_80 = _local_scalar_dense_81 = _local_scalar_dense_82 = _local_scalar_dense_83 = _local_scalar_dense_84 = _local_scalar_dense_85 = _local_scalar_dense_86 = _local_scalar_dense_87 = _local_scalar_dense_88 = _local_scalar_dense_89 = _local_scalar_dense_90 = _local_scalar_dense_91 = _local_scalar_dense_92 = _local_scalar_dense_93 = _local_scalar_dense_94 = _local_scalar_dense_95 = None
        wait_tensor_888 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_119);  all_to_all_single_119 = None
        index_put_93 = torch.ops.aten.index_put.default(full_default_52, [div_27], wait_tensor_888, True);  div_27 = wait_tensor_888 = None
        add_2085 = torch.ops.aten.add.Tensor(add_2077, index_put_93);  add_2077 = index_put_93 = None
        mul_1983 = torch.ops.aten.mul.Tensor(view_2163, 1.0);  view_2163 = None
        scatter_add_20 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_89, mul_1983);  getitem_89 = mul_1983 = None
        convert_element_type_335 = torch.ops.prims.convert_element_type.default(mm_51, torch.float32);  mm_51 = None
        sub_120 = torch.ops.aten.sub.Tensor(convert_element_type_335, amax_5);  convert_element_type_335 = amax_5 = None
        exp_16 = torch.ops.aten.exp.default(sub_120);  sub_120 = None
        div_26 = torch.ops.aten.div.Tensor(exp_16, sum_21);  exp_16 = sum_21 = None
        mul_1984 = torch.ops.aten.mul.Tensor(scatter_add_20, div_26);  scatter_add_20 = None
        sum_267 = torch.ops.aten.sum.dim_IntList(mul_1984, [1], True)
        neg_115 = torch.ops.aten.neg.default(div_26);  div_26 = None
        fma_20 = torch.ops.prims.fma.default(neg_115, sum_267, mul_1984);  neg_115 = sum_267 = mul_1984 = None
        convert_element_type_2964 = torch.ops.prims.convert_element_type.default(fma_20, torch.bfloat16);  fma_20 = None
        permute_1432 = torch.ops.aten.permute.default(convert_element_type_2964, [1, 0])
        mm_544 = torch.ops.aten.mm.default(permute_1432, view_393);  permute_1432 = view_393 = None
        convert_element_type_332 = torch.ops.prims.convert_element_type.default(primals_111, torch.bfloat16);  primals_111 = None
        all_gather_into_tensor_103 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_332, 64, '0');  convert_element_type_332 = None
        wait_tensor_123 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_103);  all_gather_into_tensor_103 = None
        permute_94 = torch.ops.aten.permute.default(wait_tensor_123, [1, 0]);  wait_tensor_123 = None
        permute_1434 = torch.ops.aten.permute.default(permute_94, [1, 0]);  permute_94 = None
        mm_545 = torch.ops.aten.mm.default(convert_element_type_2964, permute_1434);  convert_element_type_2964 = permute_1434 = None
        add_2086 = torch.ops.aten.add.Tensor(add_2085, mm_545);  add_2085 = mm_545 = None
        convert_element_type_2969 = torch.ops.prims.convert_element_type.default(mm_544, torch.float32);  mm_544 = None
        reduce_scatter_tensor_288 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2969, 'avg', 64, '0');  convert_element_type_2969 = None
        wait_tensor_889 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_288);  reduce_scatter_tensor_288 = None
        view_2165 = torch.ops.aten.view.default(add_2086, [2, 4096, 2048]);  add_2086 = None
        convert_element_type_2970 = torch.ops.prims.convert_element_type.default(view_2165, torch.float32);  view_2165 = None
        convert_element_type_329 = torch.ops.prims.convert_element_type.default(primals_109, torch.bfloat16);  primals_109 = None
        all_gather_into_tensor_102 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_329, 64, '0');  convert_element_type_329 = None
        wait_tensor_122 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_102);  all_gather_into_tensor_102 = None
        convert_element_type_2972 = torch.ops.prims.convert_element_type.default(wait_tensor_122, torch.float32);  wait_tensor_122 = None
        mul_1985 = torch.ops.aten.mul.Tensor(convert_element_type_2970, convert_element_type_2972);  convert_element_type_2972 = None
        convert_element_type_330 = torch.ops.prims.convert_element_type.default(add_348, torch.float32);  add_348 = None
        mul_260 = torch.ops.aten.mul.Tensor(convert_element_type_330, rsqrt_20);  convert_element_type_330 = None
        mul_1987 = torch.ops.aten.mul.Tensor(mul_260, mul_1985)
        sum_268 = torch.ops.aten.sum.dim_IntList(mul_1987, [2], True);  mul_1987 = None
        div_255 = torch.ops.aten.div.Tensor(mul_260, 2048)
        mul_1988 = torch.ops.aten.mul.Tensor(div_255, sum_268);  div_255 = sum_268 = None
        sub_748 = torch.ops.aten.sub.Tensor(mul_1985, mul_1988);  mul_1985 = mul_1988 = None
        mul_1989 = torch.ops.aten.mul.Tensor(sub_748, rsqrt_20);  sub_748 = rsqrt_20 = None
        mul_1990 = torch.ops.aten.mul.Tensor(convert_element_type_2970, mul_260);  convert_element_type_2970 = mul_260 = None
        sum_269 = torch.ops.aten.sum.dim_IntList(mul_1990, [0, 1]);  mul_1990 = None
        convert_element_type_2973 = torch.ops.prims.convert_element_type.default(mul_1989, torch.bfloat16);  mul_1989 = None
        add_2087 = torch.ops.aten.add.Tensor(add_2074, convert_element_type_2973);  add_2074 = convert_element_type_2973 = None
        convert_element_type_default_21 = torch.ops.prims.convert_element_type.default(sum_269, torch.float32);  sum_269 = None
        reduce_scatter_tensor_289 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_21, 'avg', 64, '0');  convert_element_type_default_21 = None
        wait_tensor_890 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_289);  reduce_scatter_tensor_289 = None
        view_2166 = torch.ops.aten.view.default(add_2087, [8192, 2048])
        permute_1436 = torch.ops.aten.permute.default(view_2166, [1, 0])
        permute_92 = torch.ops.aten.permute.default(getitem_85, [0, 2, 1, 3])
        view_388 = torch.ops.aten.view.default(permute_92, [2, 4096, -1]);  permute_92 = None
        view_390 = torch.ops.aten.view.default(view_388, [8192, 2048]);  view_388 = None
        mm_546 = torch.ops.aten.mm.default(permute_1436, view_390);  permute_1436 = view_390 = None
        convert_element_type_326 = torch.ops.prims.convert_element_type.default(primals_108, torch.bfloat16);  primals_108 = None
        all_gather_into_tensor_101 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_326, 64, '0');  convert_element_type_326 = None
        wait_tensor_121 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_101);  all_gather_into_tensor_101 = None
        permute_93 = torch.ops.aten.permute.default(wait_tensor_121, [1, 0]);  wait_tensor_121 = None
        permute_1438 = torch.ops.aten.permute.default(permute_93, [1, 0]);  permute_93 = None
        mm_547 = torch.ops.aten.mm.default(view_2166, permute_1438);  view_2166 = permute_1438 = None
        view_2167 = torch.ops.aten.view.default(mm_547, [2, 4096, 2048]);  mm_547 = None
        convert_element_type_2980 = torch.ops.prims.convert_element_type.default(mm_546, torch.float32);  mm_546 = None
        reduce_scatter_tensor_290 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2980, 'avg', 64, '0');  convert_element_type_2980 = None
        wait_tensor_891 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_290);  reduce_scatter_tensor_290 = None
        view_2168 = torch.ops.aten.view.default(view_2167, [2, 4096, 16, 128]);  view_2167 = None
        permute_1440 = torch.ops.aten.permute.default(view_2168, [0, 2, 1, 3]);  view_2168 = None
        fw_graph20 = self.fw_graph20
        joint_graph20 = self.joint_graph20
        mask_graph20 = self.mask_graph20
        flex_attention_backward_20 = torch.ops.higher_order.flex_attention_backward(permute_89, permute_90, permute_91, getitem_85, getitem_86, permute_1440, None, fw_graph20, joint_graph20, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph20), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_89 = permute_90 = permute_91 = getitem_85 = getitem_86 = permute_1440 = fw_graph20 = joint_graph20 = mask_graph20 = None
        getitem_453 = flex_attention_backward_20[0]
        getitem_454 = flex_attention_backward_20[1]
        getitem_455 = flex_attention_backward_20[2];  flex_attention_backward_20 = None
        permute_1441 = torch.ops.aten.permute.default(getitem_455, [0, 2, 1, 3]);  getitem_455 = None
        permute_1442 = torch.ops.aten.permute.default(getitem_454, [0, 2, 1, 3]);  getitem_454 = None
        permute_1443 = torch.ops.aten.permute.default(getitem_453, [0, 2, 1, 3]);  getitem_453 = None
        slice_229 = torch.ops.aten.slice.Tensor(permute_1442, 3, 0, 128)
        slice_230 = torch.ops.aten.slice.Tensor(permute_1442, 3, 128, 192);  permute_1442 = None
        sum_270 = torch.ops.aten.sum.dim_IntList(slice_230, [2], True);  slice_230 = None
        cat_140 = torch.ops.aten.cat.default([slice_229, permute_1441], 3);  slice_229 = permute_1441 = None
        view_2169 = torch.ops.aten.view.default(cat_140, [2, 4096, 4096]);  cat_140 = None
        view_2170 = torch.ops.aten.view.default(view_2169, [8192, 4096]);  view_2169 = None
        permute_1444 = torch.ops.aten.permute.default(view_2170, [1, 0])
        mm_548 = torch.ops.aten.mm.default(permute_1444, view_385);  permute_1444 = view_385 = None
        convert_element_type_323 = torch.ops.prims.convert_element_type.default(primals_107, torch.bfloat16);  primals_107 = None
        all_gather_into_tensor_100 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_323, 64, '0');  convert_element_type_323 = None
        wait_tensor_120 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_100);  all_gather_into_tensor_100 = None
        permute_88 = torch.ops.aten.permute.default(wait_tensor_120, [1, 0]);  wait_tensor_120 = None
        permute_1446 = torch.ops.aten.permute.default(permute_88, [1, 0]);  permute_88 = None
        mm_549 = torch.ops.aten.mm.default(view_2170, permute_1446);  view_2170 = permute_1446 = None
        view_2171 = torch.ops.aten.view.default(mm_549, [2, 4096, 512]);  mm_549 = None
        convert_element_type_2985 = torch.ops.prims.convert_element_type.default(mm_548, torch.float32);  mm_548 = None
        reduce_scatter_tensor_291 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2985, 'avg', 64, '0');  convert_element_type_2985 = None
        wait_tensor_892 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_291);  reduce_scatter_tensor_291 = None
        convert_element_type_2986 = torch.ops.prims.convert_element_type.default(view_2171, torch.float32);  view_2171 = None
        convert_element_type_320 = torch.ops.prims.convert_element_type.default(primals_106, torch.bfloat16);  primals_106 = None
        all_gather_into_tensor_99 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_320, 64, '0');  convert_element_type_320 = None
        wait_tensor_119 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_99);  all_gather_into_tensor_99 = None
        convert_element_type_2988 = torch.ops.prims.convert_element_type.default(wait_tensor_119, torch.float32);  wait_tensor_119 = None
        mul_1991 = torch.ops.aten.mul.Tensor(convert_element_type_2986, convert_element_type_2988);  convert_element_type_2988 = None
        convert_element_type_321 = torch.ops.prims.convert_element_type.default(getitem_81, torch.float32);  getitem_81 = None
        mul_258 = torch.ops.aten.mul.Tensor(convert_element_type_321, rsqrt_19);  convert_element_type_321 = None
        mul_1993 = torch.ops.aten.mul.Tensor(mul_258, mul_1991)
        sum_271 = torch.ops.aten.sum.dim_IntList(mul_1993, [2], True);  mul_1993 = None
        div_256 = torch.ops.aten.div.Tensor(mul_258, 512)
        mul_1994 = torch.ops.aten.mul.Tensor(div_256, sum_271);  div_256 = sum_271 = None
        sub_749 = torch.ops.aten.sub.Tensor(mul_1991, mul_1994);  mul_1991 = mul_1994 = None
        mul_1995 = torch.ops.aten.mul.Tensor(sub_749, rsqrt_19);  sub_749 = rsqrt_19 = None
        mul_1996 = torch.ops.aten.mul.Tensor(convert_element_type_2986, mul_258);  convert_element_type_2986 = mul_258 = None
        sum_272 = torch.ops.aten.sum.dim_IntList(mul_1996, [0, 1]);  mul_1996 = None
        convert_element_type_2989 = torch.ops.prims.convert_element_type.default(mul_1995, torch.bfloat16);  mul_1995 = None
        convert_element_type_default_20 = torch.ops.prims.convert_element_type.default(sum_272, torch.float32);  sum_272 = None
        reduce_scatter_tensor_292 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_20, 'avg', 64, '0');  convert_element_type_default_20 = None
        wait_tensor_893 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_292);  reduce_scatter_tensor_292 = None
        convert_element_type_2992 = torch.ops.prims.convert_element_type.default(sum_270, torch.float32);  sum_270 = None
        view_2172 = torch.ops.aten.view.default(convert_element_type_2992, [2, 4096, 1, 32, 2]);  convert_element_type_2992 = None
        view_as_complex_94 = torch.ops.aten.view_as_complex.default(view_2172);  view_2172 = None
        mul_1997 = torch.ops.aten.mul.Tensor(view_as_complex_94, clone_9);  view_as_complex_94 = None
        view_as_real_94 = torch.ops.aten.view_as_real.default(mul_1997);  mul_1997 = None
        view_2173 = torch.ops.aten.view.default(view_as_real_94, [2, 4096, 1, 64]);  view_as_real_94 = None
        convert_element_type_2993 = torch.ops.prims.convert_element_type.default(view_2173, torch.bfloat16);  view_2173 = None
        squeeze_46 = torch.ops.aten.squeeze.dim(convert_element_type_2993, 2);  convert_element_type_2993 = None
        cat_141 = torch.ops.aten.cat.default([convert_element_type_2989, squeeze_46], 2);  convert_element_type_2989 = squeeze_46 = None
        view_2174 = torch.ops.aten.view.default(cat_141, [8192, 576]);  cat_141 = None
        permute_1448 = torch.ops.aten.permute.default(view_2174, [1, 0])
        mm_550 = torch.ops.aten.mm.default(permute_1448, view_371);  permute_1448 = None
        convert_element_type_315 = torch.ops.prims.convert_element_type.default(primals_105, torch.bfloat16);  primals_105 = None
        all_gather_into_tensor_98 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_315, 64, '0');  convert_element_type_315 = None
        wait_tensor_118 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_98);  all_gather_into_tensor_98 = None
        permute_87 = torch.ops.aten.permute.default(wait_tensor_118, [1, 0]);  wait_tensor_118 = None
        permute_1450 = torch.ops.aten.permute.default(permute_87, [1, 0]);  permute_87 = None
        mm_551 = torch.ops.aten.mm.default(view_2174, permute_1450);  view_2174 = permute_1450 = None
        view_2175 = torch.ops.aten.view.default(mm_551, [2, 4096, 2048]);  mm_551 = None
        convert_element_type_2998 = torch.ops.prims.convert_element_type.default(mm_550, torch.float32);  mm_550 = None
        reduce_scatter_tensor_293 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_2998, 'avg', 64, '0');  convert_element_type_2998 = None
        wait_tensor_894 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_293);  reduce_scatter_tensor_293 = None
        slice_231 = torch.ops.aten.slice.Tensor(permute_1443, 3, 0, 128)
        slice_232 = torch.ops.aten.slice.Tensor(permute_1443, 3, 128, 192);  permute_1443 = None
        convert_element_type_2999 = torch.ops.prims.convert_element_type.default(slice_232, torch.float32);  slice_232 = None
        view_2176 = torch.ops.aten.view.default(convert_element_type_2999, [2, 4096, 16, 32, 2]);  convert_element_type_2999 = None
        view_as_complex_95 = torch.ops.aten.view_as_complex.default(view_2176);  view_2176 = None
        mul_1998 = torch.ops.aten.mul.Tensor(view_as_complex_95, clone_9);  view_as_complex_95 = None
        view_as_real_95 = torch.ops.aten.view_as_real.default(mul_1998);  mul_1998 = None
        view_2177 = torch.ops.aten.view.default(view_as_real_95, [2, 4096, 16, 64]);  view_as_real_95 = None
        convert_element_type_3000 = torch.ops.prims.convert_element_type.default(view_2177, torch.bfloat16);  view_2177 = None
        cat_142 = torch.ops.aten.cat.default([slice_231, convert_element_type_3000], 3);  slice_231 = convert_element_type_3000 = None
        view_2178 = torch.ops.aten.view.default(cat_142, [2, 4096, 3072]);  cat_142 = None
        view_2179 = torch.ops.aten.view.default(view_2178, [8192, 3072]);  view_2178 = None
        permute_1452 = torch.ops.aten.permute.default(view_2179, [1, 0])
        mm_552 = torch.ops.aten.mm.default(permute_1452, view_371);  permute_1452 = view_371 = None
        convert_element_type_310 = torch.ops.prims.convert_element_type.default(primals_104, torch.bfloat16);  primals_104 = None
        all_gather_into_tensor_97 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_310, 64, '0');  convert_element_type_310 = None
        wait_tensor_117 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_97);  all_gather_into_tensor_97 = None
        permute_86 = torch.ops.aten.permute.default(wait_tensor_117, [1, 0]);  wait_tensor_117 = None
        permute_1454 = torch.ops.aten.permute.default(permute_86, [1, 0]);  permute_86 = None
        mm_553 = torch.ops.aten.mm.default(view_2179, permute_1454);  view_2179 = permute_1454 = None
        view_2180 = torch.ops.aten.view.default(mm_553, [2, 4096, 2048]);  mm_553 = None
        add_2088 = torch.ops.aten.add.Tensor(view_2175, view_2180);  view_2175 = view_2180 = None
        convert_element_type_3005 = torch.ops.prims.convert_element_type.default(mm_552, torch.float32);  mm_552 = None
        reduce_scatter_tensor_294 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3005, 'avg', 64, '0');  convert_element_type_3005 = None
        wait_tensor_895 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_294);  reduce_scatter_tensor_294 = None
        convert_element_type_3006 = torch.ops.prims.convert_element_type.default(add_2088, torch.float32);  add_2088 = None
        convert_element_type_307 = torch.ops.prims.convert_element_type.default(primals_103, torch.bfloat16);  primals_103 = None
        all_gather_into_tensor_96 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_307, 64, '0');  convert_element_type_307 = None
        wait_tensor_116 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_96);  all_gather_into_tensor_96 = None
        convert_element_type_3008 = torch.ops.prims.convert_element_type.default(wait_tensor_116, torch.float32);  wait_tensor_116 = None
        mul_1999 = torch.ops.aten.mul.Tensor(convert_element_type_3006, convert_element_type_3008);  convert_element_type_3008 = None
        convert_element_type_308 = torch.ops.prims.convert_element_type.default(add_345, torch.float32);  add_345 = None
        mul_254 = torch.ops.aten.mul.Tensor(convert_element_type_308, rsqrt_18);  convert_element_type_308 = None
        mul_2001 = torch.ops.aten.mul.Tensor(mul_254, mul_1999)
        sum_273 = torch.ops.aten.sum.dim_IntList(mul_2001, [2], True);  mul_2001 = None
        div_257 = torch.ops.aten.div.Tensor(mul_254, 2048)
        mul_2002 = torch.ops.aten.mul.Tensor(div_257, sum_273);  div_257 = sum_273 = None
        sub_750 = torch.ops.aten.sub.Tensor(mul_1999, mul_2002);  mul_1999 = mul_2002 = None
        mul_2003 = torch.ops.aten.mul.Tensor(sub_750, rsqrt_18);  sub_750 = rsqrt_18 = None
        mul_2004 = torch.ops.aten.mul.Tensor(convert_element_type_3006, mul_254);  convert_element_type_3006 = mul_254 = None
        sum_274 = torch.ops.aten.sum.dim_IntList(mul_2004, [0, 1]);  mul_2004 = None
        convert_element_type_3009 = torch.ops.prims.convert_element_type.default(mul_2003, torch.bfloat16);  mul_2003 = None
        add_2089 = torch.ops.aten.add.Tensor(add_2087, convert_element_type_3009);  add_2087 = convert_element_type_3009 = None
        convert_element_type_default_19 = torch.ops.prims.convert_element_type.default(sum_274, torch.float32);  sum_274 = None
        reduce_scatter_tensor_295 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_19, 'avg', 64, '0');  convert_element_type_default_19 = None
        wait_tensor_896 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_295);  reduce_scatter_tensor_295 = None
        view_2181 = torch.ops.aten.view.default(add_2089, [8192, 2048])
        unsqueeze_74 = torch.ops.aten.unsqueeze.default(view_2181, 1)
        convert_element_type_3012 = torch.ops.prims.convert_element_type.default(unsqueeze_74, torch.float32);  unsqueeze_74 = None
        bmm_68 = torch.ops.aten.bmm.default(permute_1456, convert_element_type_3012);  permute_1456 = None
        bmm_69 = torch.ops.aten.bmm.default(convert_element_type_3012, permute_1457);  convert_element_type_3012 = permute_1457 = None
        convert_element_type_3013 = torch.ops.prims.convert_element_type.default(bmm_68, torch.bfloat16);  bmm_68 = None
        view_2182 = torch.ops.aten.view.default(bmm_69, [8192, 6]);  bmm_69 = None
        view_2183 = torch.ops.aten.view.default(convert_element_type_3013, [49152, 2048]);  convert_element_type_3013 = None
        index_94 = torch.ops.aten.index.Tensor(view_2183, [getitem_77]);  view_2183 = getitem_77 = None
        permute_1458 = torch.ops.aten.permute.default(view_2181, [1, 0])
        mm_554 = torch.ops.aten.mm.default(permute_1458, mul_251);  permute_1458 = mul_251 = None
        convert_element_type_302 = torch.ops.prims.convert_element_type.default(primals_102, torch.bfloat16);  primals_102 = None
        all_gather_into_tensor_95 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_302, 64, '0');  convert_element_type_302 = None
        wait_tensor_115 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_95);  all_gather_into_tensor_95 = None
        permute_85 = torch.ops.aten.permute.default(wait_tensor_115, [1, 0]);  wait_tensor_115 = None
        permute_1460 = torch.ops.aten.permute.default(permute_85, [1, 0]);  permute_85 = None
        mm_555 = torch.ops.aten.mm.default(view_2181, permute_1460);  view_2181 = permute_1460 = None
        convert_element_type_3018 = torch.ops.prims.convert_element_type.default(mm_554, torch.float32);  mm_554 = None
        reduce_scatter_tensor_296 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3018, 'avg', 64, '0');  convert_element_type_3018 = None
        wait_tensor_897 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_296);  reduce_scatter_tensor_296 = None
        convert_element_type_297 = torch.ops.prims.convert_element_type.default(mm_44, torch.float32);  mm_44 = None
        neg_10 = torch.ops.aten.neg.default(convert_element_type_297)
        exp_15 = torch.ops.aten.exp.default(neg_10);  neg_10 = None
        add_340 = torch.ops.aten.add.Tensor(exp_15, 1);  exp_15 = None
        div_25 = torch.ops.aten.div.Tensor(convert_element_type_297, add_340)
        convert_element_type_298 = torch.ops.prims.convert_element_type.default(div_25, torch.bfloat16);  div_25 = None
        mul_2005 = torch.ops.aten.mul.Tensor(mm_555, convert_element_type_298);  convert_element_type_298 = None
        mul_2006 = torch.ops.aten.mul.Tensor(mm_555, mm_45);  mm_555 = mm_45 = None
        permute_1462 = torch.ops.aten.permute.default(mul_2005, [1, 0])
        mm_556 = torch.ops.aten.mm.default(permute_1462, view_326);  permute_1462 = None
        convert_element_type_299 = torch.ops.prims.convert_element_type.default(primals_101, torch.bfloat16);  primals_101 = None
        all_gather_into_tensor_94 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_299, 64, '0');  convert_element_type_299 = None
        wait_tensor_114 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_94);  all_gather_into_tensor_94 = None
        permute_84 = torch.ops.aten.permute.default(wait_tensor_114, [1, 0]);  wait_tensor_114 = None
        permute_1464 = torch.ops.aten.permute.default(permute_84, [1, 0]);  permute_84 = None
        mm_557 = torch.ops.aten.mm.default(mul_2005, permute_1464);  mul_2005 = permute_1464 = None
        convert_element_type_3023 = torch.ops.prims.convert_element_type.default(mm_556, torch.float32);  mm_556 = None
        reduce_scatter_tensor_297 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3023, 'avg', 64, '0');  convert_element_type_3023 = None
        wait_tensor_898 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_297);  reduce_scatter_tensor_297 = None
        convert_element_type_3024 = torch.ops.prims.convert_element_type.default(mul_2006, torch.float32);  mul_2006 = None
        reciprocal_42 = torch.ops.aten.reciprocal.default(add_340);  add_340 = None
        mul_2007 = torch.ops.aten.mul.Tensor(reciprocal_42, 1);  reciprocal_42 = None
        mul_2008 = torch.ops.aten.mul.Tensor(convert_element_type_3024, mul_2007);  convert_element_type_3024 = None
        sub_751 = torch.ops.aten.sub.Tensor(1, mul_2007);  mul_2007 = None
        mul_2009 = torch.ops.aten.mul.Tensor(convert_element_type_297, sub_751);  convert_element_type_297 = sub_751 = None
        add_2091 = torch.ops.aten.add.Tensor(mul_2009, 1);  mul_2009 = None
        mul_2010 = torch.ops.aten.mul.Tensor(mul_2008, add_2091);  mul_2008 = add_2091 = None
        convert_element_type_3026 = torch.ops.prims.convert_element_type.default(mul_2010, torch.bfloat16);  mul_2010 = None
        permute_1466 = torch.ops.aten.permute.default(convert_element_type_3026, [1, 0])
        mm_558 = torch.ops.aten.mm.default(permute_1466, view_326);  permute_1466 = None
        convert_element_type_294 = torch.ops.prims.convert_element_type.default(primals_100, torch.bfloat16);  primals_100 = None
        all_gather_into_tensor_93 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_294, 64, '0');  convert_element_type_294 = None
        wait_tensor_113 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_93);  all_gather_into_tensor_93 = None
        permute_83 = torch.ops.aten.permute.default(wait_tensor_113, [1, 0]);  wait_tensor_113 = None
        permute_1468 = torch.ops.aten.permute.default(permute_83, [1, 0]);  permute_83 = None
        mm_559 = torch.ops.aten.mm.default(convert_element_type_3026, permute_1468);  convert_element_type_3026 = permute_1468 = None
        add_2092 = torch.ops.aten.add.Tensor(mm_557, mm_559);  mm_557 = mm_559 = None
        convert_element_type_3031 = torch.ops.prims.convert_element_type.default(mm_558, torch.float32);  mm_558 = None
        reduce_scatter_tensor_298 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3031, 'avg', 64, '0');  convert_element_type_3031 = None
        wait_tensor_899 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_298);  reduce_scatter_tensor_298 = None
        all_to_all_single_120 = torch.ops._c10d_functional.all_to_all_single.default(index_94, [_local_scalar_dense_72, _local_scalar_dense_73, _local_scalar_dense_74, _local_scalar_dense_75, _local_scalar_dense_76, _local_scalar_dense_77, _local_scalar_dense_78, _local_scalar_dense_79], [_local_scalar_dense_64, _local_scalar_dense_65, _local_scalar_dense_66, _local_scalar_dense_67, _local_scalar_dense_68, _local_scalar_dense_69, _local_scalar_dense_70, _local_scalar_dense_71], '521');  index_94 = None
        wait_tensor_900 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_120);  all_to_all_single_120 = None
        full_432 = torch.ops.aten.full.default([sym_size_int_17, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_17 = None
        slice_scatter_21 = torch.ops.aten.slice_scatter.default(full_432, wait_tensor_900, 0, 0, -1);  wait_tensor_900 = None
        index_95 = torch.ops.aten.index.Tensor(slice_scatter_21, [getitem_78]);  slice_scatter_21 = None
        permute_1470 = torch.ops.aten.permute.default(index_95, [1, 0])
        _grouped_mm_204 = torch.ops.aten._grouped_mm.default(permute_1470, mul_231, cumsum_14);  permute_1470 = mul_231 = None
        convert_element_type_288 = torch.ops.prims.convert_element_type.default(primals_98, torch.bfloat16);  primals_98 = None
        all_gather_into_tensor_89 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_288, 8, '513');  convert_element_type_288 = None
        wait_tensor_108 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_89);  all_gather_into_tensor_89 = None
        permute_82 = torch.ops.aten.permute.default(wait_tensor_108, [0, 2, 1]);  wait_tensor_108 = None
        permute_1472 = torch.ops.aten.permute.default(permute_82, [0, 2, 1]);  permute_82 = None
        _grouped_mm_205 = torch.ops.aten._grouped_mm.default(index_95, permute_1472, cumsum_14);  index_95 = permute_1472 = None
        convert_element_type_292 = torch.ops.prims.convert_element_type.default(_grouped_mm_12, torch.float32);  _grouped_mm_12 = None
        neg_9 = torch.ops.aten.neg.default(convert_element_type_292)
        exp_14 = torch.ops.aten.exp.default(neg_9);  neg_9 = None
        add_304 = torch.ops.aten.add.Tensor(exp_14, 1);  exp_14 = None
        div_24 = torch.ops.aten.div.Tensor(convert_element_type_292, add_304)
        convert_element_type_293 = torch.ops.prims.convert_element_type.default(div_24, torch.bfloat16);  div_24 = None
        mul_2011 = torch.ops.aten.mul.Tensor(_grouped_mm_205, convert_element_type_293);  convert_element_type_293 = None
        mul_2012 = torch.ops.aten.mul.Tensor(_grouped_mm_205, _grouped_mm_13);  _grouped_mm_205 = _grouped_mm_13 = None
        permute_1474 = torch.ops.aten.permute.default(mul_2011, [1, 0])
        _grouped_mm_206 = torch.ops.aten._grouped_mm.default(permute_1474, index_9, cumsum_14);  permute_1474 = None
        convert_element_type_289 = torch.ops.prims.convert_element_type.default(primals_99, torch.bfloat16);  primals_99 = None
        all_gather_into_tensor_90 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_289, 8, '513');  convert_element_type_289 = None
        wait_tensor_109 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_90);  all_gather_into_tensor_90 = None
        permute_81 = torch.ops.aten.permute.default(wait_tensor_109, [0, 2, 1]);  wait_tensor_109 = None
        permute_1476 = torch.ops.aten.permute.default(permute_81, [0, 2, 1]);  permute_81 = None
        _grouped_mm_207 = torch.ops.aten._grouped_mm.default(mul_2011, permute_1476, cumsum_14);  mul_2011 = permute_1476 = None
        convert_element_type_3032 = torch.ops.prims.convert_element_type.default(mul_2012, torch.float32);  mul_2012 = None
        reciprocal_43 = torch.ops.aten.reciprocal.default(add_304);  add_304 = None
        mul_2013 = torch.ops.aten.mul.Tensor(reciprocal_43, 1);  reciprocal_43 = None
        mul_2014 = torch.ops.aten.mul.Tensor(convert_element_type_3032, mul_2013);  convert_element_type_3032 = None
        sub_752 = torch.ops.aten.sub.Tensor(1, mul_2013);  mul_2013 = None
        mul_2015 = torch.ops.aten.mul.Tensor(convert_element_type_292, sub_752);  convert_element_type_292 = sub_752 = None
        add_2094 = torch.ops.aten.add.Tensor(mul_2015, 1);  mul_2015 = None
        mul_2016 = torch.ops.aten.mul.Tensor(mul_2014, add_2094);  mul_2014 = add_2094 = None
        convert_element_type_3034 = torch.ops.prims.convert_element_type.default(mul_2016, torch.bfloat16);  mul_2016 = None
        permute_1478 = torch.ops.aten.permute.default(convert_element_type_3034, [1, 0])
        _grouped_mm_208 = torch.ops.aten._grouped_mm.default(permute_1478, index_9, cumsum_14);  permute_1478 = index_9 = None
        convert_element_type_286 = torch.ops.prims.convert_element_type.default(primals_97, torch.bfloat16);  primals_97 = None
        all_gather_into_tensor_87 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_286, 8, '513');  convert_element_type_286 = None
        wait_tensor_106 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_87);  all_gather_into_tensor_87 = None
        permute_80 = torch.ops.aten.permute.default(wait_tensor_106, [0, 2, 1]);  wait_tensor_106 = None
        permute_1480 = torch.ops.aten.permute.default(permute_80, [0, 2, 1]);  permute_80 = None
        _grouped_mm_209 = torch.ops.aten._grouped_mm.default(convert_element_type_3034, permute_1480, cumsum_14);  convert_element_type_3034 = permute_1480 = cumsum_14 = None
        add_2095 = torch.ops.aten.add.Tensor(_grouped_mm_207, _grouped_mm_209);  _grouped_mm_207 = _grouped_mm_209 = None
        convert_element_type_3035 = torch.ops.prims.convert_element_type.default(_grouped_mm_206, torch.float32);  _grouped_mm_206 = None
        div_258 = torch.ops.aten.div.Tensor(convert_element_type_3035, 64);  convert_element_type_3035 = None
        reduce_scatter_tensor_299 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_258, 'sum', 8, '513');  div_258 = None
        wait_tensor_901 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_299);  reduce_scatter_tensor_299 = None
        convert_element_type_3036 = torch.ops.prims.convert_element_type.default(_grouped_mm_204, torch.float32);  _grouped_mm_204 = None
        div_259 = torch.ops.aten.div.Tensor(convert_element_type_3036, 64);  convert_element_type_3036 = None
        reduce_scatter_tensor_300 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_259, 'sum', 8, '513');  div_259 = None
        wait_tensor_902 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_300);  reduce_scatter_tensor_300 = None
        convert_element_type_3037 = torch.ops.prims.convert_element_type.default(_grouped_mm_208, torch.float32);  _grouped_mm_208 = None
        div_260 = torch.ops.aten.div.Tensor(convert_element_type_3037, 64);  convert_element_type_3037 = None
        reduce_scatter_tensor_301 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_260, 'sum', 8, '513');  div_260 = None
        wait_tensor_903 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_301);  reduce_scatter_tensor_301 = None
        index_put_94 = torch.ops.aten.index_put.default(full_432, [getitem_78], add_2095, True);  full_432 = getitem_78 = add_2095 = None
        slice_233 = torch.ops.aten.slice.Tensor(index_put_94, 0, 0, add_2096);  index_put_94 = add_2096 = None
        all_to_all_single_121 = torch.ops._c10d_functional.all_to_all_single.default(slice_233, [_local_scalar_dense_64, _local_scalar_dense_65, _local_scalar_dense_66, _local_scalar_dense_67, _local_scalar_dense_68, _local_scalar_dense_69, _local_scalar_dense_70, _local_scalar_dense_71], [_local_scalar_dense_72, _local_scalar_dense_73, _local_scalar_dense_74, _local_scalar_dense_75, _local_scalar_dense_76, _local_scalar_dense_77, _local_scalar_dense_78, _local_scalar_dense_79], '521');  slice_233 = _local_scalar_dense_64 = _local_scalar_dense_65 = _local_scalar_dense_66 = _local_scalar_dense_67 = _local_scalar_dense_68 = _local_scalar_dense_69 = _local_scalar_dense_70 = _local_scalar_dense_71 = _local_scalar_dense_72 = _local_scalar_dense_73 = _local_scalar_dense_74 = _local_scalar_dense_75 = _local_scalar_dense_76 = _local_scalar_dense_77 = _local_scalar_dense_78 = _local_scalar_dense_79 = None
        wait_tensor_904 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_121);  all_to_all_single_121 = None
        index_put_95 = torch.ops.aten.index_put.default(full_default_52, [div_22], wait_tensor_904, True);  div_22 = wait_tensor_904 = None
        add_2100 = torch.ops.aten.add.Tensor(add_2092, index_put_95);  add_2092 = index_put_95 = None
        mul_2017 = torch.ops.aten.mul.Tensor(view_2182, 1.0);  view_2182 = None
        scatter_add_21 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_75, mul_2017);  getitem_75 = mul_2017 = None
        convert_element_type_281 = torch.ops.prims.convert_element_type.default(mm_43, torch.float32);  mm_43 = None
        sub_96 = torch.ops.aten.sub.Tensor(convert_element_type_281, amax_4);  convert_element_type_281 = amax_4 = None
        exp_13 = torch.ops.aten.exp.default(sub_96);  sub_96 = None
        div_21 = torch.ops.aten.div.Tensor(exp_13, sum_17);  exp_13 = sum_17 = None
        mul_2018 = torch.ops.aten.mul.Tensor(scatter_add_21, div_21);  scatter_add_21 = None
        sum_275 = torch.ops.aten.sum.dim_IntList(mul_2018, [1], True)
        neg_118 = torch.ops.aten.neg.default(div_21);  div_21 = None
        fma_21 = torch.ops.prims.fma.default(neg_118, sum_275, mul_2018);  neg_118 = sum_275 = mul_2018 = None
        convert_element_type_3038 = torch.ops.prims.convert_element_type.default(fma_21, torch.bfloat16);  fma_21 = None
        permute_1482 = torch.ops.aten.permute.default(convert_element_type_3038, [1, 0])
        mm_560 = torch.ops.aten.mm.default(permute_1482, view_326);  permute_1482 = view_326 = None
        convert_element_type_278 = torch.ops.prims.convert_element_type.default(primals_95, torch.bfloat16);  primals_95 = None
        all_gather_into_tensor_86 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_278, 64, '0');  convert_element_type_278 = None
        wait_tensor_102 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_86);  all_gather_into_tensor_86 = None
        permute_79 = torch.ops.aten.permute.default(wait_tensor_102, [1, 0]);  wait_tensor_102 = None
        permute_1484 = torch.ops.aten.permute.default(permute_79, [1, 0]);  permute_79 = None
        mm_561 = torch.ops.aten.mm.default(convert_element_type_3038, permute_1484);  convert_element_type_3038 = permute_1484 = None
        add_2101 = torch.ops.aten.add.Tensor(add_2100, mm_561);  add_2100 = mm_561 = None
        convert_element_type_3043 = torch.ops.prims.convert_element_type.default(mm_560, torch.float32);  mm_560 = None
        reduce_scatter_tensor_302 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3043, 'avg', 64, '0');  convert_element_type_3043 = None
        wait_tensor_905 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_302);  reduce_scatter_tensor_302 = None
        view_2184 = torch.ops.aten.view.default(add_2101, [2, 4096, 2048]);  add_2101 = None
        convert_element_type_3044 = torch.ops.prims.convert_element_type.default(view_2184, torch.float32);  view_2184 = None
        convert_element_type_275 = torch.ops.prims.convert_element_type.default(primals_93, torch.bfloat16);  primals_93 = None
        all_gather_into_tensor_85 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_275, 64, '0');  convert_element_type_275 = None
        wait_tensor_101 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_85);  all_gather_into_tensor_85 = None
        convert_element_type_3046 = torch.ops.prims.convert_element_type.default(wait_tensor_101, torch.float32);  wait_tensor_101 = None
        mul_2019 = torch.ops.aten.mul.Tensor(convert_element_type_3044, convert_element_type_3046);  convert_element_type_3046 = None
        convert_element_type_276 = torch.ops.prims.convert_element_type.default(add_280, torch.float32);  add_280 = None
        mul_211 = torch.ops.aten.mul.Tensor(convert_element_type_276, rsqrt_17);  convert_element_type_276 = None
        mul_2021 = torch.ops.aten.mul.Tensor(mul_211, mul_2019)
        sum_276 = torch.ops.aten.sum.dim_IntList(mul_2021, [2], True);  mul_2021 = None
        div_261 = torch.ops.aten.div.Tensor(mul_211, 2048)
        mul_2022 = torch.ops.aten.mul.Tensor(div_261, sum_276);  div_261 = sum_276 = None
        sub_754 = torch.ops.aten.sub.Tensor(mul_2019, mul_2022);  mul_2019 = mul_2022 = None
        mul_2023 = torch.ops.aten.mul.Tensor(sub_754, rsqrt_17);  sub_754 = rsqrt_17 = None
        mul_2024 = torch.ops.aten.mul.Tensor(convert_element_type_3044, mul_211);  convert_element_type_3044 = mul_211 = None
        sum_277 = torch.ops.aten.sum.dim_IntList(mul_2024, [0, 1]);  mul_2024 = None
        convert_element_type_3047 = torch.ops.prims.convert_element_type.default(mul_2023, torch.bfloat16);  mul_2023 = None
        add_2102 = torch.ops.aten.add.Tensor(add_2089, convert_element_type_3047);  add_2089 = convert_element_type_3047 = None
        convert_element_type_default_18 = torch.ops.prims.convert_element_type.default(sum_277, torch.float32);  sum_277 = None
        reduce_scatter_tensor_303 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_18, 'avg', 64, '0');  convert_element_type_default_18 = None
        wait_tensor_906 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_303);  reduce_scatter_tensor_303 = None
        view_2185 = torch.ops.aten.view.default(add_2102, [8192, 2048])
        permute_1486 = torch.ops.aten.permute.default(view_2185, [1, 0])
        permute_77 = torch.ops.aten.permute.default(getitem_71, [0, 2, 1, 3])
        view_321 = torch.ops.aten.view.default(permute_77, [2, 4096, -1]);  permute_77 = None
        view_323 = torch.ops.aten.view.default(view_321, [8192, 2048]);  view_321 = None
        mm_562 = torch.ops.aten.mm.default(permute_1486, view_323);  permute_1486 = view_323 = None
        convert_element_type_272 = torch.ops.prims.convert_element_type.default(primals_92, torch.bfloat16);  primals_92 = None
        all_gather_into_tensor_84 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_272, 64, '0');  convert_element_type_272 = None
        wait_tensor_100 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_84);  all_gather_into_tensor_84 = None
        permute_78 = torch.ops.aten.permute.default(wait_tensor_100, [1, 0]);  wait_tensor_100 = None
        permute_1488 = torch.ops.aten.permute.default(permute_78, [1, 0]);  permute_78 = None
        mm_563 = torch.ops.aten.mm.default(view_2185, permute_1488);  view_2185 = permute_1488 = None
        view_2186 = torch.ops.aten.view.default(mm_563, [2, 4096, 2048]);  mm_563 = None
        convert_element_type_3054 = torch.ops.prims.convert_element_type.default(mm_562, torch.float32);  mm_562 = None
        reduce_scatter_tensor_304 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3054, 'avg', 64, '0');  convert_element_type_3054 = None
        wait_tensor_907 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_304);  reduce_scatter_tensor_304 = None
        view_2187 = torch.ops.aten.view.default(view_2186, [2, 4096, 16, 128]);  view_2186 = None
        permute_1490 = torch.ops.aten.permute.default(view_2187, [0, 2, 1, 3]);  view_2187 = None
        fw_graph21 = self.fw_graph21
        joint_graph21 = self.joint_graph21
        mask_graph21 = self.mask_graph21
        flex_attention_backward_21 = torch.ops.higher_order.flex_attention_backward(permute_74, permute_75, permute_76, getitem_71, getitem_72, permute_1490, None, fw_graph21, joint_graph21, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph21), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_74 = permute_75 = permute_76 = getitem_71 = getitem_72 = permute_1490 = fw_graph21 = joint_graph21 = mask_graph21 = None
        getitem_457 = flex_attention_backward_21[0]
        getitem_458 = flex_attention_backward_21[1]
        getitem_459 = flex_attention_backward_21[2];  flex_attention_backward_21 = None
        permute_1491 = torch.ops.aten.permute.default(getitem_459, [0, 2, 1, 3]);  getitem_459 = None
        permute_1492 = torch.ops.aten.permute.default(getitem_458, [0, 2, 1, 3]);  getitem_458 = None
        permute_1493 = torch.ops.aten.permute.default(getitem_457, [0, 2, 1, 3]);  getitem_457 = None
        slice_235 = torch.ops.aten.slice.Tensor(permute_1492, 3, 0, 128)
        slice_236 = torch.ops.aten.slice.Tensor(permute_1492, 3, 128, 192);  permute_1492 = None
        sum_278 = torch.ops.aten.sum.dim_IntList(slice_236, [2], True);  slice_236 = None
        cat_143 = torch.ops.aten.cat.default([slice_235, permute_1491], 3);  slice_235 = permute_1491 = None
        view_2188 = torch.ops.aten.view.default(cat_143, [2, 4096, 4096]);  cat_143 = None
        view_2189 = torch.ops.aten.view.default(view_2188, [8192, 4096]);  view_2188 = None
        permute_1494 = torch.ops.aten.permute.default(view_2189, [1, 0])
        mm_564 = torch.ops.aten.mm.default(permute_1494, view_318);  permute_1494 = view_318 = None
        convert_element_type_269 = torch.ops.prims.convert_element_type.default(primals_91, torch.bfloat16);  primals_91 = None
        all_gather_into_tensor_83 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_269, 64, '0');  convert_element_type_269 = None
        wait_tensor_99 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_83);  all_gather_into_tensor_83 = None
        permute_73 = torch.ops.aten.permute.default(wait_tensor_99, [1, 0]);  wait_tensor_99 = None
        permute_1496 = torch.ops.aten.permute.default(permute_73, [1, 0]);  permute_73 = None
        mm_565 = torch.ops.aten.mm.default(view_2189, permute_1496);  view_2189 = permute_1496 = None
        view_2190 = torch.ops.aten.view.default(mm_565, [2, 4096, 512]);  mm_565 = None
        convert_element_type_3059 = torch.ops.prims.convert_element_type.default(mm_564, torch.float32);  mm_564 = None
        reduce_scatter_tensor_305 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3059, 'avg', 64, '0');  convert_element_type_3059 = None
        wait_tensor_908 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_305);  reduce_scatter_tensor_305 = None
        convert_element_type_3060 = torch.ops.prims.convert_element_type.default(view_2190, torch.float32);  view_2190 = None
        convert_element_type_266 = torch.ops.prims.convert_element_type.default(primals_90, torch.bfloat16);  primals_90 = None
        all_gather_into_tensor_82 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_266, 64, '0');  convert_element_type_266 = None
        wait_tensor_98 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_82);  all_gather_into_tensor_82 = None
        convert_element_type_3062 = torch.ops.prims.convert_element_type.default(wait_tensor_98, torch.float32);  wait_tensor_98 = None
        mul_2025 = torch.ops.aten.mul.Tensor(convert_element_type_3060, convert_element_type_3062);  convert_element_type_3062 = None
        convert_element_type_267 = torch.ops.prims.convert_element_type.default(getitem_67, torch.float32);  getitem_67 = None
        mul_209 = torch.ops.aten.mul.Tensor(convert_element_type_267, rsqrt_16);  convert_element_type_267 = None
        mul_2027 = torch.ops.aten.mul.Tensor(mul_209, mul_2025)
        sum_279 = torch.ops.aten.sum.dim_IntList(mul_2027, [2], True);  mul_2027 = None
        div_262 = torch.ops.aten.div.Tensor(mul_209, 512)
        mul_2028 = torch.ops.aten.mul.Tensor(div_262, sum_279);  div_262 = sum_279 = None
        sub_755 = torch.ops.aten.sub.Tensor(mul_2025, mul_2028);  mul_2025 = mul_2028 = None
        mul_2029 = torch.ops.aten.mul.Tensor(sub_755, rsqrt_16);  sub_755 = rsqrt_16 = None
        mul_2030 = torch.ops.aten.mul.Tensor(convert_element_type_3060, mul_209);  convert_element_type_3060 = mul_209 = None
        sum_280 = torch.ops.aten.sum.dim_IntList(mul_2030, [0, 1]);  mul_2030 = None
        convert_element_type_3063 = torch.ops.prims.convert_element_type.default(mul_2029, torch.bfloat16);  mul_2029 = None
        convert_element_type_default_17 = torch.ops.prims.convert_element_type.default(sum_280, torch.float32);  sum_280 = None
        reduce_scatter_tensor_306 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_17, 'avg', 64, '0');  convert_element_type_default_17 = None
        wait_tensor_909 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_306);  reduce_scatter_tensor_306 = None
        convert_element_type_3066 = torch.ops.prims.convert_element_type.default(sum_278, torch.float32);  sum_278 = None
        view_2191 = torch.ops.aten.view.default(convert_element_type_3066, [2, 4096, 1, 32, 2]);  convert_element_type_3066 = None
        view_as_complex_96 = torch.ops.aten.view_as_complex.default(view_2191);  view_2191 = None
        mul_2031 = torch.ops.aten.mul.Tensor(view_as_complex_96, clone_9);  view_as_complex_96 = None
        view_as_real_96 = torch.ops.aten.view_as_real.default(mul_2031);  mul_2031 = None
        view_2192 = torch.ops.aten.view.default(view_as_real_96, [2, 4096, 1, 64]);  view_as_real_96 = None
        convert_element_type_3067 = torch.ops.prims.convert_element_type.default(view_2192, torch.bfloat16);  view_2192 = None
        squeeze_47 = torch.ops.aten.squeeze.dim(convert_element_type_3067, 2);  convert_element_type_3067 = None
        cat_144 = torch.ops.aten.cat.default([convert_element_type_3063, squeeze_47], 2);  convert_element_type_3063 = squeeze_47 = None
        view_2193 = torch.ops.aten.view.default(cat_144, [8192, 576]);  cat_144 = None
        permute_1498 = torch.ops.aten.permute.default(view_2193, [1, 0])
        mm_566 = torch.ops.aten.mm.default(permute_1498, view_304);  permute_1498 = None
        convert_element_type_261 = torch.ops.prims.convert_element_type.default(primals_89, torch.bfloat16);  primals_89 = None
        all_gather_into_tensor_81 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_261, 64, '0');  convert_element_type_261 = None
        wait_tensor_97 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_81);  all_gather_into_tensor_81 = None
        permute_72 = torch.ops.aten.permute.default(wait_tensor_97, [1, 0]);  wait_tensor_97 = None
        permute_1500 = torch.ops.aten.permute.default(permute_72, [1, 0]);  permute_72 = None
        mm_567 = torch.ops.aten.mm.default(view_2193, permute_1500);  view_2193 = permute_1500 = None
        view_2194 = torch.ops.aten.view.default(mm_567, [2, 4096, 2048]);  mm_567 = None
        convert_element_type_3072 = torch.ops.prims.convert_element_type.default(mm_566, torch.float32);  mm_566 = None
        reduce_scatter_tensor_307 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3072, 'avg', 64, '0');  convert_element_type_3072 = None
        wait_tensor_910 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_307);  reduce_scatter_tensor_307 = None
        slice_237 = torch.ops.aten.slice.Tensor(permute_1493, 3, 0, 128)
        slice_238 = torch.ops.aten.slice.Tensor(permute_1493, 3, 128, 192);  permute_1493 = None
        convert_element_type_3073 = torch.ops.prims.convert_element_type.default(slice_238, torch.float32);  slice_238 = None
        view_2195 = torch.ops.aten.view.default(convert_element_type_3073, [2, 4096, 16, 32, 2]);  convert_element_type_3073 = None
        view_as_complex_97 = torch.ops.aten.view_as_complex.default(view_2195);  view_2195 = None
        mul_2032 = torch.ops.aten.mul.Tensor(view_as_complex_97, clone_9);  view_as_complex_97 = None
        view_as_real_97 = torch.ops.aten.view_as_real.default(mul_2032);  mul_2032 = None
        view_2196 = torch.ops.aten.view.default(view_as_real_97, [2, 4096, 16, 64]);  view_as_real_97 = None
        convert_element_type_3074 = torch.ops.prims.convert_element_type.default(view_2196, torch.bfloat16);  view_2196 = None
        cat_145 = torch.ops.aten.cat.default([slice_237, convert_element_type_3074], 3);  slice_237 = convert_element_type_3074 = None
        view_2197 = torch.ops.aten.view.default(cat_145, [2, 4096, 3072]);  cat_145 = None
        view_2198 = torch.ops.aten.view.default(view_2197, [8192, 3072]);  view_2197 = None
        permute_1502 = torch.ops.aten.permute.default(view_2198, [1, 0])
        mm_568 = torch.ops.aten.mm.default(permute_1502, view_304);  permute_1502 = view_304 = None
        convert_element_type_256 = torch.ops.prims.convert_element_type.default(primals_88, torch.bfloat16);  primals_88 = None
        all_gather_into_tensor_80 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_256, 64, '0');  convert_element_type_256 = None
        wait_tensor_96 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_80);  all_gather_into_tensor_80 = None
        permute_71 = torch.ops.aten.permute.default(wait_tensor_96, [1, 0]);  wait_tensor_96 = None
        permute_1504 = torch.ops.aten.permute.default(permute_71, [1, 0]);  permute_71 = None
        mm_569 = torch.ops.aten.mm.default(view_2198, permute_1504);  view_2198 = permute_1504 = None
        view_2199 = torch.ops.aten.view.default(mm_569, [2, 4096, 2048]);  mm_569 = None
        add_2103 = torch.ops.aten.add.Tensor(view_2194, view_2199);  view_2194 = view_2199 = None
        convert_element_type_3079 = torch.ops.prims.convert_element_type.default(mm_568, torch.float32);  mm_568 = None
        reduce_scatter_tensor_308 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3079, 'avg', 64, '0');  convert_element_type_3079 = None
        wait_tensor_911 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_308);  reduce_scatter_tensor_308 = None
        convert_element_type_3080 = torch.ops.prims.convert_element_type.default(add_2103, torch.float32);  add_2103 = None
        convert_element_type_253 = torch.ops.prims.convert_element_type.default(primals_87, torch.bfloat16);  primals_87 = None
        all_gather_into_tensor_79 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_253, 64, '0');  convert_element_type_253 = None
        wait_tensor_95 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_79);  all_gather_into_tensor_79 = None
        convert_element_type_3082 = torch.ops.prims.convert_element_type.default(wait_tensor_95, torch.float32);  wait_tensor_95 = None
        mul_2033 = torch.ops.aten.mul.Tensor(convert_element_type_3080, convert_element_type_3082);  convert_element_type_3082 = None
        convert_element_type_254 = torch.ops.prims.convert_element_type.default(add_277, torch.float32);  add_277 = None
        mul_205 = torch.ops.aten.mul.Tensor(convert_element_type_254, rsqrt_15);  convert_element_type_254 = None
        mul_2035 = torch.ops.aten.mul.Tensor(mul_205, mul_2033)
        sum_281 = torch.ops.aten.sum.dim_IntList(mul_2035, [2], True);  mul_2035 = None
        div_263 = torch.ops.aten.div.Tensor(mul_205, 2048)
        mul_2036 = torch.ops.aten.mul.Tensor(div_263, sum_281);  div_263 = sum_281 = None
        sub_756 = torch.ops.aten.sub.Tensor(mul_2033, mul_2036);  mul_2033 = mul_2036 = None
        mul_2037 = torch.ops.aten.mul.Tensor(sub_756, rsqrt_15);  sub_756 = rsqrt_15 = None
        mul_2038 = torch.ops.aten.mul.Tensor(convert_element_type_3080, mul_205);  convert_element_type_3080 = mul_205 = None
        sum_282 = torch.ops.aten.sum.dim_IntList(mul_2038, [0, 1]);  mul_2038 = None
        convert_element_type_3083 = torch.ops.prims.convert_element_type.default(mul_2037, torch.bfloat16);  mul_2037 = None
        add_2104 = torch.ops.aten.add.Tensor(add_2102, convert_element_type_3083);  add_2102 = convert_element_type_3083 = None
        convert_element_type_default_16 = torch.ops.prims.convert_element_type.default(sum_282, torch.float32);  sum_282 = None
        reduce_scatter_tensor_309 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_16, 'avg', 64, '0');  convert_element_type_default_16 = None
        wait_tensor_912 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_309);  reduce_scatter_tensor_309 = None
        view_2200 = torch.ops.aten.view.default(add_2104, [8192, 2048])
        unsqueeze_75 = torch.ops.aten.unsqueeze.default(view_2200, 1)
        convert_element_type_3086 = torch.ops.prims.convert_element_type.default(unsqueeze_75, torch.float32);  unsqueeze_75 = None
        bmm_70 = torch.ops.aten.bmm.default(permute_1506, convert_element_type_3086);  permute_1506 = None
        bmm_71 = torch.ops.aten.bmm.default(convert_element_type_3086, permute_1507);  convert_element_type_3086 = permute_1507 = None
        convert_element_type_3087 = torch.ops.prims.convert_element_type.default(bmm_70, torch.bfloat16);  bmm_70 = None
        view_2201 = torch.ops.aten.view.default(bmm_71, [8192, 6]);  bmm_71 = None
        view_2202 = torch.ops.aten.view.default(convert_element_type_3087, [49152, 2048]);  convert_element_type_3087 = None
        index_96 = torch.ops.aten.index.Tensor(view_2202, [getitem_63]);  view_2202 = getitem_63 = None
        permute_1508 = torch.ops.aten.permute.default(view_2200, [1, 0])
        mm_570 = torch.ops.aten.mm.default(permute_1508, mul_202);  permute_1508 = mul_202 = None
        convert_element_type_248 = torch.ops.prims.convert_element_type.default(primals_86, torch.bfloat16);  primals_86 = None
        all_gather_into_tensor_78 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_248, 64, '0');  convert_element_type_248 = None
        wait_tensor_94 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_78);  all_gather_into_tensor_78 = None
        permute_70 = torch.ops.aten.permute.default(wait_tensor_94, [1, 0]);  wait_tensor_94 = None
        permute_1510 = torch.ops.aten.permute.default(permute_70, [1, 0]);  permute_70 = None
        mm_571 = torch.ops.aten.mm.default(view_2200, permute_1510);  view_2200 = permute_1510 = None
        convert_element_type_3092 = torch.ops.prims.convert_element_type.default(mm_570, torch.float32);  mm_570 = None
        reduce_scatter_tensor_310 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3092, 'avg', 64, '0');  convert_element_type_3092 = None
        wait_tensor_913 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_310);  reduce_scatter_tensor_310 = None
        convert_element_type_243 = torch.ops.prims.convert_element_type.default(mm_36, torch.float32);  mm_36 = None
        neg_8 = torch.ops.aten.neg.default(convert_element_type_243)
        exp_12 = torch.ops.aten.exp.default(neg_8);  neg_8 = None
        add_272 = torch.ops.aten.add.Tensor(exp_12, 1);  exp_12 = None
        div_20 = torch.ops.aten.div.Tensor(convert_element_type_243, add_272)
        convert_element_type_244 = torch.ops.prims.convert_element_type.default(div_20, torch.bfloat16);  div_20 = None
        mul_2039 = torch.ops.aten.mul.Tensor(mm_571, convert_element_type_244);  convert_element_type_244 = None
        mul_2040 = torch.ops.aten.mul.Tensor(mm_571, mm_37);  mm_571 = mm_37 = None
        permute_1512 = torch.ops.aten.permute.default(mul_2039, [1, 0])
        mm_572 = torch.ops.aten.mm.default(permute_1512, view_259);  permute_1512 = None
        convert_element_type_245 = torch.ops.prims.convert_element_type.default(primals_85, torch.bfloat16);  primals_85 = None
        all_gather_into_tensor_77 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_245, 64, '0');  convert_element_type_245 = None
        wait_tensor_93 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_77);  all_gather_into_tensor_77 = None
        permute_69 = torch.ops.aten.permute.default(wait_tensor_93, [1, 0]);  wait_tensor_93 = None
        permute_1514 = torch.ops.aten.permute.default(permute_69, [1, 0]);  permute_69 = None
        mm_573 = torch.ops.aten.mm.default(mul_2039, permute_1514);  mul_2039 = permute_1514 = None
        convert_element_type_3097 = torch.ops.prims.convert_element_type.default(mm_572, torch.float32);  mm_572 = None
        reduce_scatter_tensor_311 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3097, 'avg', 64, '0');  convert_element_type_3097 = None
        wait_tensor_914 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_311);  reduce_scatter_tensor_311 = None
        convert_element_type_3098 = torch.ops.prims.convert_element_type.default(mul_2040, torch.float32);  mul_2040 = None
        reciprocal_44 = torch.ops.aten.reciprocal.default(add_272);  add_272 = None
        mul_2041 = torch.ops.aten.mul.Tensor(reciprocal_44, 1);  reciprocal_44 = None
        mul_2042 = torch.ops.aten.mul.Tensor(convert_element_type_3098, mul_2041);  convert_element_type_3098 = None
        sub_757 = torch.ops.aten.sub.Tensor(1, mul_2041);  mul_2041 = None
        mul_2043 = torch.ops.aten.mul.Tensor(convert_element_type_243, sub_757);  convert_element_type_243 = sub_757 = None
        add_2106 = torch.ops.aten.add.Tensor(mul_2043, 1);  mul_2043 = None
        mul_2044 = torch.ops.aten.mul.Tensor(mul_2042, add_2106);  mul_2042 = add_2106 = None
        convert_element_type_3100 = torch.ops.prims.convert_element_type.default(mul_2044, torch.bfloat16);  mul_2044 = None
        permute_1516 = torch.ops.aten.permute.default(convert_element_type_3100, [1, 0])
        mm_574 = torch.ops.aten.mm.default(permute_1516, view_259);  permute_1516 = None
        convert_element_type_240 = torch.ops.prims.convert_element_type.default(primals_84, torch.bfloat16);  primals_84 = None
        all_gather_into_tensor_76 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_240, 64, '0');  convert_element_type_240 = None
        wait_tensor_92 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_76);  all_gather_into_tensor_76 = None
        permute_68 = torch.ops.aten.permute.default(wait_tensor_92, [1, 0]);  wait_tensor_92 = None
        permute_1518 = torch.ops.aten.permute.default(permute_68, [1, 0]);  permute_68 = None
        mm_575 = torch.ops.aten.mm.default(convert_element_type_3100, permute_1518);  convert_element_type_3100 = permute_1518 = None
        add_2107 = torch.ops.aten.add.Tensor(mm_573, mm_575);  mm_573 = mm_575 = None
        convert_element_type_3105 = torch.ops.prims.convert_element_type.default(mm_574, torch.float32);  mm_574 = None
        reduce_scatter_tensor_312 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3105, 'avg', 64, '0');  convert_element_type_3105 = None
        wait_tensor_915 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_312);  reduce_scatter_tensor_312 = None
        all_to_all_single_122 = torch.ops._c10d_functional.all_to_all_single.default(index_96, [_local_scalar_dense_56, _local_scalar_dense_57, _local_scalar_dense_58, _local_scalar_dense_59, _local_scalar_dense_60, _local_scalar_dense_61, _local_scalar_dense_62, _local_scalar_dense_63], [_local_scalar_dense_48, _local_scalar_dense_49, _local_scalar_dense_50, _local_scalar_dense_51, _local_scalar_dense_52, _local_scalar_dense_53, _local_scalar_dense_54, _local_scalar_dense_55], '521');  index_96 = None
        wait_tensor_916 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_122);  all_to_all_single_122 = None
        full_436 = torch.ops.aten.full.default([sym_size_int_13, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_13 = None
        slice_scatter_22 = torch.ops.aten.slice_scatter.default(full_436, wait_tensor_916, 0, 0, -1);  wait_tensor_916 = None
        index_97 = torch.ops.aten.index.Tensor(slice_scatter_22, [getitem_64]);  slice_scatter_22 = None
        permute_1520 = torch.ops.aten.permute.default(index_97, [1, 0])
        _grouped_mm_210 = torch.ops.aten._grouped_mm.default(permute_1520, mul_182, cumsum_11);  permute_1520 = mul_182 = None
        convert_element_type_234 = torch.ops.prims.convert_element_type.default(primals_82, torch.bfloat16);  primals_82 = None
        all_gather_into_tensor_72 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_234, 8, '513');  convert_element_type_234 = None
        wait_tensor_87 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_72);  all_gather_into_tensor_72 = None
        permute_67 = torch.ops.aten.permute.default(wait_tensor_87, [0, 2, 1]);  wait_tensor_87 = None
        permute_1522 = torch.ops.aten.permute.default(permute_67, [0, 2, 1]);  permute_67 = None
        _grouped_mm_211 = torch.ops.aten._grouped_mm.default(index_97, permute_1522, cumsum_11);  index_97 = permute_1522 = None
        convert_element_type_238 = torch.ops.prims.convert_element_type.default(_grouped_mm_9, torch.float32);  _grouped_mm_9 = None
        neg_7 = torch.ops.aten.neg.default(convert_element_type_238)
        exp_11 = torch.ops.aten.exp.default(neg_7);  neg_7 = None
        add_236 = torch.ops.aten.add.Tensor(exp_11, 1);  exp_11 = None
        div_19 = torch.ops.aten.div.Tensor(convert_element_type_238, add_236)
        convert_element_type_239 = torch.ops.prims.convert_element_type.default(div_19, torch.bfloat16);  div_19 = None
        mul_2045 = torch.ops.aten.mul.Tensor(_grouped_mm_211, convert_element_type_239);  convert_element_type_239 = None
        mul_2046 = torch.ops.aten.mul.Tensor(_grouped_mm_211, _grouped_mm_10);  _grouped_mm_211 = _grouped_mm_10 = None
        permute_1524 = torch.ops.aten.permute.default(mul_2045, [1, 0])
        _grouped_mm_212 = torch.ops.aten._grouped_mm.default(permute_1524, index_7, cumsum_11);  permute_1524 = None
        convert_element_type_235 = torch.ops.prims.convert_element_type.default(primals_83, torch.bfloat16);  primals_83 = None
        all_gather_into_tensor_73 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_235, 8, '513');  convert_element_type_235 = None
        wait_tensor_88 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_73);  all_gather_into_tensor_73 = None
        permute_66 = torch.ops.aten.permute.default(wait_tensor_88, [0, 2, 1]);  wait_tensor_88 = None
        permute_1526 = torch.ops.aten.permute.default(permute_66, [0, 2, 1]);  permute_66 = None
        _grouped_mm_213 = torch.ops.aten._grouped_mm.default(mul_2045, permute_1526, cumsum_11);  mul_2045 = permute_1526 = None
        convert_element_type_3106 = torch.ops.prims.convert_element_type.default(mul_2046, torch.float32);  mul_2046 = None
        reciprocal_45 = torch.ops.aten.reciprocal.default(add_236);  add_236 = None
        mul_2047 = torch.ops.aten.mul.Tensor(reciprocal_45, 1);  reciprocal_45 = None
        mul_2048 = torch.ops.aten.mul.Tensor(convert_element_type_3106, mul_2047);  convert_element_type_3106 = None
        sub_758 = torch.ops.aten.sub.Tensor(1, mul_2047);  mul_2047 = None
        mul_2049 = torch.ops.aten.mul.Tensor(convert_element_type_238, sub_758);  convert_element_type_238 = sub_758 = None
        add_2109 = torch.ops.aten.add.Tensor(mul_2049, 1);  mul_2049 = None
        mul_2050 = torch.ops.aten.mul.Tensor(mul_2048, add_2109);  mul_2048 = add_2109 = None
        convert_element_type_3108 = torch.ops.prims.convert_element_type.default(mul_2050, torch.bfloat16);  mul_2050 = None
        permute_1528 = torch.ops.aten.permute.default(convert_element_type_3108, [1, 0])
        _grouped_mm_214 = torch.ops.aten._grouped_mm.default(permute_1528, index_7, cumsum_11);  permute_1528 = index_7 = None
        convert_element_type_232 = torch.ops.prims.convert_element_type.default(primals_81, torch.bfloat16);  primals_81 = None
        all_gather_into_tensor_70 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_232, 8, '513');  convert_element_type_232 = None
        wait_tensor_85 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_70);  all_gather_into_tensor_70 = None
        permute_65 = torch.ops.aten.permute.default(wait_tensor_85, [0, 2, 1]);  wait_tensor_85 = None
        permute_1530 = torch.ops.aten.permute.default(permute_65, [0, 2, 1]);  permute_65 = None
        _grouped_mm_215 = torch.ops.aten._grouped_mm.default(convert_element_type_3108, permute_1530, cumsum_11);  convert_element_type_3108 = permute_1530 = cumsum_11 = None
        add_2110 = torch.ops.aten.add.Tensor(_grouped_mm_213, _grouped_mm_215);  _grouped_mm_213 = _grouped_mm_215 = None
        convert_element_type_3109 = torch.ops.prims.convert_element_type.default(_grouped_mm_212, torch.float32);  _grouped_mm_212 = None
        div_264 = torch.ops.aten.div.Tensor(convert_element_type_3109, 64);  convert_element_type_3109 = None
        reduce_scatter_tensor_313 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_264, 'sum', 8, '513');  div_264 = None
        wait_tensor_917 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_313);  reduce_scatter_tensor_313 = None
        convert_element_type_3110 = torch.ops.prims.convert_element_type.default(_grouped_mm_210, torch.float32);  _grouped_mm_210 = None
        div_265 = torch.ops.aten.div.Tensor(convert_element_type_3110, 64);  convert_element_type_3110 = None
        reduce_scatter_tensor_314 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_265, 'sum', 8, '513');  div_265 = None
        wait_tensor_918 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_314);  reduce_scatter_tensor_314 = None
        convert_element_type_3111 = torch.ops.prims.convert_element_type.default(_grouped_mm_214, torch.float32);  _grouped_mm_214 = None
        div_266 = torch.ops.aten.div.Tensor(convert_element_type_3111, 64);  convert_element_type_3111 = None
        reduce_scatter_tensor_315 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_266, 'sum', 8, '513');  div_266 = None
        wait_tensor_919 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_315);  reduce_scatter_tensor_315 = None
        index_put_96 = torch.ops.aten.index_put.default(full_436, [getitem_64], add_2110, True);  full_436 = getitem_64 = add_2110 = None
        slice_239 = torch.ops.aten.slice.Tensor(index_put_96, 0, 0, add_2111);  index_put_96 = add_2111 = None
        all_to_all_single_123 = torch.ops._c10d_functional.all_to_all_single.default(slice_239, [_local_scalar_dense_48, _local_scalar_dense_49, _local_scalar_dense_50, _local_scalar_dense_51, _local_scalar_dense_52, _local_scalar_dense_53, _local_scalar_dense_54, _local_scalar_dense_55], [_local_scalar_dense_56, _local_scalar_dense_57, _local_scalar_dense_58, _local_scalar_dense_59, _local_scalar_dense_60, _local_scalar_dense_61, _local_scalar_dense_62, _local_scalar_dense_63], '521');  slice_239 = _local_scalar_dense_48 = _local_scalar_dense_49 = _local_scalar_dense_50 = _local_scalar_dense_51 = _local_scalar_dense_52 = _local_scalar_dense_53 = _local_scalar_dense_54 = _local_scalar_dense_55 = _local_scalar_dense_56 = _local_scalar_dense_57 = _local_scalar_dense_58 = _local_scalar_dense_59 = _local_scalar_dense_60 = _local_scalar_dense_61 = _local_scalar_dense_62 = _local_scalar_dense_63 = None
        wait_tensor_920 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_123);  all_to_all_single_123 = None
        index_put_97 = torch.ops.aten.index_put.default(full_default_52, [div_17], wait_tensor_920, True);  div_17 = wait_tensor_920 = None
        add_2115 = torch.ops.aten.add.Tensor(add_2107, index_put_97);  add_2107 = index_put_97 = None
        mul_2051 = torch.ops.aten.mul.Tensor(view_2201, 1.0);  view_2201 = None
        scatter_add_22 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_61, mul_2051);  getitem_61 = mul_2051 = None
        convert_element_type_227 = torch.ops.prims.convert_element_type.default(mm_35, torch.float32);  mm_35 = None
        sub_72 = torch.ops.aten.sub.Tensor(convert_element_type_227, amax_3);  convert_element_type_227 = amax_3 = None
        exp_10 = torch.ops.aten.exp.default(sub_72);  sub_72 = None
        div_16 = torch.ops.aten.div.Tensor(exp_10, sum_13);  exp_10 = sum_13 = None
        mul_2052 = torch.ops.aten.mul.Tensor(scatter_add_22, div_16);  scatter_add_22 = None
        sum_283 = torch.ops.aten.sum.dim_IntList(mul_2052, [1], True)
        neg_121 = torch.ops.aten.neg.default(div_16);  div_16 = None
        fma_22 = torch.ops.prims.fma.default(neg_121, sum_283, mul_2052);  neg_121 = sum_283 = mul_2052 = None
        convert_element_type_3112 = torch.ops.prims.convert_element_type.default(fma_22, torch.bfloat16);  fma_22 = None
        permute_1532 = torch.ops.aten.permute.default(convert_element_type_3112, [1, 0])
        mm_576 = torch.ops.aten.mm.default(permute_1532, view_259);  permute_1532 = view_259 = None
        convert_element_type_224 = torch.ops.prims.convert_element_type.default(primals_79, torch.bfloat16);  primals_79 = None
        all_gather_into_tensor_69 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_224, 64, '0');  convert_element_type_224 = None
        wait_tensor_81 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_69);  all_gather_into_tensor_69 = None
        permute_64 = torch.ops.aten.permute.default(wait_tensor_81, [1, 0]);  wait_tensor_81 = None
        permute_1534 = torch.ops.aten.permute.default(permute_64, [1, 0]);  permute_64 = None
        mm_577 = torch.ops.aten.mm.default(convert_element_type_3112, permute_1534);  convert_element_type_3112 = permute_1534 = None
        add_2116 = torch.ops.aten.add.Tensor(add_2115, mm_577);  add_2115 = mm_577 = None
        convert_element_type_3117 = torch.ops.prims.convert_element_type.default(mm_576, torch.float32);  mm_576 = None
        reduce_scatter_tensor_316 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3117, 'avg', 64, '0');  convert_element_type_3117 = None
        wait_tensor_921 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_316);  reduce_scatter_tensor_316 = None
        view_2203 = torch.ops.aten.view.default(add_2116, [2, 4096, 2048]);  add_2116 = None
        convert_element_type_3118 = torch.ops.prims.convert_element_type.default(view_2203, torch.float32);  view_2203 = None
        convert_element_type_221 = torch.ops.prims.convert_element_type.default(primals_77, torch.bfloat16);  primals_77 = None
        all_gather_into_tensor_68 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_221, 64, '0');  convert_element_type_221 = None
        wait_tensor_80 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_68);  all_gather_into_tensor_68 = None
        convert_element_type_3120 = torch.ops.prims.convert_element_type.default(wait_tensor_80, torch.float32);  wait_tensor_80 = None
        mul_2053 = torch.ops.aten.mul.Tensor(convert_element_type_3118, convert_element_type_3120);  convert_element_type_3120 = None
        convert_element_type_222 = torch.ops.prims.convert_element_type.default(add_212, torch.float32);  add_212 = None
        mul_162 = torch.ops.aten.mul.Tensor(convert_element_type_222, rsqrt_14);  convert_element_type_222 = None
        mul_2055 = torch.ops.aten.mul.Tensor(mul_162, mul_2053)
        sum_284 = torch.ops.aten.sum.dim_IntList(mul_2055, [2], True);  mul_2055 = None
        div_267 = torch.ops.aten.div.Tensor(mul_162, 2048)
        mul_2056 = torch.ops.aten.mul.Tensor(div_267, sum_284);  div_267 = sum_284 = None
        sub_760 = torch.ops.aten.sub.Tensor(mul_2053, mul_2056);  mul_2053 = mul_2056 = None
        mul_2057 = torch.ops.aten.mul.Tensor(sub_760, rsqrt_14);  sub_760 = rsqrt_14 = None
        mul_2058 = torch.ops.aten.mul.Tensor(convert_element_type_3118, mul_162);  convert_element_type_3118 = mul_162 = None
        sum_285 = torch.ops.aten.sum.dim_IntList(mul_2058, [0, 1]);  mul_2058 = None
        convert_element_type_3121 = torch.ops.prims.convert_element_type.default(mul_2057, torch.bfloat16);  mul_2057 = None
        add_2117 = torch.ops.aten.add.Tensor(add_2104, convert_element_type_3121);  add_2104 = convert_element_type_3121 = None
        convert_element_type_default_15 = torch.ops.prims.convert_element_type.default(sum_285, torch.float32);  sum_285 = None
        reduce_scatter_tensor_317 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_15, 'avg', 64, '0');  convert_element_type_default_15 = None
        wait_tensor_922 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_317);  reduce_scatter_tensor_317 = None
        view_2204 = torch.ops.aten.view.default(add_2117, [8192, 2048])
        permute_1536 = torch.ops.aten.permute.default(view_2204, [1, 0])
        permute_62 = torch.ops.aten.permute.default(getitem_57, [0, 2, 1, 3])
        view_254 = torch.ops.aten.view.default(permute_62, [2, 4096, -1]);  permute_62 = None
        view_256 = torch.ops.aten.view.default(view_254, [8192, 2048]);  view_254 = None
        mm_578 = torch.ops.aten.mm.default(permute_1536, view_256);  permute_1536 = view_256 = None
        convert_element_type_218 = torch.ops.prims.convert_element_type.default(primals_76, torch.bfloat16);  primals_76 = None
        all_gather_into_tensor_67 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_218, 64, '0');  convert_element_type_218 = None
        wait_tensor_79 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_67);  all_gather_into_tensor_67 = None
        permute_63 = torch.ops.aten.permute.default(wait_tensor_79, [1, 0]);  wait_tensor_79 = None
        permute_1538 = torch.ops.aten.permute.default(permute_63, [1, 0]);  permute_63 = None
        mm_579 = torch.ops.aten.mm.default(view_2204, permute_1538);  view_2204 = permute_1538 = None
        view_2205 = torch.ops.aten.view.default(mm_579, [2, 4096, 2048]);  mm_579 = None
        convert_element_type_3128 = torch.ops.prims.convert_element_type.default(mm_578, torch.float32);  mm_578 = None
        reduce_scatter_tensor_318 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3128, 'avg', 64, '0');  convert_element_type_3128 = None
        wait_tensor_923 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_318);  reduce_scatter_tensor_318 = None
        view_2206 = torch.ops.aten.view.default(view_2205, [2, 4096, 16, 128]);  view_2205 = None
        permute_1540 = torch.ops.aten.permute.default(view_2206, [0, 2, 1, 3]);  view_2206 = None
        fw_graph22 = self.fw_graph22
        joint_graph22 = self.joint_graph22
        mask_graph22 = self.mask_graph22
        flex_attention_backward_22 = torch.ops.higher_order.flex_attention_backward(permute_59, permute_60, permute_61, getitem_57, getitem_58, permute_1540, None, fw_graph22, joint_graph22, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph22), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_59 = permute_60 = permute_61 = getitem_57 = getitem_58 = permute_1540 = fw_graph22 = joint_graph22 = mask_graph22 = None
        getitem_461 = flex_attention_backward_22[0]
        getitem_462 = flex_attention_backward_22[1]
        getitem_463 = flex_attention_backward_22[2];  flex_attention_backward_22 = None
        permute_1541 = torch.ops.aten.permute.default(getitem_463, [0, 2, 1, 3]);  getitem_463 = None
        permute_1542 = torch.ops.aten.permute.default(getitem_462, [0, 2, 1, 3]);  getitem_462 = None
        permute_1543 = torch.ops.aten.permute.default(getitem_461, [0, 2, 1, 3]);  getitem_461 = None
        slice_241 = torch.ops.aten.slice.Tensor(permute_1542, 3, 0, 128)
        slice_242 = torch.ops.aten.slice.Tensor(permute_1542, 3, 128, 192);  permute_1542 = None
        sum_286 = torch.ops.aten.sum.dim_IntList(slice_242, [2], True);  slice_242 = None
        cat_146 = torch.ops.aten.cat.default([slice_241, permute_1541], 3);  slice_241 = permute_1541 = None
        view_2207 = torch.ops.aten.view.default(cat_146, [2, 4096, 4096]);  cat_146 = None
        view_2208 = torch.ops.aten.view.default(view_2207, [8192, 4096]);  view_2207 = None
        permute_1544 = torch.ops.aten.permute.default(view_2208, [1, 0])
        mm_580 = torch.ops.aten.mm.default(permute_1544, view_251);  permute_1544 = view_251 = None
        convert_element_type_215 = torch.ops.prims.convert_element_type.default(primals_75, torch.bfloat16);  primals_75 = None
        all_gather_into_tensor_66 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_215, 64, '0');  convert_element_type_215 = None
        wait_tensor_78 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_66);  all_gather_into_tensor_66 = None
        permute_58 = torch.ops.aten.permute.default(wait_tensor_78, [1, 0]);  wait_tensor_78 = None
        permute_1546 = torch.ops.aten.permute.default(permute_58, [1, 0]);  permute_58 = None
        mm_581 = torch.ops.aten.mm.default(view_2208, permute_1546);  view_2208 = permute_1546 = None
        view_2209 = torch.ops.aten.view.default(mm_581, [2, 4096, 512]);  mm_581 = None
        convert_element_type_3133 = torch.ops.prims.convert_element_type.default(mm_580, torch.float32);  mm_580 = None
        reduce_scatter_tensor_319 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3133, 'avg', 64, '0');  convert_element_type_3133 = None
        wait_tensor_924 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_319);  reduce_scatter_tensor_319 = None
        convert_element_type_3134 = torch.ops.prims.convert_element_type.default(view_2209, torch.float32);  view_2209 = None
        convert_element_type_212 = torch.ops.prims.convert_element_type.default(primals_74, torch.bfloat16);  primals_74 = None
        all_gather_into_tensor_65 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_212, 64, '0');  convert_element_type_212 = None
        wait_tensor_77 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_65);  all_gather_into_tensor_65 = None
        convert_element_type_3136 = torch.ops.prims.convert_element_type.default(wait_tensor_77, torch.float32);  wait_tensor_77 = None
        mul_2059 = torch.ops.aten.mul.Tensor(convert_element_type_3134, convert_element_type_3136);  convert_element_type_3136 = None
        convert_element_type_213 = torch.ops.prims.convert_element_type.default(getitem_53, torch.float32);  getitem_53 = None
        mul_160 = torch.ops.aten.mul.Tensor(convert_element_type_213, rsqrt_13);  convert_element_type_213 = None
        mul_2061 = torch.ops.aten.mul.Tensor(mul_160, mul_2059)
        sum_287 = torch.ops.aten.sum.dim_IntList(mul_2061, [2], True);  mul_2061 = None
        div_268 = torch.ops.aten.div.Tensor(mul_160, 512)
        mul_2062 = torch.ops.aten.mul.Tensor(div_268, sum_287);  div_268 = sum_287 = None
        sub_761 = torch.ops.aten.sub.Tensor(mul_2059, mul_2062);  mul_2059 = mul_2062 = None
        mul_2063 = torch.ops.aten.mul.Tensor(sub_761, rsqrt_13);  sub_761 = rsqrt_13 = None
        mul_2064 = torch.ops.aten.mul.Tensor(convert_element_type_3134, mul_160);  convert_element_type_3134 = mul_160 = None
        sum_288 = torch.ops.aten.sum.dim_IntList(mul_2064, [0, 1]);  mul_2064 = None
        convert_element_type_3137 = torch.ops.prims.convert_element_type.default(mul_2063, torch.bfloat16);  mul_2063 = None
        convert_element_type_default_14 = torch.ops.prims.convert_element_type.default(sum_288, torch.float32);  sum_288 = None
        reduce_scatter_tensor_320 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_14, 'avg', 64, '0');  convert_element_type_default_14 = None
        wait_tensor_925 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_320);  reduce_scatter_tensor_320 = None
        convert_element_type_3140 = torch.ops.prims.convert_element_type.default(sum_286, torch.float32);  sum_286 = None
        view_2210 = torch.ops.aten.view.default(convert_element_type_3140, [2, 4096, 1, 32, 2]);  convert_element_type_3140 = None
        view_as_complex_98 = torch.ops.aten.view_as_complex.default(view_2210);  view_2210 = None
        mul_2065 = torch.ops.aten.mul.Tensor(view_as_complex_98, clone_9);  view_as_complex_98 = None
        view_as_real_98 = torch.ops.aten.view_as_real.default(mul_2065);  mul_2065 = None
        view_2211 = torch.ops.aten.view.default(view_as_real_98, [2, 4096, 1, 64]);  view_as_real_98 = None
        convert_element_type_3141 = torch.ops.prims.convert_element_type.default(view_2211, torch.bfloat16);  view_2211 = None
        squeeze_48 = torch.ops.aten.squeeze.dim(convert_element_type_3141, 2);  convert_element_type_3141 = None
        cat_147 = torch.ops.aten.cat.default([convert_element_type_3137, squeeze_48], 2);  convert_element_type_3137 = squeeze_48 = None
        view_2212 = torch.ops.aten.view.default(cat_147, [8192, 576]);  cat_147 = None
        permute_1548 = torch.ops.aten.permute.default(view_2212, [1, 0])
        mm_582 = torch.ops.aten.mm.default(permute_1548, view_237);  permute_1548 = None
        convert_element_type_207 = torch.ops.prims.convert_element_type.default(primals_73, torch.bfloat16);  primals_73 = None
        all_gather_into_tensor_64 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_207, 64, '0');  convert_element_type_207 = None
        wait_tensor_76 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_64);  all_gather_into_tensor_64 = None
        permute_57 = torch.ops.aten.permute.default(wait_tensor_76, [1, 0]);  wait_tensor_76 = None
        permute_1550 = torch.ops.aten.permute.default(permute_57, [1, 0]);  permute_57 = None
        mm_583 = torch.ops.aten.mm.default(view_2212, permute_1550);  view_2212 = permute_1550 = None
        view_2213 = torch.ops.aten.view.default(mm_583, [2, 4096, 2048]);  mm_583 = None
        convert_element_type_3146 = torch.ops.prims.convert_element_type.default(mm_582, torch.float32);  mm_582 = None
        reduce_scatter_tensor_321 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3146, 'avg', 64, '0');  convert_element_type_3146 = None
        wait_tensor_926 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_321);  reduce_scatter_tensor_321 = None
        slice_243 = torch.ops.aten.slice.Tensor(permute_1543, 3, 0, 128)
        slice_244 = torch.ops.aten.slice.Tensor(permute_1543, 3, 128, 192);  permute_1543 = None
        convert_element_type_3147 = torch.ops.prims.convert_element_type.default(slice_244, torch.float32);  slice_244 = None
        view_2214 = torch.ops.aten.view.default(convert_element_type_3147, [2, 4096, 16, 32, 2]);  convert_element_type_3147 = None
        view_as_complex_99 = torch.ops.aten.view_as_complex.default(view_2214);  view_2214 = None
        mul_2066 = torch.ops.aten.mul.Tensor(view_as_complex_99, clone_9);  view_as_complex_99 = None
        view_as_real_99 = torch.ops.aten.view_as_real.default(mul_2066);  mul_2066 = None
        view_2215 = torch.ops.aten.view.default(view_as_real_99, [2, 4096, 16, 64]);  view_as_real_99 = None
        convert_element_type_3148 = torch.ops.prims.convert_element_type.default(view_2215, torch.bfloat16);  view_2215 = None
        cat_148 = torch.ops.aten.cat.default([slice_243, convert_element_type_3148], 3);  slice_243 = convert_element_type_3148 = None
        view_2216 = torch.ops.aten.view.default(cat_148, [2, 4096, 3072]);  cat_148 = None
        view_2217 = torch.ops.aten.view.default(view_2216, [8192, 3072]);  view_2216 = None
        permute_1552 = torch.ops.aten.permute.default(view_2217, [1, 0])
        mm_584 = torch.ops.aten.mm.default(permute_1552, view_237);  permute_1552 = view_237 = None
        convert_element_type_202 = torch.ops.prims.convert_element_type.default(primals_72, torch.bfloat16);  primals_72 = None
        all_gather_into_tensor_63 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_202, 64, '0');  convert_element_type_202 = None
        wait_tensor_75 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_63);  all_gather_into_tensor_63 = None
        permute_56 = torch.ops.aten.permute.default(wait_tensor_75, [1, 0]);  wait_tensor_75 = None
        permute_1554 = torch.ops.aten.permute.default(permute_56, [1, 0]);  permute_56 = None
        mm_585 = torch.ops.aten.mm.default(view_2217, permute_1554);  view_2217 = permute_1554 = None
        view_2218 = torch.ops.aten.view.default(mm_585, [2, 4096, 2048]);  mm_585 = None
        add_2118 = torch.ops.aten.add.Tensor(view_2213, view_2218);  view_2213 = view_2218 = None
        convert_element_type_3153 = torch.ops.prims.convert_element_type.default(mm_584, torch.float32);  mm_584 = None
        reduce_scatter_tensor_322 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3153, 'avg', 64, '0');  convert_element_type_3153 = None
        wait_tensor_927 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_322);  reduce_scatter_tensor_322 = None
        convert_element_type_3154 = torch.ops.prims.convert_element_type.default(add_2118, torch.float32);  add_2118 = None
        convert_element_type_199 = torch.ops.prims.convert_element_type.default(primals_71, torch.bfloat16);  primals_71 = None
        all_gather_into_tensor_62 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_199, 64, '0');  convert_element_type_199 = None
        wait_tensor_74 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_62);  all_gather_into_tensor_62 = None
        convert_element_type_3156 = torch.ops.prims.convert_element_type.default(wait_tensor_74, torch.float32);  wait_tensor_74 = None
        mul_2067 = torch.ops.aten.mul.Tensor(convert_element_type_3154, convert_element_type_3156);  convert_element_type_3156 = None
        convert_element_type_200 = torch.ops.prims.convert_element_type.default(add_209, torch.float32);  add_209 = None
        mul_156 = torch.ops.aten.mul.Tensor(convert_element_type_200, rsqrt_12);  convert_element_type_200 = None
        mul_2069 = torch.ops.aten.mul.Tensor(mul_156, mul_2067)
        sum_289 = torch.ops.aten.sum.dim_IntList(mul_2069, [2], True);  mul_2069 = None
        div_269 = torch.ops.aten.div.Tensor(mul_156, 2048)
        mul_2070 = torch.ops.aten.mul.Tensor(div_269, sum_289);  div_269 = sum_289 = None
        sub_762 = torch.ops.aten.sub.Tensor(mul_2067, mul_2070);  mul_2067 = mul_2070 = None
        mul_2071 = torch.ops.aten.mul.Tensor(sub_762, rsqrt_12);  sub_762 = rsqrt_12 = None
        mul_2072 = torch.ops.aten.mul.Tensor(convert_element_type_3154, mul_156);  convert_element_type_3154 = mul_156 = None
        sum_290 = torch.ops.aten.sum.dim_IntList(mul_2072, [0, 1]);  mul_2072 = None
        convert_element_type_3157 = torch.ops.prims.convert_element_type.default(mul_2071, torch.bfloat16);  mul_2071 = None
        add_2119 = torch.ops.aten.add.Tensor(add_2117, convert_element_type_3157);  add_2117 = convert_element_type_3157 = None
        convert_element_type_default_13 = torch.ops.prims.convert_element_type.default(sum_290, torch.float32);  sum_290 = None
        reduce_scatter_tensor_323 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_13, 'avg', 64, '0');  convert_element_type_default_13 = None
        wait_tensor_928 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_323);  reduce_scatter_tensor_323 = None
        view_2219 = torch.ops.aten.view.default(add_2119, [8192, 2048])
        unsqueeze_76 = torch.ops.aten.unsqueeze.default(view_2219, 1)
        convert_element_type_3160 = torch.ops.prims.convert_element_type.default(unsqueeze_76, torch.float32);  unsqueeze_76 = None
        bmm_72 = torch.ops.aten.bmm.default(permute_1556, convert_element_type_3160);  permute_1556 = None
        bmm_73 = torch.ops.aten.bmm.default(convert_element_type_3160, permute_1557);  convert_element_type_3160 = permute_1557 = None
        convert_element_type_3161 = torch.ops.prims.convert_element_type.default(bmm_72, torch.bfloat16);  bmm_72 = None
        view_2220 = torch.ops.aten.view.default(bmm_73, [8192, 6]);  bmm_73 = None
        view_2221 = torch.ops.aten.view.default(convert_element_type_3161, [49152, 2048]);  convert_element_type_3161 = None
        index_98 = torch.ops.aten.index.Tensor(view_2221, [getitem_49]);  view_2221 = getitem_49 = None
        permute_1558 = torch.ops.aten.permute.default(view_2219, [1, 0])
        mm_586 = torch.ops.aten.mm.default(permute_1558, mul_153);  permute_1558 = mul_153 = None
        convert_element_type_194 = torch.ops.prims.convert_element_type.default(primals_70, torch.bfloat16);  primals_70 = None
        all_gather_into_tensor_61 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_194, 64, '0');  convert_element_type_194 = None
        wait_tensor_73 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_61);  all_gather_into_tensor_61 = None
        permute_55 = torch.ops.aten.permute.default(wait_tensor_73, [1, 0]);  wait_tensor_73 = None
        permute_1560 = torch.ops.aten.permute.default(permute_55, [1, 0]);  permute_55 = None
        mm_587 = torch.ops.aten.mm.default(view_2219, permute_1560);  view_2219 = permute_1560 = None
        convert_element_type_3166 = torch.ops.prims.convert_element_type.default(mm_586, torch.float32);  mm_586 = None
        reduce_scatter_tensor_324 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3166, 'avg', 64, '0');  convert_element_type_3166 = None
        wait_tensor_929 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_324);  reduce_scatter_tensor_324 = None
        convert_element_type_189 = torch.ops.prims.convert_element_type.default(mm_28, torch.float32);  mm_28 = None
        neg_6 = torch.ops.aten.neg.default(convert_element_type_189)
        exp_9 = torch.ops.aten.exp.default(neg_6);  neg_6 = None
        add_204 = torch.ops.aten.add.Tensor(exp_9, 1);  exp_9 = None
        div_15 = torch.ops.aten.div.Tensor(convert_element_type_189, add_204)
        convert_element_type_190 = torch.ops.prims.convert_element_type.default(div_15, torch.bfloat16);  div_15 = None
        mul_2073 = torch.ops.aten.mul.Tensor(mm_587, convert_element_type_190);  convert_element_type_190 = None
        mul_2074 = torch.ops.aten.mul.Tensor(mm_587, mm_29);  mm_587 = mm_29 = None
        permute_1562 = torch.ops.aten.permute.default(mul_2073, [1, 0])
        mm_588 = torch.ops.aten.mm.default(permute_1562, view_192);  permute_1562 = None
        convert_element_type_191 = torch.ops.prims.convert_element_type.default(primals_69, torch.bfloat16);  primals_69 = None
        all_gather_into_tensor_60 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_191, 64, '0');  convert_element_type_191 = None
        wait_tensor_72 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_60);  all_gather_into_tensor_60 = None
        permute_54 = torch.ops.aten.permute.default(wait_tensor_72, [1, 0]);  wait_tensor_72 = None
        permute_1564 = torch.ops.aten.permute.default(permute_54, [1, 0]);  permute_54 = None
        mm_589 = torch.ops.aten.mm.default(mul_2073, permute_1564);  mul_2073 = permute_1564 = None
        convert_element_type_3171 = torch.ops.prims.convert_element_type.default(mm_588, torch.float32);  mm_588 = None
        reduce_scatter_tensor_325 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3171, 'avg', 64, '0');  convert_element_type_3171 = None
        wait_tensor_930 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_325);  reduce_scatter_tensor_325 = None
        convert_element_type_3172 = torch.ops.prims.convert_element_type.default(mul_2074, torch.float32);  mul_2074 = None
        reciprocal_46 = torch.ops.aten.reciprocal.default(add_204);  add_204 = None
        mul_2075 = torch.ops.aten.mul.Tensor(reciprocal_46, 1);  reciprocal_46 = None
        mul_2076 = torch.ops.aten.mul.Tensor(convert_element_type_3172, mul_2075);  convert_element_type_3172 = None
        sub_763 = torch.ops.aten.sub.Tensor(1, mul_2075);  mul_2075 = None
        mul_2077 = torch.ops.aten.mul.Tensor(convert_element_type_189, sub_763);  convert_element_type_189 = sub_763 = None
        add_2121 = torch.ops.aten.add.Tensor(mul_2077, 1);  mul_2077 = None
        mul_2078 = torch.ops.aten.mul.Tensor(mul_2076, add_2121);  mul_2076 = add_2121 = None
        convert_element_type_3174 = torch.ops.prims.convert_element_type.default(mul_2078, torch.bfloat16);  mul_2078 = None
        permute_1566 = torch.ops.aten.permute.default(convert_element_type_3174, [1, 0])
        mm_590 = torch.ops.aten.mm.default(permute_1566, view_192);  permute_1566 = None
        convert_element_type_186 = torch.ops.prims.convert_element_type.default(primals_68, torch.bfloat16);  primals_68 = None
        all_gather_into_tensor_59 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_186, 64, '0');  convert_element_type_186 = None
        wait_tensor_71 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_59);  all_gather_into_tensor_59 = None
        permute_53 = torch.ops.aten.permute.default(wait_tensor_71, [1, 0]);  wait_tensor_71 = None
        permute_1568 = torch.ops.aten.permute.default(permute_53, [1, 0]);  permute_53 = None
        mm_591 = torch.ops.aten.mm.default(convert_element_type_3174, permute_1568);  convert_element_type_3174 = permute_1568 = None
        add_2122 = torch.ops.aten.add.Tensor(mm_589, mm_591);  mm_589 = mm_591 = None
        convert_element_type_3179 = torch.ops.prims.convert_element_type.default(mm_590, torch.float32);  mm_590 = None
        reduce_scatter_tensor_326 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3179, 'avg', 64, '0');  convert_element_type_3179 = None
        wait_tensor_931 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_326);  reduce_scatter_tensor_326 = None
        all_to_all_single_124 = torch.ops._c10d_functional.all_to_all_single.default(index_98, [_local_scalar_dense_40, _local_scalar_dense_41, _local_scalar_dense_42, _local_scalar_dense_43, _local_scalar_dense_44, _local_scalar_dense_45, _local_scalar_dense_46, _local_scalar_dense_47], [_local_scalar_dense_32, _local_scalar_dense_33, _local_scalar_dense_34, _local_scalar_dense_35, _local_scalar_dense_36, _local_scalar_dense_37, _local_scalar_dense_38, _local_scalar_dense_39], '521');  index_98 = None
        wait_tensor_932 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_124);  all_to_all_single_124 = None
        full_440 = torch.ops.aten.full.default([sym_size_int_9, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_9 = None
        slice_scatter_23 = torch.ops.aten.slice_scatter.default(full_440, wait_tensor_932, 0, 0, -1);  wait_tensor_932 = None
        index_99 = torch.ops.aten.index.Tensor(slice_scatter_23, [getitem_50]);  slice_scatter_23 = None
        permute_1570 = torch.ops.aten.permute.default(index_99, [1, 0])
        _grouped_mm_216 = torch.ops.aten._grouped_mm.default(permute_1570, mul_133, cumsum_8);  permute_1570 = mul_133 = None
        convert_element_type_180 = torch.ops.prims.convert_element_type.default(primals_66, torch.bfloat16);  primals_66 = None
        all_gather_into_tensor_55 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_180, 8, '513');  convert_element_type_180 = None
        wait_tensor_66 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_55);  all_gather_into_tensor_55 = None
        permute_52 = torch.ops.aten.permute.default(wait_tensor_66, [0, 2, 1]);  wait_tensor_66 = None
        permute_1572 = torch.ops.aten.permute.default(permute_52, [0, 2, 1]);  permute_52 = None
        _grouped_mm_217 = torch.ops.aten._grouped_mm.default(index_99, permute_1572, cumsum_8);  index_99 = permute_1572 = None
        convert_element_type_184 = torch.ops.prims.convert_element_type.default(_grouped_mm_6, torch.float32);  _grouped_mm_6 = None
        neg_5 = torch.ops.aten.neg.default(convert_element_type_184)
        exp_8 = torch.ops.aten.exp.default(neg_5);  neg_5 = None
        add_168 = torch.ops.aten.add.Tensor(exp_8, 1);  exp_8 = None
        div_14 = torch.ops.aten.div.Tensor(convert_element_type_184, add_168)
        convert_element_type_185 = torch.ops.prims.convert_element_type.default(div_14, torch.bfloat16);  div_14 = None
        mul_2079 = torch.ops.aten.mul.Tensor(_grouped_mm_217, convert_element_type_185);  convert_element_type_185 = None
        mul_2080 = torch.ops.aten.mul.Tensor(_grouped_mm_217, _grouped_mm_7);  _grouped_mm_217 = _grouped_mm_7 = None
        permute_1574 = torch.ops.aten.permute.default(mul_2079, [1, 0])
        _grouped_mm_218 = torch.ops.aten._grouped_mm.default(permute_1574, index_5, cumsum_8);  permute_1574 = None
        convert_element_type_181 = torch.ops.prims.convert_element_type.default(primals_67, torch.bfloat16);  primals_67 = None
        all_gather_into_tensor_56 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_181, 8, '513');  convert_element_type_181 = None
        wait_tensor_67 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_56);  all_gather_into_tensor_56 = None
        permute_51 = torch.ops.aten.permute.default(wait_tensor_67, [0, 2, 1]);  wait_tensor_67 = None
        permute_1576 = torch.ops.aten.permute.default(permute_51, [0, 2, 1]);  permute_51 = None
        _grouped_mm_219 = torch.ops.aten._grouped_mm.default(mul_2079, permute_1576, cumsum_8);  mul_2079 = permute_1576 = None
        convert_element_type_3180 = torch.ops.prims.convert_element_type.default(mul_2080, torch.float32);  mul_2080 = None
        reciprocal_47 = torch.ops.aten.reciprocal.default(add_168);  add_168 = None
        mul_2081 = torch.ops.aten.mul.Tensor(reciprocal_47, 1);  reciprocal_47 = None
        mul_2082 = torch.ops.aten.mul.Tensor(convert_element_type_3180, mul_2081);  convert_element_type_3180 = None
        sub_764 = torch.ops.aten.sub.Tensor(1, mul_2081);  mul_2081 = None
        mul_2083 = torch.ops.aten.mul.Tensor(convert_element_type_184, sub_764);  convert_element_type_184 = sub_764 = None
        add_2124 = torch.ops.aten.add.Tensor(mul_2083, 1);  mul_2083 = None
        mul_2084 = torch.ops.aten.mul.Tensor(mul_2082, add_2124);  mul_2082 = add_2124 = None
        convert_element_type_3182 = torch.ops.prims.convert_element_type.default(mul_2084, torch.bfloat16);  mul_2084 = None
        permute_1578 = torch.ops.aten.permute.default(convert_element_type_3182, [1, 0])
        _grouped_mm_220 = torch.ops.aten._grouped_mm.default(permute_1578, index_5, cumsum_8);  permute_1578 = index_5 = None
        convert_element_type_178 = torch.ops.prims.convert_element_type.default(primals_65, torch.bfloat16);  primals_65 = None
        all_gather_into_tensor_53 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_178, 8, '513');  convert_element_type_178 = None
        wait_tensor_64 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_53);  all_gather_into_tensor_53 = None
        permute_50 = torch.ops.aten.permute.default(wait_tensor_64, [0, 2, 1]);  wait_tensor_64 = None
        permute_1580 = torch.ops.aten.permute.default(permute_50, [0, 2, 1]);  permute_50 = None
        _grouped_mm_221 = torch.ops.aten._grouped_mm.default(convert_element_type_3182, permute_1580, cumsum_8);  convert_element_type_3182 = permute_1580 = cumsum_8 = None
        add_2125 = torch.ops.aten.add.Tensor(_grouped_mm_219, _grouped_mm_221);  _grouped_mm_219 = _grouped_mm_221 = None
        convert_element_type_3183 = torch.ops.prims.convert_element_type.default(_grouped_mm_218, torch.float32);  _grouped_mm_218 = None
        div_270 = torch.ops.aten.div.Tensor(convert_element_type_3183, 64);  convert_element_type_3183 = None
        reduce_scatter_tensor_327 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_270, 'sum', 8, '513');  div_270 = None
        wait_tensor_933 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_327);  reduce_scatter_tensor_327 = None
        convert_element_type_3184 = torch.ops.prims.convert_element_type.default(_grouped_mm_216, torch.float32);  _grouped_mm_216 = None
        div_271 = torch.ops.aten.div.Tensor(convert_element_type_3184, 64);  convert_element_type_3184 = None
        reduce_scatter_tensor_328 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_271, 'sum', 8, '513');  div_271 = None
        wait_tensor_934 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_328);  reduce_scatter_tensor_328 = None
        convert_element_type_3185 = torch.ops.prims.convert_element_type.default(_grouped_mm_220, torch.float32);  _grouped_mm_220 = None
        div_272 = torch.ops.aten.div.Tensor(convert_element_type_3185, 64);  convert_element_type_3185 = None
        reduce_scatter_tensor_329 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_272, 'sum', 8, '513');  div_272 = None
        wait_tensor_935 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_329);  reduce_scatter_tensor_329 = None
        index_put_98 = torch.ops.aten.index_put.default(full_440, [getitem_50], add_2125, True);  full_440 = getitem_50 = add_2125 = None
        slice_245 = torch.ops.aten.slice.Tensor(index_put_98, 0, 0, add_2126);  index_put_98 = add_2126 = None
        all_to_all_single_125 = torch.ops._c10d_functional.all_to_all_single.default(slice_245, [_local_scalar_dense_32, _local_scalar_dense_33, _local_scalar_dense_34, _local_scalar_dense_35, _local_scalar_dense_36, _local_scalar_dense_37, _local_scalar_dense_38, _local_scalar_dense_39], [_local_scalar_dense_40, _local_scalar_dense_41, _local_scalar_dense_42, _local_scalar_dense_43, _local_scalar_dense_44, _local_scalar_dense_45, _local_scalar_dense_46, _local_scalar_dense_47], '521');  slice_245 = _local_scalar_dense_32 = _local_scalar_dense_33 = _local_scalar_dense_34 = _local_scalar_dense_35 = _local_scalar_dense_36 = _local_scalar_dense_37 = _local_scalar_dense_38 = _local_scalar_dense_39 = _local_scalar_dense_40 = _local_scalar_dense_41 = _local_scalar_dense_42 = _local_scalar_dense_43 = _local_scalar_dense_44 = _local_scalar_dense_45 = _local_scalar_dense_46 = _local_scalar_dense_47 = None
        wait_tensor_936 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_125);  all_to_all_single_125 = None
        index_put_99 = torch.ops.aten.index_put.default(full_default_52, [div_12], wait_tensor_936, True);  div_12 = wait_tensor_936 = None
        add_2130 = torch.ops.aten.add.Tensor(add_2122, index_put_99);  add_2122 = index_put_99 = None
        mul_2085 = torch.ops.aten.mul.Tensor(view_2220, 1.0);  view_2220 = None
        scatter_add_23 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_47, mul_2085);  getitem_47 = mul_2085 = None
        convert_element_type_173 = torch.ops.prims.convert_element_type.default(mm_27, torch.float32);  mm_27 = None
        sub_48 = torch.ops.aten.sub.Tensor(convert_element_type_173, amax_2);  convert_element_type_173 = amax_2 = None
        exp_7 = torch.ops.aten.exp.default(sub_48);  sub_48 = None
        div_11 = torch.ops.aten.div.Tensor(exp_7, sum_9);  exp_7 = sum_9 = None
        mul_2086 = torch.ops.aten.mul.Tensor(scatter_add_23, div_11);  scatter_add_23 = None
        sum_291 = torch.ops.aten.sum.dim_IntList(mul_2086, [1], True)
        neg_124 = torch.ops.aten.neg.default(div_11);  div_11 = None
        fma_23 = torch.ops.prims.fma.default(neg_124, sum_291, mul_2086);  neg_124 = sum_291 = mul_2086 = None
        convert_element_type_3186 = torch.ops.prims.convert_element_type.default(fma_23, torch.bfloat16);  fma_23 = None
        permute_1582 = torch.ops.aten.permute.default(convert_element_type_3186, [1, 0])
        mm_592 = torch.ops.aten.mm.default(permute_1582, view_192);  permute_1582 = view_192 = None
        convert_element_type_170 = torch.ops.prims.convert_element_type.default(primals_63, torch.bfloat16);  primals_63 = None
        all_gather_into_tensor_52 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_170, 64, '0');  convert_element_type_170 = None
        wait_tensor_60 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_52);  all_gather_into_tensor_52 = None
        permute_49 = torch.ops.aten.permute.default(wait_tensor_60, [1, 0]);  wait_tensor_60 = None
        permute_1584 = torch.ops.aten.permute.default(permute_49, [1, 0]);  permute_49 = None
        mm_593 = torch.ops.aten.mm.default(convert_element_type_3186, permute_1584);  convert_element_type_3186 = permute_1584 = None
        add_2131 = torch.ops.aten.add.Tensor(add_2130, mm_593);  add_2130 = mm_593 = None
        convert_element_type_3191 = torch.ops.prims.convert_element_type.default(mm_592, torch.float32);  mm_592 = None
        reduce_scatter_tensor_330 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3191, 'avg', 64, '0');  convert_element_type_3191 = None
        wait_tensor_937 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_330);  reduce_scatter_tensor_330 = None
        view_2222 = torch.ops.aten.view.default(add_2131, [2, 4096, 2048]);  add_2131 = None
        convert_element_type_3192 = torch.ops.prims.convert_element_type.default(view_2222, torch.float32);  view_2222 = None
        convert_element_type_167 = torch.ops.prims.convert_element_type.default(primals_61, torch.bfloat16);  primals_61 = None
        all_gather_into_tensor_51 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_167, 64, '0');  convert_element_type_167 = None
        wait_tensor_59 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_51);  all_gather_into_tensor_51 = None
        convert_element_type_3194 = torch.ops.prims.convert_element_type.default(wait_tensor_59, torch.float32);  wait_tensor_59 = None
        mul_2087 = torch.ops.aten.mul.Tensor(convert_element_type_3192, convert_element_type_3194);  convert_element_type_3194 = None
        convert_element_type_168 = torch.ops.prims.convert_element_type.default(add_144, torch.float32);  add_144 = None
        mul_113 = torch.ops.aten.mul.Tensor(convert_element_type_168, rsqrt_11);  convert_element_type_168 = None
        mul_2089 = torch.ops.aten.mul.Tensor(mul_113, mul_2087)
        sum_292 = torch.ops.aten.sum.dim_IntList(mul_2089, [2], True);  mul_2089 = None
        div_273 = torch.ops.aten.div.Tensor(mul_113, 2048)
        mul_2090 = torch.ops.aten.mul.Tensor(div_273, sum_292);  div_273 = sum_292 = None
        sub_766 = torch.ops.aten.sub.Tensor(mul_2087, mul_2090);  mul_2087 = mul_2090 = None
        mul_2091 = torch.ops.aten.mul.Tensor(sub_766, rsqrt_11);  sub_766 = rsqrt_11 = None
        mul_2092 = torch.ops.aten.mul.Tensor(convert_element_type_3192, mul_113);  convert_element_type_3192 = mul_113 = None
        sum_293 = torch.ops.aten.sum.dim_IntList(mul_2092, [0, 1]);  mul_2092 = None
        convert_element_type_3195 = torch.ops.prims.convert_element_type.default(mul_2091, torch.bfloat16);  mul_2091 = None
        add_2132 = torch.ops.aten.add.Tensor(add_2119, convert_element_type_3195);  add_2119 = convert_element_type_3195 = None
        convert_element_type_default_12 = torch.ops.prims.convert_element_type.default(sum_293, torch.float32);  sum_293 = None
        reduce_scatter_tensor_331 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_12, 'avg', 64, '0');  convert_element_type_default_12 = None
        wait_tensor_938 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_331);  reduce_scatter_tensor_331 = None
        view_2223 = torch.ops.aten.view.default(add_2132, [8192, 2048])
        permute_1586 = torch.ops.aten.permute.default(view_2223, [1, 0])
        permute_47 = torch.ops.aten.permute.default(getitem_43, [0, 2, 1, 3])
        view_187 = torch.ops.aten.view.default(permute_47, [2, 4096, -1]);  permute_47 = None
        view_189 = torch.ops.aten.view.default(view_187, [8192, 2048]);  view_187 = None
        mm_594 = torch.ops.aten.mm.default(permute_1586, view_189);  permute_1586 = view_189 = None
        convert_element_type_164 = torch.ops.prims.convert_element_type.default(primals_60, torch.bfloat16);  primals_60 = None
        all_gather_into_tensor_50 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_164, 64, '0');  convert_element_type_164 = None
        wait_tensor_58 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_50);  all_gather_into_tensor_50 = None
        permute_48 = torch.ops.aten.permute.default(wait_tensor_58, [1, 0]);  wait_tensor_58 = None
        permute_1588 = torch.ops.aten.permute.default(permute_48, [1, 0]);  permute_48 = None
        mm_595 = torch.ops.aten.mm.default(view_2223, permute_1588);  view_2223 = permute_1588 = None
        view_2224 = torch.ops.aten.view.default(mm_595, [2, 4096, 2048]);  mm_595 = None
        convert_element_type_3202 = torch.ops.prims.convert_element_type.default(mm_594, torch.float32);  mm_594 = None
        reduce_scatter_tensor_332 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3202, 'avg', 64, '0');  convert_element_type_3202 = None
        wait_tensor_939 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_332);  reduce_scatter_tensor_332 = None
        view_2225 = torch.ops.aten.view.default(view_2224, [2, 4096, 16, 128]);  view_2224 = None
        permute_1590 = torch.ops.aten.permute.default(view_2225, [0, 2, 1, 3]);  view_2225 = None
        fw_graph23 = self.fw_graph23
        joint_graph23 = self.joint_graph23
        mask_graph23 = self.mask_graph23
        flex_attention_backward_23 = torch.ops.higher_order.flex_attention_backward(permute_44, permute_45, permute_46, getitem_43, getitem_44, permute_1590, None, fw_graph23, joint_graph23, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph23), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_44 = permute_45 = permute_46 = getitem_43 = getitem_44 = permute_1590 = fw_graph23 = joint_graph23 = mask_graph23 = None
        getitem_465 = flex_attention_backward_23[0]
        getitem_466 = flex_attention_backward_23[1]
        getitem_467 = flex_attention_backward_23[2];  flex_attention_backward_23 = None
        permute_1591 = torch.ops.aten.permute.default(getitem_467, [0, 2, 1, 3]);  getitem_467 = None
        permute_1592 = torch.ops.aten.permute.default(getitem_466, [0, 2, 1, 3]);  getitem_466 = None
        permute_1593 = torch.ops.aten.permute.default(getitem_465, [0, 2, 1, 3]);  getitem_465 = None
        slice_247 = torch.ops.aten.slice.Tensor(permute_1592, 3, 0, 128)
        slice_248 = torch.ops.aten.slice.Tensor(permute_1592, 3, 128, 192);  permute_1592 = None
        sum_294 = torch.ops.aten.sum.dim_IntList(slice_248, [2], True);  slice_248 = None
        cat_149 = torch.ops.aten.cat.default([slice_247, permute_1591], 3);  slice_247 = permute_1591 = None
        view_2226 = torch.ops.aten.view.default(cat_149, [2, 4096, 4096]);  cat_149 = None
        view_2227 = torch.ops.aten.view.default(view_2226, [8192, 4096]);  view_2226 = None
        permute_1594 = torch.ops.aten.permute.default(view_2227, [1, 0])
        mm_596 = torch.ops.aten.mm.default(permute_1594, view_184);  permute_1594 = view_184 = None
        convert_element_type_161 = torch.ops.prims.convert_element_type.default(primals_59, torch.bfloat16);  primals_59 = None
        all_gather_into_tensor_49 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_161, 64, '0');  convert_element_type_161 = None
        wait_tensor_57 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_49);  all_gather_into_tensor_49 = None
        permute_43 = torch.ops.aten.permute.default(wait_tensor_57, [1, 0]);  wait_tensor_57 = None
        permute_1596 = torch.ops.aten.permute.default(permute_43, [1, 0]);  permute_43 = None
        mm_597 = torch.ops.aten.mm.default(view_2227, permute_1596);  view_2227 = permute_1596 = None
        view_2228 = torch.ops.aten.view.default(mm_597, [2, 4096, 512]);  mm_597 = None
        convert_element_type_3207 = torch.ops.prims.convert_element_type.default(mm_596, torch.float32);  mm_596 = None
        reduce_scatter_tensor_333 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3207, 'avg', 64, '0');  convert_element_type_3207 = None
        wait_tensor_940 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_333);  reduce_scatter_tensor_333 = None
        convert_element_type_3208 = torch.ops.prims.convert_element_type.default(view_2228, torch.float32);  view_2228 = None
        convert_element_type_158 = torch.ops.prims.convert_element_type.default(primals_58, torch.bfloat16);  primals_58 = None
        all_gather_into_tensor_48 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_158, 64, '0');  convert_element_type_158 = None
        wait_tensor_56 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_48);  all_gather_into_tensor_48 = None
        convert_element_type_3210 = torch.ops.prims.convert_element_type.default(wait_tensor_56, torch.float32);  wait_tensor_56 = None
        mul_2093 = torch.ops.aten.mul.Tensor(convert_element_type_3208, convert_element_type_3210);  convert_element_type_3210 = None
        convert_element_type_159 = torch.ops.prims.convert_element_type.default(getitem_39, torch.float32);  getitem_39 = None
        mul_111 = torch.ops.aten.mul.Tensor(convert_element_type_159, rsqrt_10);  convert_element_type_159 = None
        mul_2095 = torch.ops.aten.mul.Tensor(mul_111, mul_2093)
        sum_295 = torch.ops.aten.sum.dim_IntList(mul_2095, [2], True);  mul_2095 = None
        div_274 = torch.ops.aten.div.Tensor(mul_111, 512)
        mul_2096 = torch.ops.aten.mul.Tensor(div_274, sum_295);  div_274 = sum_295 = None
        sub_767 = torch.ops.aten.sub.Tensor(mul_2093, mul_2096);  mul_2093 = mul_2096 = None
        mul_2097 = torch.ops.aten.mul.Tensor(sub_767, rsqrt_10);  sub_767 = rsqrt_10 = None
        mul_2098 = torch.ops.aten.mul.Tensor(convert_element_type_3208, mul_111);  convert_element_type_3208 = mul_111 = None
        sum_296 = torch.ops.aten.sum.dim_IntList(mul_2098, [0, 1]);  mul_2098 = None
        convert_element_type_3211 = torch.ops.prims.convert_element_type.default(mul_2097, torch.bfloat16);  mul_2097 = None
        convert_element_type_default_11 = torch.ops.prims.convert_element_type.default(sum_296, torch.float32);  sum_296 = None
        reduce_scatter_tensor_334 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_11, 'avg', 64, '0');  convert_element_type_default_11 = None
        wait_tensor_941 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_334);  reduce_scatter_tensor_334 = None
        convert_element_type_3214 = torch.ops.prims.convert_element_type.default(sum_294, torch.float32);  sum_294 = None
        view_2229 = torch.ops.aten.view.default(convert_element_type_3214, [2, 4096, 1, 32, 2]);  convert_element_type_3214 = None
        view_as_complex_100 = torch.ops.aten.view_as_complex.default(view_2229);  view_2229 = None
        mul_2099 = torch.ops.aten.mul.Tensor(view_as_complex_100, clone_9);  view_as_complex_100 = None
        view_as_real_100 = torch.ops.aten.view_as_real.default(mul_2099);  mul_2099 = None
        view_2230 = torch.ops.aten.view.default(view_as_real_100, [2, 4096, 1, 64]);  view_as_real_100 = None
        convert_element_type_3215 = torch.ops.prims.convert_element_type.default(view_2230, torch.bfloat16);  view_2230 = None
        squeeze_49 = torch.ops.aten.squeeze.dim(convert_element_type_3215, 2);  convert_element_type_3215 = None
        cat_150 = torch.ops.aten.cat.default([convert_element_type_3211, squeeze_49], 2);  convert_element_type_3211 = squeeze_49 = None
        view_2231 = torch.ops.aten.view.default(cat_150, [8192, 576]);  cat_150 = None
        permute_1598 = torch.ops.aten.permute.default(view_2231, [1, 0])
        mm_598 = torch.ops.aten.mm.default(permute_1598, view_170);  permute_1598 = None
        convert_element_type_153 = torch.ops.prims.convert_element_type.default(primals_57, torch.bfloat16);  primals_57 = None
        all_gather_into_tensor_47 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_153, 64, '0');  convert_element_type_153 = None
        wait_tensor_55 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_47);  all_gather_into_tensor_47 = None
        permute_42 = torch.ops.aten.permute.default(wait_tensor_55, [1, 0]);  wait_tensor_55 = None
        permute_1600 = torch.ops.aten.permute.default(permute_42, [1, 0]);  permute_42 = None
        mm_599 = torch.ops.aten.mm.default(view_2231, permute_1600);  view_2231 = permute_1600 = None
        view_2232 = torch.ops.aten.view.default(mm_599, [2, 4096, 2048]);  mm_599 = None
        convert_element_type_3220 = torch.ops.prims.convert_element_type.default(mm_598, torch.float32);  mm_598 = None
        reduce_scatter_tensor_335 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3220, 'avg', 64, '0');  convert_element_type_3220 = None
        wait_tensor_942 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_335);  reduce_scatter_tensor_335 = None
        slice_249 = torch.ops.aten.slice.Tensor(permute_1593, 3, 0, 128)
        slice_250 = torch.ops.aten.slice.Tensor(permute_1593, 3, 128, 192);  permute_1593 = None
        convert_element_type_3221 = torch.ops.prims.convert_element_type.default(slice_250, torch.float32);  slice_250 = None
        view_2233 = torch.ops.aten.view.default(convert_element_type_3221, [2, 4096, 16, 32, 2]);  convert_element_type_3221 = None
        view_as_complex_101 = torch.ops.aten.view_as_complex.default(view_2233);  view_2233 = None
        mul_2100 = torch.ops.aten.mul.Tensor(view_as_complex_101, clone_9);  view_as_complex_101 = None
        view_as_real_101 = torch.ops.aten.view_as_real.default(mul_2100);  mul_2100 = None
        view_2234 = torch.ops.aten.view.default(view_as_real_101, [2, 4096, 16, 64]);  view_as_real_101 = None
        convert_element_type_3222 = torch.ops.prims.convert_element_type.default(view_2234, torch.bfloat16);  view_2234 = None
        cat_151 = torch.ops.aten.cat.default([slice_249, convert_element_type_3222], 3);  slice_249 = convert_element_type_3222 = None
        view_2235 = torch.ops.aten.view.default(cat_151, [2, 4096, 3072]);  cat_151 = None
        view_2236 = torch.ops.aten.view.default(view_2235, [8192, 3072]);  view_2235 = None
        permute_1602 = torch.ops.aten.permute.default(view_2236, [1, 0])
        mm_600 = torch.ops.aten.mm.default(permute_1602, view_170);  permute_1602 = view_170 = None
        convert_element_type_148 = torch.ops.prims.convert_element_type.default(primals_56, torch.bfloat16);  primals_56 = None
        all_gather_into_tensor_46 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_148, 64, '0');  convert_element_type_148 = None
        wait_tensor_54 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_46);  all_gather_into_tensor_46 = None
        permute_41 = torch.ops.aten.permute.default(wait_tensor_54, [1, 0]);  wait_tensor_54 = None
        permute_1604 = torch.ops.aten.permute.default(permute_41, [1, 0]);  permute_41 = None
        mm_601 = torch.ops.aten.mm.default(view_2236, permute_1604);  view_2236 = permute_1604 = None
        view_2237 = torch.ops.aten.view.default(mm_601, [2, 4096, 2048]);  mm_601 = None
        add_2133 = torch.ops.aten.add.Tensor(view_2232, view_2237);  view_2232 = view_2237 = None
        convert_element_type_3227 = torch.ops.prims.convert_element_type.default(mm_600, torch.float32);  mm_600 = None
        reduce_scatter_tensor_336 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3227, 'avg', 64, '0');  convert_element_type_3227 = None
        wait_tensor_943 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_336);  reduce_scatter_tensor_336 = None
        convert_element_type_3228 = torch.ops.prims.convert_element_type.default(add_2133, torch.float32);  add_2133 = None
        convert_element_type_145 = torch.ops.prims.convert_element_type.default(primals_55, torch.bfloat16);  primals_55 = None
        all_gather_into_tensor_45 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_145, 64, '0');  convert_element_type_145 = None
        wait_tensor_53 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_45);  all_gather_into_tensor_45 = None
        convert_element_type_3230 = torch.ops.prims.convert_element_type.default(wait_tensor_53, torch.float32);  wait_tensor_53 = None
        mul_2101 = torch.ops.aten.mul.Tensor(convert_element_type_3228, convert_element_type_3230);  convert_element_type_3230 = None
        convert_element_type_146 = torch.ops.prims.convert_element_type.default(add_141, torch.float32);  add_141 = None
        mul_107 = torch.ops.aten.mul.Tensor(convert_element_type_146, rsqrt_9);  convert_element_type_146 = None
        mul_2103 = torch.ops.aten.mul.Tensor(mul_107, mul_2101)
        sum_297 = torch.ops.aten.sum.dim_IntList(mul_2103, [2], True);  mul_2103 = None
        div_275 = torch.ops.aten.div.Tensor(mul_107, 2048)
        mul_2104 = torch.ops.aten.mul.Tensor(div_275, sum_297);  div_275 = sum_297 = None
        sub_768 = torch.ops.aten.sub.Tensor(mul_2101, mul_2104);  mul_2101 = mul_2104 = None
        mul_2105 = torch.ops.aten.mul.Tensor(sub_768, rsqrt_9);  sub_768 = rsqrt_9 = None
        mul_2106 = torch.ops.aten.mul.Tensor(convert_element_type_3228, mul_107);  convert_element_type_3228 = mul_107 = None
        sum_298 = torch.ops.aten.sum.dim_IntList(mul_2106, [0, 1]);  mul_2106 = None
        convert_element_type_3231 = torch.ops.prims.convert_element_type.default(mul_2105, torch.bfloat16);  mul_2105 = None
        add_2134 = torch.ops.aten.add.Tensor(add_2132, convert_element_type_3231);  add_2132 = convert_element_type_3231 = None
        convert_element_type_default_10 = torch.ops.prims.convert_element_type.default(sum_298, torch.float32);  sum_298 = None
        reduce_scatter_tensor_337 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_10, 'avg', 64, '0');  convert_element_type_default_10 = None
        wait_tensor_944 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_337);  reduce_scatter_tensor_337 = None
        view_2238 = torch.ops.aten.view.default(add_2134, [8192, 2048])
        unsqueeze_77 = torch.ops.aten.unsqueeze.default(view_2238, 1)
        convert_element_type_3234 = torch.ops.prims.convert_element_type.default(unsqueeze_77, torch.float32);  unsqueeze_77 = None
        bmm_74 = torch.ops.aten.bmm.default(permute_1606, convert_element_type_3234);  permute_1606 = None
        bmm_75 = torch.ops.aten.bmm.default(convert_element_type_3234, permute_1607);  convert_element_type_3234 = permute_1607 = None
        convert_element_type_3235 = torch.ops.prims.convert_element_type.default(bmm_74, torch.bfloat16);  bmm_74 = None
        view_2239 = torch.ops.aten.view.default(bmm_75, [8192, 6]);  bmm_75 = None
        view_2240 = torch.ops.aten.view.default(convert_element_type_3235, [49152, 2048]);  convert_element_type_3235 = None
        index_100 = torch.ops.aten.index.Tensor(view_2240, [getitem_35]);  view_2240 = getitem_35 = None
        permute_1608 = torch.ops.aten.permute.default(view_2238, [1, 0])
        mm_602 = torch.ops.aten.mm.default(permute_1608, mul_104);  permute_1608 = mul_104 = None
        convert_element_type_140 = torch.ops.prims.convert_element_type.default(primals_54, torch.bfloat16);  primals_54 = None
        all_gather_into_tensor_44 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_140, 64, '0');  convert_element_type_140 = None
        wait_tensor_52 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_44);  all_gather_into_tensor_44 = None
        permute_40 = torch.ops.aten.permute.default(wait_tensor_52, [1, 0]);  wait_tensor_52 = None
        permute_1610 = torch.ops.aten.permute.default(permute_40, [1, 0]);  permute_40 = None
        mm_603 = torch.ops.aten.mm.default(view_2238, permute_1610);  view_2238 = permute_1610 = None
        convert_element_type_3240 = torch.ops.prims.convert_element_type.default(mm_602, torch.float32);  mm_602 = None
        reduce_scatter_tensor_338 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3240, 'avg', 64, '0');  convert_element_type_3240 = None
        wait_tensor_945 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_338);  reduce_scatter_tensor_338 = None
        convert_element_type_135 = torch.ops.prims.convert_element_type.default(mm_20, torch.float32);  mm_20 = None
        neg_4 = torch.ops.aten.neg.default(convert_element_type_135)
        exp_6 = torch.ops.aten.exp.default(neg_4);  neg_4 = None
        add_136 = torch.ops.aten.add.Tensor(exp_6, 1);  exp_6 = None
        div_10 = torch.ops.aten.div.Tensor(convert_element_type_135, add_136)
        convert_element_type_136 = torch.ops.prims.convert_element_type.default(div_10, torch.bfloat16);  div_10 = None
        mul_2107 = torch.ops.aten.mul.Tensor(mm_603, convert_element_type_136);  convert_element_type_136 = None
        mul_2108 = torch.ops.aten.mul.Tensor(mm_603, mm_21);  mm_603 = mm_21 = None
        permute_1612 = torch.ops.aten.permute.default(mul_2107, [1, 0])
        mm_604 = torch.ops.aten.mm.default(permute_1612, view_125);  permute_1612 = None
        convert_element_type_137 = torch.ops.prims.convert_element_type.default(primals_53, torch.bfloat16);  primals_53 = None
        all_gather_into_tensor_43 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_137, 64, '0');  convert_element_type_137 = None
        wait_tensor_51 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_43);  all_gather_into_tensor_43 = None
        permute_39 = torch.ops.aten.permute.default(wait_tensor_51, [1, 0]);  wait_tensor_51 = None
        permute_1614 = torch.ops.aten.permute.default(permute_39, [1, 0]);  permute_39 = None
        mm_605 = torch.ops.aten.mm.default(mul_2107, permute_1614);  mul_2107 = permute_1614 = None
        convert_element_type_3245 = torch.ops.prims.convert_element_type.default(mm_604, torch.float32);  mm_604 = None
        reduce_scatter_tensor_339 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3245, 'avg', 64, '0');  convert_element_type_3245 = None
        wait_tensor_946 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_339);  reduce_scatter_tensor_339 = None
        convert_element_type_3246 = torch.ops.prims.convert_element_type.default(mul_2108, torch.float32);  mul_2108 = None
        reciprocal_48 = torch.ops.aten.reciprocal.default(add_136);  add_136 = None
        mul_2109 = torch.ops.aten.mul.Tensor(reciprocal_48, 1);  reciprocal_48 = None
        mul_2110 = torch.ops.aten.mul.Tensor(convert_element_type_3246, mul_2109);  convert_element_type_3246 = None
        sub_769 = torch.ops.aten.sub.Tensor(1, mul_2109);  mul_2109 = None
        mul_2111 = torch.ops.aten.mul.Tensor(convert_element_type_135, sub_769);  convert_element_type_135 = sub_769 = None
        add_2136 = torch.ops.aten.add.Tensor(mul_2111, 1);  mul_2111 = None
        mul_2112 = torch.ops.aten.mul.Tensor(mul_2110, add_2136);  mul_2110 = add_2136 = None
        convert_element_type_3248 = torch.ops.prims.convert_element_type.default(mul_2112, torch.bfloat16);  mul_2112 = None
        permute_1616 = torch.ops.aten.permute.default(convert_element_type_3248, [1, 0])
        mm_606 = torch.ops.aten.mm.default(permute_1616, view_125);  permute_1616 = None
        convert_element_type_132 = torch.ops.prims.convert_element_type.default(primals_52, torch.bfloat16);  primals_52 = None
        all_gather_into_tensor_42 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_132, 64, '0');  convert_element_type_132 = None
        wait_tensor_50 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_42);  all_gather_into_tensor_42 = None
        permute_38 = torch.ops.aten.permute.default(wait_tensor_50, [1, 0]);  wait_tensor_50 = None
        permute_1618 = torch.ops.aten.permute.default(permute_38, [1, 0]);  permute_38 = None
        mm_607 = torch.ops.aten.mm.default(convert_element_type_3248, permute_1618);  convert_element_type_3248 = permute_1618 = None
        add_2137 = torch.ops.aten.add.Tensor(mm_605, mm_607);  mm_605 = mm_607 = None
        convert_element_type_3253 = torch.ops.prims.convert_element_type.default(mm_606, torch.float32);  mm_606 = None
        reduce_scatter_tensor_340 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3253, 'avg', 64, '0');  convert_element_type_3253 = None
        wait_tensor_947 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_340);  reduce_scatter_tensor_340 = None
        all_to_all_single_126 = torch.ops._c10d_functional.all_to_all_single.default(index_100, [_local_scalar_dense_24, _local_scalar_dense_25, _local_scalar_dense_26, _local_scalar_dense_27, _local_scalar_dense_28, _local_scalar_dense_29, _local_scalar_dense_30, _local_scalar_dense_31], [_local_scalar_dense_16, _local_scalar_dense_17, _local_scalar_dense_18, _local_scalar_dense_19, _local_scalar_dense_20, _local_scalar_dense_21, _local_scalar_dense_22, _local_scalar_dense_23], '521');  index_100 = None
        wait_tensor_948 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_126);  all_to_all_single_126 = None
        full_444 = torch.ops.aten.full.default([sym_size_int_5, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_5 = None
        slice_scatter_24 = torch.ops.aten.slice_scatter.default(full_444, wait_tensor_948, 0, 0, -1);  wait_tensor_948 = None
        index_101 = torch.ops.aten.index.Tensor(slice_scatter_24, [getitem_36]);  slice_scatter_24 = None
        permute_1620 = torch.ops.aten.permute.default(index_101, [1, 0])
        _grouped_mm_222 = torch.ops.aten._grouped_mm.default(permute_1620, mul_84, cumsum_5);  permute_1620 = mul_84 = None
        convert_element_type_126 = torch.ops.prims.convert_element_type.default(primals_50, torch.bfloat16);  primals_50 = None
        all_gather_into_tensor_38 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_126, 8, '513');  convert_element_type_126 = None
        wait_tensor_45 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_38);  all_gather_into_tensor_38 = None
        permute_37 = torch.ops.aten.permute.default(wait_tensor_45, [0, 2, 1]);  wait_tensor_45 = None
        permute_1622 = torch.ops.aten.permute.default(permute_37, [0, 2, 1]);  permute_37 = None
        _grouped_mm_223 = torch.ops.aten._grouped_mm.default(index_101, permute_1622, cumsum_5);  index_101 = permute_1622 = None
        convert_element_type_130 = torch.ops.prims.convert_element_type.default(_grouped_mm_3, torch.float32);  _grouped_mm_3 = None
        neg_3 = torch.ops.aten.neg.default(convert_element_type_130)
        exp_5 = torch.ops.aten.exp.default(neg_3);  neg_3 = None
        add_100 = torch.ops.aten.add.Tensor(exp_5, 1);  exp_5 = None
        div_9 = torch.ops.aten.div.Tensor(convert_element_type_130, add_100)
        convert_element_type_131 = torch.ops.prims.convert_element_type.default(div_9, torch.bfloat16);  div_9 = None
        mul_2113 = torch.ops.aten.mul.Tensor(_grouped_mm_223, convert_element_type_131);  convert_element_type_131 = None
        mul_2114 = torch.ops.aten.mul.Tensor(_grouped_mm_223, _grouped_mm_4);  _grouped_mm_223 = _grouped_mm_4 = None
        permute_1624 = torch.ops.aten.permute.default(mul_2113, [1, 0])
        _grouped_mm_224 = torch.ops.aten._grouped_mm.default(permute_1624, index_3, cumsum_5);  permute_1624 = None
        convert_element_type_127 = torch.ops.prims.convert_element_type.default(primals_51, torch.bfloat16);  primals_51 = None
        all_gather_into_tensor_39 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_127, 8, '513');  convert_element_type_127 = None
        wait_tensor_46 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_39);  all_gather_into_tensor_39 = None
        permute_36 = torch.ops.aten.permute.default(wait_tensor_46, [0, 2, 1]);  wait_tensor_46 = None
        permute_1626 = torch.ops.aten.permute.default(permute_36, [0, 2, 1]);  permute_36 = None
        _grouped_mm_225 = torch.ops.aten._grouped_mm.default(mul_2113, permute_1626, cumsum_5);  mul_2113 = permute_1626 = None
        convert_element_type_3254 = torch.ops.prims.convert_element_type.default(mul_2114, torch.float32);  mul_2114 = None
        reciprocal_49 = torch.ops.aten.reciprocal.default(add_100);  add_100 = None
        mul_2115 = torch.ops.aten.mul.Tensor(reciprocal_49, 1);  reciprocal_49 = None
        mul_2116 = torch.ops.aten.mul.Tensor(convert_element_type_3254, mul_2115);  convert_element_type_3254 = None
        sub_770 = torch.ops.aten.sub.Tensor(1, mul_2115);  mul_2115 = None
        mul_2117 = torch.ops.aten.mul.Tensor(convert_element_type_130, sub_770);  convert_element_type_130 = sub_770 = None
        add_2139 = torch.ops.aten.add.Tensor(mul_2117, 1);  mul_2117 = None
        mul_2118 = torch.ops.aten.mul.Tensor(mul_2116, add_2139);  mul_2116 = add_2139 = None
        convert_element_type_3256 = torch.ops.prims.convert_element_type.default(mul_2118, torch.bfloat16);  mul_2118 = None
        permute_1628 = torch.ops.aten.permute.default(convert_element_type_3256, [1, 0])
        _grouped_mm_226 = torch.ops.aten._grouped_mm.default(permute_1628, index_3, cumsum_5);  permute_1628 = index_3 = None
        convert_element_type_124 = torch.ops.prims.convert_element_type.default(primals_49, torch.bfloat16);  primals_49 = None
        all_gather_into_tensor_36 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_124, 8, '513');  convert_element_type_124 = None
        wait_tensor_43 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_36);  all_gather_into_tensor_36 = None
        permute_35 = torch.ops.aten.permute.default(wait_tensor_43, [0, 2, 1]);  wait_tensor_43 = None
        permute_1630 = torch.ops.aten.permute.default(permute_35, [0, 2, 1]);  permute_35 = None
        _grouped_mm_227 = torch.ops.aten._grouped_mm.default(convert_element_type_3256, permute_1630, cumsum_5);  convert_element_type_3256 = permute_1630 = cumsum_5 = None
        add_2140 = torch.ops.aten.add.Tensor(_grouped_mm_225, _grouped_mm_227);  _grouped_mm_225 = _grouped_mm_227 = None
        convert_element_type_3257 = torch.ops.prims.convert_element_type.default(_grouped_mm_224, torch.float32);  _grouped_mm_224 = None
        div_276 = torch.ops.aten.div.Tensor(convert_element_type_3257, 64);  convert_element_type_3257 = None
        reduce_scatter_tensor_341 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_276, 'sum', 8, '513');  div_276 = None
        wait_tensor_949 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_341);  reduce_scatter_tensor_341 = None
        convert_element_type_3258 = torch.ops.prims.convert_element_type.default(_grouped_mm_222, torch.float32);  _grouped_mm_222 = None
        div_277 = torch.ops.aten.div.Tensor(convert_element_type_3258, 64);  convert_element_type_3258 = None
        reduce_scatter_tensor_342 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_277, 'sum', 8, '513');  div_277 = None
        wait_tensor_950 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_342);  reduce_scatter_tensor_342 = None
        convert_element_type_3259 = torch.ops.prims.convert_element_type.default(_grouped_mm_226, torch.float32);  _grouped_mm_226 = None
        div_278 = torch.ops.aten.div.Tensor(convert_element_type_3259, 64);  convert_element_type_3259 = None
        reduce_scatter_tensor_343 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_278, 'sum', 8, '513');  div_278 = None
        wait_tensor_951 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_343);  reduce_scatter_tensor_343 = None
        index_put_100 = torch.ops.aten.index_put.default(full_444, [getitem_36], add_2140, True);  full_444 = getitem_36 = add_2140 = None
        slice_251 = torch.ops.aten.slice.Tensor(index_put_100, 0, 0, add_2141);  index_put_100 = add_2141 = None
        all_to_all_single_127 = torch.ops._c10d_functional.all_to_all_single.default(slice_251, [_local_scalar_dense_16, _local_scalar_dense_17, _local_scalar_dense_18, _local_scalar_dense_19, _local_scalar_dense_20, _local_scalar_dense_21, _local_scalar_dense_22, _local_scalar_dense_23], [_local_scalar_dense_24, _local_scalar_dense_25, _local_scalar_dense_26, _local_scalar_dense_27, _local_scalar_dense_28, _local_scalar_dense_29, _local_scalar_dense_30, _local_scalar_dense_31], '521');  slice_251 = _local_scalar_dense_16 = _local_scalar_dense_17 = _local_scalar_dense_18 = _local_scalar_dense_19 = _local_scalar_dense_20 = _local_scalar_dense_21 = _local_scalar_dense_22 = _local_scalar_dense_23 = _local_scalar_dense_24 = _local_scalar_dense_25 = _local_scalar_dense_26 = _local_scalar_dense_27 = _local_scalar_dense_28 = _local_scalar_dense_29 = _local_scalar_dense_30 = _local_scalar_dense_31 = None
        wait_tensor_952 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_127);  all_to_all_single_127 = None
        index_put_101 = torch.ops.aten.index_put.default(full_default_52, [div_7], wait_tensor_952, True);  div_7 = wait_tensor_952 = None
        add_2145 = torch.ops.aten.add.Tensor(add_2137, index_put_101);  add_2137 = index_put_101 = None
        mul_2119 = torch.ops.aten.mul.Tensor(view_2239, 1.0);  view_2239 = None
        scatter_add_24 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_33, mul_2119);  getitem_33 = mul_2119 = None
        convert_element_type_119 = torch.ops.prims.convert_element_type.default(mm_19, torch.float32);  mm_19 = None
        sub_24 = torch.ops.aten.sub.Tensor(convert_element_type_119, amax_1);  convert_element_type_119 = amax_1 = None
        exp_4 = torch.ops.aten.exp.default(sub_24);  sub_24 = None
        div_6 = torch.ops.aten.div.Tensor(exp_4, sum_5);  exp_4 = sum_5 = None
        mul_2120 = torch.ops.aten.mul.Tensor(scatter_add_24, div_6);  scatter_add_24 = None
        sum_299 = torch.ops.aten.sum.dim_IntList(mul_2120, [1], True)
        neg_127 = torch.ops.aten.neg.default(div_6);  div_6 = None
        fma_24 = torch.ops.prims.fma.default(neg_127, sum_299, mul_2120);  neg_127 = sum_299 = mul_2120 = None
        convert_element_type_3260 = torch.ops.prims.convert_element_type.default(fma_24, torch.bfloat16);  fma_24 = None
        permute_1632 = torch.ops.aten.permute.default(convert_element_type_3260, [1, 0])
        mm_608 = torch.ops.aten.mm.default(permute_1632, view_125);  permute_1632 = view_125 = None
        convert_element_type_116 = torch.ops.prims.convert_element_type.default(primals_47, torch.bfloat16);  primals_47 = None
        all_gather_into_tensor_35 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_116, 64, '0');  convert_element_type_116 = None
        wait_tensor_39 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_35);  all_gather_into_tensor_35 = None
        permute_34 = torch.ops.aten.permute.default(wait_tensor_39, [1, 0]);  wait_tensor_39 = None
        permute_1634 = torch.ops.aten.permute.default(permute_34, [1, 0]);  permute_34 = None
        mm_609 = torch.ops.aten.mm.default(convert_element_type_3260, permute_1634);  convert_element_type_3260 = permute_1634 = None
        add_2146 = torch.ops.aten.add.Tensor(add_2145, mm_609);  add_2145 = mm_609 = None
        convert_element_type_3265 = torch.ops.prims.convert_element_type.default(mm_608, torch.float32);  mm_608 = None
        reduce_scatter_tensor_344 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3265, 'avg', 64, '0');  convert_element_type_3265 = None
        wait_tensor_953 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_344);  reduce_scatter_tensor_344 = None
        view_2241 = torch.ops.aten.view.default(add_2146, [2, 4096, 2048]);  add_2146 = None
        convert_element_type_3266 = torch.ops.prims.convert_element_type.default(view_2241, torch.float32);  view_2241 = None
        convert_element_type_113 = torch.ops.prims.convert_element_type.default(primals_45, torch.bfloat16);  primals_45 = None
        all_gather_into_tensor_34 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_113, 64, '0');  convert_element_type_113 = None
        wait_tensor_38 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_34);  all_gather_into_tensor_34 = None
        convert_element_type_3268 = torch.ops.prims.convert_element_type.default(wait_tensor_38, torch.float32);  wait_tensor_38 = None
        mul_2121 = torch.ops.aten.mul.Tensor(convert_element_type_3266, convert_element_type_3268);  convert_element_type_3268 = None
        convert_element_type_114 = torch.ops.prims.convert_element_type.default(add_76, torch.float32);  add_76 = None
        mul_64 = torch.ops.aten.mul.Tensor(convert_element_type_114, rsqrt_8);  convert_element_type_114 = None
        mul_2123 = torch.ops.aten.mul.Tensor(mul_64, mul_2121)
        sum_300 = torch.ops.aten.sum.dim_IntList(mul_2123, [2], True);  mul_2123 = None
        div_279 = torch.ops.aten.div.Tensor(mul_64, 2048)
        mul_2124 = torch.ops.aten.mul.Tensor(div_279, sum_300);  div_279 = sum_300 = None
        sub_772 = torch.ops.aten.sub.Tensor(mul_2121, mul_2124);  mul_2121 = mul_2124 = None
        mul_2125 = torch.ops.aten.mul.Tensor(sub_772, rsqrt_8);  sub_772 = rsqrt_8 = None
        mul_2126 = torch.ops.aten.mul.Tensor(convert_element_type_3266, mul_64);  convert_element_type_3266 = mul_64 = None
        sum_301 = torch.ops.aten.sum.dim_IntList(mul_2126, [0, 1]);  mul_2126 = None
        convert_element_type_3269 = torch.ops.prims.convert_element_type.default(mul_2125, torch.bfloat16);  mul_2125 = None
        add_2147 = torch.ops.aten.add.Tensor(add_2134, convert_element_type_3269);  add_2134 = convert_element_type_3269 = None
        convert_element_type_default_9 = torch.ops.prims.convert_element_type.default(sum_301, torch.float32);  sum_301 = None
        reduce_scatter_tensor_345 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_9, 'avg', 64, '0');  convert_element_type_default_9 = None
        wait_tensor_954 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_345);  reduce_scatter_tensor_345 = None
        view_2242 = torch.ops.aten.view.default(add_2147, [8192, 2048])
        permute_1636 = torch.ops.aten.permute.default(view_2242, [1, 0])
        permute_32 = torch.ops.aten.permute.default(getitem_29, [0, 2, 1, 3])
        view_120 = torch.ops.aten.view.default(permute_32, [2, 4096, -1]);  permute_32 = None
        view_122 = torch.ops.aten.view.default(view_120, [8192, 2048]);  view_120 = None
        mm_610 = torch.ops.aten.mm.default(permute_1636, view_122);  permute_1636 = view_122 = None
        convert_element_type_110 = torch.ops.prims.convert_element_type.default(primals_44, torch.bfloat16);  primals_44 = None
        all_gather_into_tensor_33 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_110, 64, '0');  convert_element_type_110 = None
        wait_tensor_37 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_33);  all_gather_into_tensor_33 = None
        permute_33 = torch.ops.aten.permute.default(wait_tensor_37, [1, 0]);  wait_tensor_37 = None
        permute_1638 = torch.ops.aten.permute.default(permute_33, [1, 0]);  permute_33 = None
        mm_611 = torch.ops.aten.mm.default(view_2242, permute_1638);  view_2242 = permute_1638 = None
        view_2243 = torch.ops.aten.view.default(mm_611, [2, 4096, 2048]);  mm_611 = None
        convert_element_type_3276 = torch.ops.prims.convert_element_type.default(mm_610, torch.float32);  mm_610 = None
        reduce_scatter_tensor_346 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3276, 'avg', 64, '0');  convert_element_type_3276 = None
        wait_tensor_955 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_346);  reduce_scatter_tensor_346 = None
        view_2244 = torch.ops.aten.view.default(view_2243, [2, 4096, 16, 128]);  view_2243 = None
        permute_1640 = torch.ops.aten.permute.default(view_2244, [0, 2, 1, 3]);  view_2244 = None
        fw_graph24 = self.fw_graph24
        joint_graph24 = self.joint_graph24
        mask_graph24 = self.mask_graph24
        flex_attention_backward_24 = torch.ops.higher_order.flex_attention_backward(permute_29, permute_30, permute_31, getitem_29, getitem_30, permute_1640, None, fw_graph24, joint_graph24, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph24), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_29 = permute_30 = permute_31 = getitem_29 = getitem_30 = permute_1640 = fw_graph24 = joint_graph24 = mask_graph24 = None
        getitem_469 = flex_attention_backward_24[0]
        getitem_470 = flex_attention_backward_24[1]
        getitem_471 = flex_attention_backward_24[2];  flex_attention_backward_24 = None
        permute_1641 = torch.ops.aten.permute.default(getitem_471, [0, 2, 1, 3]);  getitem_471 = None
        permute_1642 = torch.ops.aten.permute.default(getitem_470, [0, 2, 1, 3]);  getitem_470 = None
        permute_1643 = torch.ops.aten.permute.default(getitem_469, [0, 2, 1, 3]);  getitem_469 = None
        slice_253 = torch.ops.aten.slice.Tensor(permute_1642, 3, 0, 128)
        slice_254 = torch.ops.aten.slice.Tensor(permute_1642, 3, 128, 192);  permute_1642 = None
        sum_302 = torch.ops.aten.sum.dim_IntList(slice_254, [2], True);  slice_254 = None
        cat_152 = torch.ops.aten.cat.default([slice_253, permute_1641], 3);  slice_253 = permute_1641 = None
        view_2245 = torch.ops.aten.view.default(cat_152, [2, 4096, 4096]);  cat_152 = None
        view_2246 = torch.ops.aten.view.default(view_2245, [8192, 4096]);  view_2245 = None
        permute_1644 = torch.ops.aten.permute.default(view_2246, [1, 0])
        mm_612 = torch.ops.aten.mm.default(permute_1644, view_117);  permute_1644 = view_117 = None
        convert_element_type_107 = torch.ops.prims.convert_element_type.default(primals_43, torch.bfloat16);  primals_43 = None
        all_gather_into_tensor_32 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_107, 64, '0');  convert_element_type_107 = None
        wait_tensor_36 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_32);  all_gather_into_tensor_32 = None
        permute_28 = torch.ops.aten.permute.default(wait_tensor_36, [1, 0]);  wait_tensor_36 = None
        permute_1646 = torch.ops.aten.permute.default(permute_28, [1, 0]);  permute_28 = None
        mm_613 = torch.ops.aten.mm.default(view_2246, permute_1646);  view_2246 = permute_1646 = None
        view_2247 = torch.ops.aten.view.default(mm_613, [2, 4096, 512]);  mm_613 = None
        convert_element_type_3281 = torch.ops.prims.convert_element_type.default(mm_612, torch.float32);  mm_612 = None
        reduce_scatter_tensor_347 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3281, 'avg', 64, '0');  convert_element_type_3281 = None
        wait_tensor_956 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_347);  reduce_scatter_tensor_347 = None
        convert_element_type_3282 = torch.ops.prims.convert_element_type.default(view_2247, torch.float32);  view_2247 = None
        convert_element_type_104 = torch.ops.prims.convert_element_type.default(primals_42, torch.bfloat16);  primals_42 = None
        all_gather_into_tensor_31 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_104, 64, '0');  convert_element_type_104 = None
        wait_tensor_35 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_31);  all_gather_into_tensor_31 = None
        convert_element_type_3284 = torch.ops.prims.convert_element_type.default(wait_tensor_35, torch.float32);  wait_tensor_35 = None
        mul_2127 = torch.ops.aten.mul.Tensor(convert_element_type_3282, convert_element_type_3284);  convert_element_type_3284 = None
        convert_element_type_105 = torch.ops.prims.convert_element_type.default(getitem_25, torch.float32);  getitem_25 = None
        mul_62 = torch.ops.aten.mul.Tensor(convert_element_type_105, rsqrt_7);  convert_element_type_105 = None
        mul_2129 = torch.ops.aten.mul.Tensor(mul_62, mul_2127)
        sum_303 = torch.ops.aten.sum.dim_IntList(mul_2129, [2], True);  mul_2129 = None
        div_280 = torch.ops.aten.div.Tensor(mul_62, 512)
        mul_2130 = torch.ops.aten.mul.Tensor(div_280, sum_303);  div_280 = sum_303 = None
        sub_773 = torch.ops.aten.sub.Tensor(mul_2127, mul_2130);  mul_2127 = mul_2130 = None
        mul_2131 = torch.ops.aten.mul.Tensor(sub_773, rsqrt_7);  sub_773 = rsqrt_7 = None
        mul_2132 = torch.ops.aten.mul.Tensor(convert_element_type_3282, mul_62);  convert_element_type_3282 = mul_62 = None
        sum_304 = torch.ops.aten.sum.dim_IntList(mul_2132, [0, 1]);  mul_2132 = None
        convert_element_type_3285 = torch.ops.prims.convert_element_type.default(mul_2131, torch.bfloat16);  mul_2131 = None
        convert_element_type_default_8 = torch.ops.prims.convert_element_type.default(sum_304, torch.float32);  sum_304 = None
        reduce_scatter_tensor_348 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_8, 'avg', 64, '0');  convert_element_type_default_8 = None
        wait_tensor_957 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_348);  reduce_scatter_tensor_348 = None
        convert_element_type_3288 = torch.ops.prims.convert_element_type.default(sum_302, torch.float32);  sum_302 = None
        view_2248 = torch.ops.aten.view.default(convert_element_type_3288, [2, 4096, 1, 32, 2]);  convert_element_type_3288 = None
        view_as_complex_102 = torch.ops.aten.view_as_complex.default(view_2248);  view_2248 = None
        mul_2133 = torch.ops.aten.mul.Tensor(view_as_complex_102, clone_9);  view_as_complex_102 = None
        view_as_real_102 = torch.ops.aten.view_as_real.default(mul_2133);  mul_2133 = None
        view_2249 = torch.ops.aten.view.default(view_as_real_102, [2, 4096, 1, 64]);  view_as_real_102 = None
        convert_element_type_3289 = torch.ops.prims.convert_element_type.default(view_2249, torch.bfloat16);  view_2249 = None
        squeeze_50 = torch.ops.aten.squeeze.dim(convert_element_type_3289, 2);  convert_element_type_3289 = None
        cat_153 = torch.ops.aten.cat.default([convert_element_type_3285, squeeze_50], 2);  convert_element_type_3285 = squeeze_50 = None
        view_2250 = torch.ops.aten.view.default(cat_153, [8192, 576]);  cat_153 = None
        permute_1648 = torch.ops.aten.permute.default(view_2250, [1, 0])
        mm_614 = torch.ops.aten.mm.default(permute_1648, view_103);  permute_1648 = None
        convert_element_type_99 = torch.ops.prims.convert_element_type.default(primals_41, torch.bfloat16);  primals_41 = None
        all_gather_into_tensor_30 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_99, 64, '0');  convert_element_type_99 = None
        wait_tensor_34 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_30);  all_gather_into_tensor_30 = None
        permute_27 = torch.ops.aten.permute.default(wait_tensor_34, [1, 0]);  wait_tensor_34 = None
        permute_1650 = torch.ops.aten.permute.default(permute_27, [1, 0]);  permute_27 = None
        mm_615 = torch.ops.aten.mm.default(view_2250, permute_1650);  view_2250 = permute_1650 = None
        view_2251 = torch.ops.aten.view.default(mm_615, [2, 4096, 2048]);  mm_615 = None
        convert_element_type_3294 = torch.ops.prims.convert_element_type.default(mm_614, torch.float32);  mm_614 = None
        reduce_scatter_tensor_349 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3294, 'avg', 64, '0');  convert_element_type_3294 = None
        wait_tensor_958 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_349);  reduce_scatter_tensor_349 = None
        slice_255 = torch.ops.aten.slice.Tensor(permute_1643, 3, 0, 128)
        slice_256 = torch.ops.aten.slice.Tensor(permute_1643, 3, 128, 192);  permute_1643 = None
        convert_element_type_3295 = torch.ops.prims.convert_element_type.default(slice_256, torch.float32);  slice_256 = None
        view_2252 = torch.ops.aten.view.default(convert_element_type_3295, [2, 4096, 16, 32, 2]);  convert_element_type_3295 = None
        view_as_complex_103 = torch.ops.aten.view_as_complex.default(view_2252);  view_2252 = None
        mul_2134 = torch.ops.aten.mul.Tensor(view_as_complex_103, clone_9);  view_as_complex_103 = None
        view_as_real_103 = torch.ops.aten.view_as_real.default(mul_2134);  mul_2134 = None
        view_2253 = torch.ops.aten.view.default(view_as_real_103, [2, 4096, 16, 64]);  view_as_real_103 = None
        convert_element_type_3296 = torch.ops.prims.convert_element_type.default(view_2253, torch.bfloat16);  view_2253 = None
        cat_154 = torch.ops.aten.cat.default([slice_255, convert_element_type_3296], 3);  slice_255 = convert_element_type_3296 = None
        view_2254 = torch.ops.aten.view.default(cat_154, [2, 4096, 3072]);  cat_154 = None
        view_2255 = torch.ops.aten.view.default(view_2254, [8192, 3072]);  view_2254 = None
        permute_1652 = torch.ops.aten.permute.default(view_2255, [1, 0])
        mm_616 = torch.ops.aten.mm.default(permute_1652, view_103);  permute_1652 = view_103 = None
        convert_element_type_94 = torch.ops.prims.convert_element_type.default(primals_40, torch.bfloat16);  primals_40 = None
        all_gather_into_tensor_29 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_94, 64, '0');  convert_element_type_94 = None
        wait_tensor_33 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_29);  all_gather_into_tensor_29 = None
        permute_26 = torch.ops.aten.permute.default(wait_tensor_33, [1, 0]);  wait_tensor_33 = None
        permute_1654 = torch.ops.aten.permute.default(permute_26, [1, 0]);  permute_26 = None
        mm_617 = torch.ops.aten.mm.default(view_2255, permute_1654);  view_2255 = permute_1654 = None
        view_2256 = torch.ops.aten.view.default(mm_617, [2, 4096, 2048]);  mm_617 = None
        add_2148 = torch.ops.aten.add.Tensor(view_2251, view_2256);  view_2251 = view_2256 = None
        convert_element_type_3301 = torch.ops.prims.convert_element_type.default(mm_616, torch.float32);  mm_616 = None
        reduce_scatter_tensor_350 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3301, 'avg', 64, '0');  convert_element_type_3301 = None
        wait_tensor_959 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_350);  reduce_scatter_tensor_350 = None
        convert_element_type_3302 = torch.ops.prims.convert_element_type.default(add_2148, torch.float32);  add_2148 = None
        convert_element_type_91 = torch.ops.prims.convert_element_type.default(primals_39, torch.bfloat16);  primals_39 = None
        all_gather_into_tensor_28 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_91, 64, '0');  convert_element_type_91 = None
        wait_tensor_32 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_28);  all_gather_into_tensor_28 = None
        convert_element_type_3304 = torch.ops.prims.convert_element_type.default(wait_tensor_32, torch.float32);  wait_tensor_32 = None
        mul_2135 = torch.ops.aten.mul.Tensor(convert_element_type_3302, convert_element_type_3304);  convert_element_type_3304 = None
        convert_element_type_92 = torch.ops.prims.convert_element_type.default(add_73, torch.float32);  add_73 = None
        mul_58 = torch.ops.aten.mul.Tensor(convert_element_type_92, rsqrt_6);  convert_element_type_92 = None
        mul_2137 = torch.ops.aten.mul.Tensor(mul_58, mul_2135)
        sum_305 = torch.ops.aten.sum.dim_IntList(mul_2137, [2], True);  mul_2137 = None
        div_281 = torch.ops.aten.div.Tensor(mul_58, 2048)
        mul_2138 = torch.ops.aten.mul.Tensor(div_281, sum_305);  div_281 = sum_305 = None
        sub_774 = torch.ops.aten.sub.Tensor(mul_2135, mul_2138);  mul_2135 = mul_2138 = None
        mul_2139 = torch.ops.aten.mul.Tensor(sub_774, rsqrt_6);  sub_774 = rsqrt_6 = None
        mul_2140 = torch.ops.aten.mul.Tensor(convert_element_type_3302, mul_58);  convert_element_type_3302 = mul_58 = None
        sum_306 = torch.ops.aten.sum.dim_IntList(mul_2140, [0, 1]);  mul_2140 = None
        convert_element_type_3305 = torch.ops.prims.convert_element_type.default(mul_2139, torch.bfloat16);  mul_2139 = None
        add_2149 = torch.ops.aten.add.Tensor(add_2147, convert_element_type_3305);  add_2147 = convert_element_type_3305 = None
        convert_element_type_default_7 = torch.ops.prims.convert_element_type.default(sum_306, torch.float32);  sum_306 = None
        reduce_scatter_tensor_351 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_7, 'avg', 64, '0');  convert_element_type_default_7 = None
        wait_tensor_960 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_351);  reduce_scatter_tensor_351 = None
        view_2257 = torch.ops.aten.view.default(add_2149, [8192, 2048])
        unsqueeze_78 = torch.ops.aten.unsqueeze.default(view_2257, 1)
        convert_element_type_3308 = torch.ops.prims.convert_element_type.default(unsqueeze_78, torch.float32);  unsqueeze_78 = None
        bmm_76 = torch.ops.aten.bmm.default(permute_1656, convert_element_type_3308);  permute_1656 = None
        bmm_77 = torch.ops.aten.bmm.default(convert_element_type_3308, permute_1657);  convert_element_type_3308 = permute_1657 = None
        convert_element_type_3309 = torch.ops.prims.convert_element_type.default(bmm_76, torch.bfloat16);  bmm_76 = None
        view_2258 = torch.ops.aten.view.default(bmm_77, [8192, 6]);  bmm_77 = None
        view_2259 = torch.ops.aten.view.default(convert_element_type_3309, [49152, 2048]);  convert_element_type_3309 = None
        index_102 = torch.ops.aten.index.Tensor(view_2259, [getitem_21]);  view_2259 = getitem_21 = None
        permute_1658 = torch.ops.aten.permute.default(view_2257, [1, 0])
        mm_618 = torch.ops.aten.mm.default(permute_1658, mul_55);  permute_1658 = mul_55 = None
        convert_element_type_86 = torch.ops.prims.convert_element_type.default(primals_38, torch.bfloat16);  primals_38 = None
        all_gather_into_tensor_27 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_86, 64, '0');  convert_element_type_86 = None
        wait_tensor_31 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_27);  all_gather_into_tensor_27 = None
        permute_25 = torch.ops.aten.permute.default(wait_tensor_31, [1, 0]);  wait_tensor_31 = None
        permute_1660 = torch.ops.aten.permute.default(permute_25, [1, 0]);  permute_25 = None
        mm_619 = torch.ops.aten.mm.default(view_2257, permute_1660);  view_2257 = permute_1660 = None
        convert_element_type_3314 = torch.ops.prims.convert_element_type.default(mm_618, torch.float32);  mm_618 = None
        reduce_scatter_tensor_352 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3314, 'avg', 64, '0');  convert_element_type_3314 = None
        wait_tensor_961 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_352);  reduce_scatter_tensor_352 = None
        convert_element_type_81 = torch.ops.prims.convert_element_type.default(mm_12, torch.float32);  mm_12 = None
        neg_2 = torch.ops.aten.neg.default(convert_element_type_81)
        exp_3 = torch.ops.aten.exp.default(neg_2);  neg_2 = None
        add_68 = torch.ops.aten.add.Tensor(exp_3, 1);  exp_3 = None
        div_5 = torch.ops.aten.div.Tensor(convert_element_type_81, add_68)
        convert_element_type_82 = torch.ops.prims.convert_element_type.default(div_5, torch.bfloat16);  div_5 = None
        mul_2141 = torch.ops.aten.mul.Tensor(mm_619, convert_element_type_82);  convert_element_type_82 = None
        mul_2142 = torch.ops.aten.mul.Tensor(mm_619, mm_13);  mm_619 = mm_13 = None
        permute_1662 = torch.ops.aten.permute.default(mul_2141, [1, 0])
        mm_620 = torch.ops.aten.mm.default(permute_1662, view_58);  permute_1662 = None
        convert_element_type_83 = torch.ops.prims.convert_element_type.default(primals_37, torch.bfloat16);  primals_37 = None
        all_gather_into_tensor_26 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_83, 64, '0');  convert_element_type_83 = None
        wait_tensor_30 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_26);  all_gather_into_tensor_26 = None
        permute_24 = torch.ops.aten.permute.default(wait_tensor_30, [1, 0]);  wait_tensor_30 = None
        permute_1664 = torch.ops.aten.permute.default(permute_24, [1, 0]);  permute_24 = None
        mm_621 = torch.ops.aten.mm.default(mul_2141, permute_1664);  mul_2141 = permute_1664 = None
        convert_element_type_3319 = torch.ops.prims.convert_element_type.default(mm_620, torch.float32);  mm_620 = None
        reduce_scatter_tensor_353 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3319, 'avg', 64, '0');  convert_element_type_3319 = None
        wait_tensor_962 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_353);  reduce_scatter_tensor_353 = None
        convert_element_type_3320 = torch.ops.prims.convert_element_type.default(mul_2142, torch.float32);  mul_2142 = None
        reciprocal_50 = torch.ops.aten.reciprocal.default(add_68);  add_68 = None
        mul_2143 = torch.ops.aten.mul.Tensor(reciprocal_50, 1);  reciprocal_50 = None
        mul_2144 = torch.ops.aten.mul.Tensor(convert_element_type_3320, mul_2143);  convert_element_type_3320 = None
        sub_775 = torch.ops.aten.sub.Tensor(1, mul_2143);  mul_2143 = None
        mul_2145 = torch.ops.aten.mul.Tensor(convert_element_type_81, sub_775);  convert_element_type_81 = sub_775 = None
        add_2151 = torch.ops.aten.add.Tensor(mul_2145, 1);  mul_2145 = None
        mul_2146 = torch.ops.aten.mul.Tensor(mul_2144, add_2151);  mul_2144 = add_2151 = None
        convert_element_type_3322 = torch.ops.prims.convert_element_type.default(mul_2146, torch.bfloat16);  mul_2146 = None
        permute_1666 = torch.ops.aten.permute.default(convert_element_type_3322, [1, 0])
        mm_622 = torch.ops.aten.mm.default(permute_1666, view_58);  permute_1666 = None
        convert_element_type_78 = torch.ops.prims.convert_element_type.default(primals_36, torch.bfloat16);  primals_36 = None
        all_gather_into_tensor_25 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_78, 64, '0');  convert_element_type_78 = None
        wait_tensor_29 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_25);  all_gather_into_tensor_25 = None
        permute_23 = torch.ops.aten.permute.default(wait_tensor_29, [1, 0]);  wait_tensor_29 = None
        permute_1668 = torch.ops.aten.permute.default(permute_23, [1, 0]);  permute_23 = None
        mm_623 = torch.ops.aten.mm.default(convert_element_type_3322, permute_1668);  convert_element_type_3322 = permute_1668 = None
        add_2152 = torch.ops.aten.add.Tensor(mm_621, mm_623);  mm_621 = mm_623 = None
        convert_element_type_3327 = torch.ops.prims.convert_element_type.default(mm_622, torch.float32);  mm_622 = None
        reduce_scatter_tensor_354 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3327, 'avg', 64, '0');  convert_element_type_3327 = None
        wait_tensor_963 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_354);  reduce_scatter_tensor_354 = None
        all_to_all_single_128 = torch.ops._c10d_functional.all_to_all_single.default(index_102, [_local_scalar_dense_8, _local_scalar_dense_9, _local_scalar_dense_10, _local_scalar_dense_11, _local_scalar_dense_12, _local_scalar_dense_13, _local_scalar_dense_14, _local_scalar_dense_15], [_local_scalar_dense, _local_scalar_dense_1, _local_scalar_dense_2, _local_scalar_dense_3, _local_scalar_dense_4, _local_scalar_dense_5, _local_scalar_dense_6, _local_scalar_dense_7], '521');  index_102 = None
        wait_tensor_964 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_128);  all_to_all_single_128 = None
        full_448 = torch.ops.aten.full.default([sym_size_int_1, 2048], 0, dtype = torch.bfloat16, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False);  sym_size_int_1 = None
        slice_scatter_25 = torch.ops.aten.slice_scatter.default(full_448, wait_tensor_964, 0, 0, -1);  wait_tensor_964 = None
        index_103 = torch.ops.aten.index.Tensor(slice_scatter_25, [getitem_22]);  slice_scatter_25 = None
        permute_1670 = torch.ops.aten.permute.default(index_103, [1, 0])
        _grouped_mm_228 = torch.ops.aten._grouped_mm.default(permute_1670, mul_35, cumsum_2);  permute_1670 = mul_35 = None
        convert_element_type_72 = torch.ops.prims.convert_element_type.default(primals_34, torch.bfloat16);  primals_34 = None
        all_gather_into_tensor_21 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_72, 8, '513');  convert_element_type_72 = None
        wait_tensor_24 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_21);  all_gather_into_tensor_21 = None
        permute_22 = torch.ops.aten.permute.default(wait_tensor_24, [0, 2, 1]);  wait_tensor_24 = None
        permute_1672 = torch.ops.aten.permute.default(permute_22, [0, 2, 1]);  permute_22 = None
        _grouped_mm_229 = torch.ops.aten._grouped_mm.default(index_103, permute_1672, cumsum_2);  index_103 = permute_1672 = None
        convert_element_type_76 = torch.ops.prims.convert_element_type.default(_grouped_mm, torch.float32);  _grouped_mm = None
        neg_1 = torch.ops.aten.neg.default(convert_element_type_76)
        exp_2 = torch.ops.aten.exp.default(neg_1);  neg_1 = None
        add_32 = torch.ops.aten.add.Tensor(exp_2, 1);  exp_2 = None
        div_4 = torch.ops.aten.div.Tensor(convert_element_type_76, add_32)
        convert_element_type_77 = torch.ops.prims.convert_element_type.default(div_4, torch.bfloat16);  div_4 = None
        mul_2147 = torch.ops.aten.mul.Tensor(_grouped_mm_229, convert_element_type_77);  convert_element_type_77 = None
        mul_2148 = torch.ops.aten.mul.Tensor(_grouped_mm_229, _grouped_mm_1);  _grouped_mm_229 = _grouped_mm_1 = None
        permute_1674 = torch.ops.aten.permute.default(mul_2147, [1, 0])
        _grouped_mm_230 = torch.ops.aten._grouped_mm.default(permute_1674, index_1, cumsum_2);  permute_1674 = None
        convert_element_type_73 = torch.ops.prims.convert_element_type.default(primals_35, torch.bfloat16);  primals_35 = None
        all_gather_into_tensor_22 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_73, 8, '513');  convert_element_type_73 = None
        wait_tensor_25 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_22);  all_gather_into_tensor_22 = None
        permute_21 = torch.ops.aten.permute.default(wait_tensor_25, [0, 2, 1]);  wait_tensor_25 = None
        permute_1676 = torch.ops.aten.permute.default(permute_21, [0, 2, 1]);  permute_21 = None
        _grouped_mm_231 = torch.ops.aten._grouped_mm.default(mul_2147, permute_1676, cumsum_2);  mul_2147 = permute_1676 = None
        convert_element_type_3328 = torch.ops.prims.convert_element_type.default(mul_2148, torch.float32);  mul_2148 = None
        reciprocal_51 = torch.ops.aten.reciprocal.default(add_32);  add_32 = None
        mul_2149 = torch.ops.aten.mul.Tensor(reciprocal_51, 1);  reciprocal_51 = None
        mul_2150 = torch.ops.aten.mul.Tensor(convert_element_type_3328, mul_2149);  convert_element_type_3328 = None
        sub_776 = torch.ops.aten.sub.Tensor(1, mul_2149);  mul_2149 = None
        mul_2151 = torch.ops.aten.mul.Tensor(convert_element_type_76, sub_776);  convert_element_type_76 = sub_776 = None
        add_2154 = torch.ops.aten.add.Tensor(mul_2151, 1);  mul_2151 = None
        mul_2152 = torch.ops.aten.mul.Tensor(mul_2150, add_2154);  mul_2150 = add_2154 = None
        convert_element_type_3330 = torch.ops.prims.convert_element_type.default(mul_2152, torch.bfloat16);  mul_2152 = None
        permute_1678 = torch.ops.aten.permute.default(convert_element_type_3330, [1, 0])
        _grouped_mm_232 = torch.ops.aten._grouped_mm.default(permute_1678, index_1, cumsum_2);  permute_1678 = index_1 = None
        convert_element_type_70 = torch.ops.prims.convert_element_type.default(primals_33, torch.bfloat16);  primals_33 = None
        all_gather_into_tensor_19 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_70, 8, '513');  convert_element_type_70 = None
        wait_tensor_22 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_19);  all_gather_into_tensor_19 = None
        permute_20 = torch.ops.aten.permute.default(wait_tensor_22, [0, 2, 1]);  wait_tensor_22 = None
        permute_1680 = torch.ops.aten.permute.default(permute_20, [0, 2, 1]);  permute_20 = None
        _grouped_mm_233 = torch.ops.aten._grouped_mm.default(convert_element_type_3330, permute_1680, cumsum_2);  convert_element_type_3330 = permute_1680 = cumsum_2 = None
        add_2155 = torch.ops.aten.add.Tensor(_grouped_mm_231, _grouped_mm_233);  _grouped_mm_231 = _grouped_mm_233 = None
        convert_element_type_3331 = torch.ops.prims.convert_element_type.default(_grouped_mm_230, torch.float32);  _grouped_mm_230 = None
        div_282 = torch.ops.aten.div.Tensor(convert_element_type_3331, 64);  convert_element_type_3331 = None
        reduce_scatter_tensor_355 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_282, 'sum', 8, '513');  div_282 = None
        wait_tensor_965 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_355);  reduce_scatter_tensor_355 = None
        convert_element_type_3332 = torch.ops.prims.convert_element_type.default(_grouped_mm_228, torch.float32);  _grouped_mm_228 = None
        div_283 = torch.ops.aten.div.Tensor(convert_element_type_3332, 64);  convert_element_type_3332 = None
        reduce_scatter_tensor_356 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_283, 'sum', 8, '513');  div_283 = None
        wait_tensor_966 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_356);  reduce_scatter_tensor_356 = None
        convert_element_type_3333 = torch.ops.prims.convert_element_type.default(_grouped_mm_232, torch.float32);  _grouped_mm_232 = None
        div_284 = torch.ops.aten.div.Tensor(convert_element_type_3333, 64);  convert_element_type_3333 = None
        reduce_scatter_tensor_357 = torch.ops._c10d_functional.reduce_scatter_tensor.default(div_284, 'sum', 8, '513');  div_284 = None
        wait_tensor_967 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_357);  reduce_scatter_tensor_357 = None
        index_put_102 = torch.ops.aten.index_put.default(full_448, [getitem_22], add_2155, True);  full_448 = getitem_22 = add_2155 = None
        slice_257 = torch.ops.aten.slice.Tensor(index_put_102, 0, 0, add_2156);  index_put_102 = add_2156 = None
        all_to_all_single_129 = torch.ops._c10d_functional.all_to_all_single.default(slice_257, [_local_scalar_dense, _local_scalar_dense_1, _local_scalar_dense_2, _local_scalar_dense_3, _local_scalar_dense_4, _local_scalar_dense_5, _local_scalar_dense_6, _local_scalar_dense_7], [_local_scalar_dense_8, _local_scalar_dense_9, _local_scalar_dense_10, _local_scalar_dense_11, _local_scalar_dense_12, _local_scalar_dense_13, _local_scalar_dense_14, _local_scalar_dense_15], '521');  slice_257 = _local_scalar_dense = _local_scalar_dense_1 = _local_scalar_dense_2 = _local_scalar_dense_3 = _local_scalar_dense_4 = _local_scalar_dense_5 = _local_scalar_dense_6 = _local_scalar_dense_7 = _local_scalar_dense_8 = _local_scalar_dense_9 = _local_scalar_dense_10 = _local_scalar_dense_11 = _local_scalar_dense_12 = _local_scalar_dense_13 = _local_scalar_dense_14 = _local_scalar_dense_15 = None
        wait_tensor_968 = torch.ops._c10d_functional.wait_tensor.default(all_to_all_single_129);  all_to_all_single_129 = None
        index_put_103 = torch.ops.aten.index_put.default(full_default_52, [div_2], wait_tensor_968, True);  full_default_52 = div_2 = wait_tensor_968 = None
        add_2160 = torch.ops.aten.add.Tensor(add_2152, index_put_103);  add_2152 = index_put_103 = None
        mul_2153 = torch.ops.aten.mul.Tensor(view_2258, 1.0);  view_2258 = None
        scatter_add_25 = torch.ops.aten.scatter_add.default(full_default_53, 1, getitem_19, mul_2153);  full_default_53 = getitem_19 = mul_2153 = None
        convert_element_type_65 = torch.ops.prims.convert_element_type.default(mm_11, torch.float32);  mm_11 = None
        sub = torch.ops.aten.sub.Tensor(convert_element_type_65, amax);  convert_element_type_65 = amax = None
        exp_1 = torch.ops.aten.exp.default(sub);  sub = None
        div_1 = torch.ops.aten.div.Tensor(exp_1, sum_1);  exp_1 = sum_1 = None
        mul_2154 = torch.ops.aten.mul.Tensor(scatter_add_25, div_1);  scatter_add_25 = None
        sum_307 = torch.ops.aten.sum.dim_IntList(mul_2154, [1], True)
        neg_130 = torch.ops.aten.neg.default(div_1);  div_1 = None
        fma_25 = torch.ops.prims.fma.default(neg_130, sum_307, mul_2154);  neg_130 = sum_307 = mul_2154 = None
        convert_element_type_3334 = torch.ops.prims.convert_element_type.default(fma_25, torch.bfloat16);  fma_25 = None
        permute_1682 = torch.ops.aten.permute.default(convert_element_type_3334, [1, 0])
        mm_624 = torch.ops.aten.mm.default(permute_1682, view_58);  permute_1682 = view_58 = None
        convert_element_type_62 = torch.ops.prims.convert_element_type.default(primals_31, torch.bfloat16);  primals_31 = None
        all_gather_into_tensor_18 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_62, 64, '0');  convert_element_type_62 = None
        wait_tensor_18 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_18);  all_gather_into_tensor_18 = None
        permute_19 = torch.ops.aten.permute.default(wait_tensor_18, [1, 0]);  wait_tensor_18 = None
        permute_1684 = torch.ops.aten.permute.default(permute_19, [1, 0]);  permute_19 = None
        mm_625 = torch.ops.aten.mm.default(convert_element_type_3334, permute_1684);  convert_element_type_3334 = permute_1684 = None
        add_2161 = torch.ops.aten.add.Tensor(add_2160, mm_625);  add_2160 = mm_625 = None
        convert_element_type_3339 = torch.ops.prims.convert_element_type.default(mm_624, torch.float32);  mm_624 = None
        reduce_scatter_tensor_358 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3339, 'avg', 64, '0');  convert_element_type_3339 = None
        wait_tensor_969 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_358);  reduce_scatter_tensor_358 = None
        view_2260 = torch.ops.aten.view.default(add_2161, [2, 4096, 2048]);  add_2161 = None
        convert_element_type_3340 = torch.ops.prims.convert_element_type.default(view_2260, torch.float32);  view_2260 = None
        convert_element_type_59 = torch.ops.prims.convert_element_type.default(primals_29, torch.bfloat16);  primals_29 = None
        all_gather_into_tensor_17 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_59, 64, '0');  convert_element_type_59 = None
        wait_tensor_17 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_17);  all_gather_into_tensor_17 = None
        convert_element_type_3342 = torch.ops.prims.convert_element_type.default(wait_tensor_17, torch.float32);  wait_tensor_17 = None
        mul_2155 = torch.ops.aten.mul.Tensor(convert_element_type_3340, convert_element_type_3342);  convert_element_type_3342 = None
        convert_element_type_60 = torch.ops.prims.convert_element_type.default(add_8, torch.float32);  add_8 = None
        mul_15 = torch.ops.aten.mul.Tensor(convert_element_type_60, rsqrt_5);  convert_element_type_60 = None
        mul_2157 = torch.ops.aten.mul.Tensor(mul_15, mul_2155)
        sum_308 = torch.ops.aten.sum.dim_IntList(mul_2157, [2], True);  mul_2157 = None
        div_285 = torch.ops.aten.div.Tensor(mul_15, 2048)
        mul_2158 = torch.ops.aten.mul.Tensor(div_285, sum_308);  div_285 = sum_308 = None
        sub_778 = torch.ops.aten.sub.Tensor(mul_2155, mul_2158);  mul_2155 = mul_2158 = None
        mul_2159 = torch.ops.aten.mul.Tensor(sub_778, rsqrt_5);  sub_778 = rsqrt_5 = None
        mul_2160 = torch.ops.aten.mul.Tensor(convert_element_type_3340, mul_15);  convert_element_type_3340 = mul_15 = None
        sum_309 = torch.ops.aten.sum.dim_IntList(mul_2160, [0, 1]);  mul_2160 = None
        convert_element_type_3343 = torch.ops.prims.convert_element_type.default(mul_2159, torch.bfloat16);  mul_2159 = None
        add_2162 = torch.ops.aten.add.Tensor(add_2149, convert_element_type_3343);  add_2149 = convert_element_type_3343 = None
        convert_element_type_default_6 = torch.ops.prims.convert_element_type.default(sum_309, torch.float32);  sum_309 = None
        reduce_scatter_tensor_359 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_6, 'avg', 64, '0');  convert_element_type_default_6 = None
        wait_tensor_970 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_359);  reduce_scatter_tensor_359 = None
        view_2261 = torch.ops.aten.view.default(add_2162, [8192, 2048])
        permute_1686 = torch.ops.aten.permute.default(view_2261, [1, 0])
        permute_17 = torch.ops.aten.permute.default(getitem_15, [0, 2, 1, 3])
        view_53 = torch.ops.aten.view.default(permute_17, [2, 4096, -1]);  permute_17 = None
        view_55 = torch.ops.aten.view.default(view_53, [8192, 2048]);  view_53 = None
        mm_626 = torch.ops.aten.mm.default(permute_1686, view_55);  permute_1686 = view_55 = None
        convert_element_type_56 = torch.ops.prims.convert_element_type.default(primals_28, torch.bfloat16);  primals_28 = None
        all_gather_into_tensor_16 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_56, 64, '0');  convert_element_type_56 = None
        wait_tensor_16 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_16);  all_gather_into_tensor_16 = None
        permute_18 = torch.ops.aten.permute.default(wait_tensor_16, [1, 0]);  wait_tensor_16 = None
        permute_1688 = torch.ops.aten.permute.default(permute_18, [1, 0]);  permute_18 = None
        mm_627 = torch.ops.aten.mm.default(view_2261, permute_1688);  view_2261 = permute_1688 = None
        view_2262 = torch.ops.aten.view.default(mm_627, [2, 4096, 2048]);  mm_627 = None
        convert_element_type_3350 = torch.ops.prims.convert_element_type.default(mm_626, torch.float32);  mm_626 = None
        reduce_scatter_tensor_360 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3350, 'avg', 64, '0');  convert_element_type_3350 = None
        wait_tensor_971 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_360);  reduce_scatter_tensor_360 = None
        view_2263 = torch.ops.aten.view.default(view_2262, [2, 4096, 16, 128]);  view_2262 = None
        permute_1690 = torch.ops.aten.permute.default(view_2263, [0, 2, 1, 3]);  view_2263 = None
        fw_graph25 = self.fw_graph25
        joint_graph25 = self.joint_graph25
        mask_graph25 = self.mask_graph25
        flex_attention_backward_25 = torch.ops.higher_order.flex_attention_backward(permute_14, permute_15, permute_16, getitem_15, getitem_16, permute_1690, None, fw_graph25, joint_graph25, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph25), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_14 = permute_15 = permute_16 = getitem_15 = getitem_16 = permute_1690 = fw_graph25 = joint_graph25 = mask_graph25 = None
        getitem_473 = flex_attention_backward_25[0]
        getitem_474 = flex_attention_backward_25[1]
        getitem_475 = flex_attention_backward_25[2];  flex_attention_backward_25 = None
        permute_1691 = torch.ops.aten.permute.default(getitem_475, [0, 2, 1, 3]);  getitem_475 = None
        permute_1692 = torch.ops.aten.permute.default(getitem_474, [0, 2, 1, 3]);  getitem_474 = None
        permute_1693 = torch.ops.aten.permute.default(getitem_473, [0, 2, 1, 3]);  getitem_473 = None
        slice_259 = torch.ops.aten.slice.Tensor(permute_1692, 3, 0, 128)
        slice_260 = torch.ops.aten.slice.Tensor(permute_1692, 3, 128, 192);  permute_1692 = None
        sum_310 = torch.ops.aten.sum.dim_IntList(slice_260, [2], True);  slice_260 = None
        cat_155 = torch.ops.aten.cat.default([slice_259, permute_1691], 3);  slice_259 = permute_1691 = None
        view_2264 = torch.ops.aten.view.default(cat_155, [2, 4096, 4096]);  cat_155 = None
        view_2265 = torch.ops.aten.view.default(view_2264, [8192, 4096]);  view_2264 = None
        permute_1694 = torch.ops.aten.permute.default(view_2265, [1, 0])
        mm_628 = torch.ops.aten.mm.default(permute_1694, view_50);  permute_1694 = view_50 = None
        convert_element_type_53 = torch.ops.prims.convert_element_type.default(primals_27, torch.bfloat16);  primals_27 = None
        all_gather_into_tensor_15 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_53, 64, '0');  convert_element_type_53 = None
        wait_tensor_15 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_15);  all_gather_into_tensor_15 = None
        permute_13 = torch.ops.aten.permute.default(wait_tensor_15, [1, 0]);  wait_tensor_15 = None
        permute_1696 = torch.ops.aten.permute.default(permute_13, [1, 0]);  permute_13 = None
        mm_629 = torch.ops.aten.mm.default(view_2265, permute_1696);  view_2265 = permute_1696 = None
        view_2266 = torch.ops.aten.view.default(mm_629, [2, 4096, 512]);  mm_629 = None
        convert_element_type_3355 = torch.ops.prims.convert_element_type.default(mm_628, torch.float32);  mm_628 = None
        reduce_scatter_tensor_361 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3355, 'avg', 64, '0');  convert_element_type_3355 = None
        wait_tensor_972 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_361);  reduce_scatter_tensor_361 = None
        convert_element_type_3356 = torch.ops.prims.convert_element_type.default(view_2266, torch.float32);  view_2266 = None
        convert_element_type_50 = torch.ops.prims.convert_element_type.default(primals_26, torch.bfloat16);  primals_26 = None
        all_gather_into_tensor_14 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_50, 64, '0');  convert_element_type_50 = None
        wait_tensor_14 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_14);  all_gather_into_tensor_14 = None
        convert_element_type_3358 = torch.ops.prims.convert_element_type.default(wait_tensor_14, torch.float32);  wait_tensor_14 = None
        mul_2161 = torch.ops.aten.mul.Tensor(convert_element_type_3356, convert_element_type_3358);  convert_element_type_3358 = None
        convert_element_type_51 = torch.ops.prims.convert_element_type.default(getitem_11, torch.float32);  getitem_11 = None
        mul_13 = torch.ops.aten.mul.Tensor(convert_element_type_51, rsqrt_4);  convert_element_type_51 = None
        mul_2163 = torch.ops.aten.mul.Tensor(mul_13, mul_2161)
        sum_311 = torch.ops.aten.sum.dim_IntList(mul_2163, [2], True);  mul_2163 = None
        div_286 = torch.ops.aten.div.Tensor(mul_13, 512)
        mul_2164 = torch.ops.aten.mul.Tensor(div_286, sum_311);  div_286 = sum_311 = None
        sub_779 = torch.ops.aten.sub.Tensor(mul_2161, mul_2164);  mul_2161 = mul_2164 = None
        mul_2165 = torch.ops.aten.mul.Tensor(sub_779, rsqrt_4);  sub_779 = rsqrt_4 = None
        mul_2166 = torch.ops.aten.mul.Tensor(convert_element_type_3356, mul_13);  convert_element_type_3356 = mul_13 = None
        sum_312 = torch.ops.aten.sum.dim_IntList(mul_2166, [0, 1]);  mul_2166 = None
        convert_element_type_3359 = torch.ops.prims.convert_element_type.default(mul_2165, torch.bfloat16);  mul_2165 = None
        convert_element_type_default_5 = torch.ops.prims.convert_element_type.default(sum_312, torch.float32);  sum_312 = None
        reduce_scatter_tensor_362 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_5, 'avg', 64, '0');  convert_element_type_default_5 = None
        wait_tensor_973 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_362);  reduce_scatter_tensor_362 = None
        convert_element_type_3362 = torch.ops.prims.convert_element_type.default(sum_310, torch.float32);  sum_310 = None
        view_2267 = torch.ops.aten.view.default(convert_element_type_3362, [2, 4096, 1, 32, 2]);  convert_element_type_3362 = None
        view_as_complex_104 = torch.ops.aten.view_as_complex.default(view_2267);  view_2267 = None
        mul_2167 = torch.ops.aten.mul.Tensor(view_as_complex_104, clone_9);  view_as_complex_104 = None
        view_as_real_104 = torch.ops.aten.view_as_real.default(mul_2167);  mul_2167 = None
        view_2268 = torch.ops.aten.view.default(view_as_real_104, [2, 4096, 1, 64]);  view_as_real_104 = None
        convert_element_type_3363 = torch.ops.prims.convert_element_type.default(view_2268, torch.bfloat16);  view_2268 = None
        squeeze_51 = torch.ops.aten.squeeze.dim(convert_element_type_3363, 2);  convert_element_type_3363 = None
        cat_156 = torch.ops.aten.cat.default([convert_element_type_3359, squeeze_51], 2);  convert_element_type_3359 = squeeze_51 = None
        view_2269 = torch.ops.aten.view.default(cat_156, [8192, 576]);  cat_156 = None
        permute_1698 = torch.ops.aten.permute.default(view_2269, [1, 0])
        mm_630 = torch.ops.aten.mm.default(permute_1698, view_36);  permute_1698 = None
        convert_element_type_45 = torch.ops.prims.convert_element_type.default(primals_25, torch.bfloat16);  primals_25 = None
        all_gather_into_tensor_13 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_45, 64, '0');  convert_element_type_45 = None
        wait_tensor_13 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_13);  all_gather_into_tensor_13 = None
        permute_12 = torch.ops.aten.permute.default(wait_tensor_13, [1, 0]);  wait_tensor_13 = None
        permute_1700 = torch.ops.aten.permute.default(permute_12, [1, 0]);  permute_12 = None
        mm_631 = torch.ops.aten.mm.default(view_2269, permute_1700);  view_2269 = permute_1700 = None
        view_2270 = torch.ops.aten.view.default(mm_631, [2, 4096, 2048]);  mm_631 = None
        convert_element_type_3368 = torch.ops.prims.convert_element_type.default(mm_630, torch.float32);  mm_630 = None
        reduce_scatter_tensor_363 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3368, 'avg', 64, '0');  convert_element_type_3368 = None
        wait_tensor_974 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_363);  reduce_scatter_tensor_363 = None
        slice_261 = torch.ops.aten.slice.Tensor(permute_1693, 3, 0, 128)
        slice_262 = torch.ops.aten.slice.Tensor(permute_1693, 3, 128, 192);  permute_1693 = None
        convert_element_type_3369 = torch.ops.prims.convert_element_type.default(slice_262, torch.float32);  slice_262 = None
        view_2271 = torch.ops.aten.view.default(convert_element_type_3369, [2, 4096, 16, 32, 2]);  convert_element_type_3369 = None
        view_as_complex_105 = torch.ops.aten.view_as_complex.default(view_2271);  view_2271 = None
        mul_2168 = torch.ops.aten.mul.Tensor(view_as_complex_105, clone_9);  view_as_complex_105 = None
        view_as_real_105 = torch.ops.aten.view_as_real.default(mul_2168);  mul_2168 = None
        view_2272 = torch.ops.aten.view.default(view_as_real_105, [2, 4096, 16, 64]);  view_as_real_105 = None
        convert_element_type_3370 = torch.ops.prims.convert_element_type.default(view_2272, torch.bfloat16);  view_2272 = None
        cat_157 = torch.ops.aten.cat.default([slice_261, convert_element_type_3370], 3);  slice_261 = convert_element_type_3370 = None
        view_2273 = torch.ops.aten.view.default(cat_157, [2, 4096, 3072]);  cat_157 = None
        view_2274 = torch.ops.aten.view.default(view_2273, [8192, 3072]);  view_2273 = None
        permute_1702 = torch.ops.aten.permute.default(view_2274, [1, 0])
        mm_632 = torch.ops.aten.mm.default(permute_1702, view_36);  permute_1702 = view_36 = None
        convert_element_type_40 = torch.ops.prims.convert_element_type.default(primals_24, torch.bfloat16);  primals_24 = None
        all_gather_into_tensor_12 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_40, 64, '0');  convert_element_type_40 = None
        wait_tensor_12 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_12);  all_gather_into_tensor_12 = None
        permute_11 = torch.ops.aten.permute.default(wait_tensor_12, [1, 0]);  wait_tensor_12 = None
        permute_1704 = torch.ops.aten.permute.default(permute_11, [1, 0]);  permute_11 = None
        mm_633 = torch.ops.aten.mm.default(view_2274, permute_1704);  view_2274 = permute_1704 = None
        view_2275 = torch.ops.aten.view.default(mm_633, [2, 4096, 2048]);  mm_633 = None
        add_2163 = torch.ops.aten.add.Tensor(view_2270, view_2275);  view_2270 = view_2275 = None
        convert_element_type_3375 = torch.ops.prims.convert_element_type.default(mm_632, torch.float32);  mm_632 = None
        reduce_scatter_tensor_364 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3375, 'avg', 64, '0');  convert_element_type_3375 = None
        wait_tensor_975 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_364);  reduce_scatter_tensor_364 = None
        convert_element_type_3376 = torch.ops.prims.convert_element_type.default(add_2163, torch.float32);  add_2163 = None
        convert_element_type_37 = torch.ops.prims.convert_element_type.default(primals_23, torch.bfloat16);  primals_23 = None
        all_gather_into_tensor_11 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_37, 64, '0');  convert_element_type_37 = None
        wait_tensor_11 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_11);  all_gather_into_tensor_11 = None
        convert_element_type_3378 = torch.ops.prims.convert_element_type.default(wait_tensor_11, torch.float32);  wait_tensor_11 = None
        mul_2169 = torch.ops.aten.mul.Tensor(convert_element_type_3376, convert_element_type_3378);  convert_element_type_3378 = None
        convert_element_type_38 = torch.ops.prims.convert_element_type.default(add_5, torch.float32);  add_5 = None
        mul_9 = torch.ops.aten.mul.Tensor(convert_element_type_38, rsqrt_3);  convert_element_type_38 = None
        mul_2171 = torch.ops.aten.mul.Tensor(mul_9, mul_2169)
        sum_313 = torch.ops.aten.sum.dim_IntList(mul_2171, [2], True);  mul_2171 = None
        div_287 = torch.ops.aten.div.Tensor(mul_9, 2048)
        mul_2172 = torch.ops.aten.mul.Tensor(div_287, sum_313);  div_287 = sum_313 = None
        sub_780 = torch.ops.aten.sub.Tensor(mul_2169, mul_2172);  mul_2169 = mul_2172 = None
        mul_2173 = torch.ops.aten.mul.Tensor(sub_780, rsqrt_3);  sub_780 = rsqrt_3 = None
        mul_2174 = torch.ops.aten.mul.Tensor(convert_element_type_3376, mul_9);  convert_element_type_3376 = mul_9 = None
        sum_314 = torch.ops.aten.sum.dim_IntList(mul_2174, [0, 1]);  mul_2174 = None
        convert_element_type_3379 = torch.ops.prims.convert_element_type.default(mul_2173, torch.bfloat16);  mul_2173 = None
        add_2164 = torch.ops.aten.add.Tensor(add_2162, convert_element_type_3379);  add_2162 = convert_element_type_3379 = None
        convert_element_type_default_4 = torch.ops.prims.convert_element_type.default(sum_314, torch.float32);  sum_314 = None
        reduce_scatter_tensor_365 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_4, 'avg', 64, '0');  convert_element_type_default_4 = None
        wait_tensor_976 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_365);  reduce_scatter_tensor_365 = None
        view_2276 = torch.ops.aten.view.default(add_2164, [8192, 2048])
        permute_1706 = torch.ops.aten.permute.default(view_2276, [1, 0])
        mm_634 = torch.ops.aten.mm.default(permute_1706, view_32);  permute_1706 = view_32 = None
        convert_element_type_34 = torch.ops.prims.convert_element_type.default(primals_22, torch.bfloat16);  primals_22 = None
        all_gather_into_tensor_10 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_34, 64, '0');  convert_element_type_34 = None
        wait_tensor_10 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_10);  all_gather_into_tensor_10 = None
        permute_10 = torch.ops.aten.permute.default(wait_tensor_10, [1, 0]);  wait_tensor_10 = None
        permute_1708 = torch.ops.aten.permute.default(permute_10, [1, 0]);  permute_10 = None
        mm_635 = torch.ops.aten.mm.default(view_2276, permute_1708);  view_2276 = permute_1708 = None
        view_2277 = torch.ops.aten.view.default(mm_635, [2, 4096, 10944]);  mm_635 = None
        convert_element_type_3386 = torch.ops.prims.convert_element_type.default(mm_634, torch.float32);  mm_634 = None
        reduce_scatter_tensor_366 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3386, 'avg', 64, '0');  convert_element_type_3386 = None
        wait_tensor_977 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_366);  reduce_scatter_tensor_366 = None
        view_27 = torch.ops.aten.view.default(mm_4, [2, 4096, 10944]);  mm_4 = None
        convert_element_type_29 = torch.ops.prims.convert_element_type.default(view_27, torch.float32);  view_27 = None
        neg = torch.ops.aten.neg.default(convert_element_type_29)
        exp = torch.ops.aten.exp.default(neg);  neg = None
        add_4 = torch.ops.aten.add.Tensor(exp, 1);  exp = None
        div = torch.ops.aten.div.Tensor(convert_element_type_29, add_4)
        convert_element_type_30 = torch.ops.prims.convert_element_type.default(div, torch.bfloat16);  div = None
        mul_2175 = torch.ops.aten.mul.Tensor(view_2277, convert_element_type_30);  convert_element_type_30 = None
        view_30 = torch.ops.aten.view.default(mm_5, [2, 4096, 10944]);  mm_5 = None
        mul_2176 = torch.ops.aten.mul.Tensor(view_2277, view_30);  view_2277 = view_30 = None
        view_2278 = torch.ops.aten.view.default(mul_2175, [8192, 10944]);  mul_2175 = None
        permute_1710 = torch.ops.aten.permute.default(view_2278, [1, 0])
        mm_636 = torch.ops.aten.mm.default(permute_1710, view_26);  permute_1710 = None
        convert_element_type_31 = torch.ops.prims.convert_element_type.default(primals_21, torch.bfloat16);  primals_21 = None
        all_gather_into_tensor_9 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_31, 64, '0');  convert_element_type_31 = None
        wait_tensor_9 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_9);  all_gather_into_tensor_9 = None
        permute_9 = torch.ops.aten.permute.default(wait_tensor_9, [1, 0]);  wait_tensor_9 = None
        permute_1712 = torch.ops.aten.permute.default(permute_9, [1, 0]);  permute_9 = None
        mm_637 = torch.ops.aten.mm.default(view_2278, permute_1712);  view_2278 = permute_1712 = None
        view_2279 = torch.ops.aten.view.default(mm_637, [2, 4096, 2048]);  mm_637 = None
        convert_element_type_3391 = torch.ops.prims.convert_element_type.default(mm_636, torch.float32);  mm_636 = None
        reduce_scatter_tensor_367 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3391, 'avg', 64, '0');  convert_element_type_3391 = None
        wait_tensor_978 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_367);  reduce_scatter_tensor_367 = None
        convert_element_type_3392 = torch.ops.prims.convert_element_type.default(mul_2176, torch.float32);  mul_2176 = None
        reciprocal_52 = torch.ops.aten.reciprocal.default(add_4);  add_4 = None
        mul_2177 = torch.ops.aten.mul.Tensor(reciprocal_52, 1);  reciprocal_52 = None
        mul_2178 = torch.ops.aten.mul.Tensor(convert_element_type_3392, mul_2177);  convert_element_type_3392 = None
        sub_781 = torch.ops.aten.sub.Tensor(1, mul_2177);  mul_2177 = None
        mul_2179 = torch.ops.aten.mul.Tensor(convert_element_type_29, sub_781);  convert_element_type_29 = sub_781 = None
        add_2166 = torch.ops.aten.add.Tensor(mul_2179, 1);  mul_2179 = None
        mul_2180 = torch.ops.aten.mul.Tensor(mul_2178, add_2166);  mul_2178 = add_2166 = None
        convert_element_type_3394 = torch.ops.prims.convert_element_type.default(mul_2180, torch.bfloat16);  mul_2180 = None
        view_2280 = torch.ops.aten.view.default(convert_element_type_3394, [8192, 10944]);  convert_element_type_3394 = None
        permute_1714 = torch.ops.aten.permute.default(view_2280, [1, 0])
        mm_638 = torch.ops.aten.mm.default(permute_1714, view_26);  permute_1714 = view_26 = None
        convert_element_type_26 = torch.ops.prims.convert_element_type.default(primals_20, torch.bfloat16);  primals_20 = None
        all_gather_into_tensor_8 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_26, 64, '0');  convert_element_type_26 = None
        wait_tensor_8 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_8);  all_gather_into_tensor_8 = None
        permute_8 = torch.ops.aten.permute.default(wait_tensor_8, [1, 0]);  wait_tensor_8 = None
        permute_1716 = torch.ops.aten.permute.default(permute_8, [1, 0]);  permute_8 = None
        mm_639 = torch.ops.aten.mm.default(view_2280, permute_1716);  view_2280 = permute_1716 = None
        view_2281 = torch.ops.aten.view.default(mm_639, [2, 4096, 2048]);  mm_639 = None
        add_2167 = torch.ops.aten.add.Tensor(view_2279, view_2281);  view_2279 = view_2281 = None
        convert_element_type_3399 = torch.ops.prims.convert_element_type.default(mm_638, torch.float32);  mm_638 = None
        reduce_scatter_tensor_368 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3399, 'avg', 64, '0');  convert_element_type_3399 = None
        wait_tensor_979 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_368);  reduce_scatter_tensor_368 = None
        convert_element_type_3400 = torch.ops.prims.convert_element_type.default(add_2167, torch.float32);  add_2167 = None
        convert_element_type_23 = torch.ops.prims.convert_element_type.default(primals_19, torch.bfloat16);  primals_19 = None
        all_gather_into_tensor_7 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_23, 64, '0');  convert_element_type_23 = None
        wait_tensor_7 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_7);  all_gather_into_tensor_7 = None
        convert_element_type_3402 = torch.ops.prims.convert_element_type.default(wait_tensor_7, torch.float32);  wait_tensor_7 = None
        mul_2181 = torch.ops.aten.mul.Tensor(convert_element_type_3400, convert_element_type_3402);  convert_element_type_3402 = None
        view_23 = torch.ops.aten.view.default(mm_3, [2, 4096, 2048]);  mm_3 = None
        add_2 = torch.ops.aten.add.Tensor(embedding, view_23);  view_23 = None
        convert_element_type_24 = torch.ops.prims.convert_element_type.default(add_2, torch.float32);  add_2 = None
        mul_6 = torch.ops.aten.mul.Tensor(convert_element_type_24, rsqrt_2);  convert_element_type_24 = None
        mul_2183 = torch.ops.aten.mul.Tensor(mul_6, mul_2181)
        sum_315 = torch.ops.aten.sum.dim_IntList(mul_2183, [2], True);  mul_2183 = None
        div_288 = torch.ops.aten.div.Tensor(mul_6, 2048)
        mul_2184 = torch.ops.aten.mul.Tensor(div_288, sum_315);  div_288 = sum_315 = None
        sub_782 = torch.ops.aten.sub.Tensor(mul_2181, mul_2184);  mul_2181 = mul_2184 = None
        mul_2185 = torch.ops.aten.mul.Tensor(sub_782, rsqrt_2);  sub_782 = rsqrt_2 = None
        mul_2186 = torch.ops.aten.mul.Tensor(convert_element_type_3400, mul_6);  convert_element_type_3400 = mul_6 = None
        sum_316 = torch.ops.aten.sum.dim_IntList(mul_2186, [0, 1]);  mul_2186 = None
        convert_element_type_3403 = torch.ops.prims.convert_element_type.default(mul_2185, torch.bfloat16);  mul_2185 = None
        add_2168 = torch.ops.aten.add.Tensor(add_2164, convert_element_type_3403);  add_2164 = convert_element_type_3403 = None
        convert_element_type_default_3 = torch.ops.prims.convert_element_type.default(sum_316, torch.float32);  sum_316 = None
        reduce_scatter_tensor_369 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_3, 'avg', 64, '0');  convert_element_type_default_3 = None
        wait_tensor_980 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_369);  reduce_scatter_tensor_369 = None
        view_2282 = torch.ops.aten.view.default(add_2168, [8192, 2048])
        permute_1718 = torch.ops.aten.permute.default(view_2282, [1, 0])
        permute_6 = torch.ops.aten.permute.default(getitem_6, [0, 2, 1, 3])
        view_20 = torch.ops.aten.view.default(permute_6, [2, 4096, -1]);  permute_6 = None
        view_22 = torch.ops.aten.view.default(view_20, [8192, 2048]);  view_20 = None
        mm_640 = torch.ops.aten.mm.default(permute_1718, view_22);  permute_1718 = view_22 = None
        convert_element_type_20 = torch.ops.prims.convert_element_type.default(primals_18, torch.bfloat16);  primals_18 = None
        all_gather_into_tensor_6 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_20, 64, '0');  convert_element_type_20 = None
        wait_tensor_6 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_6);  all_gather_into_tensor_6 = None
        permute_7 = torch.ops.aten.permute.default(wait_tensor_6, [1, 0]);  wait_tensor_6 = None
        permute_1720 = torch.ops.aten.permute.default(permute_7, [1, 0]);  permute_7 = None
        mm_641 = torch.ops.aten.mm.default(view_2282, permute_1720);  view_2282 = permute_1720 = None
        view_2283 = torch.ops.aten.view.default(mm_641, [2, 4096, 2048]);  mm_641 = None
        convert_element_type_3410 = torch.ops.prims.convert_element_type.default(mm_640, torch.float32);  mm_640 = None
        reduce_scatter_tensor_370 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3410, 'avg', 64, '0');  convert_element_type_3410 = None
        wait_tensor_981 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_370);  reduce_scatter_tensor_370 = None
        view_2284 = torch.ops.aten.view.default(view_2283, [2, 4096, 16, 128]);  view_2283 = None
        permute_1722 = torch.ops.aten.permute.default(view_2284, [0, 2, 1, 3]);  view_2284 = None
        fw_graph26 = self.fw_graph26
        joint_graph26 = self.joint_graph26
        mask_graph26 = self.mask_graph26
        flex_attention_backward_26 = torch.ops.higher_order.flex_attention_backward(permute_3, permute_4, permute_5, getitem_6, getitem_7, permute_1722, None, fw_graph26, joint_graph26, (4096, 4096, primals_10, primals_9, primals_12, primals_13, primals_14, primals_15, primals_16, primals_17, 128, 128, mask_graph26), 0.07216878364870322, {'BACKEND': 'AUTO', 'PRESCALE_QK': False, 'ROWS_GUARANTEED_SAFE': False, 'BLOCKS_ARE_CONTIGUOUS': False, 'WRITE_DQ': True, 'OUTPUT_LOGSUMEXP': True, 'OUTPUT_MAX': False}, (), (primals_11,));  permute_3 = permute_4 = permute_5 = getitem_6 = getitem_7 = permute_1722 = fw_graph26 = joint_graph26 = primals_10 = primals_9 = primals_12 = primals_13 = primals_14 = primals_15 = primals_16 = primals_17 = mask_graph26 = primals_11 = None
        getitem_477 = flex_attention_backward_26[0]
        getitem_478 = flex_attention_backward_26[1]
        getitem_479 = flex_attention_backward_26[2];  flex_attention_backward_26 = None
        permute_1723 = torch.ops.aten.permute.default(getitem_479, [0, 2, 1, 3]);  getitem_479 = None
        permute_1724 = torch.ops.aten.permute.default(getitem_478, [0, 2, 1, 3]);  getitem_478 = None
        permute_1725 = torch.ops.aten.permute.default(getitem_477, [0, 2, 1, 3]);  getitem_477 = None
        slice_263 = torch.ops.aten.slice.Tensor(permute_1724, 3, 0, 128)
        slice_264 = torch.ops.aten.slice.Tensor(permute_1724, 3, 128, 192);  permute_1724 = None
        sum_317 = torch.ops.aten.sum.dim_IntList(slice_264, [2], True);  slice_264 = None
        cat_158 = torch.ops.aten.cat.default([slice_263, permute_1723], 3);  slice_263 = permute_1723 = None
        view_2285 = torch.ops.aten.view.default(cat_158, [2, 4096, 4096]);  cat_158 = None
        view_2286 = torch.ops.aten.view.default(view_2285, [8192, 4096]);  view_2285 = None
        permute_1726 = torch.ops.aten.permute.default(view_2286, [1, 0])
        mm_642 = torch.ops.aten.mm.default(permute_1726, view_17);  permute_1726 = view_17 = None
        convert_element_type_17 = torch.ops.prims.convert_element_type.default(primals_8, torch.bfloat16);  primals_8 = None
        all_gather_into_tensor_5 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_17, 64, '0');  convert_element_type_17 = None
        wait_tensor_5 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_5);  all_gather_into_tensor_5 = None
        permute_2 = torch.ops.aten.permute.default(wait_tensor_5, [1, 0]);  wait_tensor_5 = None
        permute_1728 = torch.ops.aten.permute.default(permute_2, [1, 0]);  permute_2 = None
        mm_643 = torch.ops.aten.mm.default(view_2286, permute_1728);  view_2286 = permute_1728 = None
        view_2287 = torch.ops.aten.view.default(mm_643, [2, 4096, 512]);  mm_643 = None
        convert_element_type_3415 = torch.ops.prims.convert_element_type.default(mm_642, torch.float32);  mm_642 = None
        reduce_scatter_tensor_371 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3415, 'avg', 64, '0');  convert_element_type_3415 = None
        wait_tensor_982 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_371);  reduce_scatter_tensor_371 = None
        convert_element_type_3416 = torch.ops.prims.convert_element_type.default(view_2287, torch.float32);  view_2287 = None
        convert_element_type_14 = torch.ops.prims.convert_element_type.default(primals_7, torch.bfloat16);  primals_7 = None
        all_gather_into_tensor_4 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_14, 64, '0');  convert_element_type_14 = None
        wait_tensor_4 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_4);  all_gather_into_tensor_4 = None
        convert_element_type_3418 = torch.ops.prims.convert_element_type.default(wait_tensor_4, torch.float32);  wait_tensor_4 = None
        mul_2187 = torch.ops.aten.mul.Tensor(convert_element_type_3416, convert_element_type_3418);  convert_element_type_3418 = None
        convert_element_type_15 = torch.ops.prims.convert_element_type.default(getitem_2, torch.float32);  getitem_2 = None
        mul_4 = torch.ops.aten.mul.Tensor(convert_element_type_15, rsqrt_1);  convert_element_type_15 = None
        mul_2189 = torch.ops.aten.mul.Tensor(mul_4, mul_2187)
        sum_318 = torch.ops.aten.sum.dim_IntList(mul_2189, [2], True);  mul_2189 = None
        div_289 = torch.ops.aten.div.Tensor(mul_4, 512)
        mul_2190 = torch.ops.aten.mul.Tensor(div_289, sum_318);  div_289 = sum_318 = None
        sub_783 = torch.ops.aten.sub.Tensor(mul_2187, mul_2190);  mul_2187 = mul_2190 = None
        mul_2191 = torch.ops.aten.mul.Tensor(sub_783, rsqrt_1);  sub_783 = rsqrt_1 = None
        mul_2192 = torch.ops.aten.mul.Tensor(convert_element_type_3416, mul_4);  convert_element_type_3416 = mul_4 = None
        sum_319 = torch.ops.aten.sum.dim_IntList(mul_2192, [0, 1]);  mul_2192 = None
        convert_element_type_3419 = torch.ops.prims.convert_element_type.default(mul_2191, torch.bfloat16);  mul_2191 = None
        convert_element_type_default_2 = torch.ops.prims.convert_element_type.default(sum_319, torch.float32);  sum_319 = None
        reduce_scatter_tensor_372 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_2, 'avg', 64, '0');  convert_element_type_default_2 = None
        wait_tensor_983 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_372);  reduce_scatter_tensor_372 = None
        convert_element_type_3422 = torch.ops.prims.convert_element_type.default(sum_317, torch.float32);  sum_317 = None
        view_2288 = torch.ops.aten.view.default(convert_element_type_3422, [2, 4096, 1, 32, 2]);  convert_element_type_3422 = None
        view_as_complex_106 = torch.ops.aten.view_as_complex.default(view_2288);  view_2288 = None
        mul_2193 = torch.ops.aten.mul.Tensor(view_as_complex_106, clone_9);  view_as_complex_106 = None
        view_as_real_106 = torch.ops.aten.view_as_real.default(mul_2193);  mul_2193 = None
        view_2289 = torch.ops.aten.view.default(view_as_real_106, [2, 4096, 1, 64]);  view_as_real_106 = None
        convert_element_type_3423 = torch.ops.prims.convert_element_type.default(view_2289, torch.bfloat16);  view_2289 = None
        squeeze_52 = torch.ops.aten.squeeze.dim(convert_element_type_3423, 2);  convert_element_type_3423 = None
        cat_159 = torch.ops.aten.cat.default([convert_element_type_3419, squeeze_52], 2);  convert_element_type_3419 = squeeze_52 = None
        view_2290 = torch.ops.aten.view.default(cat_159, [8192, 576]);  cat_159 = None
        permute_1730 = torch.ops.aten.permute.default(view_2290, [1, 0])
        mm_644 = torch.ops.aten.mm.default(permute_1730, view_3);  permute_1730 = None
        convert_element_type_9 = torch.ops.prims.convert_element_type.default(primals_6, torch.bfloat16);  primals_6 = None
        all_gather_into_tensor_3 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_9, 64, '0');  convert_element_type_9 = None
        wait_tensor_3 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_3);  all_gather_into_tensor_3 = None
        permute_1 = torch.ops.aten.permute.default(wait_tensor_3, [1, 0]);  wait_tensor_3 = None
        permute_1732 = torch.ops.aten.permute.default(permute_1, [1, 0]);  permute_1 = None
        mm_645 = torch.ops.aten.mm.default(view_2290, permute_1732);  view_2290 = permute_1732 = None
        view_2291 = torch.ops.aten.view.default(mm_645, [2, 4096, 2048]);  mm_645 = None
        convert_element_type_3428 = torch.ops.prims.convert_element_type.default(mm_644, torch.float32);  mm_644 = None
        reduce_scatter_tensor_373 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3428, 'avg', 64, '0');  convert_element_type_3428 = None
        wait_tensor_984 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_373);  reduce_scatter_tensor_373 = None
        slice_265 = torch.ops.aten.slice.Tensor(permute_1725, 3, 0, 128)
        slice_266 = torch.ops.aten.slice.Tensor(permute_1725, 3, 128, 192);  permute_1725 = None
        convert_element_type_3429 = torch.ops.prims.convert_element_type.default(slice_266, torch.float32);  slice_266 = None
        view_2292 = torch.ops.aten.view.default(convert_element_type_3429, [2, 4096, 16, 32, 2]);  convert_element_type_3429 = None
        view_as_complex_107 = torch.ops.aten.view_as_complex.default(view_2292);  view_2292 = None
        mul_2194 = torch.ops.aten.mul.Tensor(view_as_complex_107, clone_9);  view_as_complex_107 = clone_9 = None
        view_as_real_107 = torch.ops.aten.view_as_real.default(mul_2194);  mul_2194 = None
        view_2293 = torch.ops.aten.view.default(view_as_real_107, [2, 4096, 16, 64]);  view_as_real_107 = None
        convert_element_type_3430 = torch.ops.prims.convert_element_type.default(view_2293, torch.bfloat16);  view_2293 = None
        cat_160 = torch.ops.aten.cat.default([slice_265, convert_element_type_3430], 3);  slice_265 = convert_element_type_3430 = None
        view_2294 = torch.ops.aten.view.default(cat_160, [2, 4096, 3072]);  cat_160 = None
        view_2295 = torch.ops.aten.view.default(view_2294, [8192, 3072]);  view_2294 = None
        permute_1734 = torch.ops.aten.permute.default(view_2295, [1, 0])
        mm_646 = torch.ops.aten.mm.default(permute_1734, view_3);  permute_1734 = view_3 = None
        convert_element_type_4 = torch.ops.prims.convert_element_type.default(primals_5, torch.bfloat16);  primals_5 = None
        all_gather_into_tensor_2 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_4, 64, '0');  convert_element_type_4 = None
        wait_tensor_2 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_2);  all_gather_into_tensor_2 = None
        permute = torch.ops.aten.permute.default(wait_tensor_2, [1, 0]);  wait_tensor_2 = None
        permute_1736 = torch.ops.aten.permute.default(permute, [1, 0]);  permute = None
        mm_647 = torch.ops.aten.mm.default(view_2295, permute_1736);  view_2295 = permute_1736 = None
        view_2296 = torch.ops.aten.view.default(mm_647, [2, 4096, 2048]);  mm_647 = None
        add_2169 = torch.ops.aten.add.Tensor(view_2291, view_2296);  view_2291 = view_2296 = None
        convert_element_type_3435 = torch.ops.prims.convert_element_type.default(mm_646, torch.float32);  mm_646 = None
        reduce_scatter_tensor_374 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_3435, 'avg', 64, '0');  convert_element_type_3435 = None
        wait_tensor_985 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_374);  reduce_scatter_tensor_374 = None
        convert_element_type_3436 = torch.ops.prims.convert_element_type.default(add_2169, torch.float32);  add_2169 = None
        convert_element_type_1 = torch.ops.prims.convert_element_type.default(primals_4, torch.bfloat16);  primals_4 = None
        all_gather_into_tensor_1 = torch.ops._c10d_functional.all_gather_into_tensor.default(convert_element_type_1, 64, '0');  convert_element_type_1 = None
        wait_tensor_1 = torch.ops._c10d_functional.wait_tensor.default(all_gather_into_tensor_1);  all_gather_into_tensor_1 = None
        convert_element_type_3438 = torch.ops.prims.convert_element_type.default(wait_tensor_1, torch.float32);  wait_tensor_1 = None
        mul_2195 = torch.ops.aten.mul.Tensor(convert_element_type_3436, convert_element_type_3438);  convert_element_type_3438 = None
        convert_element_type_2 = torch.ops.prims.convert_element_type.default(embedding, torch.float32);  embedding = None
        mul = torch.ops.aten.mul.Tensor(convert_element_type_2, rsqrt);  convert_element_type_2 = None
        mul_2197 = torch.ops.aten.mul.Tensor(mul, mul_2195)
        sum_320 = torch.ops.aten.sum.dim_IntList(mul_2197, [2], True);  mul_2197 = None
        div_290 = torch.ops.aten.div.Tensor(mul, 2048)
        mul_2198 = torch.ops.aten.mul.Tensor(div_290, sum_320);  div_290 = sum_320 = None
        sub_784 = torch.ops.aten.sub.Tensor(mul_2195, mul_2198);  mul_2195 = mul_2198 = None
        mul_2199 = torch.ops.aten.mul.Tensor(sub_784, rsqrt);  sub_784 = rsqrt = None
        mul_2200 = torch.ops.aten.mul.Tensor(convert_element_type_3436, mul);  convert_element_type_3436 = mul = None
        sum_321 = torch.ops.aten.sum.dim_IntList(mul_2200, [0, 1]);  mul_2200 = None
        convert_element_type_3439 = torch.ops.prims.convert_element_type.default(mul_2199, torch.bfloat16);  mul_2199 = None
        add_2170 = torch.ops.aten.add.Tensor(add_2168, convert_element_type_3439);  add_2168 = convert_element_type_3439 = None
        convert_element_type_default_1 = torch.ops.prims.convert_element_type.default(sum_321, torch.float32);  sum_321 = None
        reduce_scatter_tensor_375 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default_1, 'avg', 64, '0');  convert_element_type_default_1 = None
        wait_tensor_986 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_375);  reduce_scatter_tensor_375 = None
        convert_element_type_3442 = torch.ops.prims.convert_element_type.default(add_2170, torch.float32);  add_2170 = None
        eq_572 = torch.ops.aten.eq.Scalar(primals_2, -1)
        unsqueeze_79 = torch.ops.aten.unsqueeze.default(eq_572, -1);  eq_572 = None
        full_default_104 = torch.ops.aten.full.default([], 0.0, dtype = torch.float32, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False)
        where = torch.ops.aten.where.self(unsqueeze_79, full_default_104, convert_element_type_3442);  unsqueeze_79 = full_default_104 = convert_element_type_3442 = None
        full_default_105 = torch.ops.aten.full.default([102400, 2048], 0, dtype = torch.float32, layout = torch.strided, device = device(type='cuda', index=0), pin_memory = False)
        index_put_104 = torch.ops.aten.index_put.default(full_default_105, [primals_2], where, True);  full_default_105 = primals_2 = where = None
        convert_element_type_default = torch.ops.prims.convert_element_type.default(index_put_104, torch.float32);  index_put_104 = None
        reduce_scatter_tensor_376 = torch.ops._c10d_functional.reduce_scatter_tensor.default(convert_element_type_default, 'avg', 64, '0');  convert_element_type_default = None
        wait_tensor_987 = torch.ops._c10d_functional.wait_tensor.default(reduce_scatter_tensor_376);  reduce_scatter_tensor_376 = None
        return (wait_tensor_987, None, None, wait_tensor_986, wait_tensor_985, wait_tensor_984, wait_tensor_983, wait_tensor_982, None, None, None, None, None, None, None, None, None, wait_tensor_981, wait_tensor_980, wait_tensor_979, wait_tensor_978, wait_tensor_977, wait_tensor_976, wait_tensor_975, wait_tensor_974, wait_tensor_973, wait_tensor_972, wait_tensor_971, wait_tensor_970, None, wait_tensor_969, None, wait_tensor_967, wait_tensor_966, wait_tensor_965, wait_tensor_963, wait_tensor_962, wait_tensor_961, wait_tensor_960, wait_tensor_959, wait_tensor_958, wait_tensor_957, wait_tensor_956, wait_tensor_955, wait_tensor_954, None, wait_tensor_953, None, wait_tensor_951, wait_tensor_950, wait_tensor_949, wait_tensor_947, wait_tensor_946, wait_tensor_945, wait_tensor_944, wait_tensor_943, wait_tensor_942, wait_tensor_941, wait_tensor_940, wait_tensor_939, wait_tensor_938, None, wait_tensor_937, None, wait_tensor_935, wait_tensor_934, wait_tensor_933, wait_tensor_931, wait_tensor_930, wait_tensor_929, wait_tensor_928, wait_tensor_927, wait_tensor_926, wait_tensor_925, wait_tensor_924, wait_tensor_923, wait_tensor_922, None, wait_tensor_921, None, wait_tensor_919, wait_tensor_918, wait_tensor_917, wait_tensor_915, wait_tensor_914, wait_tensor_913, wait_tensor_912, wait_tensor_911, wait_tensor_910, wait_tensor_909, wait_tensor_908, wait_tensor_907, wait_tensor_906, None, wait_tensor_905, None, wait_tensor_903, wait_tensor_902, wait_tensor_901, wait_tensor_899, wait_tensor_898, wait_tensor_897, wait_tensor_896, wait_tensor_895, wait_tensor_894, wait_tensor_893, wait_tensor_892, wait_tensor_891, wait_tensor_890, None, wait_tensor_889, None, wait_tensor_887, wait_tensor_886, wait_tensor_885, wait_tensor_883, wait_tensor_882, wait_tensor_881, wait_tensor_880, wait_tensor_879, wait_tensor_878, wait_tensor_877, wait_tensor_876, wait_tensor_875, wait_tensor_874, None, wait_tensor_873, None, wait_tensor_871, wait_tensor_870, wait_tensor_869, wait_tensor_867, wait_tensor_866, wait_tensor_865, wait_tensor_864, wait_tensor_863, wait_tensor_862, wait_tensor_861, wait_tensor_860, wait_tensor_859, wait_tensor_858, None, wait_tensor_857, None, wait_tensor_855, wait_tensor_854, wait_tensor_853, wait_tensor_851, wait_tensor_850, wait_tensor_849, wait_tensor_848, wait_tensor_847, wait_tensor_846, wait_tensor_845, wait_tensor_844, wait_tensor_843, wait_tensor_842, None, wait_tensor_841, None, wait_tensor_839, wait_tensor_838, wait_tensor_837, wait_tensor_835, wait_tensor_834, wait_tensor_833, wait_tensor_832, wait_tensor_831, wait_tensor_830, wait_tensor_829, wait_tensor_828, wait_tensor_827, wait_tensor_826, None, wait_tensor_825, None, wait_tensor_823, wait_tensor_822, wait_tensor_821, wait_tensor_819, wait_tensor_818, wait_tensor_817, wait_tensor_816, wait_tensor_815, wait_tensor_814, wait_tensor_813, wait_tensor_812, wait_tensor_811, wait_tensor_810, None, wait_tensor_809, None, wait_tensor_807, wait_tensor_806, wait_tensor_805, wait_tensor_803, wait_tensor_802, wait_tensor_801, wait_tensor_800, wait_tensor_799, wait_tensor_798, wait_tensor_797, wait_tensor_796, wait_tensor_795, wait_tensor_794, None, wait_tensor_793, None, wait_tensor_791, wait_tensor_790, wait_tensor_789, wait_tensor_787, wait_tensor_786, wait_tensor_785, wait_tensor_784, wait_tensor_783, wait_tensor_782, wait_tensor_781, wait_tensor_780, wait_tensor_779, wait_tensor_778, None, wait_tensor_777, None, wait_tensor_775, wait_tensor_774, wait_tensor_773, wait_tensor_771, wait_tensor_770, wait_tensor_769, wait_tensor_768, wait_tensor_767, wait_tensor_766, wait_tensor_765, wait_tensor_764, wait_tensor_763, wait_tensor_762, None, wait_tensor_761, None, wait_tensor_759, wait_tensor_758, wait_tensor_757, wait_tensor_755, wait_tensor_754, wait_tensor_753, wait_tensor_752, wait_tensor_751, wait_tensor_750, wait_tensor_749, wait_tensor_748, wait_tensor_747, wait_tensor_746, None, wait_tensor_745, None, wait_tensor_743, wait_tensor_742, wait_tensor_741, wait_tensor_739, wait_tensor_738, wait_tensor_737, wait_tensor_736, wait_tensor_735, wait_tensor_734, wait_tensor_733, wait_tensor_732, wait_tensor_731, wait_tensor_730, None, wait_tensor_729, None, wait_tensor_727, wait_tensor_726, wait_tensor_725, wait_tensor_723, wait_tensor_722, wait_tensor_721, wait_tensor_720, wait_tensor_719, wait_tensor_718, wait_tensor_717, wait_tensor_716, wait_tensor_715, wait_tensor_714, None, wait_tensor_713, None, wait_tensor_711, wait_tensor_710, wait_tensor_709, wait_tensor_707, wait_tensor_706, wait_tensor_705, wait_tensor_704, wait_tensor_703, wait_tensor_702, wait_tensor_701, wait_tensor_700, wait_tensor_699, wait_tensor_698, None, wait_tensor_697, None, wait_tensor_695, wait_tensor_694, wait_tensor_693, wait_tensor_691, wait_tensor_690, wait_tensor_689, wait_tensor_688, wait_tensor_687, wait_tensor_686, wait_tensor_685, wait_tensor_684, wait_tensor_683, wait_tensor_682, None, wait_tensor_681, None, wait_tensor_679, wait_tensor_678, wait_tensor_677, wait_tensor_675, wait_tensor_674, wait_tensor_673, wait_tensor_672, wait_tensor_671, wait_tensor_670, wait_tensor_669, wait_tensor_668, wait_tensor_667, wait_tensor_666, None, wait_tensor_665, None, wait_tensor_663, wait_tensor_662, wait_tensor_661, wait_tensor_659, wait_tensor_658, wait_tensor_657, wait_tensor_656, wait_tensor_655, wait_tensor_654, wait_tensor_653, wait_tensor_652, wait_tensor_651, wait_tensor_650, None, wait_tensor_649, None, wait_tensor_647, wait_tensor_646, wait_tensor_645, wait_tensor_643, wait_tensor_642, wait_tensor_641, wait_tensor_640, wait_tensor_639, wait_tensor_638, wait_tensor_637, wait_tensor_636, wait_tensor_635, wait_tensor_634, None, wait_tensor_633, None, wait_tensor_631, wait_tensor_630, wait_tensor_629, wait_tensor_627, wait_tensor_626, wait_tensor_625, wait_tensor_624, wait_tensor_623, wait_tensor_622, wait_tensor_621, wait_tensor_620, wait_tensor_619, wait_tensor_618, None, wait_tensor_617, None, wait_tensor_615, wait_tensor_614, wait_tensor_613, wait_tensor_611, wait_tensor_610, wait_tensor_609, wait_tensor_608, wait_tensor_607, wait_tensor_606, wait_tensor_605, wait_tensor_604, wait_tensor_603, wait_tensor_602, None, wait_tensor_601, None, wait_tensor_599, wait_tensor_598, wait_tensor_597, wait_tensor_595, wait_tensor_594, wait_tensor_593, wait_tensor_592, wait_tensor_591, wait_tensor_590, wait_tensor_589, wait_tensor_588, wait_tensor_587, wait_tensor_586, None, wait_tensor_585, None, wait_tensor_583, wait_tensor_582, wait_tensor_581, wait_tensor_579, wait_tensor_578, wait_tensor_577, wait_tensor_576, wait_tensor_575, wait_tensor_574, wait_tensor_573, wait_tensor_572, wait_tensor_571, wait_tensor_570, None, wait_tensor_569, None, wait_tensor_567, wait_tensor_566, wait_tensor_565, wait_tensor_563, wait_tensor_562, wait_tensor_561, wait_tensor_560, wait_tensor_559)

def load_args(reader):
    # MoE expert token counts (approximate uniform distribution)
    u8 = u9 = u10 = u11 = u12 = u13 = u14 = u15 = u24 = u25 = u26 = u27 = u28 = u29 = u30 = u31 = u40 = u41 = u42 = u43 = u44 = u45 = u46 = u47 = u56 = u57 = u58 = u59 = u60 = u61 = u62 = u63 = u72 = u73 = u74 = u75 = u76 = u77 = u78 = u79 = u88 = u89 = u90 = u91 = u92 = u93 = u94 = u95 = u104 = u105 = u106 = u107 = u108 = u109 = u110 = u111 = u120 = u121 = u122 = u123 = u124 = u125 = u126 = u127 = u136 = u137 = u138 = u139 = u140 = u141 = u142 = u143 = u152 = u153 = u154 = u155 = u156 = u157 = u158 = u159 = u168 = u169 = u170 = u171 = u172 = u173 = u174 = u175 = u184 = u185 = u186 = u187 = u188 = u189 = u190 = u191 = u200 = u201 = u202 = u203 = u204 = u205 = u206 = u207 = u216 = u217 = u218 = u219 = u220 = u221 = u222 = u223 = u232 = u233 = u234 = u235 = u236 = u237 = u238 = u239 = u248 = u249 = u250 = u251 = u252 = u253 = u254 = u255 = u264 = u265 = u266 = u267 = u268 = u269 = u270 = u271 = u280 = u281 = u282 = u283 = u284 = u285 = u286 = u287 = u296 = u297 = u298 = u299 = u300 = u301 = u302 = u303 = u312 = u313 = u314 = u315 = u316 = u317 = u318 = u319 = u328 = u329 = u330 = u331 = u332 = u333 = u334 = u335 = u344 = u345 = u346 = u347 = u348 = u349 = u350 = u351 = u360 = u361 = u362 = u363 = u364 = u365 = u366 = u367 = u376 = u377 = u378 = u379 = u380 = u381 = u382 = u383 = u392 = u393 = u394 = u395 = u396 = u397 = u398 = u399 = u408 = u409 = u410 = u411 = u412 = u413 = u414 = u415 = 512
    reader.symint(512)  # _local_scalar_dense
    reader.symint(512)  # _local_scalar_dense_1
    reader.symint(512)  # _local_scalar_dense_2
    reader.symint(512)  # _local_scalar_dense_3
    reader.symint(512)  # _local_scalar_dense_4
    reader.symint(512)  # _local_scalar_dense_5
    reader.symint(512)  # _local_scalar_dense_6
    reader.symint(512)  # _local_scalar_dense_7
    reader.symint(512)  # _local_scalar_dense_8
    reader.symint(512)  # _local_scalar_dense_9
    reader.symint(512)  # _local_scalar_dense_10
    reader.symint(512)  # _local_scalar_dense_11
    reader.symint(512)  # _local_scalar_dense_12
    reader.symint(512)  # _local_scalar_dense_13
    reader.symint(512)  # _local_scalar_dense_14
    reader.symint(512)  # _local_scalar_dense_15
    reader.symint(512)  # _local_scalar_dense_16
    reader.symint(512)  # _local_scalar_dense_17
    reader.symint(512)  # _local_scalar_dense_18
    reader.symint(512)  # _local_scalar_dense_19
    reader.symint(512)  # _local_scalar_dense_20
    reader.symint(512)  # _local_scalar_dense_21
    reader.symint(512)  # _local_scalar_dense_22
    reader.symint(512)  # _local_scalar_dense_23
    reader.symint(512)  # _local_scalar_dense_24
    reader.symint(512)  # _local_scalar_dense_25
    reader.symint(512)  # _local_scalar_dense_26
    reader.symint(512)  # _local_scalar_dense_27
    reader.symint(512)  # _local_scalar_dense_28
    reader.symint(512)  # _local_scalar_dense_29
    reader.symint(512)  # _local_scalar_dense_30
    reader.symint(512)  # _local_scalar_dense_31
    reader.symint(512)  # _local_scalar_dense_32
    reader.symint(512)  # _local_scalar_dense_33
    reader.symint(512)  # _local_scalar_dense_34
    reader.symint(512)  # _local_scalar_dense_35
    reader.symint(512)  # _local_scalar_dense_36
    reader.symint(512)  # _local_scalar_dense_37
    reader.symint(512)  # _local_scalar_dense_38
    reader.symint(512)  # _local_scalar_dense_39
    reader.symint(512)  # _local_scalar_dense_40
    reader.symint(512)  # _local_scalar_dense_41
    reader.symint(512)  # _local_scalar_dense_42
    reader.symint(512)  # _local_scalar_dense_43
    reader.symint(512)  # _local_scalar_dense_44
    reader.symint(512)  # _local_scalar_dense_45
    reader.symint(512)  # _local_scalar_dense_46
    reader.symint(512)  # _local_scalar_dense_47
    reader.symint(512)  # _local_scalar_dense_48
    reader.symint(512)  # _local_scalar_dense_49
    reader.symint(512)  # _local_scalar_dense_50
    reader.symint(512)  # _local_scalar_dense_51
    reader.symint(512)  # _local_scalar_dense_52
    reader.symint(512)  # _local_scalar_dense_53
    reader.symint(512)  # _local_scalar_dense_54
    reader.symint(512)  # _local_scalar_dense_55
    reader.symint(512)  # _local_scalar_dense_56
    reader.symint(512)  # _local_scalar_dense_57
    reader.symint(512)  # _local_scalar_dense_58
    reader.symint(512)  # _local_scalar_dense_59
    reader.symint(512)  # _local_scalar_dense_60
    reader.symint(512)  # _local_scalar_dense_61
    reader.symint(512)  # _local_scalar_dense_62
    reader.symint(512)  # _local_scalar_dense_63
    reader.symint(512)  # _local_scalar_dense_64
    reader.symint(512)  # _local_scalar_dense_65
    reader.symint(512)  # _local_scalar_dense_66
    reader.symint(512)  # _local_scalar_dense_67
    reader.symint(512)  # _local_scalar_dense_68
    reader.symint(512)  # _local_scalar_dense_69
    reader.symint(512)  # _local_scalar_dense_70
    reader.symint(512)  # _local_scalar_dense_71
    reader.symint(512)  # _local_scalar_dense_72
    reader.symint(512)  # _local_scalar_dense_73
    reader.symint(512)  # _local_scalar_dense_74
    reader.symint(512)  # _local_scalar_dense_75
    reader.symint(512)  # _local_scalar_dense_76
    reader.symint(512)  # _local_scalar_dense_77
    reader.symint(512)  # _local_scalar_dense_78
    reader.symint(512)  # _local_scalar_dense_79
    reader.symint(512)  # _local_scalar_dense_80
    reader.symint(512)  # _local_scalar_dense_81
    reader.symint(512)  # _local_scalar_dense_82
    reader.symint(512)  # _local_scalar_dense_83
    reader.symint(512)  # _local_scalar_dense_84
    reader.symint(512)  # _local_scalar_dense_85
    reader.symint(512)  # _local_scalar_dense_86
    reader.symint(512)  # _local_scalar_dense_87
    reader.symint(512)  # _local_scalar_dense_88
    reader.symint(512)  # _local_scalar_dense_89
    reader.symint(512)  # _local_scalar_dense_90
    reader.symint(512)  # _local_scalar_dense_91
    reader.symint(512)  # _local_scalar_dense_92
    reader.symint(512)  # _local_scalar_dense_93
    reader.symint(512)  # _local_scalar_dense_94
    reader.symint(512)  # _local_scalar_dense_95
    reader.symint(512)  # _local_scalar_dense_96
    reader.symint(512)  # _local_scalar_dense_97
    reader.symint(512)  # _local_scalar_dense_98
    reader.symint(512)  # _local_scalar_dense_99
    reader.symint(512)  # _local_scalar_dense_100
    reader.symint(512)  # _local_scalar_dense_101
    reader.symint(512)  # _local_scalar_dense_102
    reader.symint(512)  # _local_scalar_dense_103
    reader.symint(512)  # _local_scalar_dense_104
    reader.symint(512)  # _local_scalar_dense_105
    reader.symint(512)  # _local_scalar_dense_106
    reader.symint(512)  # _local_scalar_dense_107
    reader.symint(512)  # _local_scalar_dense_108
    reader.symint(512)  # _local_scalar_dense_109
    reader.symint(512)  # _local_scalar_dense_110
    reader.symint(512)  # _local_scalar_dense_111
    reader.symint(512)  # _local_scalar_dense_112
    reader.symint(512)  # _local_scalar_dense_113
    reader.symint(512)  # _local_scalar_dense_114
    reader.symint(512)  # _local_scalar_dense_115
    reader.symint(512)  # _local_scalar_dense_116
    reader.symint(512)  # _local_scalar_dense_117
    reader.symint(512)  # _local_scalar_dense_118
    reader.symint(512)  # _local_scalar_dense_119
    reader.symint(512)  # _local_scalar_dense_120
    reader.symint(512)  # _local_scalar_dense_121
    reader.symint(512)  # _local_scalar_dense_122
    reader.symint(512)  # _local_scalar_dense_123
    reader.symint(512)  # _local_scalar_dense_124
    reader.symint(512)  # _local_scalar_dense_125
    reader.symint(512)  # _local_scalar_dense_126
    reader.symint(512)  # _local_scalar_dense_127
    reader.symint(512)  # _local_scalar_dense_128
    reader.symint(512)  # _local_scalar_dense_129
    reader.symint(512)  # _local_scalar_dense_130
    reader.symint(512)  # _local_scalar_dense_131
    reader.symint(512)  # _local_scalar_dense_132
    reader.symint(512)  # _local_scalar_dense_133
    reader.symint(512)  # _local_scalar_dense_134
    reader.symint(512)  # _local_scalar_dense_135
    reader.symint(512)  # _local_scalar_dense_136
    reader.symint(512)  # _local_scalar_dense_137
    reader.symint(512)  # _local_scalar_dense_138
    reader.symint(512)  # _local_scalar_dense_139
    reader.symint(512)  # _local_scalar_dense_140
    reader.symint(512)  # _local_scalar_dense_141
    reader.symint(512)  # _local_scalar_dense_142
    reader.symint(512)  # _local_scalar_dense_143
    reader.symint(512)  # _local_scalar_dense_144
    reader.symint(512)  # _local_scalar_dense_145
    reader.symint(512)  # _local_scalar_dense_146
    reader.symint(512)  # _local_scalar_dense_147
    reader.symint(512)  # _local_scalar_dense_148
    reader.symint(512)  # _local_scalar_dense_149
    reader.symint(512)  # _local_scalar_dense_150
    reader.symint(512)  # _local_scalar_dense_151
    reader.symint(512)  # _local_scalar_dense_152
    reader.symint(512)  # _local_scalar_dense_153
    reader.symint(512)  # _local_scalar_dense_154
    reader.symint(512)  # _local_scalar_dense_155
    reader.symint(512)  # _local_scalar_dense_156
    reader.symint(512)  # _local_scalar_dense_157
    reader.symint(512)  # _local_scalar_dense_158
    reader.symint(512)  # _local_scalar_dense_159
    reader.symint(512)  # _local_scalar_dense_160
    reader.symint(512)  # _local_scalar_dense_161
    reader.symint(512)  # _local_scalar_dense_162
    reader.symint(512)  # _local_scalar_dense_163
    reader.symint(512)  # _local_scalar_dense_164
    reader.symint(512)  # _local_scalar_dense_165
    reader.symint(512)  # _local_scalar_dense_166
    reader.symint(512)  # _local_scalar_dense_167
    reader.symint(512)  # _local_scalar_dense_168
    reader.symint(512)  # _local_scalar_dense_169
    reader.symint(512)  # _local_scalar_dense_170
    reader.symint(512)  # _local_scalar_dense_171
    reader.symint(512)  # _local_scalar_dense_172
    reader.symint(512)  # _local_scalar_dense_173
    reader.symint(512)  # _local_scalar_dense_174
    reader.symint(512)  # _local_scalar_dense_175
    reader.symint(512)  # _local_scalar_dense_176
    reader.symint(512)  # _local_scalar_dense_177
    reader.symint(512)  # _local_scalar_dense_178
    reader.symint(512)  # _local_scalar_dense_179
    reader.symint(512)  # _local_scalar_dense_180
    reader.symint(512)  # _local_scalar_dense_181
    reader.symint(512)  # _local_scalar_dense_182
    reader.symint(512)  # _local_scalar_dense_183
    reader.symint(512)  # _local_scalar_dense_184
    reader.symint(512)  # _local_scalar_dense_185
    reader.symint(512)  # _local_scalar_dense_186
    reader.symint(512)  # _local_scalar_dense_187
    reader.symint(512)  # _local_scalar_dense_188
    reader.symint(512)  # _local_scalar_dense_189
    reader.symint(512)  # _local_scalar_dense_190
    reader.symint(512)  # _local_scalar_dense_191
    reader.symint(512)  # _local_scalar_dense_192
    reader.symint(512)  # _local_scalar_dense_193
    reader.symint(512)  # _local_scalar_dense_194
    reader.symint(512)  # _local_scalar_dense_195
    reader.symint(512)  # _local_scalar_dense_196
    reader.symint(512)  # _local_scalar_dense_197
    reader.symint(512)  # _local_scalar_dense_198
    reader.symint(512)  # _local_scalar_dense_199
    reader.symint(512)  # _local_scalar_dense_200
    reader.symint(512)  # _local_scalar_dense_201
    reader.symint(512)  # _local_scalar_dense_202
    reader.symint(512)  # _local_scalar_dense_203
    reader.symint(512)  # _local_scalar_dense_204
    reader.symint(512)  # _local_scalar_dense_205
    reader.symint(512)  # _local_scalar_dense_206
    reader.symint(512)  # _local_scalar_dense_207
    reader.symint(512)  # _local_scalar_dense_208
    reader.symint(512)  # _local_scalar_dense_209
    reader.symint(512)  # _local_scalar_dense_210
    reader.symint(512)  # _local_scalar_dense_211
    reader.symint(512)  # _local_scalar_dense_212
    reader.symint(512)  # _local_scalar_dense_213
    reader.symint(512)  # _local_scalar_dense_214
    reader.symint(512)  # _local_scalar_dense_215
    reader.symint(512)  # _local_scalar_dense_216
    reader.symint(512)  # _local_scalar_dense_217
    reader.symint(512)  # _local_scalar_dense_218
    reader.symint(512)  # _local_scalar_dense_219
    reader.symint(512)  # _local_scalar_dense_220
    reader.symint(512)  # _local_scalar_dense_221
    reader.symint(512)  # _local_scalar_dense_222
    reader.symint(512)  # _local_scalar_dense_223
    reader.symint(512)  # _local_scalar_dense_224
    reader.symint(512)  # _local_scalar_dense_225
    reader.symint(512)  # _local_scalar_dense_226
    reader.symint(512)  # _local_scalar_dense_227
    reader.symint(512)  # _local_scalar_dense_228
    reader.symint(512)  # _local_scalar_dense_229
    reader.symint(512)  # _local_scalar_dense_230
    reader.symint(512)  # _local_scalar_dense_231
    reader.symint(512)  # _local_scalar_dense_232
    reader.symint(512)  # _local_scalar_dense_233
    reader.symint(512)  # _local_scalar_dense_234
    reader.symint(512)  # _local_scalar_dense_235
    reader.symint(512)  # _local_scalar_dense_236
    reader.symint(512)  # _local_scalar_dense_237
    reader.symint(512)  # _local_scalar_dense_238
    reader.symint(512)  # _local_scalar_dense_239
    reader.symint(512)  # _local_scalar_dense_240
    reader.symint(512)  # _local_scalar_dense_241
    reader.symint(512)  # _local_scalar_dense_242
    reader.symint(512)  # _local_scalar_dense_243
    reader.symint(512)  # _local_scalar_dense_244
    reader.symint(512)  # _local_scalar_dense_245
    reader.symint(512)  # _local_scalar_dense_246
    reader.symint(512)  # _local_scalar_dense_247
    reader.symint(512)  # _local_scalar_dense_248
    reader.symint(512)  # _local_scalar_dense_249
    reader.symint(512)  # _local_scalar_dense_250
    reader.symint(512)  # _local_scalar_dense_251
    reader.symint(512)  # _local_scalar_dense_252
    reader.symint(512)  # _local_scalar_dense_253
    reader.symint(512)  # _local_scalar_dense_254
    reader.symint(512)  # _local_scalar_dense_255
    reader.symint(512)  # _local_scalar_dense_256
    reader.symint(512)  # _local_scalar_dense_257
    reader.symint(512)  # _local_scalar_dense_258
    reader.symint(512)  # _local_scalar_dense_259
    reader.symint(512)  # _local_scalar_dense_260
    reader.symint(512)  # _local_scalar_dense_261
    reader.symint(512)  # _local_scalar_dense_262
    reader.symint(512)  # _local_scalar_dense_263
    reader.symint(512)  # _local_scalar_dense_264
    reader.symint(512)  # _local_scalar_dense_265
    reader.symint(512)  # _local_scalar_dense_266
    reader.symint(512)  # _local_scalar_dense_267
    reader.symint(512)  # _local_scalar_dense_268
    reader.symint(512)  # _local_scalar_dense_269
    reader.symint(512)  # _local_scalar_dense_270
    reader.symint(512)  # _local_scalar_dense_271
    reader.symint(512)  # _local_scalar_dense_272
    reader.symint(512)  # _local_scalar_dense_273
    reader.symint(512)  # _local_scalar_dense_274
    reader.symint(512)  # _local_scalar_dense_275
    reader.symint(512)  # _local_scalar_dense_276
    reader.symint(512)  # _local_scalar_dense_277
    reader.symint(512)  # _local_scalar_dense_278
    reader.symint(512)  # _local_scalar_dense_279
    reader.symint(512)  # _local_scalar_dense_280
    reader.symint(512)  # _local_scalar_dense_281
    reader.symint(512)  # _local_scalar_dense_282
    reader.symint(512)  # _local_scalar_dense_283
    reader.symint(512)  # _local_scalar_dense_284
    reader.symint(512)  # _local_scalar_dense_285
    reader.symint(512)  # _local_scalar_dense_286
    reader.symint(512)  # _local_scalar_dense_287
    reader.symint(512)  # _local_scalar_dense_288
    reader.symint(512)  # _local_scalar_dense_289
    reader.symint(512)  # _local_scalar_dense_290
    reader.symint(512)  # _local_scalar_dense_291
    reader.symint(512)  # _local_scalar_dense_292
    reader.symint(512)  # _local_scalar_dense_293
    reader.symint(512)  # _local_scalar_dense_294
    reader.symint(512)  # _local_scalar_dense_295
    reader.symint(512)  # _local_scalar_dense_296
    reader.symint(512)  # _local_scalar_dense_297
    reader.symint(512)  # _local_scalar_dense_298
    reader.symint(512)  # _local_scalar_dense_299
    reader.symint(512)  # _local_scalar_dense_300
    reader.symint(512)  # _local_scalar_dense_301
    reader.symint(512)  # _local_scalar_dense_302
    reader.symint(512)  # _local_scalar_dense_303
    reader.symint(512)  # _local_scalar_dense_304
    reader.symint(512)  # _local_scalar_dense_305
    reader.symint(512)  # _local_scalar_dense_306
    reader.symint(512)  # _local_scalar_dense_307
    reader.symint(512)  # _local_scalar_dense_308
    reader.symint(512)  # _local_scalar_dense_309
    reader.symint(512)  # _local_scalar_dense_310
    reader.symint(512)  # _local_scalar_dense_311
    reader.symint(512)  # _local_scalar_dense_312
    reader.symint(512)  # _local_scalar_dense_313
    reader.symint(512)  # _local_scalar_dense_314
    reader.symint(512)  # _local_scalar_dense_315
    reader.symint(512)  # _local_scalar_dense_316
    reader.symint(512)  # _local_scalar_dense_317
    reader.symint(512)  # _local_scalar_dense_318
    reader.symint(512)  # _local_scalar_dense_319
    reader.symint(512)  # _local_scalar_dense_320
    reader.symint(512)  # _local_scalar_dense_321
    reader.symint(512)  # _local_scalar_dense_322
    reader.symint(512)  # _local_scalar_dense_323
    reader.symint(512)  # _local_scalar_dense_324
    reader.symint(512)  # _local_scalar_dense_325
    reader.symint(512)  # _local_scalar_dense_326
    reader.symint(512)  # _local_scalar_dense_327
    reader.symint(512)  # _local_scalar_dense_328
    reader.symint(512)  # _local_scalar_dense_329
    reader.symint(512)  # _local_scalar_dense_330
    reader.symint(512)  # _local_scalar_dense_331
    reader.symint(512)  # _local_scalar_dense_332
    reader.symint(512)  # _local_scalar_dense_333
    reader.symint(512)  # _local_scalar_dense_334
    reader.symint(512)  # _local_scalar_dense_335
    reader.symint(512)  # _local_scalar_dense_336
    reader.symint(512)  # _local_scalar_dense_337
    reader.symint(512)  # _local_scalar_dense_338
    reader.symint(512)  # _local_scalar_dense_339
    reader.symint(512)  # _local_scalar_dense_340
    reader.symint(512)  # _local_scalar_dense_341
    reader.symint(512)  # _local_scalar_dense_342
    reader.symint(512)  # _local_scalar_dense_343
    reader.symint(512)  # _local_scalar_dense_344
    reader.symint(512)  # _local_scalar_dense_345
    reader.symint(512)  # _local_scalar_dense_346
    reader.symint(512)  # _local_scalar_dense_347
    reader.symint(512)  # _local_scalar_dense_348
    reader.symint(512)  # _local_scalar_dense_349
    reader.symint(512)  # _local_scalar_dense_350
    reader.symint(512)  # _local_scalar_dense_351
    reader.symint(512)  # _local_scalar_dense_352
    reader.symint(512)  # _local_scalar_dense_353
    reader.symint(512)  # _local_scalar_dense_354
    reader.symint(512)  # _local_scalar_dense_355
    reader.symint(512)  # _local_scalar_dense_356
    reader.symint(512)  # _local_scalar_dense_357
    reader.symint(512)  # _local_scalar_dense_358
    reader.symint(512)  # _local_scalar_dense_359
    reader.symint(512)  # _local_scalar_dense_360
    reader.symint(512)  # _local_scalar_dense_361
    reader.symint(512)  # _local_scalar_dense_362
    reader.symint(512)  # _local_scalar_dense_363
    reader.symint(512)  # _local_scalar_dense_364
    reader.symint(512)  # _local_scalar_dense_365
    reader.symint(512)  # _local_scalar_dense_366
    reader.symint(512)  # _local_scalar_dense_367
    reader.symint(512)  # _local_scalar_dense_368
    reader.symint(512)  # _local_scalar_dense_369
    reader.symint(512)  # _local_scalar_dense_370
    reader.symint(512)  # _local_scalar_dense_371
    reader.symint(512)  # _local_scalar_dense_372
    reader.symint(512)  # _local_scalar_dense_373
    reader.symint(512)  # _local_scalar_dense_374
    reader.symint(512)  # _local_scalar_dense_375
    reader.symint(512)  # _local_scalar_dense_376
    reader.symint(512)  # _local_scalar_dense_377
    reader.symint(512)  # _local_scalar_dense_378
    reader.symint(512)  # _local_scalar_dense_379
    reader.symint(512)  # _local_scalar_dense_380
    reader.symint(512)  # _local_scalar_dense_381
    reader.symint(512)  # _local_scalar_dense_382
    reader.symint(512)  # _local_scalar_dense_383
    reader.symint(512)  # _local_scalar_dense_384
    reader.symint(512)  # _local_scalar_dense_385
    reader.symint(512)  # _local_scalar_dense_386
    reader.symint(512)  # _local_scalar_dense_387
    reader.symint(512)  # _local_scalar_dense_388
    reader.symint(512)  # _local_scalar_dense_389
    reader.symint(512)  # _local_scalar_dense_390
    reader.symint(512)  # _local_scalar_dense_391
    reader.symint(512)  # _local_scalar_dense_392
    reader.symint(512)  # _local_scalar_dense_393
    reader.symint(512)  # _local_scalar_dense_394
    reader.symint(512)  # _local_scalar_dense_395
    reader.symint(512)  # _local_scalar_dense_396
    reader.symint(512)  # _local_scalar_dense_397
    reader.symint(512)  # _local_scalar_dense_398
    reader.symint(512)  # _local_scalar_dense_399
    reader.symint(512)  # _local_scalar_dense_400
    reader.symint(512)  # _local_scalar_dense_401
    reader.symint(512)  # _local_scalar_dense_402
    reader.symint(512)  # _local_scalar_dense_403
    reader.symint(512)  # _local_scalar_dense_404
    reader.symint(512)  # _local_scalar_dense_405
    reader.symint(512)  # _local_scalar_dense_406
    reader.symint(512)  # _local_scalar_dense_407
    reader.symint(512)  # _local_scalar_dense_408
    reader.symint(512)  # _local_scalar_dense_409
    reader.symint(512)  # _local_scalar_dense_410
    reader.symint(512)  # _local_scalar_dense_411
    reader.symint(512)  # _local_scalar_dense_412
    reader.symint(512)  # _local_scalar_dense_413
    reader.symint(512)  # _local_scalar_dense_414
    reader.symint(512)  # _local_scalar_dense_415
    reader.symint(512)  # sym_size_int_1
    reader.symint(512)  # sym_size_int_5
    reader.symint(512)  # sym_size_int_9
    reader.symint(512)  # sym_size_int_13
    reader.symint(512)  # sym_size_int_17
    reader.symint(512)  # sym_size_int_21
    reader.symint(512)  # sym_size_int_25
    reader.symint(512)  # sym_size_int_29
    reader.symint(512)  # sym_size_int_33
    reader.symint(512)  # sym_size_int_37
    reader.symint(512)  # sym_size_int_41
    reader.symint(512)  # sym_size_int_45
    reader.symint(512)  # sym_size_int_49
    reader.symint(512)  # sym_size_int_53
    reader.symint(512)  # sym_size_int_57
    reader.symint(512)  # sym_size_int_61
    reader.symint(512)  # sym_size_int_65
    reader.symint(512)  # sym_size_int_69
    reader.symint(512)  # sym_size_int_73
    reader.symint(512)  # sym_size_int_77
    reader.symint(512)  # sym_size_int_81
    reader.symint(512)  # sym_size_int_85
    reader.symint(512)  # sym_size_int_89
    reader.symint(512)  # sym_size_int_93
    reader.symint(512)  # sym_size_int_97
    reader.symint(512)  # sym_size_int_101
    reader.symint(512)  # add_1781
    reader.symint(512)  # add_1796
    reader.symint(512)  # add_1811
    reader.symint(512)  # add_1826
    reader.symint(512)  # add_1841
    reader.symint(512)  # add_1856
    reader.symint(512)  # add_1871
    reader.symint(512)  # add_1886
    reader.symint(512)  # add_1901
    reader.symint(512)  # add_1916
    reader.symint(512)  # add_1931
    reader.symint(512)  # add_1946
    reader.symint(512)  # add_1961
    reader.symint(512)  # add_1976
    reader.symint(512)  # add_1991
    reader.symint(512)  # add_2006
    reader.symint(512)  # add_2021
    reader.symint(512)  # add_2036
    reader.symint(512)  # add_2051
    reader.symint(512)  # add_2066
    reader.symint(512)  # add_2081
    reader.symint(512)  # add_2096
    reader.symint(512)  # add_2111
    reader.symint(512)  # add_2126
    reader.symint(512)  # add_2141
    reader.symint(512)  # add_2156
    buf0 = reader.storage(None, 13107200, device=device(type='cuda', index=0))
    reader.tensor(buf0, (1600, 2048), is_leaf=True)  # primals_1
    buf1 = reader.storage(None, 65536, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1, (2, 4096), dtype=torch.int64, is_leaf=True)  # primals_2
    buf2 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.complex64)
    reader.tensor(buf2, (4096, 32), dtype=torch.complex64, is_leaf=True)  # primals_3
    buf3 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf3, (32,), is_leaf=True)  # primals_4
    buf4 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf4, (48, 2048), is_leaf=True)  # primals_5
    buf5 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf5, (9, 2048), is_leaf=True)  # primals_6
    buf6 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf6, (8,), is_leaf=True)  # primals_7
    buf7 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf7, (64, 512), is_leaf=True)  # primals_8
    buf8 = reader.storage(None, 8192, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf8, (2, 1, 32, 32), dtype=torch.int32, is_leaf=True)  # primals_9
    buf9 = reader.storage(None, 256, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf9, (2, 1, 32), dtype=torch.int32, is_leaf=True)  # primals_10
    buf10 = reader.storage(None, 32768, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf10, (2, 4096), dtype=torch.int32, is_leaf=True)  # primals_11
    buf11 = reader.storage(None, 256, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf11, (2, 1, 32), dtype=torch.int32, is_leaf=True)  # primals_12
    buf12 = reader.storage(None, 8192, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf12, (2, 1, 32, 32), dtype=torch.int32, is_leaf=True)  # primals_13
    buf13 = reader.storage(None, 256, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf13, (2, 1, 32), dtype=torch.int32, is_leaf=True)  # primals_14
    buf14 = reader.storage(None, 8192, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf14, (2, 1, 32, 32), dtype=torch.int32, is_leaf=True)  # primals_15
    buf15 = reader.storage(None, 256, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf15, (2, 1, 32), dtype=torch.int32, is_leaf=True)  # primals_16
    buf16 = reader.storage(None, 8192, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf16, (2, 1, 32, 32), dtype=torch.int32, is_leaf=True)  # primals_17
    buf17 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf17, (32, 2048), is_leaf=True)  # primals_18
    buf18 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf18, (32,), is_leaf=True)  # primals_19
    buf19 = reader.storage(None, 1400832, device=device(type='cuda', index=0))
    reader.tensor(buf19, (171, 2048), is_leaf=True)  # primals_20
    buf20 = reader.storage(None, 1400832, device=device(type='cuda', index=0))
    reader.tensor(buf20, (171, 2048), is_leaf=True)  # primals_21
    buf21 = reader.storage(None, 1400832, device=device(type='cuda', index=0))
    reader.tensor(buf21, (32, 10944), is_leaf=True)  # primals_22
    buf22 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf22, (32,), is_leaf=True)  # primals_23
    buf23 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf23, (48, 2048), is_leaf=True)  # primals_24
    buf24 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf24, (9, 2048), is_leaf=True)  # primals_25
    buf25 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf25, (8,), is_leaf=True)  # primals_26
    buf26 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf26, (64, 512), is_leaf=True)  # primals_27
    buf27 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf27, (32, 2048), is_leaf=True)  # primals_28
    buf28 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf28, (32,), is_leaf=True)  # primals_29
    buf29 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf29, (1, 2048), is_leaf=True)  # primals_31
    buf30 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf30, (1, 1408, 2048), is_leaf=True)  # primals_33
    buf31 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf31, (1, 2048, 1408), is_leaf=True)  # primals_34
    buf32 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf32, (1, 1408, 2048), is_leaf=True)  # primals_35
    buf33 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf33, (44, 2048), is_leaf=True)  # primals_36
    buf34 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf34, (44, 2048), is_leaf=True)  # primals_37
    buf35 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf35, (32, 2816), is_leaf=True)  # primals_38
    buf36 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf36, (32,), is_leaf=True)  # primals_39
    buf37 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf37, (48, 2048), is_leaf=True)  # primals_40
    buf38 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf38, (9, 2048), is_leaf=True)  # primals_41
    buf39 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf39, (8,), is_leaf=True)  # primals_42
    buf40 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf40, (64, 512), is_leaf=True)  # primals_43
    buf41 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf41, (32, 2048), is_leaf=True)  # primals_44
    buf42 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf42, (32,), is_leaf=True)  # primals_45
    buf43 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf43, (1, 2048), is_leaf=True)  # primals_47
    buf44 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf44, (1, 1408, 2048), is_leaf=True)  # primals_49
    buf45 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf45, (1, 2048, 1408), is_leaf=True)  # primals_50
    buf46 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf46, (1, 1408, 2048), is_leaf=True)  # primals_51
    buf47 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf47, (44, 2048), is_leaf=True)  # primals_52
    buf48 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf48, (44, 2048), is_leaf=True)  # primals_53
    buf49 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf49, (32, 2816), is_leaf=True)  # primals_54
    buf50 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf50, (32,), is_leaf=True)  # primals_55
    buf51 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf51, (48, 2048), is_leaf=True)  # primals_56
    buf52 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf52, (9, 2048), is_leaf=True)  # primals_57
    buf53 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf53, (8,), is_leaf=True)  # primals_58
    buf54 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf54, (64, 512), is_leaf=True)  # primals_59
    buf55 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf55, (32, 2048), is_leaf=True)  # primals_60
    buf56 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf56, (32,), is_leaf=True)  # primals_61
    buf57 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf57, (1, 2048), is_leaf=True)  # primals_63
    buf58 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf58, (1, 1408, 2048), is_leaf=True)  # primals_65
    buf59 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf59, (1, 2048, 1408), is_leaf=True)  # primals_66
    buf60 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf60, (1, 1408, 2048), is_leaf=True)  # primals_67
    buf61 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf61, (44, 2048), is_leaf=True)  # primals_68
    buf62 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf62, (44, 2048), is_leaf=True)  # primals_69
    buf63 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf63, (32, 2816), is_leaf=True)  # primals_70
    buf64 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf64, (32,), is_leaf=True)  # primals_71
    buf65 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf65, (48, 2048), is_leaf=True)  # primals_72
    buf66 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf66, (9, 2048), is_leaf=True)  # primals_73
    buf67 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf67, (8,), is_leaf=True)  # primals_74
    buf68 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf68, (64, 512), is_leaf=True)  # primals_75
    buf69 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf69, (32, 2048), is_leaf=True)  # primals_76
    buf70 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf70, (32,), is_leaf=True)  # primals_77
    buf71 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf71, (1, 2048), is_leaf=True)  # primals_79
    buf72 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf72, (1, 1408, 2048), is_leaf=True)  # primals_81
    buf73 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf73, (1, 2048, 1408), is_leaf=True)  # primals_82
    buf74 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf74, (1, 1408, 2048), is_leaf=True)  # primals_83
    buf75 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf75, (44, 2048), is_leaf=True)  # primals_84
    buf76 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf76, (44, 2048), is_leaf=True)  # primals_85
    buf77 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf77, (32, 2816), is_leaf=True)  # primals_86
    buf78 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf78, (32,), is_leaf=True)  # primals_87
    buf79 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf79, (48, 2048), is_leaf=True)  # primals_88
    buf80 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf80, (9, 2048), is_leaf=True)  # primals_89
    buf81 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf81, (8,), is_leaf=True)  # primals_90
    buf82 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf82, (64, 512), is_leaf=True)  # primals_91
    buf83 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf83, (32, 2048), is_leaf=True)  # primals_92
    buf84 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf84, (32,), is_leaf=True)  # primals_93
    buf85 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf85, (1, 2048), is_leaf=True)  # primals_95
    buf86 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf86, (1, 1408, 2048), is_leaf=True)  # primals_97
    buf87 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf87, (1, 2048, 1408), is_leaf=True)  # primals_98
    buf88 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf88, (1, 1408, 2048), is_leaf=True)  # primals_99
    buf89 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf89, (44, 2048), is_leaf=True)  # primals_100
    buf90 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf90, (44, 2048), is_leaf=True)  # primals_101
    buf91 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf91, (32, 2816), is_leaf=True)  # primals_102
    buf92 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf92, (32,), is_leaf=True)  # primals_103
    buf93 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf93, (48, 2048), is_leaf=True)  # primals_104
    buf94 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf94, (9, 2048), is_leaf=True)  # primals_105
    buf95 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf95, (8,), is_leaf=True)  # primals_106
    buf96 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf96, (64, 512), is_leaf=True)  # primals_107
    buf97 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf97, (32, 2048), is_leaf=True)  # primals_108
    buf98 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf98, (32,), is_leaf=True)  # primals_109
    buf99 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf99, (1, 2048), is_leaf=True)  # primals_111
    buf100 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf100, (1, 1408, 2048), is_leaf=True)  # primals_113
    buf101 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf101, (1, 2048, 1408), is_leaf=True)  # primals_114
    buf102 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf102, (1, 1408, 2048), is_leaf=True)  # primals_115
    buf103 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf103, (44, 2048), is_leaf=True)  # primals_116
    buf104 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf104, (44, 2048), is_leaf=True)  # primals_117
    buf105 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf105, (32, 2816), is_leaf=True)  # primals_118
    buf106 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf106, (32,), is_leaf=True)  # primals_119
    buf107 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf107, (48, 2048), is_leaf=True)  # primals_120
    buf108 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf108, (9, 2048), is_leaf=True)  # primals_121
    buf109 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf109, (8,), is_leaf=True)  # primals_122
    buf110 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf110, (64, 512), is_leaf=True)  # primals_123
    buf111 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf111, (32, 2048), is_leaf=True)  # primals_124
    buf112 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf112, (32,), is_leaf=True)  # primals_125
    buf113 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf113, (1, 2048), is_leaf=True)  # primals_127
    buf114 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf114, (1, 1408, 2048), is_leaf=True)  # primals_129
    buf115 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf115, (1, 2048, 1408), is_leaf=True)  # primals_130
    buf116 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf116, (1, 1408, 2048), is_leaf=True)  # primals_131
    buf117 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf117, (44, 2048), is_leaf=True)  # primals_132
    buf118 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf118, (44, 2048), is_leaf=True)  # primals_133
    buf119 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf119, (32, 2816), is_leaf=True)  # primals_134
    buf120 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf120, (32,), is_leaf=True)  # primals_135
    buf121 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf121, (48, 2048), is_leaf=True)  # primals_136
    buf122 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf122, (9, 2048), is_leaf=True)  # primals_137
    buf123 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf123, (8,), is_leaf=True)  # primals_138
    buf124 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf124, (64, 512), is_leaf=True)  # primals_139
    buf125 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf125, (32, 2048), is_leaf=True)  # primals_140
    buf126 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf126, (32,), is_leaf=True)  # primals_141
    buf127 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf127, (1, 2048), is_leaf=True)  # primals_143
    buf128 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf128, (1, 1408, 2048), is_leaf=True)  # primals_145
    buf129 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf129, (1, 2048, 1408), is_leaf=True)  # primals_146
    buf130 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf130, (1, 1408, 2048), is_leaf=True)  # primals_147
    buf131 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf131, (44, 2048), is_leaf=True)  # primals_148
    buf132 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf132, (44, 2048), is_leaf=True)  # primals_149
    buf133 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf133, (32, 2816), is_leaf=True)  # primals_150
    buf134 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf134, (32,), is_leaf=True)  # primals_151
    buf135 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf135, (48, 2048), is_leaf=True)  # primals_152
    buf136 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf136, (9, 2048), is_leaf=True)  # primals_153
    buf137 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf137, (8,), is_leaf=True)  # primals_154
    buf138 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf138, (64, 512), is_leaf=True)  # primals_155
    buf139 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf139, (32, 2048), is_leaf=True)  # primals_156
    buf140 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf140, (32,), is_leaf=True)  # primals_157
    buf141 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf141, (1, 2048), is_leaf=True)  # primals_159
    buf142 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf142, (1, 1408, 2048), is_leaf=True)  # primals_161
    buf143 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf143, (1, 2048, 1408), is_leaf=True)  # primals_162
    buf144 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf144, (1, 1408, 2048), is_leaf=True)  # primals_163
    buf145 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf145, (44, 2048), is_leaf=True)  # primals_164
    buf146 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf146, (44, 2048), is_leaf=True)  # primals_165
    buf147 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf147, (32, 2816), is_leaf=True)  # primals_166
    buf148 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf148, (32,), is_leaf=True)  # primals_167
    buf149 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf149, (48, 2048), is_leaf=True)  # primals_168
    buf150 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf150, (9, 2048), is_leaf=True)  # primals_169
    buf151 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf151, (8,), is_leaf=True)  # primals_170
    buf152 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf152, (64, 512), is_leaf=True)  # primals_171
    buf153 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf153, (32, 2048), is_leaf=True)  # primals_172
    buf154 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf154, (32,), is_leaf=True)  # primals_173
    buf155 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf155, (1, 2048), is_leaf=True)  # primals_175
    buf156 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf156, (1, 1408, 2048), is_leaf=True)  # primals_177
    buf157 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf157, (1, 2048, 1408), is_leaf=True)  # primals_178
    buf158 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf158, (1, 1408, 2048), is_leaf=True)  # primals_179
    buf159 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf159, (44, 2048), is_leaf=True)  # primals_180
    buf160 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf160, (44, 2048), is_leaf=True)  # primals_181
    buf161 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf161, (32, 2816), is_leaf=True)  # primals_182
    buf162 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf162, (32,), is_leaf=True)  # primals_183
    buf163 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf163, (48, 2048), is_leaf=True)  # primals_184
    buf164 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf164, (9, 2048), is_leaf=True)  # primals_185
    buf165 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf165, (8,), is_leaf=True)  # primals_186
    buf166 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf166, (64, 512), is_leaf=True)  # primals_187
    buf167 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf167, (32, 2048), is_leaf=True)  # primals_188
    buf168 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf168, (32,), is_leaf=True)  # primals_189
    buf169 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf169, (1, 2048), is_leaf=True)  # primals_191
    buf170 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf170, (1, 1408, 2048), is_leaf=True)  # primals_193
    buf171 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf171, (1, 2048, 1408), is_leaf=True)  # primals_194
    buf172 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf172, (1, 1408, 2048), is_leaf=True)  # primals_195
    buf173 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf173, (44, 2048), is_leaf=True)  # primals_196
    buf174 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf174, (44, 2048), is_leaf=True)  # primals_197
    buf175 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf175, (32, 2816), is_leaf=True)  # primals_198
    buf176 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf176, (32,), is_leaf=True)  # primals_199
    buf177 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf177, (48, 2048), is_leaf=True)  # primals_200
    buf178 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf178, (9, 2048), is_leaf=True)  # primals_201
    buf179 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf179, (8,), is_leaf=True)  # primals_202
    buf180 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf180, (64, 512), is_leaf=True)  # primals_203
    buf181 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf181, (32, 2048), is_leaf=True)  # primals_204
    buf182 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf182, (32,), is_leaf=True)  # primals_205
    buf183 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf183, (1, 2048), is_leaf=True)  # primals_207
    buf184 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf184, (1, 1408, 2048), is_leaf=True)  # primals_209
    buf185 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf185, (1, 2048, 1408), is_leaf=True)  # primals_210
    buf186 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf186, (1, 1408, 2048), is_leaf=True)  # primals_211
    buf187 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf187, (44, 2048), is_leaf=True)  # primals_212
    buf188 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf188, (44, 2048), is_leaf=True)  # primals_213
    buf189 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf189, (32, 2816), is_leaf=True)  # primals_214
    buf190 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf190, (32,), is_leaf=True)  # primals_215
    buf191 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf191, (48, 2048), is_leaf=True)  # primals_216
    buf192 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf192, (9, 2048), is_leaf=True)  # primals_217
    buf193 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf193, (8,), is_leaf=True)  # primals_218
    buf194 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf194, (64, 512), is_leaf=True)  # primals_219
    buf195 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf195, (32, 2048), is_leaf=True)  # primals_220
    buf196 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf196, (32,), is_leaf=True)  # primals_221
    buf197 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf197, (1, 2048), is_leaf=True)  # primals_223
    buf198 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf198, (1, 1408, 2048), is_leaf=True)  # primals_225
    buf199 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf199, (1, 2048, 1408), is_leaf=True)  # primals_226
    buf200 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf200, (1, 1408, 2048), is_leaf=True)  # primals_227
    buf201 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf201, (44, 2048), is_leaf=True)  # primals_228
    buf202 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf202, (44, 2048), is_leaf=True)  # primals_229
    buf203 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf203, (32, 2816), is_leaf=True)  # primals_230
    buf204 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf204, (32,), is_leaf=True)  # primals_231
    buf205 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf205, (48, 2048), is_leaf=True)  # primals_232
    buf206 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf206, (9, 2048), is_leaf=True)  # primals_233
    buf207 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf207, (8,), is_leaf=True)  # primals_234
    buf208 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf208, (64, 512), is_leaf=True)  # primals_235
    buf209 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf209, (32, 2048), is_leaf=True)  # primals_236
    buf210 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf210, (32,), is_leaf=True)  # primals_237
    buf211 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf211, (1, 2048), is_leaf=True)  # primals_239
    buf212 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf212, (1, 1408, 2048), is_leaf=True)  # primals_241
    buf213 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf213, (1, 2048, 1408), is_leaf=True)  # primals_242
    buf214 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf214, (1, 1408, 2048), is_leaf=True)  # primals_243
    buf215 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf215, (44, 2048), is_leaf=True)  # primals_244
    buf216 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf216, (44, 2048), is_leaf=True)  # primals_245
    buf217 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf217, (32, 2816), is_leaf=True)  # primals_246
    buf218 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf218, (32,), is_leaf=True)  # primals_247
    buf219 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf219, (48, 2048), is_leaf=True)  # primals_248
    buf220 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf220, (9, 2048), is_leaf=True)  # primals_249
    buf221 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf221, (8,), is_leaf=True)  # primals_250
    buf222 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf222, (64, 512), is_leaf=True)  # primals_251
    buf223 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf223, (32, 2048), is_leaf=True)  # primals_252
    buf224 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf224, (32,), is_leaf=True)  # primals_253
    buf225 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf225, (1, 2048), is_leaf=True)  # primals_255
    buf226 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf226, (1, 1408, 2048), is_leaf=True)  # primals_257
    buf227 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf227, (1, 2048, 1408), is_leaf=True)  # primals_258
    buf228 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf228, (1, 1408, 2048), is_leaf=True)  # primals_259
    buf229 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf229, (44, 2048), is_leaf=True)  # primals_260
    buf230 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf230, (44, 2048), is_leaf=True)  # primals_261
    buf231 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf231, (32, 2816), is_leaf=True)  # primals_262
    buf232 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf232, (32,), is_leaf=True)  # primals_263
    buf233 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf233, (48, 2048), is_leaf=True)  # primals_264
    buf234 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf234, (9, 2048), is_leaf=True)  # primals_265
    buf235 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf235, (8,), is_leaf=True)  # primals_266
    buf236 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf236, (64, 512), is_leaf=True)  # primals_267
    buf237 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf237, (32, 2048), is_leaf=True)  # primals_268
    buf238 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf238, (32,), is_leaf=True)  # primals_269
    buf239 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf239, (1, 2048), is_leaf=True)  # primals_271
    buf240 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf240, (1, 1408, 2048), is_leaf=True)  # primals_273
    buf241 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf241, (1, 2048, 1408), is_leaf=True)  # primals_274
    buf242 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf242, (1, 1408, 2048), is_leaf=True)  # primals_275
    buf243 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf243, (44, 2048), is_leaf=True)  # primals_276
    buf244 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf244, (44, 2048), is_leaf=True)  # primals_277
    buf245 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf245, (32, 2816), is_leaf=True)  # primals_278
    buf246 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf246, (32,), is_leaf=True)  # primals_279
    buf247 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf247, (48, 2048), is_leaf=True)  # primals_280
    buf248 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf248, (9, 2048), is_leaf=True)  # primals_281
    buf249 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf249, (8,), is_leaf=True)  # primals_282
    buf250 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf250, (64, 512), is_leaf=True)  # primals_283
    buf251 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf251, (32, 2048), is_leaf=True)  # primals_284
    buf252 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf252, (32,), is_leaf=True)  # primals_285
    buf253 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf253, (1, 2048), is_leaf=True)  # primals_287
    buf254 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf254, (1, 1408, 2048), is_leaf=True)  # primals_289
    buf255 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf255, (1, 2048, 1408), is_leaf=True)  # primals_290
    buf256 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf256, (1, 1408, 2048), is_leaf=True)  # primals_291
    buf257 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf257, (44, 2048), is_leaf=True)  # primals_292
    buf258 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf258, (44, 2048), is_leaf=True)  # primals_293
    buf259 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf259, (32, 2816), is_leaf=True)  # primals_294
    buf260 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf260, (32,), is_leaf=True)  # primals_295
    buf261 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf261, (48, 2048), is_leaf=True)  # primals_296
    buf262 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf262, (9, 2048), is_leaf=True)  # primals_297
    buf263 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf263, (8,), is_leaf=True)  # primals_298
    buf264 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf264, (64, 512), is_leaf=True)  # primals_299
    buf265 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf265, (32, 2048), is_leaf=True)  # primals_300
    buf266 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf266, (32,), is_leaf=True)  # primals_301
    buf267 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf267, (1, 2048), is_leaf=True)  # primals_303
    buf268 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf268, (1, 1408, 2048), is_leaf=True)  # primals_305
    buf269 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf269, (1, 2048, 1408), is_leaf=True)  # primals_306
    buf270 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf270, (1, 1408, 2048), is_leaf=True)  # primals_307
    buf271 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf271, (44, 2048), is_leaf=True)  # primals_308
    buf272 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf272, (44, 2048), is_leaf=True)  # primals_309
    buf273 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf273, (32, 2816), is_leaf=True)  # primals_310
    buf274 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf274, (32,), is_leaf=True)  # primals_311
    buf275 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf275, (48, 2048), is_leaf=True)  # primals_312
    buf276 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf276, (9, 2048), is_leaf=True)  # primals_313
    buf277 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf277, (8,), is_leaf=True)  # primals_314
    buf278 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf278, (64, 512), is_leaf=True)  # primals_315
    buf279 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf279, (32, 2048), is_leaf=True)  # primals_316
    buf280 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf280, (32,), is_leaf=True)  # primals_317
    buf281 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf281, (1, 2048), is_leaf=True)  # primals_319
    buf282 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf282, (1, 1408, 2048), is_leaf=True)  # primals_321
    buf283 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf283, (1, 2048, 1408), is_leaf=True)  # primals_322
    buf284 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf284, (1, 1408, 2048), is_leaf=True)  # primals_323
    buf285 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf285, (44, 2048), is_leaf=True)  # primals_324
    buf286 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf286, (44, 2048), is_leaf=True)  # primals_325
    buf287 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf287, (32, 2816), is_leaf=True)  # primals_326
    buf288 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf288, (32,), is_leaf=True)  # primals_327
    buf289 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf289, (48, 2048), is_leaf=True)  # primals_328
    buf290 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf290, (9, 2048), is_leaf=True)  # primals_329
    buf291 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf291, (8,), is_leaf=True)  # primals_330
    buf292 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf292, (64, 512), is_leaf=True)  # primals_331
    buf293 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf293, (32, 2048), is_leaf=True)  # primals_332
    buf294 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf294, (32,), is_leaf=True)  # primals_333
    buf295 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf295, (1, 2048), is_leaf=True)  # primals_335
    buf296 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf296, (1, 1408, 2048), is_leaf=True)  # primals_337
    buf297 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf297, (1, 2048, 1408), is_leaf=True)  # primals_338
    buf298 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf298, (1, 1408, 2048), is_leaf=True)  # primals_339
    buf299 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf299, (44, 2048), is_leaf=True)  # primals_340
    buf300 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf300, (44, 2048), is_leaf=True)  # primals_341
    buf301 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf301, (32, 2816), is_leaf=True)  # primals_342
    buf302 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf302, (32,), is_leaf=True)  # primals_343
    buf303 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf303, (48, 2048), is_leaf=True)  # primals_344
    buf304 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf304, (9, 2048), is_leaf=True)  # primals_345
    buf305 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf305, (8,), is_leaf=True)  # primals_346
    buf306 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf306, (64, 512), is_leaf=True)  # primals_347
    buf307 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf307, (32, 2048), is_leaf=True)  # primals_348
    buf308 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf308, (32,), is_leaf=True)  # primals_349
    buf309 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf309, (1, 2048), is_leaf=True)  # primals_351
    buf310 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf310, (1, 1408, 2048), is_leaf=True)  # primals_353
    buf311 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf311, (1, 2048, 1408), is_leaf=True)  # primals_354
    buf312 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf312, (1, 1408, 2048), is_leaf=True)  # primals_355
    buf313 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf313, (44, 2048), is_leaf=True)  # primals_356
    buf314 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf314, (44, 2048), is_leaf=True)  # primals_357
    buf315 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf315, (32, 2816), is_leaf=True)  # primals_358
    buf316 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf316, (32,), is_leaf=True)  # primals_359
    buf317 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf317, (48, 2048), is_leaf=True)  # primals_360
    buf318 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf318, (9, 2048), is_leaf=True)  # primals_361
    buf319 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf319, (8,), is_leaf=True)  # primals_362
    buf320 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf320, (64, 512), is_leaf=True)  # primals_363
    buf321 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf321, (32, 2048), is_leaf=True)  # primals_364
    buf322 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf322, (32,), is_leaf=True)  # primals_365
    buf323 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf323, (1, 2048), is_leaf=True)  # primals_367
    buf324 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf324, (1, 1408, 2048), is_leaf=True)  # primals_369
    buf325 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf325, (1, 2048, 1408), is_leaf=True)  # primals_370
    buf326 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf326, (1, 1408, 2048), is_leaf=True)  # primals_371
    buf327 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf327, (44, 2048), is_leaf=True)  # primals_372
    buf328 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf328, (44, 2048), is_leaf=True)  # primals_373
    buf329 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf329, (32, 2816), is_leaf=True)  # primals_374
    buf330 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf330, (32,), is_leaf=True)  # primals_375
    buf331 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf331, (48, 2048), is_leaf=True)  # primals_376
    buf332 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf332, (9, 2048), is_leaf=True)  # primals_377
    buf333 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf333, (8,), is_leaf=True)  # primals_378
    buf334 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf334, (64, 512), is_leaf=True)  # primals_379
    buf335 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf335, (32, 2048), is_leaf=True)  # primals_380
    buf336 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf336, (32,), is_leaf=True)  # primals_381
    buf337 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf337, (1, 2048), is_leaf=True)  # primals_383
    buf338 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf338, (1, 1408, 2048), is_leaf=True)  # primals_385
    buf339 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf339, (1, 2048, 1408), is_leaf=True)  # primals_386
    buf340 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf340, (1, 1408, 2048), is_leaf=True)  # primals_387
    buf341 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf341, (44, 2048), is_leaf=True)  # primals_388
    buf342 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf342, (44, 2048), is_leaf=True)  # primals_389
    buf343 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf343, (32, 2816), is_leaf=True)  # primals_390
    buf344 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf344, (32,), is_leaf=True)  # primals_391
    buf345 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf345, (48, 2048), is_leaf=True)  # primals_392
    buf346 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf346, (9, 2048), is_leaf=True)  # primals_393
    buf347 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf347, (8,), is_leaf=True)  # primals_394
    buf348 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf348, (64, 512), is_leaf=True)  # primals_395
    buf349 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf349, (32, 2048), is_leaf=True)  # primals_396
    buf350 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf350, (32,), is_leaf=True)  # primals_397
    buf351 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf351, (1, 2048), is_leaf=True)  # primals_399
    buf352 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf352, (1, 1408, 2048), is_leaf=True)  # primals_401
    buf353 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf353, (1, 2048, 1408), is_leaf=True)  # primals_402
    buf354 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf354, (1, 1408, 2048), is_leaf=True)  # primals_403
    buf355 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf355, (44, 2048), is_leaf=True)  # primals_404
    buf356 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf356, (44, 2048), is_leaf=True)  # primals_405
    buf357 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf357, (32, 2816), is_leaf=True)  # primals_406
    buf358 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf358, (32,), is_leaf=True)  # primals_407
    buf359 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf359, (48, 2048), is_leaf=True)  # primals_408
    buf360 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf360, (9, 2048), is_leaf=True)  # primals_409
    buf361 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf361, (8,), is_leaf=True)  # primals_410
    buf362 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf362, (64, 512), is_leaf=True)  # primals_411
    buf363 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf363, (32, 2048), is_leaf=True)  # primals_412
    buf364 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf364, (32,), is_leaf=True)  # primals_413
    buf365 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf365, (1, 2048), is_leaf=True)  # primals_415
    buf366 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf366, (1, 1408, 2048), is_leaf=True)  # primals_417
    buf367 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf367, (1, 2048, 1408), is_leaf=True)  # primals_418
    buf368 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf368, (1, 1408, 2048), is_leaf=True)  # primals_419
    buf369 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf369, (44, 2048), is_leaf=True)  # primals_420
    buf370 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf370, (44, 2048), is_leaf=True)  # primals_421
    buf371 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf371, (32, 2816), is_leaf=True)  # primals_422
    buf372 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf372, (32,), is_leaf=True)  # primals_423
    buf373 = reader.storage(None, 393216, device=device(type='cuda', index=0))
    reader.tensor(buf373, (48, 2048), is_leaf=True)  # primals_424
    buf374 = reader.storage(None, 73728, device=device(type='cuda', index=0))
    reader.tensor(buf374, (9, 2048), is_leaf=True)  # primals_425
    buf375 = reader.storage(None, 32, device=device(type='cuda', index=0))
    reader.tensor(buf375, (8,), is_leaf=True)  # primals_426
    buf376 = reader.storage(None, 131072, device=device(type='cuda', index=0))
    reader.tensor(buf376, (64, 512), is_leaf=True)  # primals_427
    buf377 = reader.storage(None, 262144, device=device(type='cuda', index=0))
    reader.tensor(buf377, (32, 2048), is_leaf=True)  # primals_428
    buf378 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf378, (32,), is_leaf=True)  # primals_429
    buf379 = reader.storage(None, 8192, device=device(type='cuda', index=0))
    reader.tensor(buf379, (1, 2048), is_leaf=True)  # primals_431
    buf380 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf380, (1, 1408, 2048), is_leaf=True)  # primals_433
    buf381 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf381, (1, 2048, 1408), is_leaf=True)  # primals_434
    buf382 = reader.storage(None, 11534336, device=device(type='cuda', index=0))
    reader.tensor(buf382, (1, 1408, 2048), is_leaf=True)  # primals_435
    buf383 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf383, (44, 2048), is_leaf=True)  # primals_436
    buf384 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf384, (44, 2048), is_leaf=True)  # primals_437
    buf385 = reader.storage(None, 360448, device=device(type='cuda', index=0))
    reader.tensor(buf385, (32, 2816), is_leaf=True)  # primals_438
    buf386 = reader.storage(None, 128, device=device(type='cuda', index=0))
    reader.tensor(buf386, (32,), is_leaf=True)  # primals_439
    buf387 = reader.storage(None, 13107200, device=device(type='cuda', index=0))
    reader.tensor(buf387, (1600, 2048), is_leaf=True)  # primals_440
    buf388 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf388, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # embedding
    buf389 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf389, (2, 4096, 1), is_leaf=True)  # rsqrt
    buf390 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf390, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_3
    buf391 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf391, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_2
    buf392 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf392, (2, 4096, 1), is_leaf=True)  # rsqrt_1
    buf393 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf393, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_17
    buf394 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf394, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_3
    buf395 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf395, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_4
    buf396 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf396, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_5
    buf397 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf397, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_6
    buf398 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf398, (2, 16, 4096), is_leaf=True)  # getitem_7
    buf399 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf399, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # mm_3
    buf400 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf400, (2, 4096, 1), is_leaf=True)  # rsqrt_2
    buf401 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf401, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_26
    buf402 = reader.storage(None, 179306496, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf402, (8192, 10944), dtype=torch.bfloat16, is_leaf=True)  # mm_4
    buf403 = reader.storage(None, 179306496, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf403, (8192, 10944), dtype=torch.bfloat16, is_leaf=True)  # mm_5
    buf404 = reader.storage(None, 179306496, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf404, (8192, 10944), dtype=torch.bfloat16, is_leaf=True)  # view_32
    buf405 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf405, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_5
    buf406 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf406, (2, 4096, 1), is_leaf=True)  # rsqrt_3
    buf407 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf407, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_36
    buf408 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf408, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_11
    buf409 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf409, (2, 4096, 1), is_leaf=True)  # rsqrt_4
    buf410 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf410, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_50
    buf411 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf411, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_14
    buf412 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf412, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_15
    buf413 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf413, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_16
    buf414 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf414, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_15
    buf415 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf415, (2, 16, 4096), is_leaf=True)  # getitem_16
    buf416 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf416, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_8
    buf417 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf417, (2, 4096, 1), is_leaf=True)  # rsqrt_5
    buf418 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf418, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_58
    buf419 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf419, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_11
    buf420 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf420, (8192, 1), is_leaf=True)  # amax
    buf421 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf421, (8192, 1), is_leaf=True)  # sum_1
    buf422 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf422, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_19
    buf423 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf423, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_21
    buf424 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf424, (49152,), dtype=torch.int64, is_leaf=True)  # div_2
    buf425 = reader.storage(None, 32*(((u10 + u11 + u12 + u13 + u14 + u15 + u8 + u9 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf425, (8*(((u10 + u11 + u12 + u13 + u14 + u15 + u8 + u9 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_22
    buf426 = reader.storage(None, 32768*(((u10 + u11 + u12 + u13 + u14 + u15 + u8 + u9 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf426, (8*(((u10 + u11 + u12 + u13 + u14 + u15 + u8 + u9 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_1
    buf427 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf427, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_2
    buf428 = reader.storage(None, 22528*(((u10 + u11 + u12 + u13 + u14 + u15 + u8 + u9 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf428, (8*(((u10 + u11 + u12 + u13 + u14 + u15 + u8 + u9 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm
    buf429 = reader.storage(None, 22528*(((u10 + u11 + u12 + u13 + u14 + u15 + u8 + u9 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf429, (8*(((u10 + u11 + u12 + u13 + u14 + u15 + u8 + u9 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_1
    buf430 = reader.storage(None, 22528*(((u10 + u11 + u12 + u13 + u14 + u15 + u8 + u9 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf430, (8*(((u10 + u11 + u12 + u13 + u14 + u15 + u8 + u9 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_35
    buf431 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf431, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_12
    buf432 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf432, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_13
    buf433 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf433, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_55
    buf434 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf434, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_73
    buf435 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf435, (2, 4096, 1), is_leaf=True)  # rsqrt_6
    buf436 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf436, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_103
    buf437 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf437, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_25
    buf438 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf438, (2, 4096, 1), is_leaf=True)  # rsqrt_7
    buf439 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf439, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_117
    buf440 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf440, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_29
    buf441 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf441, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_30
    buf442 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf442, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_31
    buf443 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf443, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_29
    buf444 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf444, (2, 16, 4096), is_leaf=True)  # getitem_30
    buf445 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf445, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_76
    buf446 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf446, (2, 4096, 1), is_leaf=True)  # rsqrt_8
    buf447 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf447, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_125
    buf448 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf448, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_19
    buf449 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf449, (8192, 1), is_leaf=True)  # amax_1
    buf450 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf450, (8192, 1), is_leaf=True)  # sum_5
    buf451 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf451, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_33
    buf452 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf452, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_35
    buf453 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf453, (49152,), dtype=torch.int64, is_leaf=True)  # div_7
    buf454 = reader.storage(None, 32*(((u24 + u25 + u26 + u27 + u28 + u29 + u30 + u31 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf454, (8*(((u24 + u25 + u26 + u27 + u28 + u29 + u30 + u31 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_36
    buf455 = reader.storage(None, 32768*(((u24 + u25 + u26 + u27 + u28 + u29 + u30 + u31 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf455, (8*(((u24 + u25 + u26 + u27 + u28 + u29 + u30 + u31 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_3
    buf456 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf456, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_5
    buf457 = reader.storage(None, 22528*(((u24 + u25 + u26 + u27 + u28 + u29 + u30 + u31 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf457, (8*(((u24 + u25 + u26 + u27 + u28 + u29 + u30 + u31 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_3
    buf458 = reader.storage(None, 22528*(((u24 + u25 + u26 + u27 + u28 + u29 + u30 + u31 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf458, (8*(((u24 + u25 + u26 + u27 + u28 + u29 + u30 + u31 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_4
    buf459 = reader.storage(None, 22528*(((u24 + u25 + u26 + u27 + u28 + u29 + u30 + u31 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf459, (8*(((u24 + u25 + u26 + u27 + u28 + u29 + u30 + u31 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_84
    buf460 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf460, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_20
    buf461 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf461, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_21
    buf462 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf462, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_104
    buf463 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf463, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_141
    buf464 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf464, (2, 4096, 1), is_leaf=True)  # rsqrt_9
    buf465 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf465, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_170
    buf466 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf466, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_39
    buf467 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf467, (2, 4096, 1), is_leaf=True)  # rsqrt_10
    buf468 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf468, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_184
    buf469 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf469, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_44
    buf470 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf470, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_45
    buf471 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf471, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_46
    buf472 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf472, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_43
    buf473 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf473, (2, 16, 4096), is_leaf=True)  # getitem_44
    buf474 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf474, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_144
    buf475 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf475, (2, 4096, 1), is_leaf=True)  # rsqrt_11
    buf476 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf476, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_192
    buf477 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf477, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_27
    buf478 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf478, (8192, 1), is_leaf=True)  # amax_2
    buf479 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf479, (8192, 1), is_leaf=True)  # sum_9
    buf480 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf480, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_47
    buf481 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf481, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_49
    buf482 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf482, (49152,), dtype=torch.int64, is_leaf=True)  # div_12
    buf483 = reader.storage(None, 32*(((u40 + u41 + u42 + u43 + u44 + u45 + u46 + u47 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf483, (8*(((u40 + u41 + u42 + u43 + u44 + u45 + u46 + u47 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_50
    buf484 = reader.storage(None, 32768*(((u40 + u41 + u42 + u43 + u44 + u45 + u46 + u47 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf484, (8*(((u40 + u41 + u42 + u43 + u44 + u45 + u46 + u47 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_5
    buf485 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf485, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_8
    buf486 = reader.storage(None, 22528*(((u40 + u41 + u42 + u43 + u44 + u45 + u46 + u47 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf486, (8*(((u40 + u41 + u42 + u43 + u44 + u45 + u46 + u47 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_6
    buf487 = reader.storage(None, 22528*(((u40 + u41 + u42 + u43 + u44 + u45 + u46 + u47 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf487, (8*(((u40 + u41 + u42 + u43 + u44 + u45 + u46 + u47 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_7
    buf488 = reader.storage(None, 22528*(((u40 + u41 + u42 + u43 + u44 + u45 + u46 + u47 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf488, (8*(((u40 + u41 + u42 + u43 + u44 + u45 + u46 + u47 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_133
    buf489 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf489, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_28
    buf490 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf490, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_29
    buf491 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf491, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_153
    buf492 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf492, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_209
    buf493 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf493, (2, 4096, 1), is_leaf=True)  # rsqrt_12
    buf494 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf494, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_237
    buf495 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf495, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_53
    buf496 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf496, (2, 4096, 1), is_leaf=True)  # rsqrt_13
    buf497 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf497, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_251
    buf498 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf498, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_59
    buf499 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf499, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_60
    buf500 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf500, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_61
    buf501 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf501, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_57
    buf502 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf502, (2, 16, 4096), is_leaf=True)  # getitem_58
    buf503 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf503, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_212
    buf504 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf504, (2, 4096, 1), is_leaf=True)  # rsqrt_14
    buf505 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf505, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_259
    buf506 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf506, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_35
    buf507 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf507, (8192, 1), is_leaf=True)  # amax_3
    buf508 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf508, (8192, 1), is_leaf=True)  # sum_13
    buf509 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf509, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_61
    buf510 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf510, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_63
    buf511 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf511, (49152,), dtype=torch.int64, is_leaf=True)  # div_17
    buf512 = reader.storage(None, 32*(((u56 + u57 + u58 + u59 + u60 + u61 + u62 + u63 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf512, (8*(((u56 + u57 + u58 + u59 + u60 + u61 + u62 + u63 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_64
    buf513 = reader.storage(None, 32768*(((u56 + u57 + u58 + u59 + u60 + u61 + u62 + u63 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf513, (8*(((u56 + u57 + u58 + u59 + u60 + u61 + u62 + u63 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_7
    buf514 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf514, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_11
    buf515 = reader.storage(None, 22528*(((u56 + u57 + u58 + u59 + u60 + u61 + u62 + u63 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf515, (8*(((u56 + u57 + u58 + u59 + u60 + u61 + u62 + u63 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_9
    buf516 = reader.storage(None, 22528*(((u56 + u57 + u58 + u59 + u60 + u61 + u62 + u63 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf516, (8*(((u56 + u57 + u58 + u59 + u60 + u61 + u62 + u63 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_10
    buf517 = reader.storage(None, 22528*(((u56 + u57 + u58 + u59 + u60 + u61 + u62 + u63 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf517, (8*(((u56 + u57 + u58 + u59 + u60 + u61 + u62 + u63 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_182
    buf518 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf518, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_36
    buf519 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf519, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_37
    buf520 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf520, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_202
    buf521 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf521, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_277
    buf522 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf522, (2, 4096, 1), is_leaf=True)  # rsqrt_15
    buf523 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf523, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_304
    buf524 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf524, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_67
    buf525 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf525, (2, 4096, 1), is_leaf=True)  # rsqrt_16
    buf526 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf526, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_318
    buf527 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf527, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_74
    buf528 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf528, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_75
    buf529 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf529, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_76
    buf530 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf530, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_71
    buf531 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf531, (2, 16, 4096), is_leaf=True)  # getitem_72
    buf532 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf532, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_280
    buf533 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf533, (2, 4096, 1), is_leaf=True)  # rsqrt_17
    buf534 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf534, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_326
    buf535 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf535, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_43
    buf536 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf536, (8192, 1), is_leaf=True)  # amax_4
    buf537 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf537, (8192, 1), is_leaf=True)  # sum_17
    buf538 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf538, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_75
    buf539 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf539, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_77
    buf540 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf540, (49152,), dtype=torch.int64, is_leaf=True)  # div_22
    buf541 = reader.storage(None, 32*(((u72 + u73 + u74 + u75 + u76 + u77 + u78 + u79 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf541, (8*(((u72 + u73 + u74 + u75 + u76 + u77 + u78 + u79 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_78
    buf542 = reader.storage(None, 32768*(((u72 + u73 + u74 + u75 + u76 + u77 + u78 + u79 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf542, (8*(((u72 + u73 + u74 + u75 + u76 + u77 + u78 + u79 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_9
    buf543 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf543, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_14
    buf544 = reader.storage(None, 22528*(((u72 + u73 + u74 + u75 + u76 + u77 + u78 + u79 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf544, (8*(((u72 + u73 + u74 + u75 + u76 + u77 + u78 + u79 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_12
    buf545 = reader.storage(None, 22528*(((u72 + u73 + u74 + u75 + u76 + u77 + u78 + u79 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf545, (8*(((u72 + u73 + u74 + u75 + u76 + u77 + u78 + u79 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_13
    buf546 = reader.storage(None, 22528*(((u72 + u73 + u74 + u75 + u76 + u77 + u78 + u79 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf546, (8*(((u72 + u73 + u74 + u75 + u76 + u77 + u78 + u79 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_231
    buf547 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf547, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_44
    buf548 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf548, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_45
    buf549 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf549, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_251
    buf550 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf550, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_345
    buf551 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf551, (2, 4096, 1), is_leaf=True)  # rsqrt_18
    buf552 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf552, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_371
    buf553 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf553, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_81
    buf554 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf554, (2, 4096, 1), is_leaf=True)  # rsqrt_19
    buf555 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf555, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_385
    buf556 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf556, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_89
    buf557 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf557, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_90
    buf558 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf558, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_91
    buf559 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf559, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_85
    buf560 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf560, (2, 16, 4096), is_leaf=True)  # getitem_86
    buf561 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf561, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_348
    buf562 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf562, (2, 4096, 1), is_leaf=True)  # rsqrt_20
    buf563 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf563, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_393
    buf564 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf564, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_51
    buf565 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf565, (8192, 1), is_leaf=True)  # amax_5
    buf566 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf566, (8192, 1), is_leaf=True)  # sum_21
    buf567 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf567, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_89
    buf568 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf568, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_91
    buf569 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf569, (49152,), dtype=torch.int64, is_leaf=True)  # div_27
    buf570 = reader.storage(None, 32*(((u88 + u89 + u90 + u91 + u92 + u93 + u94 + u95 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf570, (8*(((u88 + u89 + u90 + u91 + u92 + u93 + u94 + u95 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_92
    buf571 = reader.storage(None, 32768*(((u88 + u89 + u90 + u91 + u92 + u93 + u94 + u95 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf571, (8*(((u88 + u89 + u90 + u91 + u92 + u93 + u94 + u95 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_11
    buf572 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf572, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_17
    buf573 = reader.storage(None, 22528*(((u88 + u89 + u90 + u91 + u92 + u93 + u94 + u95 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf573, (8*(((u88 + u89 + u90 + u91 + u92 + u93 + u94 + u95 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_15
    buf574 = reader.storage(None, 22528*(((u88 + u89 + u90 + u91 + u92 + u93 + u94 + u95 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf574, (8*(((u88 + u89 + u90 + u91 + u92 + u93 + u94 + u95 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_16
    buf575 = reader.storage(None, 22528*(((u88 + u89 + u90 + u91 + u92 + u93 + u94 + u95 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf575, (8*(((u88 + u89 + u90 + u91 + u92 + u93 + u94 + u95 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_280
    buf576 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf576, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_52
    buf577 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf577, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_53
    buf578 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf578, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_300
    buf579 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf579, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_413
    buf580 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf580, (2, 4096, 1), is_leaf=True)  # rsqrt_21
    buf581 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf581, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_438
    buf582 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf582, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_95
    buf583 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf583, (2, 4096, 1), is_leaf=True)  # rsqrt_22
    buf584 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf584, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_452
    buf585 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf585, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_104
    buf586 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf586, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_105
    buf587 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf587, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_106
    buf588 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf588, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_99
    buf589 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf589, (2, 16, 4096), is_leaf=True)  # getitem_100
    buf590 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf590, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_416
    buf591 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf591, (2, 4096, 1), is_leaf=True)  # rsqrt_23
    buf592 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf592, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_460
    buf593 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf593, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_59
    buf594 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf594, (8192, 1), is_leaf=True)  # amax_6
    buf595 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf595, (8192, 1), is_leaf=True)  # sum_25
    buf596 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf596, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_103
    buf597 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf597, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_105
    buf598 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf598, (49152,), dtype=torch.int64, is_leaf=True)  # div_32
    buf599 = reader.storage(None, 32*(((u104 + u105 + u106 + u107 + u108 + u109 + u110 + u111 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf599, (8*(((u104 + u105 + u106 + u107 + u108 + u109 + u110 + u111 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_106
    buf600 = reader.storage(None, 32768*(((u104 + u105 + u106 + u107 + u108 + u109 + u110 + u111 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf600, (8*(((u104 + u105 + u106 + u107 + u108 + u109 + u110 + u111 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_13
    buf601 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf601, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_20
    buf602 = reader.storage(None, 22528*(((u104 + u105 + u106 + u107 + u108 + u109 + u110 + u111 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf602, (8*(((u104 + u105 + u106 + u107 + u108 + u109 + u110 + u111 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_18
    buf603 = reader.storage(None, 22528*(((u104 + u105 + u106 + u107 + u108 + u109 + u110 + u111 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf603, (8*(((u104 + u105 + u106 + u107 + u108 + u109 + u110 + u111 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_19
    buf604 = reader.storage(None, 22528*(((u104 + u105 + u106 + u107 + u108 + u109 + u110 + u111 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf604, (8*(((u104 + u105 + u106 + u107 + u108 + u109 + u110 + u111 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_329
    buf605 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf605, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_60
    buf606 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf606, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_61
    buf607 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf607, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_349
    buf608 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf608, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_481
    buf609 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf609, (2, 4096, 1), is_leaf=True)  # rsqrt_24
    buf610 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf610, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_505
    buf611 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf611, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_109
    buf612 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf612, (2, 4096, 1), is_leaf=True)  # rsqrt_25
    buf613 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf613, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_519
    buf614 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf614, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_119
    buf615 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf615, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_120
    buf616 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf616, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_121
    buf617 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf617, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_113
    buf618 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf618, (2, 16, 4096), is_leaf=True)  # getitem_114
    buf619 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf619, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_484
    buf620 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf620, (2, 4096, 1), is_leaf=True)  # rsqrt_26
    buf621 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf621, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_527
    buf622 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf622, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_67
    buf623 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf623, (8192, 1), is_leaf=True)  # amax_7
    buf624 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf624, (8192, 1), is_leaf=True)  # sum_29
    buf625 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf625, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_117
    buf626 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf626, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_119
    buf627 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf627, (49152,), dtype=torch.int64, is_leaf=True)  # div_37
    buf628 = reader.storage(None, 32*(((u120 + u121 + u122 + u123 + u124 + u125 + u126 + u127 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf628, (8*(((u120 + u121 + u122 + u123 + u124 + u125 + u126 + u127 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_120
    buf629 = reader.storage(None, 32768*(((u120 + u121 + u122 + u123 + u124 + u125 + u126 + u127 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf629, (8*(((u120 + u121 + u122 + u123 + u124 + u125 + u126 + u127 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_15
    buf630 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf630, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_23
    buf631 = reader.storage(None, 22528*(((u120 + u121 + u122 + u123 + u124 + u125 + u126 + u127 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf631, (8*(((u120 + u121 + u122 + u123 + u124 + u125 + u126 + u127 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_21
    buf632 = reader.storage(None, 22528*(((u120 + u121 + u122 + u123 + u124 + u125 + u126 + u127 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf632, (8*(((u120 + u121 + u122 + u123 + u124 + u125 + u126 + u127 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_22
    buf633 = reader.storage(None, 22528*(((u120 + u121 + u122 + u123 + u124 + u125 + u126 + u127 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf633, (8*(((u120 + u121 + u122 + u123 + u124 + u125 + u126 + u127 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_378
    buf634 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf634, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_68
    buf635 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf635, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_69
    buf636 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf636, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_398
    buf637 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf637, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_549
    buf638 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf638, (2, 4096, 1), is_leaf=True)  # rsqrt_27
    buf639 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf639, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_572
    buf640 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf640, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_123
    buf641 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf641, (2, 4096, 1), is_leaf=True)  # rsqrt_28
    buf642 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf642, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_586
    buf643 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf643, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_134
    buf644 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf644, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_135
    buf645 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf645, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_136
    buf646 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf646, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_127
    buf647 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf647, (2, 16, 4096), is_leaf=True)  # getitem_128
    buf648 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf648, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_552
    buf649 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf649, (2, 4096, 1), is_leaf=True)  # rsqrt_29
    buf650 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf650, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_594
    buf651 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf651, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_75
    buf652 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf652, (8192, 1), is_leaf=True)  # amax_8
    buf653 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf653, (8192, 1), is_leaf=True)  # sum_33
    buf654 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf654, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_131
    buf655 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf655, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_133
    buf656 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf656, (49152,), dtype=torch.int64, is_leaf=True)  # div_42
    buf657 = reader.storage(None, 32*(((u136 + u137 + u138 + u139 + u140 + u141 + u142 + u143 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf657, (8*(((u136 + u137 + u138 + u139 + u140 + u141 + u142 + u143 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_134
    buf658 = reader.storage(None, 32768*(((u136 + u137 + u138 + u139 + u140 + u141 + u142 + u143 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf658, (8*(((u136 + u137 + u138 + u139 + u140 + u141 + u142 + u143 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_17
    buf659 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf659, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_26
    buf660 = reader.storage(None, 22528*(((u136 + u137 + u138 + u139 + u140 + u141 + u142 + u143 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf660, (8*(((u136 + u137 + u138 + u139 + u140 + u141 + u142 + u143 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_24
    buf661 = reader.storage(None, 22528*(((u136 + u137 + u138 + u139 + u140 + u141 + u142 + u143 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf661, (8*(((u136 + u137 + u138 + u139 + u140 + u141 + u142 + u143 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_25
    buf662 = reader.storage(None, 22528*(((u136 + u137 + u138 + u139 + u140 + u141 + u142 + u143 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf662, (8*(((u136 + u137 + u138 + u139 + u140 + u141 + u142 + u143 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_427
    buf663 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf663, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_76
    buf664 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf664, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_77
    buf665 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf665, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_447
    buf666 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf666, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_617
    buf667 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf667, (2, 4096, 1), is_leaf=True)  # rsqrt_30
    buf668 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf668, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_639
    buf669 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf669, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_137
    buf670 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf670, (2, 4096, 1), is_leaf=True)  # rsqrt_31
    buf671 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf671, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_653
    buf672 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf672, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_149
    buf673 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf673, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_150
    buf674 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf674, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_151
    buf675 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf675, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_141
    buf676 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf676, (2, 16, 4096), is_leaf=True)  # getitem_142
    buf677 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf677, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_620
    buf678 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf678, (2, 4096, 1), is_leaf=True)  # rsqrt_32
    buf679 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf679, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_661
    buf680 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf680, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_83
    buf681 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf681, (8192, 1), is_leaf=True)  # amax_9
    buf682 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf682, (8192, 1), is_leaf=True)  # sum_37
    buf683 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf683, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_145
    buf684 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf684, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_147
    buf685 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf685, (49152,), dtype=torch.int64, is_leaf=True)  # div_47
    buf686 = reader.storage(None, 32*(((u152 + u153 + u154 + u155 + u156 + u157 + u158 + u159 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf686, (8*(((u152 + u153 + u154 + u155 + u156 + u157 + u158 + u159 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_148
    buf687 = reader.storage(None, 32768*(((u152 + u153 + u154 + u155 + u156 + u157 + u158 + u159 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf687, (8*(((u152 + u153 + u154 + u155 + u156 + u157 + u158 + u159 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_19
    buf688 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf688, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_29
    buf689 = reader.storage(None, 22528*(((u152 + u153 + u154 + u155 + u156 + u157 + u158 + u159 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf689, (8*(((u152 + u153 + u154 + u155 + u156 + u157 + u158 + u159 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_27
    buf690 = reader.storage(None, 22528*(((u152 + u153 + u154 + u155 + u156 + u157 + u158 + u159 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf690, (8*(((u152 + u153 + u154 + u155 + u156 + u157 + u158 + u159 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_28
    buf691 = reader.storage(None, 22528*(((u152 + u153 + u154 + u155 + u156 + u157 + u158 + u159 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf691, (8*(((u152 + u153 + u154 + u155 + u156 + u157 + u158 + u159 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_476
    buf692 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf692, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_84
    buf693 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf693, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_85
    buf694 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf694, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_496
    buf695 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf695, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_685
    buf696 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf696, (2, 4096, 1), is_leaf=True)  # rsqrt_33
    buf697 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf697, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_706
    buf698 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf698, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_151
    buf699 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf699, (2, 4096, 1), is_leaf=True)  # rsqrt_34
    buf700 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf700, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_720
    buf701 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf701, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_164
    buf702 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf702, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_165
    buf703 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf703, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_166
    buf704 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf704, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_155
    buf705 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf705, (2, 16, 4096), is_leaf=True)  # getitem_156
    buf706 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf706, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_688
    buf707 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf707, (2, 4096, 1), is_leaf=True)  # rsqrt_35
    buf708 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf708, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_728
    buf709 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf709, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_91
    buf710 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf710, (8192, 1), is_leaf=True)  # amax_10
    buf711 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf711, (8192, 1), is_leaf=True)  # sum_41
    buf712 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf712, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_159
    buf713 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf713, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_161
    buf714 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf714, (49152,), dtype=torch.int64, is_leaf=True)  # div_52
    buf715 = reader.storage(None, 32*(((u168 + u169 + u170 + u171 + u172 + u173 + u174 + u175 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf715, (8*(((u168 + u169 + u170 + u171 + u172 + u173 + u174 + u175 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_162
    buf716 = reader.storage(None, 32768*(((u168 + u169 + u170 + u171 + u172 + u173 + u174 + u175 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf716, (8*(((u168 + u169 + u170 + u171 + u172 + u173 + u174 + u175 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_21
    buf717 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf717, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_32
    buf718 = reader.storage(None, 22528*(((u168 + u169 + u170 + u171 + u172 + u173 + u174 + u175 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf718, (8*(((u168 + u169 + u170 + u171 + u172 + u173 + u174 + u175 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_30
    buf719 = reader.storage(None, 22528*(((u168 + u169 + u170 + u171 + u172 + u173 + u174 + u175 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf719, (8*(((u168 + u169 + u170 + u171 + u172 + u173 + u174 + u175 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_31
    buf720 = reader.storage(None, 22528*(((u168 + u169 + u170 + u171 + u172 + u173 + u174 + u175 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf720, (8*(((u168 + u169 + u170 + u171 + u172 + u173 + u174 + u175 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_525
    buf721 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf721, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_92
    buf722 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf722, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_93
    buf723 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf723, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_545
    buf724 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf724, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_753
    buf725 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf725, (2, 4096, 1), is_leaf=True)  # rsqrt_36
    buf726 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf726, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_773
    buf727 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf727, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_165
    buf728 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf728, (2, 4096, 1), is_leaf=True)  # rsqrt_37
    buf729 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf729, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_787
    buf730 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf730, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_179
    buf731 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf731, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_180
    buf732 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf732, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_181
    buf733 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf733, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_169
    buf734 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf734, (2, 16, 4096), is_leaf=True)  # getitem_170
    buf735 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf735, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_756
    buf736 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf736, (2, 4096, 1), is_leaf=True)  # rsqrt_38
    buf737 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf737, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_795
    buf738 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf738, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_99
    buf739 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf739, (8192, 1), is_leaf=True)  # amax_11
    buf740 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf740, (8192, 1), is_leaf=True)  # sum_45
    buf741 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf741, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_173
    buf742 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf742, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_175
    buf743 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf743, (49152,), dtype=torch.int64, is_leaf=True)  # div_57
    buf744 = reader.storage(None, 32*(((u184 + u185 + u186 + u187 + u188 + u189 + u190 + u191 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf744, (8*(((u184 + u185 + u186 + u187 + u188 + u189 + u190 + u191 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_176
    buf745 = reader.storage(None, 32768*(((u184 + u185 + u186 + u187 + u188 + u189 + u190 + u191 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf745, (8*(((u184 + u185 + u186 + u187 + u188 + u189 + u190 + u191 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_23
    buf746 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf746, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_35
    buf747 = reader.storage(None, 22528*(((u184 + u185 + u186 + u187 + u188 + u189 + u190 + u191 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf747, (8*(((u184 + u185 + u186 + u187 + u188 + u189 + u190 + u191 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_33
    buf748 = reader.storage(None, 22528*(((u184 + u185 + u186 + u187 + u188 + u189 + u190 + u191 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf748, (8*(((u184 + u185 + u186 + u187 + u188 + u189 + u190 + u191 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_34
    buf749 = reader.storage(None, 22528*(((u184 + u185 + u186 + u187 + u188 + u189 + u190 + u191 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf749, (8*(((u184 + u185 + u186 + u187 + u188 + u189 + u190 + u191 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_574
    buf750 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf750, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_100
    buf751 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf751, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_101
    buf752 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf752, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_594
    buf753 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf753, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_821
    buf754 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf754, (2, 4096, 1), is_leaf=True)  # rsqrt_39
    buf755 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf755, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_840
    buf756 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf756, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_179
    buf757 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf757, (2, 4096, 1), is_leaf=True)  # rsqrt_40
    buf758 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf758, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_854
    buf759 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf759, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_194
    buf760 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf760, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_195
    buf761 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf761, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_196
    buf762 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf762, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_183
    buf763 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf763, (2, 16, 4096), is_leaf=True)  # getitem_184
    buf764 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf764, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_824
    buf765 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf765, (2, 4096, 1), is_leaf=True)  # rsqrt_41
    buf766 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf766, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_862
    buf767 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf767, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_107
    buf768 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf768, (8192, 1), is_leaf=True)  # amax_12
    buf769 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf769, (8192, 1), is_leaf=True)  # sum_49
    buf770 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf770, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_187
    buf771 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf771, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_189
    buf772 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf772, (49152,), dtype=torch.int64, is_leaf=True)  # div_62
    buf773 = reader.storage(None, 32*(((u200 + u201 + u202 + u203 + u204 + u205 + u206 + u207 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf773, (8*(((u200 + u201 + u202 + u203 + u204 + u205 + u206 + u207 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_190
    buf774 = reader.storage(None, 32768*(((u200 + u201 + u202 + u203 + u204 + u205 + u206 + u207 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf774, (8*(((u200 + u201 + u202 + u203 + u204 + u205 + u206 + u207 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_25
    buf775 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf775, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_38
    buf776 = reader.storage(None, 22528*(((u200 + u201 + u202 + u203 + u204 + u205 + u206 + u207 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf776, (8*(((u200 + u201 + u202 + u203 + u204 + u205 + u206 + u207 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_36
    buf777 = reader.storage(None, 22528*(((u200 + u201 + u202 + u203 + u204 + u205 + u206 + u207 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf777, (8*(((u200 + u201 + u202 + u203 + u204 + u205 + u206 + u207 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_37
    buf778 = reader.storage(None, 22528*(((u200 + u201 + u202 + u203 + u204 + u205 + u206 + u207 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf778, (8*(((u200 + u201 + u202 + u203 + u204 + u205 + u206 + u207 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_623
    buf779 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf779, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_108
    buf780 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf780, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_109
    buf781 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf781, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_643
    buf782 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf782, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_889
    buf783 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf783, (2, 4096, 1), is_leaf=True)  # rsqrt_42
    buf784 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf784, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_907
    buf785 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf785, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_193
    buf786 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf786, (2, 4096, 1), is_leaf=True)  # rsqrt_43
    buf787 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf787, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_921
    buf788 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf788, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_209
    buf789 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf789, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_210
    buf790 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf790, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_211
    buf791 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf791, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_197
    buf792 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf792, (2, 16, 4096), is_leaf=True)  # getitem_198
    buf793 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf793, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_892
    buf794 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf794, (2, 4096, 1), is_leaf=True)  # rsqrt_44
    buf795 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf795, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_929
    buf796 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf796, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_115
    buf797 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf797, (8192, 1), is_leaf=True)  # amax_13
    buf798 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf798, (8192, 1), is_leaf=True)  # sum_53
    buf799 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf799, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_201
    buf800 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf800, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_203
    buf801 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf801, (49152,), dtype=torch.int64, is_leaf=True)  # div_67
    buf802 = reader.storage(None, 32*(((u216 + u217 + u218 + u219 + u220 + u221 + u222 + u223 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf802, (8*(((u216 + u217 + u218 + u219 + u220 + u221 + u222 + u223 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_204
    buf803 = reader.storage(None, 32768*(((u216 + u217 + u218 + u219 + u220 + u221 + u222 + u223 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf803, (8*(((u216 + u217 + u218 + u219 + u220 + u221 + u222 + u223 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_27
    buf804 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf804, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_41
    buf805 = reader.storage(None, 22528*(((u216 + u217 + u218 + u219 + u220 + u221 + u222 + u223 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf805, (8*(((u216 + u217 + u218 + u219 + u220 + u221 + u222 + u223 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_39
    buf806 = reader.storage(None, 22528*(((u216 + u217 + u218 + u219 + u220 + u221 + u222 + u223 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf806, (8*(((u216 + u217 + u218 + u219 + u220 + u221 + u222 + u223 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_40
    buf807 = reader.storage(None, 22528*(((u216 + u217 + u218 + u219 + u220 + u221 + u222 + u223 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf807, (8*(((u216 + u217 + u218 + u219 + u220 + u221 + u222 + u223 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_672
    buf808 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf808, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_116
    buf809 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf809, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_117
    buf810 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf810, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_692
    buf811 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf811, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_957
    buf812 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf812, (2, 4096, 1), is_leaf=True)  # rsqrt_45
    buf813 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf813, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_974
    buf814 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf814, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_207
    buf815 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf815, (2, 4096, 1), is_leaf=True)  # rsqrt_46
    buf816 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf816, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_988
    buf817 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf817, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_224
    buf818 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf818, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_225
    buf819 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf819, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_226
    buf820 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf820, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_211
    buf821 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf821, (2, 16, 4096), is_leaf=True)  # getitem_212
    buf822 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf822, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_960
    buf823 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf823, (2, 4096, 1), is_leaf=True)  # rsqrt_47
    buf824 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf824, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_996
    buf825 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf825, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_123
    buf826 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf826, (8192, 1), is_leaf=True)  # amax_14
    buf827 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf827, (8192, 1), is_leaf=True)  # sum_57
    buf828 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf828, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_215
    buf829 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf829, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_217
    buf830 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf830, (49152,), dtype=torch.int64, is_leaf=True)  # div_72
    buf831 = reader.storage(None, 32*(((u232 + u233 + u234 + u235 + u236 + u237 + u238 + u239 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf831, (8*(((u232 + u233 + u234 + u235 + u236 + u237 + u238 + u239 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_218
    buf832 = reader.storage(None, 32768*(((u232 + u233 + u234 + u235 + u236 + u237 + u238 + u239 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf832, (8*(((u232 + u233 + u234 + u235 + u236 + u237 + u238 + u239 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_29
    buf833 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf833, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_44
    buf834 = reader.storage(None, 22528*(((u232 + u233 + u234 + u235 + u236 + u237 + u238 + u239 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf834, (8*(((u232 + u233 + u234 + u235 + u236 + u237 + u238 + u239 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_42
    buf835 = reader.storage(None, 22528*(((u232 + u233 + u234 + u235 + u236 + u237 + u238 + u239 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf835, (8*(((u232 + u233 + u234 + u235 + u236 + u237 + u238 + u239 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_43
    buf836 = reader.storage(None, 22528*(((u232 + u233 + u234 + u235 + u236 + u237 + u238 + u239 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf836, (8*(((u232 + u233 + u234 + u235 + u236 + u237 + u238 + u239 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_721
    buf837 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf837, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_124
    buf838 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf838, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_125
    buf839 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf839, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_741
    buf840 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf840, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1025
    buf841 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf841, (2, 4096, 1), is_leaf=True)  # rsqrt_48
    buf842 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf842, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1041
    buf843 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf843, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_221
    buf844 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf844, (2, 4096, 1), is_leaf=True)  # rsqrt_49
    buf845 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf845, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1055
    buf846 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf846, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_239
    buf847 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf847, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_240
    buf848 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf848, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_241
    buf849 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf849, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_225
    buf850 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf850, (2, 16, 4096), is_leaf=True)  # getitem_226
    buf851 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf851, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1028
    buf852 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf852, (2, 4096, 1), is_leaf=True)  # rsqrt_50
    buf853 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf853, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1063
    buf854 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf854, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_131
    buf855 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf855, (8192, 1), is_leaf=True)  # amax_15
    buf856 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf856, (8192, 1), is_leaf=True)  # sum_61
    buf857 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf857, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_229
    buf858 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf858, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_231
    buf859 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf859, (49152,), dtype=torch.int64, is_leaf=True)  # div_77
    buf860 = reader.storage(None, 32*(((u248 + u249 + u250 + u251 + u252 + u253 + u254 + u255 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf860, (8*(((u248 + u249 + u250 + u251 + u252 + u253 + u254 + u255 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_232
    buf861 = reader.storage(None, 32768*(((u248 + u249 + u250 + u251 + u252 + u253 + u254 + u255 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf861, (8*(((u248 + u249 + u250 + u251 + u252 + u253 + u254 + u255 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_31
    buf862 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf862, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_47
    buf863 = reader.storage(None, 22528*(((u248 + u249 + u250 + u251 + u252 + u253 + u254 + u255 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf863, (8*(((u248 + u249 + u250 + u251 + u252 + u253 + u254 + u255 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_45
    buf864 = reader.storage(None, 22528*(((u248 + u249 + u250 + u251 + u252 + u253 + u254 + u255 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf864, (8*(((u248 + u249 + u250 + u251 + u252 + u253 + u254 + u255 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_46
    buf865 = reader.storage(None, 22528*(((u248 + u249 + u250 + u251 + u252 + u253 + u254 + u255 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf865, (8*(((u248 + u249 + u250 + u251 + u252 + u253 + u254 + u255 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_770
    buf866 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf866, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_132
    buf867 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf867, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_133
    buf868 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf868, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_790
    buf869 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf869, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1093
    buf870 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf870, (2, 4096, 1), is_leaf=True)  # rsqrt_51
    buf871 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf871, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1108
    buf872 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf872, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_235
    buf873 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf873, (2, 4096, 1), is_leaf=True)  # rsqrt_52
    buf874 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf874, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1122
    buf875 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf875, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_254
    buf876 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf876, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_255
    buf877 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf877, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_256
    buf878 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf878, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_239
    buf879 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf879, (2, 16, 4096), is_leaf=True)  # getitem_240
    buf880 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf880, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1096
    buf881 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf881, (2, 4096, 1), is_leaf=True)  # rsqrt_53
    buf882 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf882, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1130
    buf883 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf883, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_139
    buf884 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf884, (8192, 1), is_leaf=True)  # amax_16
    buf885 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf885, (8192, 1), is_leaf=True)  # sum_65
    buf886 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf886, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_243
    buf887 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf887, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_245
    buf888 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf888, (49152,), dtype=torch.int64, is_leaf=True)  # div_82
    buf889 = reader.storage(None, 32*(((u264 + u265 + u266 + u267 + u268 + u269 + u270 + u271 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf889, (8*(((u264 + u265 + u266 + u267 + u268 + u269 + u270 + u271 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_246
    buf890 = reader.storage(None, 32768*(((u264 + u265 + u266 + u267 + u268 + u269 + u270 + u271 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf890, (8*(((u264 + u265 + u266 + u267 + u268 + u269 + u270 + u271 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_33
    buf891 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf891, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_50
    buf892 = reader.storage(None, 22528*(((u264 + u265 + u266 + u267 + u268 + u269 + u270 + u271 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf892, (8*(((u264 + u265 + u266 + u267 + u268 + u269 + u270 + u271 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_48
    buf893 = reader.storage(None, 22528*(((u264 + u265 + u266 + u267 + u268 + u269 + u270 + u271 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf893, (8*(((u264 + u265 + u266 + u267 + u268 + u269 + u270 + u271 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_49
    buf894 = reader.storage(None, 22528*(((u264 + u265 + u266 + u267 + u268 + u269 + u270 + u271 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf894, (8*(((u264 + u265 + u266 + u267 + u268 + u269 + u270 + u271 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_819
    buf895 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf895, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_140
    buf896 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf896, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_141
    buf897 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf897, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_839
    buf898 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf898, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1161
    buf899 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf899, (2, 4096, 1), is_leaf=True)  # rsqrt_54
    buf900 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf900, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1175
    buf901 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf901, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_249
    buf902 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf902, (2, 4096, 1), is_leaf=True)  # rsqrt_55
    buf903 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf903, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1189
    buf904 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf904, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_269
    buf905 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf905, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_270
    buf906 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf906, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_271
    buf907 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf907, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_253
    buf908 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf908, (2, 16, 4096), is_leaf=True)  # getitem_254
    buf909 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf909, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1164
    buf910 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf910, (2, 4096, 1), is_leaf=True)  # rsqrt_56
    buf911 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf911, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1197
    buf912 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf912, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_147
    buf913 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf913, (8192, 1), is_leaf=True)  # amax_17
    buf914 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf914, (8192, 1), is_leaf=True)  # sum_69
    buf915 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf915, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_257
    buf916 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf916, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_259
    buf917 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf917, (49152,), dtype=torch.int64, is_leaf=True)  # div_87
    buf918 = reader.storage(None, 32*(((u280 + u281 + u282 + u283 + u284 + u285 + u286 + u287 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf918, (8*(((u280 + u281 + u282 + u283 + u284 + u285 + u286 + u287 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_260
    buf919 = reader.storage(None, 32768*(((u280 + u281 + u282 + u283 + u284 + u285 + u286 + u287 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf919, (8*(((u280 + u281 + u282 + u283 + u284 + u285 + u286 + u287 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_35
    buf920 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf920, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_53
    buf921 = reader.storage(None, 22528*(((u280 + u281 + u282 + u283 + u284 + u285 + u286 + u287 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf921, (8*(((u280 + u281 + u282 + u283 + u284 + u285 + u286 + u287 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_51
    buf922 = reader.storage(None, 22528*(((u280 + u281 + u282 + u283 + u284 + u285 + u286 + u287 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf922, (8*(((u280 + u281 + u282 + u283 + u284 + u285 + u286 + u287 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_52
    buf923 = reader.storage(None, 22528*(((u280 + u281 + u282 + u283 + u284 + u285 + u286 + u287 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf923, (8*(((u280 + u281 + u282 + u283 + u284 + u285 + u286 + u287 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_868
    buf924 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf924, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_148
    buf925 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf925, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_149
    buf926 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf926, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_888
    buf927 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf927, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1229
    buf928 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf928, (2, 4096, 1), is_leaf=True)  # rsqrt_57
    buf929 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf929, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1242
    buf930 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf930, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_263
    buf931 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf931, (2, 4096, 1), is_leaf=True)  # rsqrt_58
    buf932 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf932, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1256
    buf933 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf933, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_284
    buf934 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf934, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_285
    buf935 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf935, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_286
    buf936 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf936, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_267
    buf937 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf937, (2, 16, 4096), is_leaf=True)  # getitem_268
    buf938 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf938, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1232
    buf939 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf939, (2, 4096, 1), is_leaf=True)  # rsqrt_59
    buf940 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf940, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1264
    buf941 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf941, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_155
    buf942 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf942, (8192, 1), is_leaf=True)  # amax_18
    buf943 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf943, (8192, 1), is_leaf=True)  # sum_73
    buf944 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf944, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_271
    buf945 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf945, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_273
    buf946 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf946, (49152,), dtype=torch.int64, is_leaf=True)  # div_92
    buf947 = reader.storage(None, 32*(((u296 + u297 + u298 + u299 + u300 + u301 + u302 + u303 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf947, (8*(((u296 + u297 + u298 + u299 + u300 + u301 + u302 + u303 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_274
    buf948 = reader.storage(None, 32768*(((u296 + u297 + u298 + u299 + u300 + u301 + u302 + u303 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf948, (8*(((u296 + u297 + u298 + u299 + u300 + u301 + u302 + u303 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_37
    buf949 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf949, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_56
    buf950 = reader.storage(None, 22528*(((u296 + u297 + u298 + u299 + u300 + u301 + u302 + u303 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf950, (8*(((u296 + u297 + u298 + u299 + u300 + u301 + u302 + u303 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_54
    buf951 = reader.storage(None, 22528*(((u296 + u297 + u298 + u299 + u300 + u301 + u302 + u303 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf951, (8*(((u296 + u297 + u298 + u299 + u300 + u301 + u302 + u303 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_55
    buf952 = reader.storage(None, 22528*(((u296 + u297 + u298 + u299 + u300 + u301 + u302 + u303 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf952, (8*(((u296 + u297 + u298 + u299 + u300 + u301 + u302 + u303 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_917
    buf953 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf953, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_156
    buf954 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf954, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_157
    buf955 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf955, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_937
    buf956 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf956, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1297
    buf957 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf957, (2, 4096, 1), is_leaf=True)  # rsqrt_60
    buf958 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf958, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1309
    buf959 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf959, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_277
    buf960 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf960, (2, 4096, 1), is_leaf=True)  # rsqrt_61
    buf961 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf961, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1323
    buf962 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf962, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_299
    buf963 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf963, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_300
    buf964 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf964, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_301
    buf965 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf965, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_281
    buf966 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf966, (2, 16, 4096), is_leaf=True)  # getitem_282
    buf967 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf967, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1300
    buf968 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf968, (2, 4096, 1), is_leaf=True)  # rsqrt_62
    buf969 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf969, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1331
    buf970 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf970, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_163
    buf971 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf971, (8192, 1), is_leaf=True)  # amax_19
    buf972 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf972, (8192, 1), is_leaf=True)  # sum_77
    buf973 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf973, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_285
    buf974 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf974, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_287
    buf975 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf975, (49152,), dtype=torch.int64, is_leaf=True)  # div_97
    buf976 = reader.storage(None, 32*(((u312 + u313 + u314 + u315 + u316 + u317 + u318 + u319 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf976, (8*(((u312 + u313 + u314 + u315 + u316 + u317 + u318 + u319 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_288
    buf977 = reader.storage(None, 32768*(((u312 + u313 + u314 + u315 + u316 + u317 + u318 + u319 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf977, (8*(((u312 + u313 + u314 + u315 + u316 + u317 + u318 + u319 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_39
    buf978 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf978, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_59
    buf979 = reader.storage(None, 22528*(((u312 + u313 + u314 + u315 + u316 + u317 + u318 + u319 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf979, (8*(((u312 + u313 + u314 + u315 + u316 + u317 + u318 + u319 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_57
    buf980 = reader.storage(None, 22528*(((u312 + u313 + u314 + u315 + u316 + u317 + u318 + u319 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf980, (8*(((u312 + u313 + u314 + u315 + u316 + u317 + u318 + u319 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_58
    buf981 = reader.storage(None, 22528*(((u312 + u313 + u314 + u315 + u316 + u317 + u318 + u319 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf981, (8*(((u312 + u313 + u314 + u315 + u316 + u317 + u318 + u319 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_966
    buf982 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf982, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_164
    buf983 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf983, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_165
    buf984 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf984, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_986
    buf985 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf985, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1365
    buf986 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf986, (2, 4096, 1), is_leaf=True)  # rsqrt_63
    buf987 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf987, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1376
    buf988 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf988, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_291
    buf989 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf989, (2, 4096, 1), is_leaf=True)  # rsqrt_64
    buf990 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf990, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1390
    buf991 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf991, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_314
    buf992 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf992, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_315
    buf993 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf993, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_316
    buf994 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf994, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_295
    buf995 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf995, (2, 16, 4096), is_leaf=True)  # getitem_296
    buf996 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf996, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1368
    buf997 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf997, (2, 4096, 1), is_leaf=True)  # rsqrt_65
    buf998 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf998, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1398
    buf999 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf999, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_171
    buf1000 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1000, (8192, 1), is_leaf=True)  # amax_20
    buf1001 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1001, (8192, 1), is_leaf=True)  # sum_81
    buf1002 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1002, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_299
    buf1003 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1003, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_301
    buf1004 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1004, (49152,), dtype=torch.int64, is_leaf=True)  # div_102
    buf1005 = reader.storage(None, 32*(((u328 + u329 + u330 + u331 + u332 + u333 + u334 + u335 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1005, (8*(((u328 + u329 + u330 + u331 + u332 + u333 + u334 + u335 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_302
    buf1006 = reader.storage(None, 32768*(((u328 + u329 + u330 + u331 + u332 + u333 + u334 + u335 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1006, (8*(((u328 + u329 + u330 + u331 + u332 + u333 + u334 + u335 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_41
    buf1007 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1007, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_62
    buf1008 = reader.storage(None, 22528*(((u328 + u329 + u330 + u331 + u332 + u333 + u334 + u335 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1008, (8*(((u328 + u329 + u330 + u331 + u332 + u333 + u334 + u335 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_60
    buf1009 = reader.storage(None, 22528*(((u328 + u329 + u330 + u331 + u332 + u333 + u334 + u335 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1009, (8*(((u328 + u329 + u330 + u331 + u332 + u333 + u334 + u335 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_61
    buf1010 = reader.storage(None, 22528*(((u328 + u329 + u330 + u331 + u332 + u333 + u334 + u335 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1010, (8*(((u328 + u329 + u330 + u331 + u332 + u333 + u334 + u335 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_1015
    buf1011 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1011, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_172
    buf1012 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1012, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_173
    buf1013 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1013, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_1035
    buf1014 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1014, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1433
    buf1015 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1015, (2, 4096, 1), is_leaf=True)  # rsqrt_66
    buf1016 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1016, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1443
    buf1017 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1017, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_305
    buf1018 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1018, (2, 4096, 1), is_leaf=True)  # rsqrt_67
    buf1019 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1019, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1457
    buf1020 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1020, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_329
    buf1021 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1021, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_330
    buf1022 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1022, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_331
    buf1023 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1023, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_309
    buf1024 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf1024, (2, 16, 4096), is_leaf=True)  # getitem_310
    buf1025 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1025, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1436
    buf1026 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1026, (2, 4096, 1), is_leaf=True)  # rsqrt_68
    buf1027 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1027, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1465
    buf1028 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1028, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_179
    buf1029 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1029, (8192, 1), is_leaf=True)  # amax_21
    buf1030 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1030, (8192, 1), is_leaf=True)  # sum_85
    buf1031 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1031, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_313
    buf1032 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1032, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_315
    buf1033 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1033, (49152,), dtype=torch.int64, is_leaf=True)  # div_107
    buf1034 = reader.storage(None, 32*(((u344 + u345 + u346 + u347 + u348 + u349 + u350 + u351 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1034, (8*(((u344 + u345 + u346 + u347 + u348 + u349 + u350 + u351 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_316
    buf1035 = reader.storage(None, 32768*(((u344 + u345 + u346 + u347 + u348 + u349 + u350 + u351 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1035, (8*(((u344 + u345 + u346 + u347 + u348 + u349 + u350 + u351 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_43
    buf1036 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1036, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_65
    buf1037 = reader.storage(None, 22528*(((u344 + u345 + u346 + u347 + u348 + u349 + u350 + u351 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1037, (8*(((u344 + u345 + u346 + u347 + u348 + u349 + u350 + u351 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_63
    buf1038 = reader.storage(None, 22528*(((u344 + u345 + u346 + u347 + u348 + u349 + u350 + u351 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1038, (8*(((u344 + u345 + u346 + u347 + u348 + u349 + u350 + u351 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_64
    buf1039 = reader.storage(None, 22528*(((u344 + u345 + u346 + u347 + u348 + u349 + u350 + u351 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1039, (8*(((u344 + u345 + u346 + u347 + u348 + u349 + u350 + u351 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_1064
    buf1040 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1040, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_180
    buf1041 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1041, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_181
    buf1042 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1042, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_1084
    buf1043 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1043, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1501
    buf1044 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1044, (2, 4096, 1), is_leaf=True)  # rsqrt_69
    buf1045 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1045, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1510
    buf1046 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1046, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_319
    buf1047 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1047, (2, 4096, 1), is_leaf=True)  # rsqrt_70
    buf1048 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1048, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1524
    buf1049 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1049, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_344
    buf1050 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1050, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_345
    buf1051 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1051, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_346
    buf1052 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1052, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_323
    buf1053 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf1053, (2, 16, 4096), is_leaf=True)  # getitem_324
    buf1054 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1054, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1504
    buf1055 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1055, (2, 4096, 1), is_leaf=True)  # rsqrt_71
    buf1056 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1056, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1532
    buf1057 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1057, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_187
    buf1058 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1058, (8192, 1), is_leaf=True)  # amax_22
    buf1059 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1059, (8192, 1), is_leaf=True)  # sum_89
    buf1060 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1060, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_327
    buf1061 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1061, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_329
    buf1062 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1062, (49152,), dtype=torch.int64, is_leaf=True)  # div_112
    buf1063 = reader.storage(None, 32*(((u360 + u361 + u362 + u363 + u364 + u365 + u366 + u367 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1063, (8*(((u360 + u361 + u362 + u363 + u364 + u365 + u366 + u367 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_330
    buf1064 = reader.storage(None, 32768*(((u360 + u361 + u362 + u363 + u364 + u365 + u366 + u367 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1064, (8*(((u360 + u361 + u362 + u363 + u364 + u365 + u366 + u367 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_45
    buf1065 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1065, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_68
    buf1066 = reader.storage(None, 22528*(((u360 + u361 + u362 + u363 + u364 + u365 + u366 + u367 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1066, (8*(((u360 + u361 + u362 + u363 + u364 + u365 + u366 + u367 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_66
    buf1067 = reader.storage(None, 22528*(((u360 + u361 + u362 + u363 + u364 + u365 + u366 + u367 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1067, (8*(((u360 + u361 + u362 + u363 + u364 + u365 + u366 + u367 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_67
    buf1068 = reader.storage(None, 22528*(((u360 + u361 + u362 + u363 + u364 + u365 + u366 + u367 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1068, (8*(((u360 + u361 + u362 + u363 + u364 + u365 + u366 + u367 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_1113
    buf1069 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1069, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_188
    buf1070 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1070, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_189
    buf1071 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1071, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_1133
    buf1072 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1072, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1569
    buf1073 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1073, (2, 4096, 1), is_leaf=True)  # rsqrt_72
    buf1074 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1074, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1577
    buf1075 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1075, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_333
    buf1076 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1076, (2, 4096, 1), is_leaf=True)  # rsqrt_73
    buf1077 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1077, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1591
    buf1078 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1078, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_359
    buf1079 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1079, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_360
    buf1080 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1080, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_361
    buf1081 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1081, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_337
    buf1082 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf1082, (2, 16, 4096), is_leaf=True)  # getitem_338
    buf1083 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1083, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1572
    buf1084 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1084, (2, 4096, 1), is_leaf=True)  # rsqrt_74
    buf1085 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1085, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1599
    buf1086 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1086, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_195
    buf1087 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1087, (8192, 1), is_leaf=True)  # amax_23
    buf1088 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1088, (8192, 1), is_leaf=True)  # sum_93
    buf1089 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1089, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_341
    buf1090 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1090, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_343
    buf1091 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1091, (49152,), dtype=torch.int64, is_leaf=True)  # div_117
    buf1092 = reader.storage(None, 32*(((u376 + u377 + u378 + u379 + u380 + u381 + u382 + u383 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1092, (8*(((u376 + u377 + u378 + u379 + u380 + u381 + u382 + u383 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_344
    buf1093 = reader.storage(None, 32768*(((u376 + u377 + u378 + u379 + u380 + u381 + u382 + u383 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1093, (8*(((u376 + u377 + u378 + u379 + u380 + u381 + u382 + u383 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_47
    buf1094 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1094, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_71
    buf1095 = reader.storage(None, 22528*(((u376 + u377 + u378 + u379 + u380 + u381 + u382 + u383 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1095, (8*(((u376 + u377 + u378 + u379 + u380 + u381 + u382 + u383 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_69
    buf1096 = reader.storage(None, 22528*(((u376 + u377 + u378 + u379 + u380 + u381 + u382 + u383 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1096, (8*(((u376 + u377 + u378 + u379 + u380 + u381 + u382 + u383 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_70
    buf1097 = reader.storage(None, 22528*(((u376 + u377 + u378 + u379 + u380 + u381 + u382 + u383 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1097, (8*(((u376 + u377 + u378 + u379 + u380 + u381 + u382 + u383 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_1162
    buf1098 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1098, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_196
    buf1099 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1099, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_197
    buf1100 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1100, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_1182
    buf1101 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1101, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1637
    buf1102 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1102, (2, 4096, 1), is_leaf=True)  # rsqrt_75
    buf1103 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1103, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1644
    buf1104 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1104, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_347
    buf1105 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1105, (2, 4096, 1), is_leaf=True)  # rsqrt_76
    buf1106 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1106, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1658
    buf1107 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1107, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_374
    buf1108 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1108, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_375
    buf1109 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1109, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_376
    buf1110 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1110, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_351
    buf1111 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf1111, (2, 16, 4096), is_leaf=True)  # getitem_352
    buf1112 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1112, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1640
    buf1113 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1113, (2, 4096, 1), is_leaf=True)  # rsqrt_77
    buf1114 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1114, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1666
    buf1115 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1115, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_203
    buf1116 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1116, (8192, 1), is_leaf=True)  # amax_24
    buf1117 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1117, (8192, 1), is_leaf=True)  # sum_97
    buf1118 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1118, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_355
    buf1119 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1119, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_357
    buf1120 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1120, (49152,), dtype=torch.int64, is_leaf=True)  # div_122
    buf1121 = reader.storage(None, 32*(((u392 + u393 + u394 + u395 + u396 + u397 + u398 + u399 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1121, (8*(((u392 + u393 + u394 + u395 + u396 + u397 + u398 + u399 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_358
    buf1122 = reader.storage(None, 32768*(((u392 + u393 + u394 + u395 + u396 + u397 + u398 + u399 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1122, (8*(((u392 + u393 + u394 + u395 + u396 + u397 + u398 + u399 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_49
    buf1123 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1123, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_74
    buf1124 = reader.storage(None, 22528*(((u392 + u393 + u394 + u395 + u396 + u397 + u398 + u399 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1124, (8*(((u392 + u393 + u394 + u395 + u396 + u397 + u398 + u399 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_72
    buf1125 = reader.storage(None, 22528*(((u392 + u393 + u394 + u395 + u396 + u397 + u398 + u399 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1125, (8*(((u392 + u393 + u394 + u395 + u396 + u397 + u398 + u399 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_73
    buf1126 = reader.storage(None, 22528*(((u392 + u393 + u394 + u395 + u396 + u397 + u398 + u399 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1126, (8*(((u392 + u393 + u394 + u395 + u396 + u397 + u398 + u399 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_1211
    buf1127 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1127, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_204
    buf1128 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1128, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_205
    buf1129 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1129, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_1231
    buf1130 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1130, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1705
    buf1131 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1131, (2, 4096, 1), is_leaf=True)  # rsqrt_78
    buf1132 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1132, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1711
    buf1133 = reader.storage(None, 9437184, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1133, (2, 4096, 512), (2359296, 576, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_361
    buf1134 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1134, (2, 4096, 1), is_leaf=True)  # rsqrt_79
    buf1135 = reader.storage(None, 8388608, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1135, (8192, 512), dtype=torch.bfloat16, is_leaf=True)  # view_1725
    buf1136 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1136, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_389
    buf1137 = reader.storage(None, 50331648, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1137, (2, 16, 4096, 192), (12582912, 192, 3072, 1), dtype=torch.bfloat16, is_leaf=True)  # permute_390
    buf1138 = reader.storage(None, 67108864, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1138, (2, 16, 4096, 128), (16777216, 256, 4096, 1), dtype=torch.bfloat16, storage_offset=128, is_leaf=True)  # permute_391
    buf1139 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1139, (2, 16, 4096, 128), (8388608, 128, 2048, 1), dtype=torch.bfloat16, is_leaf=True)  # getitem_365
    buf1140 = reader.storage(None, 524288, device=device(type='cuda', index=0))
    reader.tensor(buf1140, (2, 16, 4096), is_leaf=True)  # getitem_366
    buf1141 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1141, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1708
    buf1142 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1142, (2, 4096, 1), is_leaf=True)  # rsqrt_80
    buf1143 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1143, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1733
    buf1144 = reader.storage(None, 1048576, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1144, (8192, 64), dtype=torch.bfloat16, is_leaf=True)  # mm_211
    buf1145 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1145, (8192, 1), is_leaf=True)  # amax_25
    buf1146 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1146, (8192, 1), is_leaf=True)  # sum_101
    buf1147 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1147, (8192, 6), dtype=torch.int64, is_leaf=True)  # getitem_369
    buf1148 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1148, (49152,), dtype=torch.int64, is_leaf=True)  # getitem_371
    buf1149 = reader.storage(None, 393216, device=device(type='cuda', index=0), dtype_hint=torch.int64)
    reader.tensor(buf1149, (49152,), dtype=torch.int64, is_leaf=True)  # div_127
    buf1150 = reader.storage(None, 32*(((u408 + u409 + u410 + u411 + u412 + u413 + u414 + u415 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1150, (8*(((u408 + u409 + u410 + u411 + u412 + u413 + u414 + u415 + 71)//8)),), dtype=torch.int32, is_leaf=True)  # getitem_372
    buf1151 = reader.storage(None, 32768*(((u408 + u409 + u410 + u411 + u412 + u413 + u414 + u415 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1151, (8*(((u408 + u409 + u410 + u411 + u412 + u413 + u414 + u415 + 71)//8)), 2048), dtype=torch.bfloat16, is_leaf=True)  # index_51
    buf1152 = reader.storage(None, 32, device=device(type='cuda', index=0), dtype_hint=torch.int32)
    reader.tensor(buf1152, (8,), dtype=torch.int32, is_leaf=True)  # cumsum_77
    buf1153 = reader.storage(None, 22528*(((u408 + u409 + u410 + u411 + u412 + u413 + u414 + u415 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1153, (8*(((u408 + u409 + u410 + u411 + u412 + u413 + u414 + u415 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_75
    buf1154 = reader.storage(None, 22528*(((u408 + u409 + u410 + u411 + u412 + u413 + u414 + u415 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1154, (8*(((u408 + u409 + u410 + u411 + u412 + u413 + u414 + u415 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # _grouped_mm_76
    buf1155 = reader.storage(None, 22528*(((u408 + u409 + u410 + u411 + u412 + u413 + u414 + u415 + 71)//8)), device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1155, (8*(((u408 + u409 + u410 + u411 + u412 + u413 + u414 + u415 + 71)//8)), 1408), dtype=torch.bfloat16, is_leaf=True)  # mul_1260
    buf1156 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1156, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_212
    buf1157 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1157, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mm_213
    buf1158 = reader.storage(None, 46137344, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1158, (8192, 2816), dtype=torch.bfloat16, is_leaf=True)  # mul_1280
    buf1159 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1159, (2, 4096, 2048), dtype=torch.bfloat16, is_leaf=True)  # add_1773
    buf1160 = reader.storage(None, 32768, device=device(type='cuda', index=0))
    reader.tensor(buf1160, (2, 4096, 1), is_leaf=True)  # rsqrt_81
    buf1161 = reader.storage(None, 33554432, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1161, (8192, 2048), dtype=torch.bfloat16, is_leaf=True)  # view_1778
    buf1162 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1162, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_406
    buf1163 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1163, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_407
    buf1164 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1164, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_456
    buf1165 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1165, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_457
    buf1166 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1166, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_506
    buf1167 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1167, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_507
    buf1168 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1168, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_556
    buf1169 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1169, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_557
    buf1170 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1170, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_606
    buf1171 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1171, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_607
    buf1172 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1172, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_656
    buf1173 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1173, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_657
    buf1174 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1174, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_706
    buf1175 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1175, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_707
    buf1176 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1176, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_756
    buf1177 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1177, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_757
    buf1178 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1178, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_806
    buf1179 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1179, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_807
    buf1180 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1180, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_856
    buf1181 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1181, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_857
    buf1182 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1182, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_906
    buf1183 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1183, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_907
    buf1184 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1184, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_956
    buf1185 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1185, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_957
    buf1186 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1186, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1006
    buf1187 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1187, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1007
    buf1188 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1188, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1056
    buf1189 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1189, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1057
    buf1190 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1190, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1106
    buf1191 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1191, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1107
    buf1192 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1192, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1156
    buf1193 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1193, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1157
    buf1194 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1194, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1206
    buf1195 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1195, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1207
    buf1196 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1196, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1256
    buf1197 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1197, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1257
    buf1198 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1198, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1306
    buf1199 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1199, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1307
    buf1200 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1200, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1356
    buf1201 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1201, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1357
    buf1202 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1202, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1406
    buf1203 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1203, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1407
    buf1204 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1204, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1456
    buf1205 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1205, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1457
    buf1206 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1206, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1506
    buf1207 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1207, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1507
    buf1208 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1208, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1556
    buf1209 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1209, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1557
    buf1210 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1210, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1606
    buf1211 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1211, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1607
    buf1212 = reader.storage(None, 196608, device=device(type='cuda', index=0))
    reader.tensor(buf1212, (8192, 6, 1), (6, 1, 6), is_leaf=True)  # permute_1656
    buf1213 = reader.storage(None, 402653184, device=device(type='cuda', index=0))
    reader.tensor(buf1213, (8192, 2048, 6), (12288, 1, 2048), is_leaf=True)  # permute_1657
    buf1214 = reader.storage(None, 1677721600, device=device(type='cuda', index=0), dtype_hint=torch.bfloat16)
    reader.tensor(buf1214, (2, 4096, 102400), dtype=torch.bfloat16, is_leaf=True)  # tangents_1
load_args._version = 0
mod = Repro()
if __name__ == '__main__':
    from torch._dynamo.repro.after_aot import run_repro
    from torch._dynamo.repro.after_aot import setup_fake_process_groups
    setup_fake_process_groups({'0': {'size': 64, 'rank': 0}, '521': {'size': 8, 'rank': 0}, '513': {'size': 8, 'rank': 0}})
    with torch.no_grad():
        run_repro(mod, load_args, accuracy=False, command='run', save_dir=None, tracing_mode='symbolic', check_str=None)
        # To run it separately, do 
        # mod, args = run_repro(mod, load_args, accuracy=False, command='get_args', save_dir=None, tracing_mode='symbolic', check_str=None)
        # mod(*args)
    dist.destroy_process_group()

# Helper functions for overlap simulator
def get_mesh_sizes():
    """Return mesh dimensions for DSv3 with 64 GPUs (FSDP=64, TP=8, EP=8)."""
    return (1, 8, 8)

def get_pg_names():
    """Return process group names."""
    return ["0", "513", "521"]

def get_colls_estimations_file():
    """Return collective estimations table filename."""
    return "colls_dsv3_bw_64.table"
